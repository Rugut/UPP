Процедура ДействияФормыВыполнитьОбмен(Кнопка)
	
	ПроизвестиОбменДанными();	
	
КонецПроцедуры

Процедура ПроизвестиОбменДанными()
	
	Если ЭлементыФормы.СправочникСписок.ВыделенныеСтроки = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	МассивОбменов = Новый Массив();
    Для Каждого ВыделеннаяСтрока Из ЭлементыФормы.СправочникСписок.ВыделенныеСтроки Цикл
		
		ПроцедурыОбменаССайтом.ВыполнитьАвтообмен(ВыделеннаяСтрока.Ссылка, Ложь);
		
	КонецЦикла;
	
	// после проведения обмена данными, надо обновить список
	Обновить();
	
КонецПроцедуры

Процедура ДействияФормыОткрытьМониторОбменов(Кнопка)
	
	Если ЭлементыФормы.СправочникСписок.ТекущиеДанные = Неопределено Тогда
		Возврат;
	КонецЕсли;		
	
	ПроцедурыОбменаДаннымиКлиент.ОткрытьМониторОбменовДляНастройки(ЭлементыФормы.СправочникСписок.ТекущиеДанные.ссылка, ЭтаФорма);
	
КонецПроцедуры

Процедура СправочникСписокПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки)
	
	ПроцедурыОбменаДаннымиКлиент.ДействияСправочникСписокПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки);
	ОформлениеСтроки.Ячейки.АдресДляОбмена.Значение = ?(ДанныеСтроки.ВыгружатьНаСайт, ДанныеСтроки.HTTPОбменАдресСайта, ДанныеСтроки.КаталогВыгрузки);
	
КонецПроцедуры

Процедура СправочникСписокПриПолученииДанных(Элемент, ОформленияСтрок)
	
	ПроцедурыОбменаДаннымиКлиент.ДействияСправочникСписокПриПолученииДанныхОбменСWEB(Элемент, ОформленияСтрок);	
	
КонецПроцедуры

Процедура ДействияФормыПомощникНастройкиОбмена(Кнопка)
	
	ОбработкаПомощника = Обработки.ПомощникНастройкиОбменаДаннымиССайтом.Создать();
	ФормаНастройки = ОбработкаПомощника.ПолучитьФорму("Форма");
	ФормаНастройки.Открыть();
	
КонецПроцедуры

СправочникСписок.Колонки.Добавить("ИспользоватьРегламентныеЗадания");
СправочникСписок.Колонки.Добавить("HTTPОбменАдресСайта");
СправочникСписок.Колонки.Добавить("КаталогВыгрузки");
СправочникСписок.Колонки.Добавить("ВыгружатьНаСайт");