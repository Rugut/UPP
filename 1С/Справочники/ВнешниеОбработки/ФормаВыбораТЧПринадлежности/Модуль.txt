Процедура ЗаполнитьСписокОбъектов()
    ЕСли УжеВыбранные = Неопределено  Тогда
		УжеВыбранные = Новый Соответствие;
	КонецЕсли;
	
	СписокТабЧастей = ПолучитьСписокТабличныхЧастей();
	
	Для Каждого ТабличнаяЧасть Из СписокТабЧастей Цикл
		Если УжеВыбранные[ТабличнаяЧасть.Значение] = Неопределено Тогда
			СписокТабличныхЧастей.Добавить(ТабличнаяЧасть.Значение, ТабличнаяЧасть.Представление);
		КонецЕсли;
	КонецЦикла;
КонецПроцедуры

Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
	ЗаполнитьСписокОбъектов();
КонецПроцедуры

Процедура ОсновныеДействияФормыКнопкаОК(Кнопка)	
	ОповеститьОВыборе(ЭлементыФормы.СписокТабличныхЧастей.ТекущаяСтрока);
КонецПроцедуры

Процедура СписокДокументовВыбор(Элемент, ВыбраннаяСтрока, Колонка, СтандартнаяОбработка)
	ОповеститьОВыборе(ЭлементыФормы.СписокТабличныхЧастей.ТекущаяСтрока);
КонецПроцедуры

Процедура ПриПовторномОткрытии(СтандартнаяОбработка)
	ЗаполнитьСписокОбъектов(); 
КонецПроцедуры

Функция ПолучитьСписокТабличныхЧастей()

	Объект = Неопределено;
	
	Если Лев(МетаданныеОбъекта, 8) = "Документ" Тогда
		Объект = Документы[Сред(МетаданныеОбъекта, 10)].СоздатьДокумент();
	ИначеЕсли Лев(МетаданныеОбъекта, 10) = "Справочник" Тогда
		Объект = Справочники[Сред(МетаданныеОбъекта, 12)].СоздатьЭлемент();
	КонецЕсли; 
	
	Если Объект <> Неопределено Тогда
		Попытка
			Возврат Объект.ПолучитьТабличныеЧастиДляЗаполнения();
		Исключение
		КонецПопытки;
	КонецЕсли;
	
	СписокТабЧастей = Новый СписокЗначений;
	
	Для Каждого ТабличнаяЧасть Из Метаданные.НайтиПоПолномуИмени(МетаданныеОбъекта).ТабличныеЧасти Цикл
		СписокТабЧастей.Добавить(ТабличнаяЧасть.Имя, ТабличнаяЧасть.Синоним);
	КонецЦикла;
	
	Возврат СписокТабЧастей;
	
КонецФункции