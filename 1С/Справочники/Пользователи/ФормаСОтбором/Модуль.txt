Процедура УстановитьОтбор(ЗначениеОтбора)

	ТипЗначенияОтбора = ТипЗнч(ЗначениеОтбора);
	Если ТипЗначенияОтбора = Тип("СправочникСсылка.ПрофилиПолномочийПользователей") Тогда
		ПолеОтбора = "ПрофильПолномочийПользователя";
		Отбор[ПолеОтбора].ВидСравнения = ВидСравнения.Равно;
		
	ИначеЕсли ТипЗначенияОтбора = Тип("СписокЗначений") Тогда
		ПолеОтбора = "Ссылка";
		Отбор[ПолеОтбора].ВидСравнения = ВидСравнения.ВСписке;
		
	Иначе
		Возврат;
	КонецЕсли; 
	
	Отбор[ПолеОтбора].Использование = Истина;
	Отбор[ПолеОтбора].Значение = ЗначениеОтбора;
	
КонецПроцедуры // УстановитьОтбор
 
Процедура УстановитьОтборПриОткрытии()

	Если ПараметрТекущаяСтрока <> Неопределено Тогда
		ЗначениеОтбора = ПараметрТекущаяСтрока;
	ИначеЕсли НачальноеЗначениеВыбора <> Неопределено Тогда
		ЗначениеОтбора = НачальноеЗначениеВыбора;
	Иначе
		Возврат;
	КонецЕсли;
	
	УстановитьОтбор(ЗначениеОтбора);
	
КонецПроцедуры // УстановитьОтборПриОткрытии
 
Процедура ПриОткрытии()
	
	УстановитьОтборПриОткрытии();
	
КонецПроцедуры

Процедура ПриПовторномОткрытии(СтандартнаяОбработка)
	
	УстановитьОтборПриОткрытии();
	
КонецПроцедуры

Процедура ОбработкаОповещения(ИмяСобытия, Параметр, Источник)
	
	Если ИмяСобытия = "ПоказатьПользователейПоОтбору" Тогда
		УстановитьОтбор(Параметр);
	КонецЕсли; 
	
КонецПроцедуры

Процедура СправочникСписокВыбор(Элемент, ВыбраннаяСтрока, Колонка, СтандартнаяОбработка)
	
	// Не используем стандартную обработку, т.к. в этом случае форма открывается на просмотр	
	СтандартнаяОбработка = Ложь;
	
	ВыбраннаяСтрока.ПолучитьФорму().Открыть();
	
КонецПроцедуры