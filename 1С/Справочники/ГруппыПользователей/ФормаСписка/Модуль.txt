Функция ПолучитьПользователейГруппы(ГруппаПользователей)
	
	ПользователиГруппы = Новый СписокЗначений;	

	ТабличнаяЧастьГруппы = ГруппаПользователей.ПользователиГруппы;
	
	Для каждого СтрокаТабличнойЧасти Из ТабличнаяЧастьГруппы Цикл
		ПользователиГруппы.Добавить(СтрокаТабличнойЧасти.Пользователь);
	КонецЦикла; 
	
	Возврат ПользователиГруппы;
	
КонецФункции // 
 

// Процедура оповещает форму пользователей ФормаСОтбором
// чтобы показать пользователей текущего профиля
//
Процедура ОповеститьФормуПользователейСОтборомПоПрофилю()

	ТекущиеДанные = ЭлементыФормы.СправочникСписок.ТекущиеДанные;
	Если ТекущиеДанные <> Неопределено Тогда
		ЗначениеОтбора = ПолучитьПользователейГруппы(ТекущиеДанные.Ссылка);
	Иначе
		ЗначениеОтбора = Неопределено;
	КонецЕсли;
	
	Оповестить("ПоказатьПользователейПоОтбору", ЗначениеОтбора, ЭтаФорма);	
	
КонецПроцедуры // ОповеститьФормуПользователейСОтборомПоПрофилю

Процедура ДействияФормыПрава(Кнопка)
	
	Если Не ЭлементыФормы.СправочникСписок.ТекущиеДанные = Неопределено
	   И ЗначениеЗаполнено(ЭлементыФормы.СправочникСписок.ТекущиеДанные.Ссылка) Тогда
		НастройкаПравДоступа.РедактироватьПраваДоступа(ЭлементыФормы.СправочникСписок.ТекущиеДанные.Ссылка);
	КонецЕсли;
	
КонецПроцедуры

Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
	
	Если НЕ ПараметрыСеанса.ИспользоватьОграниченияПравДоступаНаУровнеЗаписей Тогда
		ЭлементыФормы.ДействияФормы.Кнопки.Удалить(ЭлементыФормы.ДействияФормы.Кнопки.Права);
		ЭлементыФормы.ДействияФормы.Кнопки.Удалить(ЭлементыФормы.ДействияФормы.Кнопки.РазделительПрава);
	КонецЕсли;
	
КонецПроцедуры

Процедура ДействияФормыДействиеПоказатьСоставПользователей(Кнопка)
	
	ТекущиеДанные = ЭлементыФормы.СправочникСписок.ТекущиеДанные;
	Если ТекущиеДанные = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	ЗначениеОтбора = ПолучитьПользователейГруппы(ТекущиеДанные.Ссылка);	
	
	ФормаСОтбором = Справочники.Пользователи.ПолучитьФорму("ФормаСОтбором");
	ФормаСОтбором.НачальноеЗначениеВыбора = ЗначениеОтбора;
	ФормаСОтбором.Открыть();
	
КонецПроцедуры

Процедура СправочникСписокПриАктивизацииСтроки(Элемент)
	
	ОповеститьФормуПользователейСОтборомПоПрофилю();
	
КонецПроцедуры