Перем СхемаОтчета Экспорт;

Функция ПолучитьНовыйКлюч(ТаблицаИсточникиДанных)
	
	МаксКлюч = 0;
	
	Для каждого ЭлКоллекции Из ТаблицаИсточникиДанных Цикл
		Если МаксКлюч <= ЭлКоллекции.КлючИсточника Тогда
			МаксКлюч = ЭлКоллекции.КлючИсточника + 1;
		КонецЕсли;	
	КонецЦикла; 
	
	Возврат МаксКлюч;

КонецФункции //

Функция ДобавитьИсточникДанных(ТаблицаИсточникиДанных) Экспорт

	НовыйИсточникДанных = ТаблицаИсточникиДанных.Добавить();
	НовыйИсточникДанных.КлючИсточника = ПолучитьНовыйКлюч(ТаблицаИсточникиДанных);

КонецФункции //