////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ЭЛЕМЕНТОВ ФОРМЫ

Процедура ДействияФормыРедактироватьКод(Кнопка)
	МеханизмНумерацииОбъектов.ИзменениеВозможностиРедактированияНомера(Метаданные.Справочники.ВидыКонтактнойИнформации, ЭлементыФормы.СправочникСписок, ЭлементыФормы.ДействияФормы.Кнопки.Подменю, ЭлементыФормы.СправочникСписок.Колонки.Код);
КонецПроцедуры
// Процедура вызывается перед началом изменения строки списка справочника
//
Процедура СправочникСписокПередНачаломИзменения(Элемент, Отказ)
	Если Элемент.ТекущиеДанные <> Неопределено Тогда
		Отказ = Элемент.ТекущиеДанные.Предопределенный
	КонецЕсли;
КонецПроцедуры

// Процедура вызывается при начале редактирования строки списка справочника
//
Процедура СправочникСписокПриНачалеРедактирования(Элемент, НоваяСтрока)

	Если НоваяСтрока Тогда

		Если Отбор.ВидОбъектаКонтактнойИнформации.Использование = Истина
		   И Отбор.ВидОбъектаКонтактнойИнформации.Значение <> Неопределено Тогда
			Элемент.ТекущиеДанные.ВидОбъектаКонтактнойИнформации = Отбор.ВидОбъектаКонтактнойИнформации.Значение;
		КонецЕсли;

		Если Отбор.Тип.Использование = Истина
		   И Отбор.Тип.Значение <> Неопределено Тогда
			Если ТипЗнч(Отбор.Тип.Значение) = Тип("СписокЗначений") И Отбор.Тип.Значение.Количество()>0 Тогда
				ВыбранныйЭлементСписка = Отбор.Тип.Значение.ВыбратьЭлемент();
				Если ВыбранныйЭлементСписка = Неопределено Тогда
					Элемент.ТекущиеДанные.Тип = Отбор.Тип.Значение[0];
				Иначе
					Элемент.ТекущиеДанные.Тип = ВыбранныйЭлементСписка.Значение;
				КонецЕсли; 
			Иначе
				Элемент.ТекущиеДанные.Тип = Отбор.Тип.Значение;
			КонецЕсли; 
		КонецЕсли;

	КонецЕсли;

КонецПроцедуры

// Процедура вызывается перед окончанием редактирования строки
//
Процедура СправочникСписокПередОкончаниемРедактирования(Элемент, НоваяСтрока, ОтменаРедактирования, Отказ)

	Если Элемент.ТекущиеДанные.ВидОбъектаКонтактнойИнформации.Пустая() И НЕ ОтменаРедактирования Тогда
		Предупреждение("Укажите вид объекта контактной информации.");
		ЭлементыФормы.СправочникСписок.Колонки.ВидОбъектаКонтактнойИнформации.Видимость = Истина;
		Отказ = Истина;
		Возврат;
	КонецЕсли;

КонецПроцедуры

Процедура ПриОткрытии()
	
	МеханизмНумерацииОбъектов.ДобавитьВМенюДействияКнопкуРедактированияКода(ЭлементыФормы.ДействияФормы.Кнопки.Подменю);
	МеханизмНумерацииОбъектов.УстановитьДоступностьПоляВводаНомера(Метаданные.Справочники.ВидыКонтактнойИнформации, ЭлементыФормы.СправочникСписок, ЭлементыФормы.ДействияФормы.Кнопки.Подменю, ЭлементыФормы.СправочникСписок.Колонки.Код);
КонецПроцедуры