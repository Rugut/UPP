// Структура содержащая данные о связи элементов управления быстрых отборов с данными
Перем СтруктураСвязиЭлементовСДанными;

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

// Обработчик события ПриОткрытии формы.
//
Процедура ПриОткрытии()
	
	УправлениеОтчетами.УстановитьСвязьПолейБыстрогоОтбораНаФорме(ЭлементыФормы, ПостроительОтчета.Отбор, СтруктураСвязиЭлементовСДанными, "ОбработкаОбъект.ПостроительОтчета.Отбор");
	ЭлектронныеПисьмаСписок.Отбор.ЭлектронныеПисьмаПоАдресуЭлектроннойПочты.Использование = Истина;
	ЭлементыФормы.ЭлектронныеПисьмаСписок.НастройкаОтбора.ЭлектронныеПисьмаПоАдресуЭлектроннойПочты.Доступность = Ложь;
	
КонецПроцедуры

// Обработчик события ПередОткрытием формы.
//
Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
	
	Если НЕ Константы.ИспользованиеВстроенногоПочтовогоКлиента.Получить() Тогда
		Предупреждение("Данная опция доступна только в режиме использования встроенного почтового клиента.");
		Отказ = Истина;
	КонецЕсли; 
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ОБРАБОТЧИКИ СОБЫТИЙ КОМАНДНЫХ ПАНЕЛЕЙ ФОРМЫ

// Обработчик события Нажатие элемента формы КоманднаяПанель.Обновить.
//
Процедура КоманднаяПанельОбновить(Кнопка)
	
	ОбновитьТаблицуПисем(ЭлектронныеПисьмаСписок);
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ОБРАБОТЧИКИ СОБЫТИЙ ЭЛЕМЕНТОВ ФОРМЫ

// Обработчик события ПриИзменении элемента формы ПолеВидаСравненияОбъектПоиска.
//
Процедура ПолеВидаСравненияОбъектПоискаПриИзменении(Элемент)
	
	УправлениеОтчетами.ПолеВидаСравненияПриИзменении(Элемент, ЭлементыФормы);
	ОбновитьТаблицуПисем(ЭлектронныеПисьмаСписок);
	
КонецПроцедуры

// Обработчик события ПриИзменении элемента формы ПолеНастройкиОбъектПоиска.
//
Процедура ПолеНастройкиОбъектПоискаПриИзменении(Элемент)
	
	УправлениеОтчетами.ПолеНастройкиПриИзменении(Элемент, ПостроительОтчета.Отбор);
	ОбновитьТаблицуПисем(ЭлектронныеПисьмаСписок);
	
КонецПроцедуры

// Обработчик события ПриВыводеСтроки элемента формы ЭлектронныеПисьмаСписок.
//
Процедура ЭлектронныеПисьмаСписокПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки)
	
	УправлениеЭлектроннойПочтой.ПриВыводеСтрокиЭлектронногоПисьма(Элемент, ОформлениеСтроки, ДанныеСтроки);
	
КонецПроцедуры

Для каждого Реквизит Из Метаданные.Документы.ЭлектронноеПисьмо.Реквизиты Цикл
	ЭлектронныеПисьмаСписок.Колонки.Добавить(Реквизит.Имя, Ложь);
КонецЦикла;