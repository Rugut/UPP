Перем ПравилаОбмена;

// Процедура выполняет выгрузку по списку 
//
Процедура ВыполнитьВыгрузку() Экспорт

	Если СписокОбъектов.Количество() = 0 Тогда
		Возврат;
	КонецЕсли;
	
	ИмяФайлаПравилОбмена = ПолучитьИмяВременногоФайла("xml");
	ПравилаОбмена.Вывод = ИспользованиеВывода.Разрешить; 
	ПравилаОбмена.Записать(ИмяФайлаПравилОбмена);
	
	УниверсальныйОбменДаннымиXML = Обработки.УниверсальныйОбменДаннымиXML.Создать();
	
	УниверсальныйОбменДаннымиXML.ЗагрузитьПравилаОбмена(ИмяФайлаПравилОбмена);
	УниверсальныйОбменДаннымиXML.Параметры.Вставить("СписокСсылок", СписокОбъектов.ВыгрузитьЗначения());
	
	УниверсальныйОбменДаннымиXML.ИмяФайлаПравилОбмена = ИмяФайлаПравилОбмена;
	УниверсальныйОбменДаннымиXML.ИмяФайлаОбмена = ИмяФайлаОбмена;
	
	УниверсальныйОбменДаннымиXML.ВыполнитьВыгрузку();
	
КонецПроцедуры //

// Процедура выполняет инициализацию обработки
//
// Параметры:
//	МакетПравилОбмена	- <ТекстовыйДокумент>, содержит правила обмена
//	ИмяТипаОбъектов		- <Строка>, например "СправочникСсылка.ПроизвольныеОтчеты"
//
Процедура ИнициализироватьОбработку(Знач МакетПравилОбмена, ИмяТипаОбъектов) Экспорт

	ПравилаОбмена = МакетПравилОбмена;
	
	ТипВыгружаемыхОбъектов = Новый ОписаниеТипов(ИмяТипаОбъектов);
	
КонецПроцедуры //