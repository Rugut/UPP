Перем БылаНажатаКнопкаОК;

Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)

	Фамилия = НачальноеЗначениеВыбора.Фамилия;
	Имя = НачальноеЗначениеВыбора.Имя;
	Отчество = НачальноеЗначениеВыбора.Отчество;

	БылаНажатаКнопкаОК = Ложь;

КонецПроцедуры

Процедура ОсновныеДействияФормыОсновныеДействияФормыОк(Кнопка)

	ТестированиеДанных = Ложь;

	Если ПустаяСтрока(Фамилия) И ((НЕ ПустаяСтрока(Имя)) Или (НЕ ПустаяСтрока(Отчество))) Тогда
		Сообщить("Реквизит ""Фамилия"" не заполнен!", СтатусСообщения.Важное);
		ТестированиеДанных = Истина;
	КонецЕсли;

	Если НЕ ПустаяСтрока(Фамилия) И ((ПустаяСтрока(Имя)) И (НЕ ПустаяСтрока(Отчество))) Тогда
		Сообщить("Реквизит ""Имя"" не заполнен!", СтатусСообщения.Важное);
		ТестированиеДанных = Истина;
	КонецЕсли;

	// Заблокируем временно тестирование на заполненность.

	//Если ПустаяСтрока(Имя) Тогда
	//	Сообщить("Реквизит ""Имя"" не заполнен!", СтатусСообщения.Важное);
	//	ТестированиеДанных = Истина;
	//КонецЕсли;

	//Если ПустаяСтрока(Отчество) Тогда
	//	Сообщить("Реквизит ""Отчество"" не заполнен!", СтатусСообщения.Важное);
	//	ТестированиеДанных = Истина;
	//КонецЕсли;

	Если Найти(Фамилия, ",") > 0 Тогда
		Сообщить("В реквизите ""Фамилия"" найден недопустимый символ "",""!", СтатусСообщения.Важное);
		ТестированиеДанных = Истина;
	КонецЕсли;

	Если Найти(Имя, ",") > 0 Тогда
		Сообщить("В реквизите ""Имя"" найден недопустимый символ "",""!", СтатусСообщения.Важное);
		ТестированиеДанных = Истина;
	КонецЕсли;

	Если Найти(Отчество, ",") > 0 Тогда
		Сообщить("В реквизите ""Отчество"" найден недопустимый символ "",""!", СтатусСообщения.Важное);
		ТестированиеДанных = Истина;
	КонецЕсли;

	Если ТестированиеДанных Тогда
		Возврат;
	КонецЕсли;

	БылаНажатаКнопкаОК = Истина;
	Закрыть();

КонецПроцедуры

Процедура ПриЗакрытии()

	Если НЕ БылаНажатаКнопкаОк Тогда
		Возврат;
	КонецЕсли;

	НачальноеЗначениеВыбора.Вставить("Фамилия", Фамилия);
	НачальноеЗначениеВыбора.Вставить("Имя", Имя);
	НачальноеЗначениеВыбора.Вставить("Отчество", Отчество);

КонецПроцедуры

Процедура ПередЗакрытием(Отказ, СтандартнаяОбработка)
	Отказ = Истина;
	Закрыть(БылаНажатаКнопкаОК);
КонецПроцедуры