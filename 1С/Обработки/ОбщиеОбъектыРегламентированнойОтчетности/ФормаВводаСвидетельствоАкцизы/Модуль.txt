Перем БылаНажатаКнопкаОК;

Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)

	СвидСерия = НачальноеЗначениеВыбора.Серия;
	СвидНомер = НачальноеЗначениеВыбора.Номер;

	БылаНажатаКнопкаОК = Ложь;

КонецПроцедуры

Процедура ОсновныеДействияФормыОсновныеДействияФормыОк(Кнопка)

	ТестированиеДанных = Ложь;

	Если Найти(СвидСерия, ",") > 0 Тогда
		Сообщить("В реквизите ""Серия"" найдет недопустимый символ "",""!", СтатусСообщения.Важное);
		ТестированиеДанных = Истина;
	КонецЕсли;

	Если Найти(СвидНомер, ",") > 0 Тогда
		Сообщить("В реквизите ""Номер"" найдет недопустимый символ "",""!", СтатусСообщения.Важное);
		ТестированиеДанных = Истина;
	КонецЕсли;

	Если ТестированиеДанных Тогда
		Возврат;
	КонецЕсли;

	БылаНажатаКнопкаОК = Истина;
	Закрыть();

КонецПроцедуры

Процедура ПриЗакрытии()

	Если НЕ БылаНажатаКнопкаОк Тогда
		Возврат;
	КонецЕсли;

	НачальноеЗначениеВыбора.Вставить("Серия", СвидСерия);
	НачальноеЗначениеВыбора.Вставить("Номер", СвидНомер);

КонецПроцедуры

Процедура ПередЗакрытием(Отказ, СтандартнаяОбработка)
	Отказ = Истина;
	Закрыть(БылаНажатаКнопкаОК);
КонецПроцедуры