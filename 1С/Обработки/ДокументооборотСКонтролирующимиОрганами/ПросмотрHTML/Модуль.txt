Перем ИмяВременногоФайла;

Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
	
	Если ЗначениеЗаполнено(ИмяФайла) Тогда
		Заголовок = ИмяФайла + " - просмотр";
	ИначеЕсли ЗначениеЗаполнено(ИмяФайлаСодержимого) Тогда
		
	КонецЕсли;
	
	ТипСодержимого = ТипЗнч(Содержимое);
	Если ТипСодержимого = Тип("ДвоичныеДанные") Тогда
		ИмяВременногоФайла = ПолучитьИмяВременногоФайла(ИмяФайла);
		Содержимое.Записать(ИмяВременногоФайла);
		ЭлементыФормы.ПолеHTMLДокумента.Перейти(ИмяВременногоФайла);
	ИначеЕсли ТипСодержимого = Тип("ХранилищеЗначения") Тогда
		ИмяВременногоФайла = ПолучитьИмяВременногоФайла(ИмяФайла);
		Содержимое.Получить().Записать(ИмяВременногоФайла);
		ЭлементыФормы.ПолеHTMLДокумента.Перейти(ИмяВременногоФайла);
	ИначеЕсли ТипСодержимого = Тип("Строка") Тогда
		Если Найти(Содержимое, "<") <> 0 Тогда // это текст HTML, т.к. в имени файла символ "<" недопустим
			ЭлементыФормы.ПолеHTMLДокумента.УстановитьТекст(Содержимое);
		Иначе
			ЭлементыФормы.ПолеHTMLДокумента.Перейти(Содержимое);
		КонецЕсли;
	ИначеЕсли ЗначениеЗаполнено(ИмяФайлаСодержимого) Тогда
		ЭлементыФормы.ПолеHTMLДокумента.Перейти(ИмяФайлаСодержимого);
	КонецЕсли;
	
КонецПроцедуры

Процедура ПриЗакрытии()
	
	Если ЗначениеЗаполнено(ИмяВременногоФайла) Тогда
		КонтекстЭДО.УдалитьВременныйФайл(ИмяВременногоФайла);
	КонецЕсли;
	
КонецПроцедуры