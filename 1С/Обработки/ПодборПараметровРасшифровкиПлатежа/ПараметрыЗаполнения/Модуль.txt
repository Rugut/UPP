// Устанавливает видимость панелей настройки
//
Процедура УстановитьВидимость()
	
	Если ПоЗаявкам Тогда
		
		РаботаСДиалогами.УстановитьТекущуюСтраницу("ПоЗаявкам",ЭлементыФормы.ПанельЗаполнение);
		
	Иначе
		
		РаботаСДиалогами.УстановитьТекущуюСтраницу("ПоДоговорам",ЭлементыФормы.ПанельЗаполнение);
		
	КонецЕсли;
	
КонецПроцедуры // УстановитьВидимость()


Процедура КнопкаВыполнитьНажатие(Элемент)
	
	Если Не СпособЗаполнения="ТЧ" Тогда
		
		Если РасшифровкаПлатежаДок.Количество() > 0 Тогда
			
			ТекстВопроса = "Перед заполнением табличная часть будет очищена. Заполнить?";
			Ответ = Вопрос(ТекстВопроса, РежимДиалогаВопрос.ДаНет, , КодВозвратаДиалога.Да,);
			Если Ответ <> КодВозвратаДиалога.Да Тогда
				Возврат;
			КонецЕсли; 
			
			РасшифровкаПлатежаДок.Очистить();
			
		КонецЕсли;
		
	КонецЕсли;
	
	ВключенныеВПлатежныйКалендарь=ТолькоВключенныеВПлатежныйКалендарь;	
	
	Если ПоЗаявкам Тогда
		ЗаполнитьРасшифровкуПоПланам();
	Иначе
		ЗаполнитьРасшифровкуПоДолгам(ПодборПоСуммеПлатежа,Ложь);
	КонецЕсли;
	
	ЭтаФорма.Закрыть();
	
КонецПроцедуры

Процедура ПриОткрытии()
		
	Если НЕ (УчитыватьФактическиеЗадолженности ИЛИ УчитыватьОперативныеЗадолженности) Тогда УчитыватьФактическиеЗадолженности=Истина КонецЕсли;
	Если СпособЗаполнения="" Тогда СпособЗаполнения="ФИФО" КонецЕсли;
	
	Если ТипЗадолженности="<0" Тогда
		ЭлементыФормы.ПоЗаявкам1.Заголовок="По заявкам на расходование средств";
		ЭлементыФормы.СпособЗаполнения3.Заголовок="По возрастанию даты планируемого расхода";
		ЭлементыФормы.СпособЗаполнения4.Заголовок="По убыванию даты планируемого расхода";
		ЭлементыФормы.ПодбиратьПланируемыеДвижения.Заголовок="Подбирать заявки на расходование средств";
	Иначе
		ЭлементыФормы.ПоЗаявкам1.Заголовок="По планируемым поступлениям денежных средств";
		ЭлементыФормы.СпособЗаполнения3.Заголовок="По возрастанию даты планируемого поступления";
		ЭлементыФормы.СпособЗаполнения4.Заголовок="По убыванию даты планируемого поступления";
		ЭлементыФормы.ПодбиратьПланируемыеДвижения.Заголовок="Подбирать планируемые поступления средств";
	КонецЕсли;
	
	УстановитьВидимость();
	
	ТолькоВключенныеВПлатежныйКалендарь = ВосстановитьЗначение("ТолькоВключенныеВПлатежныйКалендарь");
	ПодборПоСуммеПлатежа = ВосстановитьЗначение("ПодборПоСуммеПлатежа");
	ПодборПоДоговорам = ВосстановитьЗначение("ПодборПоДоговорам");
	
	Если ПодборПоДоговорам <> Неопределено Тогда
		ПостроительОтбораДоговоров.УстановитьНастройки(ПодборПоДоговорам, Истина, Ложь, Ложь, Ложь, Ложь);
	КонецЕсли;
	
КонецПроцедуры

Процедура ПоЗаявкамПриИзменении(Элемент)
	
	Если ПоЗаявкам И СпособЗаполнения="ТЧ" Тогда
		СпопобЗаполнения="ФИФО";
	КонецЕсли;
	
	УстановитьВидимость();
	
КонецПроцедуры

Процедура ПриЗакрытии()
	
	СохранитьЗначение("ТолькоВключенныеВПлатежныйКалендарь", ТолькоВключенныеВПлатежныйКалендарь);
	СохранитьЗначение("ПодборПоСуммеПлатежа", ПодборПоСуммеПлатежа);
	СохранитьЗначение("ПодборПоДоговорам", ПостроительОтбораДоговоров.ПолучитьНастройки(Истина, Ложь, Ложь, Ложь, Ложь));
	
КонецПроцедуры