Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
	
	Если СписокФормП1Пр3.Количество() > 0 Тогда
		
		ЭлементыФормы.СписокФормП1Пр3.ТекущаяСтрока = СписокФормП1Пр3[СписокФормП1Пр3.Количество()-1];
		
	КонецЕсли;
	
КонецПроцедуры

Процедура ДействияФормыОткрыть(Кнопка)
	
	ТекДанные = ЭлементыФормы.СписокФормП1Пр3.ТекущиеДанные;
	
	Если ТекДанные <> Неопределено Тогда
		
		ТекДок = ТекДанные.ТекДок;
        ТекДок.ПолучитьФорму(, ЭтаФорма).Открыть();
		
	КонецЕсли; 
	
КонецПроцедуры

Процедура ДействияФормыВыбрать(Кнопка)
	
	ВыбратьФормуП1Пр3();
	
КонецПроцедуры

Процедура ВыбратьФормуП1Пр3()
	
	ТекДанные = ЭлементыФормы.СписокФормП1Пр3.ТекущиеДанные;
	Если ТекДанные = Неопределено Тогда
		Предупреждение("Не выбрана из списка форма ""П-1 Приложение 3"".");
		Возврат;
	КонецЕсли;
	
	Закрыть(ТекДанные);
	
КонецПроцедуры

Процедура СписокФормП1Пр3ПриАктивизацииСтроки(Элемент)
	
	ДоступностьКнопок = (ЭлементыФормы.СписокФормП1Пр3.ТекущаяСтрока <> Неопределено);
	
	ЭлементыФормы.ДействияФормы.Кнопки.Выбрать.Доступность = ДоступностьКнопок;
	ЭлементыФормы.ДействияФормы.Кнопки.Открыть.Доступность = ДоступностьКнопок;
	
КонецПроцедуры

Процедура СписокФормП1Пр3ПриПолученииДанных(Элемент, ОформленияСтрок)
	
	Для Каждого ОформлениеСтроки Из ОформленияСтрок Цикл
		
		ОформлениеСтроки.Ячейки.Период.УстановитьТекст(ПредставлениеПериода(ОформлениеСтроки.ДанныеСтроки.ДатаНачала, КонецДня(ОформлениеСтроки.ДанныеСтроки.ДатаОкончания), "ФП=Истина"));
		
	КонецЦикла;
	
КонецПроцедуры

Процедура СписокФормП1Пр3Выбор(Элемент, ВыбраннаяСтрока, Колонка, СтандартнаяОбработка)
	
	ВыбратьФормуП1Пр3();
	
КонецПроцедуры