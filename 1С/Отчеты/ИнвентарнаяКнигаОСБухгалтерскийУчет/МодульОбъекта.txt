#Если Клиент Тогда

// Процедура формирует табличный документ с обложкой инвентарной книги.
//
// Параметры:
//  ДокументРезультат - табличный документ, в который выводится
//                      обложка инвентарной книги.
//
// Возвращаемое значение:
//  Нет.
//
Процедура СформироватьОбложкуИнвентарнойКнигиОС(ДокументРезультат) Экспорт
	
	ДатаОтбора = ?(ЗначениеЗаполнено(КонецПериода), КонецПериода, Неопределено);
	
	Сведения             = УправлениеКонтактнойИнформацией.СведенияОЮрФизЛице(Организация, ДатаОтбора);
	ДанныеОтветственного = ОбщегоНазначения.ДанныеФизЛица(Организация, Ответственный, ДатаОтбора);
	
	ДокументРезультат.Очистить();
	
	ДокументРезультат.ОриентацияСтраницы = ОриентацияСтраницы.Ландшафт;
	ДокументРезультат.ПолеСверху         = 20;
	ДокументРезультат.ПолеСнизу          = 20;
	ДокументРезультат.ПолеСлева          = 10;
	ДокументРезультат.ПолеСправа         = 10;
	
	ДокументРезультат.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_ИнвентарнаяКнигаОС_Обложка";
	
	Макет = ПолучитьМакет("Обложка");
	Макет.Параметры.НаименованиеОрганизации          = Сведения.ПолноеНаименование;
	Макет.Параметры.ОКПО                             = Сведения.КодПоОКПО;
	Макет.Параметры.Период                           = " с " + ?(НЕ ЗначениеЗаполнено(НачалоПериода), """____"" ___________ ______ г.", Формат(НачалоПериода, "ДЛФ=DD")) + " по " + ?(НЕ ЗначениеЗаполнено(КонецПериода), """____"" ___________ ______ г.", Формат(КонецПериода, "ДЛФ=DD"));
	Макет.Параметры.НаименованиеПодразделения        = ?(ЗначениеЗаполнено(Подразделение), Подразделение.Наименование, "");  
	Макет.Параметры.КодПодразделения                 = ?(ЗначениеЗаполнено(Подразделение), Подразделение.Код, "");
	Макет.Параметры.Должность                        = ДанныеОтветственного.Должность;
	Макет.Параметры.ФамилияИО                        = ДанныеОтветственного.Представление;
	Макет.Параметры.ТабельныйНомер                   = ДанныеОтветственного.ТабельныйНомер;
	
	ДокументРезультат.Вывести(Макет);

	ДокументРезультат.ТолькоПросмотр = Истина;
	
КонецПроцедуры // СформироватьОбложку()

// Процедура формирует табличный документ со страницами инвентарной книги.
//
// Параметры:
//  ДокументРезультат - табличный документ, в который выводятся
//                      страницы инвентарной книги.
//
// Возвращаемое значение:
//  Нет.
//
Процедура СформироватьСтраницыИнвентарнойКнигиОС(ДокументРезультат) Экспорт
	
	Запрос = Новый Запрос();
	
	СубконтоОС = Новый Массив();
	СубконтоОС.Добавить(ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.ОсновныеСредства);
	
	Запрос.УстановитьПараметр("СубконтоОС",    СубконтоОС);
	Запрос.УстановитьПараметр("НачалоПериода", ?(ОбщегоНазначения.ПустаяДата(НачалоПериода), НачалоПериода, НачалоДня(НачалоПериода)));
	Запрос.УстановитьПараметр("КонецПериода",  ?(ОбщегоНазначения.ПустаяДата(КонецПериода),  КонецПериода,  КонецДня(КонецПериода)));
	Запрос.УстановитьПараметр("Организация",   Организация);
	Запрос.УстановитьПараметр("Подразделение", Подразделение);	
	Запрос.УстановитьПараметр("МОЛ",           МОЛ);
	
	Если НЕ ОбщегоНазначения.ПустаяДата(НачалоПериода)
	   И НЕ ОбщегоНазначения.ПустаяДата(КонецПериода) Тогда
	   
	   ОтборПоПериоду = "СобытияОСОрганизаций.Период МЕЖДУ &НачалоПериода И &КонецПериода И";
	   
	ИначеЕсли НЕ ОбщегоНазначения.ПустаяДата(НачалоПериода) Тогда
		
	   ОтборПоПериоду = "СобытияОСОрганизаций.Период >= &НачалоПериода И";
	   
	ИначеЕсли НЕ ОбщегоНазначения.ПустаяДата(КонецПериода) Тогда
		
	   ОтборПоПериоду = "СобытияОСОрганизаций.Период <= &КонецПериода И";
	   
	Иначе
	   
	   ОтборПоПериоду = "";
	   
	КонецЕсли;
	
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	СрезПоследнихПоРегистрамСведенийИБухгалтерии.ОсновноеСредство.НаименованиеПолное КАК ОсновноеСредствоНаименованиеПолное,
	|	СрезПоследнихПоРегистрамСведенийИБухгалтерии.ОсновноеСредство.Наименование КАК ОсновноеСредствоНаименование,
	|	СрезПоследнихПоРегистрамСведенийИБухгалтерии.ОсновноеСредство КАК ОсновноеСредствоСсылка,
	|	ПРЕДСТАВЛЕНИЕ(СрезПоследнихПоРегистрамСведенийИБухгалтерии.Документ) КАК ПредставлениеДокумента,
	|	СрезПоследнихПоРегистрамСведенийИБухгалтерии.Документ,
	|	СрезПоследнихПоРегистрамСведенийИБухгалтерии.ТипДокумента,
	|	СрезПоследнихПоРегистрамСведенийИБухгалтерии.ДатаДокумента КАК ДатаДокумента,
	|	СрезПоследнихПоРегистрамСведенийИБухгалтерии.ПричинаСписания,
	|	СрезПоследнихПоРегистрамСведенийИБухгалтерии.СписыватьПриПринятииКУчету КАК СписыватьПриПринятииКУчету,
	|	СрезПоследнихПоРегистрамСведенийИБухгалтерии.СрокПолезногоИспользования,
	|	СрезПоследнихПоРегистрамСведенийИБухгалтерии.ИнвентарныйНомер,
	|	СрезПоследнихПоРегистрамСведенийИБухгалтерии.ПервоначальнаяСтоимость,
	|	СрезПоследнихПоРегистрамСведенийИБухгалтерии.ПоследнееМОЛ,
	|	СрезПоследнихПоРегистрамСведенийИБухгалтерии.ПоследнееМОЛ.Представление,
	|	СрезПоследнихПоРегистрамСведенийИБухгалтерии.ПредпоследнееМОЛ,
	|	СрезПоследнихПоРегистрамСведенийИБухгалтерии.ПредпоследнееМОЛ.Представление,
	|	СрезПоследнихПоРегистрамСведенийИБухгалтерии.ПоследнееМестонахождение,
	|	СрезПоследнихПоРегистрамСведенийИБухгалтерии.ПоследнееМестонахождение.Представление,
	|	СрезПоследнихПоРегистрамСведенийИБухгалтерии.ПредпоследнееМестонахождение,
	|	СрезПоследнихПоРегистрамСведенийИБухгалтерии.ПредпоследнееМестонахождение.Представление,
	|	СостоянияОСОрганизаций.ДатаСостояния КАК ДатаПринятияКУчету,
	|	СостоянияОСОрганизаций.Регистратор КАК ДокументПринятияКУчету,
	|	ВосстановительнаяСтоимостьОСБУ.СтоимостьКонечныйОстаток КАК ВосстановительнаяСтоимость,
	|	НачисленнаяАмортизацияИлиИзносОСБУ.АмортизацияКонечныйОстаток КАК НачисленнаяАмортизация,
	|	АмортизацияИлиИзносПоДокументу.АмортизацияПриход КАК АмортизацияПоДокументу,
	|	СрезПоследнихПоРегистрамСведенийИБухгалтерии.СчетНачисленияАмортизации
	|ИЗ
	|	(ВЫБРАТЬ
	|		СрезПоследнихПоРегистрамСведений.ОсновноеСредство КАК ОсновноеСредство,
	|		СрезПоследнихПоРегистрамСведений.Документ КАК Документ,
	|		СрезПоследнихПоРегистрамСведений.ТипДокумента КАК ТипДокумента,
	|		СрезПоследнихПоРегистрамСведений.ДатаДокумента КАК ДатаДокумента,
	|		СрезПоследнихПоРегистрамСведений.ДатаДвиженийБухгалтерии КАК ДатаДвиженийБухгалтерии,
	|		СрезПоследнихПоРегистрамСведений.ПричинаСписания КАК ПричинаСписания,
	|		СрезПоследнихПоРегистрамСведений.СписыватьПриПринятииКУчету КАК СписыватьПриПринятииКУчету,
	|		СрезПоследнихПоРегистрамСведений.СрокПолезногоИспользования КАК СрокПолезногоИспользования,
	|		СрезПоследнихПоРегистрамСведений.ИнвентарныйНомер КАК ИнвентарныйНомер,
	|		СрезПоследнихПоРегистрамСведений.ПервоначальнаяСтоимость КАК ПервоначальнаяСтоимость,
	|		СрезПоследнихПоРегистрамСведений.ПоследнееМОЛ КАК ПоследнееМОЛ,
	|		СрезПоследнихПоРегистрамСведений.ПредпоследнееМОЛ КАК ПредпоследнееМОЛ,
	|		СрезПоследнихПоРегистрамСведений.ПоследнееМестонахождение КАК ПоследнееМестонахождение,
	|		СрезПоследнихПоРегистрамСведений.ПредпоследнееМестонахождение КАК ПредпоследнееМестонахождение,
	|		МАКСИМУМ(ВосстановительнаяСтоимостьОСБУ.Период) КАК ДатаПоследнегоДвиженияВосстановительнаяСтоимость,
	|		МАКСИМУМ(НачисленнаяАмортизацияИлиИзносОСБУ.Период) КАК ДатаПоследнегоДвиженияНачисленнаяАмортизацияИлиИзнос,
	|		СрезПоследнихПоРегистрамСведений.СчетУчета КАК СчетУчета,
	|		СрезПоследнихПоРегистрамСведений.СчетНачисленияАмортизации КАК СчетНачисленияАмортизации
	|	ИЗ
	|		(ВЫБРАТЬ
	|			ДатыПоследнихДвиженийПоРегистрамСведений.ОсновноеСредство КАК ОсновноеСредство,
	|			ДатыПоследнихДвиженийПоРегистрамСведений.Документ КАК Документ,
	|			ДатыПоследнихДвиженийПоРегистрамСведений.ТипДокумента КАК ТипДокумента,
	|			ДатыПоследнихДвиженийПоРегистрамСведений.ДатаДокумента КАК ДатаДокумента,
	|			ДатыПоследнихДвиженийПоРегистрамСведений.ДатаДвиженийБухгалтерии КАК ДатаДвиженийБухгалтерии,
	|			ДатыПоследнихДвиженийПоРегистрамСведений.ПричинаСписания КАК ПричинаСписания,
	|			ДатыПоследнихДвиженийПоРегистрамСведений.СписыватьПриПринятииКУчету КАК СписыватьПриПринятииКУчету,
	|			ПараметрыАмортизацииОСБухгалтерскийУчет.СрокПолезногоИспользования КАК СрокПолезногоИспользования,
	|			ПервоначальныеСведенияОСБухгалтерскийУчет.ИнвентарныйНомер КАК ИнвентарныйНомер,
	|			ПервоначальныеСведенияОСБухгалтерскийУчет.ПервоначальнаяСтоимость КАК ПервоначальнаяСтоимость,
	|			СчетаБухгалтерскогоУчетаОС.СчетУчета КАК СчетУчета,
	|			СчетаБухгалтерскогоУчетаОС.СчетНачисленияАмортизации КАК СчетНачисленияАмортизации,
	|			МестонахождениеОСБухгалтерскийУчетПоследнее.МОЛ КАК ПоследнееМОЛ,
	|			МестонахождениеОСБухгалтерскийУчетПоследнее.Местонахождение КАК ПоследнееМестонахождение,
	|			МестонахождениеОСБухгалтерскийУчетПредпоследнее.МОЛ КАК ПредпоследнееМОЛ,
	|			МестонахождениеОСБухгалтерскийУчетПредпоследнее.Местонахождение КАК ПредпоследнееМестонахождение
	|		ИЗ
	|			(ВЫБРАТЬ
	|				ДвиженияОС.ОсновноеСредство КАК ОсновноеСредство,
	|				ДвиженияОС.Документ КАК Документ,
	|				ДвиженияОС.ТипДокумента КАК ТипДОкумента,
	|				ДвиженияОС.ДатаДокумента КАК ДатаДокумента,
	|				ДвиженияОС.ДатаДвиженийБухгалтерии КАК ДатаДвиженийБухгалтерии,
	|				ДвиженияОС.ПричинаСписания КАК ПричинаСписания,
	|				ДвиженияОС.СписыватьПриПринятииКУчету КАК СписыватьПриПринятииКУчету,
	|				МАКСИМУМ(ПервоначальныеСведенияОСБухгалтерскийУчет.Период) КАК ДатаПоследнегоПервоначальныеСведенияОС,
	|				МАКСИМУМ(ПараметрыАмортизацииОСБухгалтерскийУчет.Период) КАК ДатаПоследнегоПараметрыАмортизацииОС,
	|				МАКСИМУМ(МестонахождениеОСБухгалтерскийУчетПоследнее.Период) КАК ДатаПоследнегоМестонахождениеОС,
	|				МАКСИМУМ(МестонахождениеОСБухгалтерскийУчетПредпоследнее.Период) КАК ДатаПредпоследнегоМестонахождениеОС,
	|				МАКСИМУМ(СчетаБухгалтерскогоУчетаОС.Период) КАК ДатаПоследнегоСчетаБухгалтерскогоУчетаОС
	|			ИЗ
	|				(ВЫБРАТЬ
	|					СобытияОСОрганизаций.ОсновноеСредство КАК ОсновноеСредство,
	|					Документы.Ссылка КАК Документ,
	|					Документы.ТипДокумента КАК ТипДокумента,
	|					Документы.ПричинаСписания КАК ПричинаСписания,
	|					Документы.СписыватьПриПринятииКУчету КАК СписыватьПриПринятииКУчету,
	|					СобытияОСОрганизаций.Период КАК ДатаДокумента,
	|					Документы.ДатаДвиженийБухгалтерии КАК ДатаДвиженийБухгалтерии
	|				ИЗ
	|					РегистрСведений.СобытияОСОрганизаций КАК СобытияОСОрганизаций
	|						ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|							ПринятиеКУчетуОС.Ссылка КАК Ссылка,
	|							ПринятиеКУчетуОС.Дата КАК ДатаДвиженийБухгалтерии,
	|							""ПринятиеКУчетуОС"" КАК ТипДокумента,
	|							"""" КАК ПричинаСписания,
	|							ПринятиеКУчетуОС.СписыватьПриПринятииКУчету КАК СписыватьПриПринятииКУчету
	|						ИЗ
	|							Документ.ПринятиеКУчетуОС КАК ПринятиеКУчетуОС
	|						
	|						ОБЪЕДИНИТЬ ВСЕ
	|						
	|						ВЫБРАТЬ
	|							ПеремещениеОС.Ссылка,
	|							ПеремещениеОС.Дата,
	|							""ПеремещениеОС"",
	|							"""",
	|							Null
	|						ИЗ
	|							Документ.ПеремещениеОС КАК ПеремещениеОС
	|						
	|						ОБЪЕДИНИТЬ ВСЕ
	|						
	|						ВЫБРАТЬ
	|							ПередачаОС.Ссылка,
	|							ПередачаОС.ДокПодготовкаКПередачеОС.Дата,
	|							""ПередачаОС"",
	|							"""",
	|							Null
	|						ИЗ
	|							Документ.ПередачаОС КАК ПередачаОС
	|							ГДЕ ПередачаОС.ДокПодготовкаКПередачеОС ССЫЛКА Документ.ПодготовкаКПередачеОС
	|						
	|						ОБЪЕДИНИТЬ ВСЕ
	|						
	|						ВЫБРАТЬ
	|							ПередачаОС.Ссылка,
	|							ПередачаОС.Дата,
	|							""ПередачаОС"",
	|							"""",
	|							Null
	|						ИЗ
	|							Документ.ПередачаОС КАК ПередачаОС
	|							ГДЕ НЕ ПередачаОС.ДокПодготовкаКПередачеОС ССЫЛКА Документ.ПодготовкаКПередачеОС
	|						
	|						ОБЪЕДИНИТЬ ВСЕ
	|						
	|						ВЫБРАТЬ
	|							СписаниеОС.Ссылка,
	|							СписаниеОС.Дата,
	|							""СписаниеОС"",
	|							СписаниеОС.ПричинаСписания.Представление,
	|							Null
	|						ИЗ
	|							Документ.СписаниеОС КАК СписаниеОС) КАК Документы
	|						ПО СобытияОСОрганизаций.Регистратор = Документы.Ссылка
	|				
	|				ГДЕ
	|" + ОтборПоПериоду + "
	|					СобытияОСОрганизаций.Организация = &Организация) КАК ДвиженияОС
	|					ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ПервоначальныеСведенияОСБухгалтерскийУчет КАК ПервоначальныеСведенияОСБухгалтерскийУчет
	|					ПО (ДвиженияОС.ДатаДокумента >= ПервоначальныеСведенияОСБухгалтерскийУчет.Период ИЛИ ПервоначальныеСведенияОСБухгалтерскийУчет.Регистратор ССЫЛКА Документ.РасчетСебестоимостиВыпуска И НАЧАЛОПЕРИОДА(ДвиженияОС.ДатаДокумента, МЕСЯЦ) = НАЧАЛОПЕРИОДА(ПервоначальныеСведенияОСБухгалтерскийУчет.Период, МЕСЯЦ)) И ДвиженияОС.ОсновноеСредство = ПервоначальныеСведенияОСБухгалтерскийУчет.ОсновноеСредство
	|					ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.МестонахождениеОСБухгалтерскийУчет КАК МестонахождениеОСБухгалтерскийУчетПоследнее
	|					ПО ДвиженияОС.ДатаДокумента >= МестонахождениеОСБухгалтерскийУчетПоследнее.Период И ДвиженияОС.ОсновноеСредство = МестонахождениеОСБухгалтерскийУчетПоследнее.ОсновноеСредство И (МестонахождениеОСБухгалтерскийУчетПоследнее.Организация = &Организация)
	|					ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПараметрыАмортизацииОСБухгалтерскийУчет КАК ПараметрыАмортизацииОСБухгалтерскийУчет
	|					ПО ДвиженияОС.ДатаДокумента >= ПараметрыАмортизацииОСБухгалтерскийУчет.Период И ДвиженияОС.ОсновноеСредство = ПараметрыАмортизацииОСБухгалтерскийУчет.ОсновноеСредство И (ПараметрыАмортизацииОСБухгалтерскийУчет.Организация = &Организация)
	|					ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.МестонахождениеОСБухгалтерскийУчет КАК МестонахождениеОСБухгалтерскийУчетПредпоследнее
	|					ПО ДвиженияОС.ОсновноеСредство = МестонахождениеОСБухгалтерскийУчетПредпоследнее.ОсновноеСредство И ДвиженияОС.ДатаДокумента > МестонахождениеОСБухгалтерскийУчетПредпоследнее.Период И (МестонахождениеОСБухгалтерскийУчетПредпоследнее.Организация = &Организация)
	|					ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СчетаБухгалтерскогоУчетаОС КАК СчетаБухгалтерскогоУчетаОС
	|					ПО ДвиженияОС.ОсновноеСредство = СчетаБухгалтерскогоУчетаОС.ОсновноеСредство И ДвиженияОС.ДатаДвиженийБухгалтерии >= СчетаБухгалтерскогоУчетаОС.Период И (СчетаБухгалтерскогоУчетаОС.Организация = &Организация)
	|			
	|			СГРУППИРОВАТЬ ПО
	|				ДвиженияОС.ОсновноеСредство,
	|				ДвиженияОС.Документ,
	|				ДвиженияОС.ТипДокумента,
	|				ДвиженияОС.ДатаДокумента,
	|				ДвиженияОС.СписыватьПриПринятииКУчету,
	|				ДвиженияОС.ДатаДвиженийБухгалтерии,
	|				ДвиженияОС.ПричинаСписания) КАК ДатыПоследнихДвиженийПоРегистрамСведений
	|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СчетаБухгалтерскогоУчетаОС КАК СчетаБухгалтерскогоУчетаОС
	|				ПО ДатыПоследнихДвиженийПоРегистрамСведений.ОсновноеСредство = СчетаБухгалтерскогоУчетаОС.ОсновноеСредство И ДатыПоследнихДвиженийПоРегистрамСведений.ДатаПоследнегоСчетаБухгалтерскогоУчетаОС = СчетаБухгалтерскогоУчетаОС.Период И (СчетаБухгалтерскогоУчетаОС.Организация = &Организация)
	|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.МестонахождениеОСБухгалтерскийУчет КАК МестонахождениеОСБухгалтерскийУчетПоследнее
	|				ПО ДатыПоследнихДвиженийПоРегистрамСведений.ОсновноеСредство = МестонахождениеОСБухгалтерскийУчетПоследнее.ОсновноеСредство И ДатыПоследнихДвиженийПоРегистрамСведений.ДатаПоследнегоМестонахождениеОС = МестонахождениеОСБухгалтерскийУчетПоследнее.Период И (МестонахождениеОСБухгалтерскийУчетПоследнее.Организация = &Организация)
	|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.МестонахождениеОСБухгалтерскийУчет КАК МестонахождениеОСБухгалтерскийУчетПредпоследнее
	|				ПО ДатыПоследнихДвиженийПоРегистрамСведений.ОсновноеСредство = МестонахождениеОСБухгалтерскийУчетПредпоследнее.ОсновноеСредство И ДатыПоследнихДвиженийПоРегистрамСведений.ДатаПредпоследнегоМестонахождениеОС = МестонахождениеОСБухгалтерскийУчетПредпоследнее.Период И (МестонахождениеОСБухгалтерскийУчетПредпоследнее.Организация = &Организация)
	|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПараметрыАмортизацииОСБухгалтерскийУчет КАК ПараметрыАмортизацииОСБухгалтерскийУчет
	|				ПО ДатыПоследнихДвиженийПоРегистрамСведений.ОсновноеСредство = ПараметрыАмортизацииОСБухгалтерскийУчет.ОсновноеСредство И ДатыПоследнихДвиженийПоРегистрамСведений.ДатаПоследнегоПараметрыАмортизацииОС = ПараметрыАмортизацииОСБухгалтерскийУчет.Период И (ПараметрыАмортизацииОСБухгалтерскийУчет.Организация = &Организация)
	|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПервоначальныеСведенияОСБухгалтерскийУчет КАК ПервоначальныеСведенияОСБухгалтерскийУчет
	|				ПО ДатыПоследнихДвиженийПоРегистрамСведений.ОсновноеСредство = ПервоначальныеСведенияОСБухгалтерскийУчет.ОсновноеСредство И ДатыПоследнихДвиженийПоРегистрамСведений.ДатаПоследнегоПервоначальныеСведенияОС = ПервоначальныеСведенияОСБухгалтерскийУчет.Период) КАК СрезПоследнихПоРегистрамСведений
	|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.СтоимостьОСБухгалтерскийУчет.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, Запись, , Организация = &Организация) КАК НачисленнаяАмортизацияИлиИзносОСБУ
	|				ПО СрезПоследнихПоРегистрамСведений.ОсновноеСредство = НачисленнаяАмортизацияИлиИзносОСБУ.ОсновноеСредство
	|					И СрезПоследнихПоРегистрамСведений.ДатаДвиженийБухгалтерии > НачисленнаяАмортизацияИлиИзносОСБУ.Период
	|				ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.СтоимостьОСБухгалтерскийУчет.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, Запись, , Организация = &Организация) КАК ВосстановительнаяСтоимостьОСБУ
	|				ПО СрезПоследнихПоРегистрамСведений.ОсновноеСредство = ВосстановительнаяСтоимостьОСБУ.ОсновноеСредство
	|					И СрезПоследнихПоРегистрамСведений.ДатаДвиженийБухгалтерии > ВосстановительнаяСтоимостьОСБУ.Период
	|					И НЕ (ВосстановительнаяСтоимостьОСБУ.Регистратор ССЫЛКА Документ.АмортизацияОС)
	|
	|			СГРУППИРОВАТЬ ПО
	|				СрезПоследнихПоРегистрамСведений.ОсновноеСредство,
	|				СрезПоследнихПоРегистрамСведений.Документ,
	|				СрезПоследнихПоРегистрамСведений.ТипДокумента,
	|				СрезПоследнихПоРегистрамСведений.ДатаДокумента,
	|				СрезПоследнихПоРегистрамСведений.ПричинаСписания,
	|				СрезПоследнихПоРегистрамСведений.СписыватьПриПринятииКУчету,
	|				СрезПоследнихПоРегистрамСведений.СрокПолезногоИспользования,
	|				СрезПоследнихПоРегистрамСведений.ИнвентарныйНомер,
	|				СрезПоследнихПоРегистрамСведений.ПервоначальнаяСтоимость,
	|				СрезПоследнихПоРегистрамСведений.ПоследнееМОЛ,
	|				СрезПоследнихПоРегистрамСведений.ПредпоследнееМОЛ,
	|				СрезПоследнихПоРегистрамСведений.ПоследнееМестонахождение,
	|				СрезПоследнихПоРегистрамСведений.ПредпоследнееМестонахождение,
	|				СрезПоследнихПоРегистрамСведений.СчетУчета,
	|				СрезПоследнихПоРегистрамСведений.СчетНачисленияАмортизации,
	|				СрезПоследнихПоРегистрамСведений.ДатаДвиженийБухгалтерии) КАК СрезПоследнихПоРегистрамСведенийИБухгалтерии
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СостоянияОСОрганизаций КАК СостоянияОСОрганизаций
	|		ПО СрезПоследнихПоРегистрамСведенийИБухгалтерии.ОсновноеСредство = СостоянияОСОрганизаций.ОсновноеСредство И (СостоянияОСОрганизаций.Организация = &Организация) И (СостоянияОСОрганизаций.Состояние = ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПринятоКУчету))
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.СтоимостьОСБухгалтерскийУчет.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, Запись, , Организация = &Организация) КАК ВосстановительнаяСтоимостьОСБУ
	|		ПО СрезПоследнихПоРегистрамСведенийИБухгалтерии.ОсновноеСредство = ВосстановительнаяСтоимостьОСБУ.ОсновноеСредство
	|			И ВосстановительнаяСтоимостьОСБУ.Период = СрезПоследнихПоРегистрамСведенийИБухгалтерии.ДатаПоследнегоДвиженияВосстановительнаяСтоимость
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.СтоимостьОСБухгалтерскийУчет.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, Запись, , Организация = &Организация) КАК НачисленнаяАмортизацияИлиИзносОСБУ
	|		ПО СрезПоследнихПоРегистрамСведенийИБухгалтерии.ОсновноеСредство = НачисленнаяАмортизацияИлиИзносОСБУ.ОсновноеСредство
	|			И НачисленнаяАмортизацияИлиИзносОСБУ.Период = СрезПоследнихПоРегистрамСведенийИБухгалтерии.ДатаПоследнегоДвиженияНачисленнаяАмортизацияИлиИзнос
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.СтоимостьОСБухгалтерскийУчет.ОстаткиИОбороты(&НачалоПериода, &КонецПериода, Запись, , Организация = &Организация) КАК АмортизацияИлиИзносПоДокументу
	|		ПО СрезПоследнихПоРегистрамСведенийИБухгалтерии.ОсновноеСредство = АмортизацияИлиИзносПоДокументу.ОсновноеСредство
	|			И СрезПоследнихПоРегистрамСведенийИБухгалтерии.ДатаДвиженийБухгалтерии = АмортизацияИлиИзносПоДокументу.Период
	|			И (АмортизацияИлиИзносПоДокументу.АмортизацияПриход > 0)
	|
	|" + ?((ЗначениеЗаполнено(Подразделение)) ИЛИ (ЗначениеЗаполнено(МОЛ)), "ГДЕ " ,"") + ?(НЕ ЗначениеЗаполнено(Подразделение), "", "СрезПоследнихПоРегистрамСведенийИБухгалтерии.ПоследнееМестонахождение = &Подразделение ИЛИ СрезПоследнихПоРегистрамСведенийИБухгалтерии.ПредпоследнееМестонахождение = &Подразделение") + 
				   ?(НЕ ЗначениеЗаполнено(МОЛ), "", ?(НЕ ЗначениеЗаполнено(Подразделение), "", " И ") + "СрезПоследнихПоРегистрамСведенийИБухгалтерии.ПоследнееМОЛ = &МОЛ ИЛИ СрезПоследнихПоРегистрамСведенийИБухгалтерии.ПредпоследнееМОЛ = &МОЛ") + "
	|
	|УПОРЯДОЧИТЬ ПО
	|	ДатаДокумента
	|";

	Выборка = Запрос.Выполнить().Выбрать();
	
	// Заполнение таблицы строк инвентарной книги.
	
	СтрокиИнвентарнойКниги = Новый ТаблицаЗначений();
	СтрокиИнвентарнойКниги.Колонки.Добавить("ДокументСсылка");
	СтрокиИнвентарнойКниги.Колонки.Добавить("ОсновноеСредствоСсылка");	
	СтрокиИнвентарнойКниги.Колонки.Добавить("ОсновноеСредство");
	СтрокиИнвентарнойКниги.Колонки.Добавить("ИнвентарныйНомер");
	СтрокиИнвентарнойКниги.Колонки.Добавить("СрокПолезногоИспользования");
	СтрокиИнвентарнойКниги.Колонки.Добавить("ПервоначальнаяСтоимость");
	СтрокиИнвентарнойКниги.Колонки.Добавить("ПоступилоПредставлениеДокумента");
	СтрокиИнвентарнойКниги.Колонки.Добавить("ПоступилоДатаПринятияКУчету");
	СтрокиИнвентарнойКниги.Колонки.Добавить("ПоступилоДокументПринятияКУчету");
	СтрокиИнвентарнойКниги.Колонки.Добавить("ПоступилоПодразделение");
	СтрокиИнвентарнойКниги.Колонки.Добавить("ПоступилоМОЛ");
	СтрокиИнвентарнойКниги.Колонки.Добавить("НачисленнаяАмортизацияИлиИзнос");
	СтрокиИнвентарнойКниги.Колонки.Добавить("ОстаточнаяСтоимость");
	СтрокиИнвентарнойКниги.Колонки.Добавить("ПеремещениеИлиВыбытиеПредставлениеДокумента");
	СтрокиИнвентарнойКниги.Колонки.Добавить("ПеремещениеИлиВыбытиеПодразделение");
	СтрокиИнвентарнойКниги.Колонки.Добавить("ПеремещениеИлиВыбытиеМОЛ");
	СтрокиИнвентарнойКниги.Колонки.Добавить("ПеремещениеИлиВыбытиеПричинаВыбытия");
	
	Пока Выборка.Следующий() Цикл
		
		СтрокаИнвентарнойКниги = СтрокиИнвентарнойКниги.Добавить();
		
		СтрокаИнвентарнойКниги.ОсновноеСредствоСсылка                          = Выборка.ОсновноеСредствоСсылка;
		СтрокаИнвентарнойКниги.ОсновноеСредство                                = ?(НЕ ЗначениеЗаполнено(Выборка.ОсновноеСредствоНаименованиеПолное), Выборка.ОсновноеСредствоНаименование, Выборка.ОсновноеСредствоНаименованиеПолное);
		СтрокаИнвентарнойКниги.ИнвентарныйНомер                                = Выборка.ИнвентарныйНомер;
		СтрокаИнвентарнойКниги.СрокПолезногоИспользования                      = Выборка.СрокПолезногоИспользования;
		СтрокаИнвентарнойКниги.ДокументСсылка                                  = Выборка.Документ;
		
		Если Выборка.ТипДокумента = "ПринятиеКУчетуОС" Тогда
			
			// Четная страница.
			СтрокаИнвентарнойКниги.ПоступилоПредставлениеДокумента             = Выборка.ПредставлениеДокумента;
			СтрокаИнвентарнойКниги.ПоступилоДатаПринятияКУчету                 = Выборка.ДатаПринятияКУчету;
			СтрокаИнвентарнойКниги.ПоступилоДокументПринятияКУчету             = Выборка.ДокументПринятияКУчету;
			СтрокаИнвентарнойКниги.ПоступилоПодразделение                      = Выборка.ПоследнееМестонахождениеПредставление;
			СтрокаИнвентарнойКниги.ПоступилоМОЛ                                = ОбщегоНазначения.ФамилияИнициалыФизЛица(Выборка.ПоследнееМОЛПредставление);
			СтрокаИнвентарнойКниги.ПервоначальнаяСтоимость                     = Выборка.ПервоначальнаяСтоимость;
			СтрокаИнвентарнойКниги.НачисленнаяАмортизацияИлиИзнос              = 0;
			
			// Нечетная страница.
			СтрокаИнвентарнойКниги.ОстаточнаяСтоимость                         = ?(Выборка.СписыватьПриПринятииКУчету,
																				   0,
																				   Выборка.ПервоначальнаяСтоимость);
			СтрокаИнвентарнойКниги.ПеремещениеИлиВыбытиеПредставлениеДокумента = "";
			СтрокаИнвентарнойКниги.ПеремещениеИлиВыбытиеПодразделение          = "";
			СтрокаИнвентарнойКниги.ПеремещениеИлиВыбытиеМОЛ                    = "";
			СтрокаИнвентарнойКниги.ПеремещениеИлиВыбытиеПричинаВыбытия         = "";
			
		ИначеЕсли Выборка.ТипДокумента = "ПеремещениеОС" И Выборка.ПоследнееМестонахождение = Подразделение Тогда
			
			// Четная страница.
			СтрокаИнвентарнойКниги.ПоступилоПредставлениеДокумента             = Выборка.ПредставлениеДокумента;
			СтрокаИнвентарнойКниги.ПоступилоДатаПринятияКУчету                 = Выборка.ДатаПринятияКУчету;
			СтрокаИнвентарнойКниги.ПоступилоДокументПринятияКУчету             = "";
			СтрокаИнвентарнойКниги.ПоступилоПодразделение                      = Выборка.ПоследнееМестонахождениеПредставление;
			СтрокаИнвентарнойКниги.ПоступилоМОЛ                                = ОбщегоНазначения.ФамилияИнициалыФизЛица(Выборка.ПоследнееМОЛПредставление);
			СтрокаИнвентарнойКниги.ПервоначальнаяСтоимость                     = Выборка.ВосстановительнаяСтоимость;
			СтрокаИнвентарнойКниги.НачисленнаяАмортизацияИлиИзнос              = ?(Выборка.НачисленнаяАмортизация <> NULL, Выборка.НачисленнаяАмортизация, 0) 
																				 + ?(Выборка.АмортизацияПоДокументу <> NULL, Выборка.АмортизацияПоДокументу, 0);
			// Нечетная страница.
			СтрокаИнвентарнойКниги.ОстаточнаяСтоимость                         = ?(Выборка.ВосстановительнаяСтоимость <> NULL, Выборка.ВосстановительнаяСтоимость, 0) - СтрокаИнвентарнойКниги.НачисленнаяАмортизацияИлиИзнос;
			СтрокаИнвентарнойКниги.ПеремещениеИлиВыбытиеПредставлениеДокумента = Выборка.ПредставлениеДокумента;			
			СтрокаИнвентарнойКниги.ПеремещениеИлиВыбытиеПодразделение          = Выборка.ПредпоследнееМестонахождениеПредставление;
			СтрокаИнвентарнойКниги.ПеремещениеИлиВыбытиеМОЛ                    = ОбщегоНазначения.ФамилияИнициалыФизЛица(Выборка.ПредпоследнееМОЛПредставление);
			СтрокаИнвентарнойКниги.ПеремещениеИлиВыбытиеПричинаВыбытия         = "";
			
		Иначе
			
			// Четная страница.
			СтрокаИнвентарнойКниги.ПоступилоПредставлениеДокумента             = "";
			СтрокаИнвентарнойКниги.ПоступилоДатаПринятияКУчету                 = "";
			СтрокаИнвентарнойКниги.ПоступилоДокументПринятияКУчету             = Неопределено;
			СтрокаИнвентарнойКниги.ПоступилоПодразделение                      = "";
			СтрокаИнвентарнойКниги.ПоступилоМОЛ                                = "";
			СтрокаИнвентарнойКниги.ПервоначальнаяСтоимость                     = Выборка.ВосстановительнаяСтоимость;
			СтрокаИнвентарнойКниги.НачисленнаяАмортизацияИлиИзнос              = ?(Выборка.НачисленнаяАмортизация <> NULL, Выборка.НачисленнаяАмортизация, 0)
																				+ ?(Выборка.АмортизацияПоДокументу <> NULL, Выборка.АмортизацияПоДокументу, 0);
			
			// Нечетная страница.
			СтрокаИнвентарнойКниги.ОстаточнаяСтоимость                         = ?(Выборка.ВосстановительнаяСтоимость <> NULL, Выборка.ВосстановительнаяСтоимость, 0) - СтрокаИнвентарнойКниги.НачисленнаяАмортизацияИлиИзнос;
			СтрокаИнвентарнойКниги.ПеремещениеИлиВыбытиеПредставлениеДокумента = Выборка.ПредставлениеДокумента;			
			СтрокаИнвентарнойКниги.ПеремещениеИлиВыбытиеПодразделение          = Выборка.ПоследнееМестонахождениеПредставление;
			СтрокаИнвентарнойКниги.ПеремещениеИлиВыбытиеМОЛ                    = ОбщегоНазначения.ФамилияИнициалыФизЛица(Выборка.ПоследнееМОЛПредставление);
			СтрокаИнвентарнойКниги.ПеремещениеИлиВыбытиеПричинаВыбытия         = Выборка.ПричинаСписания;
			
		КонецЕсли;
		
	КонецЦикла;
	
	// Вывод страниц инвентарной книги.
	                    
	ДокументРезультат.Очистить();
	
	ДокументРезультат.ОриентацияСтраницы = ОриентацияСтраницы.Ландшафт;
	ДокументРезультат.ПолеСверху         = 20;
	ДокументРезультат.ПолеСнизу          = 20;
	ДокументРезультат.ПолеСлева          = 10;
	ДокументРезультат.ПолеСправа         = 10;
	ДокументРезультат.ФиксацияСлева      = 3;
	
	ДокументРезультат.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_ИнвентарнаяКнигаОС_Обложка";
	
	Макет = ПолучитьМакет("Страницы");
	
	НомерЧетнойСтраницы   = 2;
	НомерНечетнойСтраницы = НомерЧетнойСтраницы + 1;
	
	Шапка = Макет.ПолучитьОбласть("Шапка");
	Шапка.Параметры.НомерЧетнойСтраницы   = НомерЧетнойСтраницы;
	Шапка.Параметры.НомерНечетнойСтраницы = НомерНечетнойСтраницы;	
	ДокументРезультат.Вывести(Шапка);
	
	Подвал = Макет.ПолучитьОбласть("Подвал");
	
	Для Каждого СтрокаИнвентарнойКниги Из СтрокиИнвентарнойКниги Цикл
		
		Строка = Макет.ПолучитьОбласть("Строка");
				
		Строка.Параметры.Заполнить(СтрокаИнвентарнойКниги);
		Строка.Параметры.НомерСтроки = СтрокиИнвентарнойКниги.Индекс(СтрокаИнвентарнойКниги) + 1;
		
		СтрокаСПодвалом = Новый Массив;
		СтрокаСПодвалом.Добавить(Строка);
		СтрокаСПодвалом.Добавить(Подвал);

		Если НЕ ФормированиеПечатныхФорм.ПроверитьВыводТабличногоДокумента(ДокументРезультат, СтрокаСПодвалом) Тогда
			
			ДокументРезультат.Вывести(Подвал);
			ДокументРезультат.ВывестиГоризонтальныйРазделительСтраниц();

			НомерЧетнойСтраницы   = НомерЧетнойСтраницы + 2;
			НомерНечетнойСтраницы = НомерНечетнойСтраницы + 2;
			
			Шапка = Макет.ПолучитьОбласть("Шапка");
			Шапка.Параметры.НомерЧетнойСтраницы   = НомерЧетнойСтраницы;
			Шапка.Параметры.НомерНечетнойСтраницы = НомерНечетнойСтраницы;
			ДокументРезультат.Вывести(Шапка);
			
		КонецЕсли;

		ДокументРезультат.Вывести(Строка);
		
	КонецЦикла;

	ДокументРезультат.Вывести(Подвал);
	
	ДокументРезультат.ТолькоПросмотр = Истина;
	
КонецПроцедуры // СформироватьСтраницы()

#КонецЕсли