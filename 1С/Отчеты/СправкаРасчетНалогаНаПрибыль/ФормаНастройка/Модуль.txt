Процедура КнопкаОКНажатие(Кнопка)
		Закрыть(Истина);
	КонецПроцедуры
	
Процедура УправлениеДиалогом()	
		ВидОтчета = ?(ВидОтчета = 0, 1, ВидОтчета);
КонецПроцедуры

Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
		УправлениеДиалогом();
КонецПроцедуры

Процедура ПриОткрытии()
	
	Если РегламентированнаяОтчетность.ИДКонфигурации() <> "БП" Тогда
		// Проверка ведения однофирменности
		УчетПоВсемОрганизациям = Истина;
	Иначе
		УчетПоВсемОрганизациям = глЗначениеПеременной("УчетПоВсемОрганизациям");
	КонецЕсли;
	Если Не ЗначениеЗаполнено(ПериодРегистрации) Тогда
		ПериодРегистрации = ТекущаяДата();
	КонецЕсли;
	
	ПредставлениеПериодаРегистрации = РаботаСДиалогами.ПолучитьПредставлениеПериодаРегистрации(ПериодРегистрации);
	БухгалтерскиеОтчеты.ПоддержкаОднофирменностиДляФормыНастроекБухОтчетов(ЭтаФорма, УчетПоВсемОрганизациям);
	УправлениеВидимостьюВариантовОтчета();
	ЗаполнитьНачальныеНастройки()
КонецПроцедуры

Процедура ОбновлениеОтображения()
		УправлениеДиалогом();

КонецПроцедуры

Процедура ЗаполнитьНачальныеНастройки() Экспорт
	
	СтарыеНастройки = УправлениеОтчетами.ПолучитьКопиюОтбораВТЗ(ПостроительОтчета.Отбор);
	
	СоотвСубконто = Новый Соответствие;
	
	Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
	        |	ХозрасчетныйОбороты.СуммаОборотКт КАК СуммаОборотКт
	        |{ВЫБРАТЬ
	        |	ХозрасчетныйОбороты.Валюта.*}
	        |ИЗ
	        |	РегистрБухгалтерии.Хозрасчетный.Обороты(, , Месяц, Счет В ИЕРАРХИИ (&Счет), , {Валюта.*}, , ) КАК ХозрасчетныйОбороты
	        |ИТОГИ
	        |	СУММА(СуммаОборотКт)
	        |ПО
	        |	ОБЩИЕ
	        |{ИТОГИ ПО
	        |	ХозрасчетныйОбороты.Валюта.*}";

Массив = Новый Массив;
Массив.Добавить(ПланыСчетов.Хозрасчетный.ВалютныеСчета);
ПостроительОтчета.Параметры.Вставить("Счет", Массив);
ПостроительОтчета.Параметры.Вставить("ПустаяОрганизация", Справочники.Организации.ПустаяСсылка());
	
ПостроительОтчета.Текст = Текст;

СоотвСубконто = Новый Соответствие;
СоотвСубконто.Вставить("Валюта",    Справочники.Валюты);

Если ПостроительОтчета.Отбор.Количество() = 0 Тогда
	ПостроительОтчета.Отбор.Добавить("Валюта");
КонецЕсли;

УправлениеОтчетами.УстановитьОтборИзТаблицы(ПостроительОтчета.Отбор, СтарыеНастройки);

КонецПроцедуры

// Процедура - обработчик события "Регулирование" элемента управления ПредставлениеПериодаРегистрации.
//
Процедура ПредставлениеПериодаРегистрацииРегулирование(Элемент, Направление, СтандартнаяОбработка)
	
	РаботаСДиалогами.РегулированиеПредставленияПериодаРегистрации(Направление, СтандартнаяОбработка, ПериодРегистрации, ПредставлениеПериодаРегистрации);
	
КонецПроцедуры

// Процедура - обработчик события "НачалоВыбораИзСписка" элемента управления ПредставлениеПериодаРегистрации.
//
Процедура ПредставлениеПериодаРегистрацииНачалоВыбораИзСписка(Элемент, СтандартнаяОбработка)
	
	РаботаСДиалогами.НачалоВыбораИзСпискаПредставленияПериодаРегистрации(Элемент, СтандартнаяОбработка, ПериодРегистрации, ЭтаФорма);
	
КонецПроцедуры

Процедура УправлениеВидимостьюВариантовОтчета()
	
	ПрименяетсяУСН = НалоговыйУчетУСН.ПрименениеУСН(Организация,НачалоМесяца(ПериодРегистрации));
	
	ВариантОтчета = ?(ВариантОтчета = 0 ИЛИ ПрименяетсяУСН, 1, ВариантОтчета);
	ЭлементыФормы.ВариантОтчета.Доступность = Не ПрименяетсяУСН;
	ЭлементыФормы.ВариантОтчета2.Доступность = Не ПрименяетсяУСН;
	ЭлементыФормы.ВариантОтчета3.Доступность = Не ПрименяетсяУСН;
	ЭлементыФормы.ВариантОтчета2.Видимость = Не ПрименяетсяУСН;
	ЭлементыФормы.ВариантОтчета3.Видимость = Не ПрименяетсяУСН;
	
КонецПроцедуры

Процедура ПредставлениеПериодаРегистрацииПриИзменении(Элемент)
	УправлениеВидимостьюВариантовОтчета()
КонецПроцедуры

Процедура ОрганизацияПриИзменении(Элемент)
	УправлениеВидимостьюВариантовОтчета()
КонецПроцедуры