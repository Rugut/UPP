////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

// Обработчик события ПриОткрытии формы.
//
Процедура ПриОткрытии() Экспорт

	ЭлементыФормы.ПанельОтчета.ТекущаяСтраница = ЭлементыФормы.ПанельОтчета.Страницы[0];

КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ЭЛЕМЕНТОВ УПРАВЛЕНИЯ КОМАНДНОЙ ПАНЕЛИ ФОРМЫ

// Обработчик события элемента ОсновныеДействияФормы.Сформировать.
//
Процедура КнопкаВыполнитьНажатие(Элемент) Экспорт

	СформироватьОтчет(ЭлементыФормы.ПолеТабличногоДокумента);
	ЭлементыФормы.ПанельОтчета.ТекущаяСтраница = ЭлементыФормы.ПанельОтчета.Страницы[0];
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ КОМАНДНОЙ ПАНЕЛИ СПИСКА ЗНАЧЕНИЙ

// Обработчик события Нажатие элемента КоманднаяПанельСпискаЗначений.СнятьФлажки.
//
Процедура КоманднаяПанельСпискаЗначенийСнятьФлажки(Кнопка)
	
	Для каждого ЭлементСписка Из СписокНастроек Цикл
		ЭлементСписка.Пометка = Ложь;
	КонецЦикла; 
	
КонецПроцедуры

// Обработчик события Нажатие элемента КоманднаяПанельСпискаЗначений.УстановитьФлажки.
//
Процедура КоманднаяПанельСпискаЗначенийУстановитьФлажки(Кнопка)
	
	Для каждого ЭлементСписка Из СписокНастроек Цикл
		ЭлементСписка.Пометка = Истина;
	КонецЦикла; 
	
КонецПроцедуры

// Обработчик события Нажатие элемента КоманднаяПанельСпискаЗначений.Вверх.
//
Процедура КоманднаяПанельСпискаЗначенийВверх(Кнопка)
	
	Если ЭлементыФормы.СписокНастроек.ТекущаяСтрока = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	ТекЭлемент = СписокНастроек.НайтиПоЗначению(ЭлементыФормы.СписокНастроек.ТекущаяСтрока.Значение);
	
	ТекИндекс = СписокНастроек.Индекс(ТекЭлемент);
	
	Если ТекИндекс = 0 Тогда
		СписокНастроек.Сдвинуть(СписокНастроек[ТекИндекс],(СписокНастроек.Количество()-1));
	Иначе
		СписокНастроек.Сдвинуть(СписокНастроек[ТекИндекс],-1);
	КонецЕсли; 
	
КонецПроцедуры

// Обработчик события Нажатие элемента КоманднаяПанельСпискаЗначений.Вниз.
//
Процедура КоманднаяПанельСпискаЗначенийВниз(Кнопка)

	Если ЭлементыФормы.СписокНастроек.ТекущаяСтрока = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	ТекЭлемент = СписокНастроек.НайтиПоЗначению(ЭлементыФормы.СписокНастроек.ТекущаяСтрока.Значение);
	
	ТекИндекс = СписокНастроек.Индекс(ТекЭлемент);
	
	Если ТекИндекс = СписокНастроек.Количество()-1 Тогда
		СписокНастроек.Сдвинуть(СписокНастроек[ТекИндекс],-(СписокНастроек.Количество()-1));
	Иначе
		СписокНастроек.Сдвинуть(СписокНастроек[ТекИндекс],1);
	КонецЕсли; 
	
КонецПроцедуры