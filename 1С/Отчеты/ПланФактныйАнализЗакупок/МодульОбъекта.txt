#Если Клиент Тогда
	
////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ НАЧАЛЬНОЙ НАСТРОЙКИ ОТЧЕТА

// Процедура установки начальных настроек отчета с использованием текста запроса
//
Процедура УстановитьНачальныеНастройки(ДополнительныеПараметры = Неопределено) Экспорт
	
	УниверсальныйОтчет.мНазваниеОтчета = СокрЛП(ЭтотОбъект.Метаданные().Синоним);
	УниверсальныйОтчет.мВыбиратьИмяРегистра = Ложь;
	
	Если ДополнительныеПараметры <> Неопределено Тогда
		
		УправлениеОтчетами.ВосстановитьРеквизитыОтчета(ЭтотОбъект, ДополнительныеПараметры);
		
	ИначеЕсли ДанныеОтчета.Количество() = 0 Тогда
		
		НоваяСтрока = ДанныеОтчета.Добавить();
		НоваяСтрока.ТипДанных = "Планы закупок";
		
		НоваяСтрока = ДанныеОтчета.Добавить();
		НоваяСтрока.ТипДанных = "Фактические закупки";
		
	КонецЕсли;
	
	ТекстЗапроса = ПолучитьТекстЗапроса();
	
	// В универсальном отчете включен флаг использования свойств и категорий.
	Если УниверсальныйОтчет.ИспользоватьСвойстваИКатегории Тогда
		
		// Добавление свойств и категорий поля запроса в таблицу полей.
		// Необходимо вызывать для каждого поля запроса, предоставляющего возможность использования свойств и категорий.
		
		// УниверсальныйОтчет.ДобавитьСвойстваИКатегорииДляПоля(<ПсевдонимТаблицы>.<Поле> , <ПсевдонимПоля>, <Представление>, <Назначение>);
		
		УниверсальныйОтчет.ДобавитьСвойстваИКатегорииДляПоля("РезультатАнализа.Проект", "Проект", "Проект", ПланыВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_Проекты);
		УниверсальныйОтчет.ДобавитьСвойстваИКатегорииДляПоля("РезультатАнализа.Подразделение", "Подразделение", "Подразделение", ПланыВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_Подразделения);
		УниверсальныйОтчет.ДобавитьСвойстваИКатегорииДляПоля("РезультатАнализа.Контрагент", "Контрагент", "Контрагент", ПланыВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_Контрагенты);
		УниверсальныйОтчет.ДобавитьСвойстваИКатегорииДляПоля("РезультатАнализа.Договор", "Договор", "Договор", ПланыВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_ДоговорыКонтрагентов);
		УниверсальныйОтчет.ДобавитьСвойстваИКатегорииДляПоля("РезультатАнализа.Заказ", "Заказ", "Заказ", ПланыВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Документы);
		УниверсальныйОтчет.ДобавитьСвойстваИКатегорииДляПоля("РезультатАнализа.Номенклатура", "Номенклатура", "Номенклатура", ПланыВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_Номенклатура);
		УниверсальныйОтчет.ДобавитьСвойстваИКатегорииДляПоля("РезультатАнализа.НоменклатурнаяГруппа", "НоменклатурнаяГруппа", "Номенклатурная группа", ПланыВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_НоменклатурныеГруппы);
		УниверсальныйОтчет.ДобавитьСвойстваИКатегорииДляПоля("РезультатАнализа.ХарактеристикаНоменклатуры", "ХарактеристикаНоменклатуры", "Характеристика номенклатуры", ПланыВидовХарактеристик.НазначенияСвойствКатегорийОбъектов.Справочник_ХарактеристикиНоменклатуры);
		
		// Добавление свойств и категорий в исходный текст запроса.
		УниверсальныйОтчет.ДобавитьВТекстЗапросаСвойстваИКатегории(ТекстЗапроса);
		
	КонецЕсли;
		
	// Инициализация текста запроса построителя отчета
	УниверсальныйОтчет.ПостроительОтчета.Текст = ТекстЗапроса;
	
	// Представления полей отчета.
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("ТипДанных", "Источник данных");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("Проект", "Проект");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("Подразделение", "Подразделение");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("Контрагент", "Контрагент");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("Договор", "Договор");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("Заказ", "Заказ");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("НоменклатурнаяГруппа", "Номенклатурная группа");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("Номенклатура", "Номенклатура");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("ХарактеристикаНоменклатуры", "Характеристика номенклатуры");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("Ответственный", "Ответственный");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("ДокументПланирования", "Документ планирования");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("ВариантРаспределения", "Вариант распределения");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("Организация", "Организация");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("ДокументЗакупки", "Документ закупки");
	
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("Количество", "Количество (в единицах хранения)");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("КоличествоБазовыхЕдиниц", "Количество (в базовых единицах)");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("КоличествоЕдиницОтчетов", "Количество (в единицах отчетов)");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("КоличествоОтклонение", "Отклонение (в единицах хранения)");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("КоличествоБазовыхЕдиницОтклонение", "Отклонение (в базовых единицах)");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("КоличествоЕдиницОтчетовОтклонение", "Отклонение (в единицах отчетов)");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("КоличествоОтклонениеПроцент", "Отклонение количества (%)");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("СтоимостьБезНДС", "Стоимость без НДС");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("СтоимостьБезНДСОтклонение", "Отклонение стоимости без НДС");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("СтоимостьБезНДСОтклонениеПроцент", "Отклонение стоимости без НДС (%)");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("НДС", "НДС");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("НДСОтклонение", "Отклонение НДС");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("НДСОтклонениеПроцент", "Отклонение НДС (%)");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("СтоимостьСНДС", "Стоимость с НДС");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("СтоимостьСНДСОтклонение", "Отклонение стоимости с НДС");
	УниверсальныйОтчет.мСтруктураПредставлениеПолей.Вставить("СтоимостьСНДСОтклонениеПроцент", "Отклонение стоимости с НДС (%)");
	
	// Добавление показателей
	УниверсальныйОтчет.ДобавитьПоказатель("Количество", "Ед. хранения", Истина, "ЧЦ=15; ЧДЦ=3", "Количество", "Количество");
	УниверсальныйОтчет.ДобавитьПоказатель("КоличествоБазовыхЕдиниц", "Базовых ед.", Ложь, "ЧЦ=15; ЧДЦ=3", "Количество");
	УниверсальныйОтчет.ДобавитьПоказатель("КоличествоЕдиницОтчетов", "Ед. отчетов", Ложь, "ЧЦ=15; ЧДЦ=3", "Количество");
	
	УниверсальныйОтчет.ДобавитьПоказатель("КоличествоОтклонение", "Ед. хранения", Истина, "ЧЦ=15; ЧДЦ=3", "ОтклонениеКоличества", "Отклонение количества");
	УниверсальныйОтчет.ДобавитьПоказатель("КоличествоБазовыхЕдиницОтклонение", "Базовых ед.", Ложь, "ЧЦ=15; ЧДЦ=3", "ОтклонениеКоличества");
	УниверсальныйОтчет.ДобавитьПоказатель("КоличествоЕдиницОтчетовОтклонение", "Ед. отчетов", Ложь, "ЧЦ=15; ЧДЦ=3", "ОтклонениеКоличества");
	УниверсальныйОтчет.ДобавитьПоказатель("КоличествоОтклонениеПроцент", "%", Истина, "ЧЦ=15; ЧДЦ=2", "ОтклонениеКоличества");
	
	УниверсальныйОтчет.ДобавитьПоказатель("СтоимостьБезНДС", "Без НДС", Ложь, "ЧЦ=15; ЧДЦ=2", "Стоимость", "Стоимость");
	УниверсальныйОтчет.ДобавитьПоказатель("НДС", "НДС", Ложь, "ЧЦ=15; ЧДЦ=2", "Стоимость", "Стоимость");
	УниверсальныйОтчет.ДобавитьПоказатель("СтоимостьСНДС", "С НДС", Истина, "ЧЦ=15; ЧДЦ=2", "Стоимость");
	
	УниверсальныйОтчет.ДобавитьПоказатель("СтоимостьБезНДСОтклонение", "Без НДС", Ложь, "ЧЦ=15; ЧДЦ=2", "ОтклонениеСтоимости", "Отклонение стоимости");
	УниверсальныйОтчет.ДобавитьПоказатель("НДСОтклонение", "НДС", Ложь, "ЧЦ=15; ЧДЦ=2", "ОтклонениеСтоимости");
	УниверсальныйОтчет.ДобавитьПоказатель("СтоимостьСНДСОтклонение", "С НДС", Истина, "ЧЦ=15; ЧДЦ=2", "ОтклонениеСтоимости");
	
	УниверсальныйОтчет.ДобавитьПоказатель("СтоимостьБезНДСОтклонениеПроцент", "Без НДС, %", Ложь, "ЧЦ=15; ЧДЦ=2", "ОтклонениеСтоимости");
	УниверсальныйОтчет.ДобавитьПоказатель("НДСОтклонениеПроцент", "НДС, %", Ложь, "ЧЦ=15; ЧДЦ=2", "ОтклонениеСтоимости");
	УниверсальныйОтчет.ДобавитьПоказатель("СтоимостьСНДСОтклонениеПроцент", "С НДС, %", Истина, "ЧЦ=15; ЧДЦ=2", "ОтклонениеСтоимости");
	
	// Добавление предопределенных группировок строк отчета.
	УниверсальныйОтчет.ДобавитьИзмерениеСтроки("Подразделение");
	УниверсальныйОтчет.ДобавитьИзмерениеСтроки("Номенклатура");
	
	// Добавление предопределенных группировок колонок отчета.
	УниверсальныйОтчет.ДобавитьИзмерениеКолонки("ТипДанных");
	
	// Добавление предопределенных отборов отчета.
	// Необходимо вызывать для каждого добавляемого отбора.
	// УниверсальныйОтчет.ДобавитьОтбор(<ПутьКДанным>);
	УниверсальныйОтчет.ДобавитьОтбор("Подразделение");
	УниверсальныйОтчет.ДобавитьОтбор("Номенклатура");
	
	// Добавление предопределенных полей порядка отчета.
	// Необходимо вызывать для каждого добавляемого поля порядка.
	// УниверсальныйОтчет.ДобавитьПорядок(<ПутьКДанным>);
	
	// Установка связи подчиненных и родительских полей
	// УниверсальныйОтчет.УстановитьСвязьПолей(<ПутьКДанным>, <ПутьКДаннымРодитель>);
	
	// Установка связи полей и измерений
	// УниверсальныйОтчет.УстановитьСвязьПоляИИзмерения(<ИмяПоля>, <ИмяИзмерения>);
	
	// Установка представлений полей
	УниверсальныйОтчет.УстановитьПредставленияПолей(УниверсальныйОтчет.мСтруктураПредставлениеПолей, УниверсальныйОтчет.ПостроительОтчета);
	
	// Установка типов значений свойств в отборах отчета
	УниверсальныйОтчет.УстановитьТипыЗначенийСвойствДляОтбора();
	
	// Заполнение начальных настроек универсального отчета
	УниверсальныйОтчет.УстановитьНачальныеНастройки(Ложь);
	
	// Добавление дополнительных полей
	// Необходимо вызывать для каждого добавляемого дополнительного поля.
	// УниверсальныйОтчет.ДобавитьДополнительноеПоле(<ПутьКДанным>, <Размещение>, <Положение>);
	
КонецПроцедуры // УстановитьНачальныеНастройки()

Функция ПолучитьТекстЗапроса() Экспорт
	
	ТекстЗапроса = "";
	
	ЭталонныйТипДанных = ДанныеОтчета[0].ТипДанных;
	
	Для каждого СравниваемыеДанные из ДанныеОтчета Цикл
		
		СравниваемыйТипДанных = СравниваемыеДанные.ТипДанных;
		
		Если ЭталонныйТипДанных = "Планы закупок" И СравниваемыйТипДанных = "Фактические закупки" Тогда
			
			ДобавитьФакт_План(ТекстЗапроса, СравниваемыеДанные, ДанныеОтчета[0]);
			
		ИначеЕсли ЭталонныйТипДанных = "Фактические закупки" И СравниваемыйТипДанных = "Планы закупок" Тогда
			
			ДобавитьПлан_Факт(ТекстЗапроса, СравниваемыеДанные, ДанныеОтчета[0]);
			
		ИначеЕсли ЭталонныйТипДанных = "Планы закупок" И СравниваемыйТипДанных = "Планы закупок" Тогда
			
			ДобавитьПлан_План(ТекстЗапроса, СравниваемыеДанные, ДанныеОтчета[0]);
			
		ИначеЕсли ЭталонныйТипДанных = "Фактические закупки" И СравниваемыйТипДанных = "Фактические закупки" Тогда
			
			ДобавитьФакт_Факт(ТекстЗапроса, СравниваемыеДанные, ДанныеОтчета[0]);
			
		КонецЕсли;
		
	КонецЦикла;
	
	ТекстЗапроса = ТекстЗапроса + "
	|{УПОРЯДОЧИТЬ ПО
	|	ТипДанных,
	|	Проект.*,
	|	Подразделение.*,
	|	Контрагент.*,
	|	Договор.*,
	|	Заказ.*,
	|	НоменклатурнаяГруппа.*,
	|	Номенклатура.*,
	|	ХарактеристикаНоменклатуры.*,
	|	Ответственный.*,
	|	Регистратор.*,
	|	Период,
	|	ПериодДень,
	|	ПериодНеделя,
	|	ПериодДекада,
	|	ПериодМесяц,
	|	ПериодКвартал,
	|	ПериодПолугодие,
	|	ПериодГод,
	|	Количество,
	|	КоличествоБазовыхЕдиниц,
	|	КоличествоЕдиницОтчетов,
	|	КоличествоОтклонение,
	|	КоличествоБазовыхЕдиницОтклонение,
	|	КоличествоЕдиницОтчетовОтклонение,
	|	КоличествоОтклонениеПроцент,
	|	СтоимостьБезНДС,
	|	НДС,
	|	СтоимостьСНДС,
	|	СтоимостьБезНДСОтклонение,
	|	СтоимостьБезНДСОтклонениеПроцент,
	|	НДСОтклонение,
	|	НДСОтклонениеПроцент,
	|	СтоимостьСНДСОтклонение,
	|	СтоимостьСНДСОтклонениеПроцент
	|	//ПСЕВДОНИМЫ_СВОЙСТВА
	|	//ПСЕВДОНИМЫ_КАТЕГОРИИ
	|}
	|ИТОГИ
	|	СУММА(Количество),
	|	СУММА(КоличествоБазовыхЕдиниц),
	|	СУММА(КоличествоЕдиницОтчетов),
	|	СУММА(КоличествоОтклонение),
	|	СУММА(КоличествоБазовыхЕдиницОтклонение),
	|	СУММА(КоличествоЕдиницОтчетовОтклонение),
	|	ВЫБОР КОГДА ЕСТЬNULL(СУММА(КоличествоОтклонение), 0) = 0 ТОГДА
	|		0
	|	ИНАЧЕ
	|		ВЫБОР КОГДА ЕСТЬNULL(СУММА(Количество), 0) = 0 ТОГДА
	|			- 100
	|		ИНАЧЕ
	|			ВЫБОР КОГДА (СУММА(Количество) - СУММА(КоличествоОтклонение)) = 0 ТОГДА
	|				""-""
	|			ИНАЧЕ
	|				СУММА(КоличествоОтклонение) * 100 / (СУММА(Количество) - СУММА(КоличествоОтклонение))
	|			КОНЕЦ
	|		КОНЕЦ
	|	КОНЕЦ КАК КоличествоОтклонениеПроцент,
	|	СУММА(СтоимостьБезНДС),
	|	СУММА(СтоимостьБезНДСОтклонение),
	|	ВЫБОР КОГДА ЕСТЬNULL(СУММА(СтоимостьБезНДСОтклонение), 0) = 0 ТОГДА
	|		0
	|	ИНАЧЕ
	|		ВЫБОР КОГДА ЕСТЬNULL(СУММА(СтоимостьБезНДС), 0) = 0 ТОГДА
	|			- 100
	|		ИНАЧЕ
	|			ВЫБОР КОГДА (СУММА(СтоимостьБезНДС) - СУММА(СтоимостьБезНДСОтклонение)) = 0 ТОГДА
	|				""-""
	|			ИНАЧЕ
	|				СУММА(СтоимостьБезНДСОтклонение) * 100 / (СУММА(СтоимостьБезНДС) - СУММА(СтоимостьБезНДСОтклонение))
	|			КОНЕЦ
	|		КОНЕЦ
	|	КОНЕЦ КАК СтоимостьБезНДСОтклонениеПроцент,
	|	СУММА(НДС),
	|	СУММА(НДСОтклонение),
	|	ВЫБОР КОГДА ЕСТЬNULL(СУММА(НДСОтклонение), 0) = 0 ТОГДА
	|		0
	|	ИНАЧЕ
	|		ВЫБОР КОГДА ЕСТЬNULL(СУММА(НДС), 0) = 0 ТОГДА
	|			- 100
	|		ИНАЧЕ
	|			ВЫБОР КОГДА (СУММА(НДС) - СУММА(НДСОтклонение)) = 0 ТОГДА
	|				""-""
	|			ИНАЧЕ
	|				СУММА(НДСОтклонение) * 100 / (СУММА(НДС) - СУММА(НДСОтклонение))
	|			КОНЕЦ
	|		КОНЕЦ
	|	КОНЕЦ КАК НДСОтклонениеПроцент,
	|	СУММА(СтоимостьСНДС),
	|	СУММА(СтоимостьСНДСОтклонение),
	|	ВЫБОР КОГДА ЕСТЬNULL(СУММА(СтоимостьСНДСОтклонение), 0) = 0 ТОГДА
	|		0
	|	ИНАЧЕ
	|		ВЫБОР КОГДА ЕСТЬNULL(СУММА(СтоимостьСНДС), 0) = 0 ТОГДА
	|			- 100
	|		ИНАЧЕ
	|			ВЫБОР КОГДА (СУММА(СтоимостьСНДС) - СУММА(СтоимостьСНДСОтклонение)) = 0 ТОГДА
	|				""-""
	|			ИНАЧЕ
	|				СУММА(СтоимостьСНДСОтклонение) * 100 / (СУММА(СтоимостьСНДС) - СУММА(СтоимостьСНДСОтклонение))
	|			КОНЕЦ
	|		КОНЕЦ
	|	КОНЕЦ КАК СтоимостьСНДСОтклонениеПроцент
	|	//ИТОГИ_СВОЙСТВА
	|	//ИТОГИ_КАТЕГОРИИ
	|ПО
	|	ОБЩИЕ
	|{ИТОГИ ПО
	|	ТипДанных,
	|	Проект.*,
	|	Подразделение.*,
	|	Контрагент.*,
	|	Договор.*,
	|	Заказ.*,
	|	НоменклатурнаяГруппа.*,
	|	Номенклатура.*,
	|	ХарактеристикаНоменклатуры.*,
	|	Ответственный.*,
	|	Регистратор.*,
	|	Период,
	|	ПериодДень,
	|	ПериодНеделя,
	|	ПериодДекада,
	|	ПериодМесяц,
	|	ПериодКвартал,
	|	ПериодПолугодие,
	|	ПериодГод
	|	//ПСЕВДОНИМЫ_СВОЙСТВА
	|	//ПСЕВДОНИМЫ_КАТЕГОРИИ
	|}";
		
	Возврат ТекстЗапроса;
	
КонецФункции // ПолучитьТекстЗапроса()

// Эталонные данные - "Факт", текущие данные - "План"
Процедура ДобавитьПлан_Факт(ТекстЗапроса, СравниваемыеДанные, ЭталонныеДанные)
	
	НомерСтроки = СравниваемыеДанные.НомерСтроки;
	
	Если НомерСтроки > 1 Тогда
			
		ТекстЗапроса = ТекстЗапроса + "
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|";
			
	КонецЕсли;
	
	ТекстЗапроса = ТекстЗапроса + 
	"ВЫБРАТЬ " + ?(ПустаяСтрока(ТекстЗапроса), "РАЗРЕШЕННЫЕ", "") + "
	|	&ТипДанных" + Формат(НомерСтроки, "ЧГ=0") + " КАК ТипДанных,
	|	РезультатАнализа.Проект КАК Проект,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Проект) КАК ПроектПредставление,
	|	РезультатАнализа.Подразделение КАК Подразделение,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Подразделение) КАК ПодразделениеПредставление,
	|	РезультатАнализа.Контрагент КАК Контрагент,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Контрагент) КАК КонтрагентПредставление,
	|	РезультатАнализа.Договор КАК Договор,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Договор) КАК ДоговорПредставление,
	|	РезультатАнализа.Заказ КАК Заказ,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Заказ) КАК ЗаказПредставление,
	|	РезультатАнализа.НоменклатурнаяГруппа КАК НоменклатурнаяГруппа,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.НоменклатурнаяГруппа) КАК НоменклатурнаяГруппаПредставление,
	|	РезультатАнализа.Номенклатура КАК Номенклатура,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Номенклатура) КАК НоменклатураПредставление,
	|	РезультатАнализа.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.ХарактеристикаНоменклатуры) КАК ХарактеристикаНоменклатурыПредставление,
	|	РезультатАнализа.Ответственный КАК Ответственный,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Ответственный) КАК ОтветственныйПредставление,
	|	РезультатАнализа.Регистратор КАК Регистратор,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Регистратор) КАК РегистраторПредставление,
	|	РезультатАнализа.Период КАК Период,
	|	РезультатАнализа.ПериодДень КАК ПериодДень,
	|	РезультатАнализа.ПериодНеделя КАК ПериодНеделя,
	|	РезультатАнализа.ПериодДекада КАК ПериодДекада,
	|	РезультатАнализа.ПериодМесяц КАК ПериодМесяц,
	|	РезультатАнализа.ПериодКвартал КАК ПериодКвартал,
	|	РезультатАнализа.ПериодПолугодие КАК ПериодПолугодие,
	|	РезультатАнализа.ПериодГод КАК ПериодГод,
	|	РезультатАнализа.Количество КАК Количество,
	|	РезультатАнализа.КоличествоБазовыхЕдиниц КАК КоличествоБазовыхЕдиниц,
	|	РезультатАнализа.КоличествоЕдиницОтчетов КАК КоличествоЕдиницОтчетов,
	|	РезультатАнализа.КоличествоОтклонение КАК КоличествоОтклонение,
	|	РезультатАнализа.КоличествоБазовыхЕдиницОтклонение КАК КоличествоБазовыхЕдиницОтклонение,
	|	РезультатАнализа.КоличествоЕдиницОтчетовОтклонение КАК КоличествоЕдиницОтчетовОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.КоличествоОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.Количество = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.Количество - РезультатАнализа.КоличествоОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.КоличествоОтклонение * 100 / РезультатАнализа.Количество - РезультатАнализа.КоличествоОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК КоличествоОтклонениеПроцент,
	|	РезультатАнализа.СтоимостьБезНДС КАК СтоимостьБезНДС,
	|	РезультатАнализа.НДС КАК НДС,
	|	РезультатАнализа.СтоимостьСНДС КАК СтоимостьСНДС,
	|	РезультатАнализа.СтоимостьБезНДСОтклонение КАК СтоимостьБезНДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.СтоимостьБезНДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.СтоимостьБезНДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.СтоимостьБезНДС - РезультатАнализа.СтоимостьБезНДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.СтоимостьБезНДСОтклонение * 100 / РезультатАнализа.СтоимостьБезНДС - РезультатАнализа.СтоимостьБезНДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК СтоимостьБезНДСОтклонениеПроцент,
	|	РезультатАнализа.НДСОтклонение КАК НДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.НДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.НДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.НДС - РезультатАнализа.НДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.НДСОтклонение * 100 / РезультатАнализа.НДС - РезультатАнализа.НДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК НДСОтклонениеПроцент,
	|	РезультатАнализа.СтоимостьСНДСОтклонение КАК СтоимостьСНДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.СтоимостьСНДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.СтоимостьСНДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.СтоимостьСНДС - РезультатАнализа.СтоимостьСНДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.СтоимостьСНДСОтклонение * 100 / РезультатАнализа.СтоимостьСНДС - РезультатАнализа.СтоимостьСНДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК СтоимостьСНДСОтклонениеПроцент
	|	//ПОЛЯ_СВОЙСТВА
	|	//ПОЛЯ_КАТЕГОРИИ
	|{ВЫБРАТЬ
	|	Проект.*,
	|	Подразделение.*,
	|	Контрагент.*,
	|	Договор.*,
	|	Заказ.*,
	|	НоменклатурнаяГруппа.*,
	|	Номенклатура.*,
	|	ХарактеристикаНоменклатуры.*,
	|	Ответственный.*,
	|	Регистратор.*,
	|	Период,
	|	ПериодДень,
	|	ПериодНеделя,
	|	ПериодДекада,
	|	ПериодМесяц,
	|	ПериодКвартал,
	|	ПериодПолугодие,
	|	ПериодГод,
	|	Количество,
	|	КоличествоБазовыхЕдиниц,
	|	КоличествоЕдиницОтчетов,
	|	КоличествоОтклонение,
	|	КоличествоБазовыхЕдиницОтклонение,
	|	КоличествоЕдиницОтчетовОтклонение,
	|	КоличествоОтклонениеПроцент,
	|	СтоимостьБезНДС,
	|	НДС,
	|	СтоимостьСНДС,
	|	СтоимостьБезНДСОтклонение,
	|	СтоимостьБезНДСОтклонениеПроцент,
	|	НДСОтклонение,
	|	НДСОтклонениеПроцент,
	|	СтоимостьСНДСОтклонение,
	|	СтоимостьСНДСОтклонениеПроцент
	|	//ПСЕВДОНИМЫ_СВОЙСТВА
	|	//ПСЕВДОНИМЫ_КАТЕГОРИИ
	|}
	|ИЗ
	|	(ВЫБРАТЬ
	|		АнализируемыеДанные.Проект КАК Проект,
	|		АнализируемыеДанные.Подразделение КАК Подразделение,
	|		АнализируемыеДанные.Контрагент КАК Контрагент,
	|		АнализируемыеДанные.Договор КАК Договор,
	|		АнализируемыеДанные.Заказ КАК Заказ,
	|		АнализируемыеДанные.НоменклатурнаяГруппа КАК НоменклатурнаяГруппа,
	|		АнализируемыеДанные.Номенклатура КАК Номенклатура,
	|		АнализируемыеДанные.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	|		АнализируемыеДанные.Ответственный КАК Ответственный,
	|		АнализируемыеДанные.Регистратор КАК Регистратор,
	|		АнализируемыеДанные.Период КАК Период,
	|		АнализируемыеДанные.ПериодДень КАК ПериодДень,
	|		АнализируемыеДанные.ПериодНеделя КАК ПериодНеделя,
	|		АнализируемыеДанные.ПериодДекада КАК ПериодДекада,
	|		АнализируемыеДанные.ПериодМесяц КАК ПериодМесяц,
	|		АнализируемыеДанные.ПериодКвартал КАК ПериодКвартал,
	|		АнализируемыеДанные.ПериодПолугодие КАК ПериодПолугодие,
	|		АнализируемыеДанные.ПериодГод КАК ПериодГод,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокКоличество) КАК Количество,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокКоличествоБазовыхЕдиниц) КАК КоличествоБазовыхЕдиниц,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокКоличествоЕдиницОтчетов) КАК КоличествоЕдиницОтчетов,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокКоличество) - СУММА(АнализируемыеДанные.ЗакупкиКоличество) КАК КоличествоОтклонение,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокКоличествоБазовыхЕдиниц) - СУММА(АнализируемыеДанные.ЗакупкиКоличествоБазовыхЕдиниц) КАК КоличествоБазовыхЕдиницОтклонение,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокКоличествоЕдиницОтчетов) - СУММА(АнализируемыеДанные.ЗакупкиКоличествоЕдиницОтчетов) КАК КоличествоЕдиницОтчетовОтклонение,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокСтоимостьБезНДС) КАК СтоимостьБезНДС,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокНДС) КАК НДС,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокСтоимостьСНДС) КАК СтоимостьСНДС,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокСтоимостьБезНДС) - СУММА(АнализируемыеДанные.ЗакупкиСтоимостьБезНДС) КАК СтоимостьБезНДСОтклонение,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокНДС) - СУММА(АнализируемыеДанные.ЗакупкиНДС) КАК НДСОтклонение,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокСтоимостьСНДС) - СУММА(АнализируемыеДанные.ЗакупкиСтоимостьСНДС) КАК СтоимостьСНДСОтклонение
	|	ИЗ
	|		(ВЫБРАТЬ
	|			ПланыЗакупокОбороты.Проект КАК Проект,
	|			ПланыЗакупокОбороты.Подразделение КАК Подразделение,
	|			ПланыЗакупокОбороты.Контрагент КАК Контрагент,
	|			ПланыЗакупокОбороты.Договор КАК Договор,
	|			ПланыЗакупокОбороты.Заказ КАК Заказ,
	|			ВЫРАЗИТЬ(ВЫБОР
	|					КОГДА ПланыЗакупокОбороты.Номенклатура ССЫЛКА Справочник.Номенклатура
	|						ТОГДА ПланыЗакупокОбороты.Номенклатура.НоменклатурнаяГруппа
	|					ИНАЧЕ ПланыЗакупокОбороты.Номенклатура
	|				КОНЕЦ КАК Справочник.НоменклатурныеГруппы) КАК НоменклатурнаяГруппа,
	|			ВЫРАЗИТЬ(ВЫБОР
	|					КОГДА ПланыЗакупокОбороты.Номенклатура ССЫЛКА Справочник.НоменклатурныеГруппы
	|						ТОГДА &СправочникНоменклатураПустаяСсылка
	|					ИНАЧЕ ПланыЗакупокОбороты.Номенклатура
	|				КОНЕЦ КАК Справочник.Номенклатура) КАК Номенклатура,
	|			ПланыЗакупокОбороты.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	|			ПланыЗакупокОбороты.ДокументПланирования.Ответственный КАК Ответственный,
	|			ПланыЗакупокОбороты.Регистратор КАК Регистратор,
	|			ПланыЗакупокОбороты.Период КАК Период,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОбороты.Период, ДЕНЬ) КАК ПериодДень,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОбороты.Период, НЕДЕЛЯ) КАК ПериодНеделя,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОбороты.Период, ДЕКАДА) КАК ПериодДекада,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОбороты.Период, МЕСЯЦ) КАК ПериодМесяц,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОбороты.Период, КВАРТАЛ) КАК ПериодКвартал,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОбороты.Период, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОбороты.Период, ГОД) КАК ПериодГод,
	|			ПланыЗакупокОбороты.КоличествоОборот КАК ПланыЗакупокКоличество,
	|			ПланыЗакупокОбороты.КоличествоОборот * ПланыЗакупокОбороты.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент КАК ПланыЗакупокКоличествоБазовыхЕдиниц,
	|			ПланыЗакупокОбороты.КоличествоОборот * ПланыЗакупокОбороты.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент / ЕСТЬNULL(ПланыЗакупокОбороты.Номенклатура.ЕдиницаДляОтчетов.Коэффициент, 1) КАК ПланыЗакупокКоличествоЕдиницОтчетов,
	|			0 КАК ЗакупкиКоличество,
	|			0 КАК ЗакупкиКоличествоБазовыхЕдиниц,
	|			0 КАК ЗакупкиКоличествоЕдиницОтчетов,
	|			ПланыЗакупокОбороты.СтоимостьОборот КАК ПланыЗакупокСтоимостьБезНДС,
	|			ПланыЗакупокОбороты.НДСОборот КАК ПланыЗакупокНДС,
	|			ПланыЗакупокОбороты.СтоимостьОборот + ПланыЗакупокОбороты.НДСОборот КАК ПланыЗакупокСтоимостьСНДС,
	|			0 КАК ЗакупкиСтоимостьБезНДС,
	|			0 КАК ЗакупкиНДС,
	|			0 КАК ЗакупкиСтоимостьСНДС
	|		ИЗ
	|			РегистрНакопления.ПланыЗакупок.Обороты(&ДатаНач" + Формат(НомерСтроки, "ЧГ=0") + ", &ДатаКон" + Формат(НомерСтроки, "ЧГ=0") + ", Регистратор, ВЫБОР КОГДА &Сценарий" + Формат(НомерСтроки, "ЧГ=0") + " = НЕОПРЕДЕЛЕНО ТОГДА ИСТИНА ИНАЧЕ Сценарий = &Сценарий" + Формат(НомерСтроки, "ЧГ=0") + " КОНЕЦ {Проект.* КАК Проект, Подразделение.* КАК Подразделение, Контрагент.* КАК Контрагент, Договор.* КАК Договор, Заказ.* КАК Заказ, ДокументПланирования.* КАК ДокументПланирования, ВЫРАЗИТЬ((ВЫБОР КОГДА Номенклатура ССЫЛКА Справочник.Номенклатура ТОГДА Номенклатура.НоменклатурнаяГруппа ИНАЧЕ Номенклатура КОНЕЦ) КАК Справочник.НоменклатурныеГруппы).* КАК НоменклатурнаяГруппа, ВЫРАЗИТЬ(Номенклатура КАК Справочник.Номенклатура).* КАК Номенклатура, ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры, ДокументПланирования.Ответственный.* КАК Ответственный, ВариантРаспределения.* КАК ВариантРаспределения}) КАК ПланыЗакупокОбороты
	|
	|		ОБЪЕДИНИТЬ ВСЕ
	|
	|		ВЫБРАТЬ
	|			ЗакупкиОбороты.Проект КАК Проект,
	|			ЗакупкиОбороты.Подразделение КАК Подразделение,
	|			ЗакупкиОбороты.Контрагент КАК Контрагент,
	|			ЗакупкиОбороты.ДоговорКонтрагента КАК Договор,
	|			ЗакупкиОбороты.ЗаказПоставщику КАК Заказ,
	|			ЗакупкиОбороты.Номенклатура.НоменклатурнаяГруппа КАК НоменклатурнаяГруппа,
	|			ЗакупкиОбороты.Номенклатура КАК Номенклатура,
	|			ЗакупкиОбороты.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	|			ЗакупкиОбороты.ДокументЗакупки.Ответственный КАК Ответственный,
	|			ЗакупкиОбороты.Регистратор КАК Регистратор,
	|			ЗакупкиОбороты.Период КАК Период,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОбороты.Период, ДЕНЬ) КАК ПериодДень,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОбороты.Период, НЕДЕЛЯ) КАК ПериодНеделя,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОбороты.Период, ДЕКАДА) КАК ПериодДекада,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОбороты.Период, МЕСЯЦ) КАК ПериодМесяц,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОбороты.Период, КВАРТАЛ) КАК ПериодКвартал,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОбороты.Период, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОбороты.Период, ГОД) КАК ПериодГод,
	|			0 КАК ПланыЗакупокКоличество,
	|			0 КАК ПланыЗакупокКоличествоБазовыхЕдиниц,
	|			0 КАК ПланыЗакупокКоличествоЕдиницОтчетов,
	|			ЗакупкиОбороты.КоличествоОборот КАК ЗакупкиКоличество,
	|			ЗакупкиОбороты.КоличествоОборот * ЗакупкиОбороты.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент КАК ЗакупкиКоличествоБазовыхЕдиниц,
	|			ЗакупкиОбороты.КоличествоОборот * ЗакупкиОбороты.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент / ЗакупкиОбороты.Номенклатура.ЕдиницаДляОтчетов.Коэффициент КАК ЗакупкиКоличествоЕдиницОтчетов,
	|			0 КАК ПланыЗакупокСтоимостьБезНДС,
	|			0 КАК ПланыЗакупокНДС,
	|			0 КАК ПланыЗакупокСтоимостьСНДС,
	|			ЗакупкиОбороты.СтоимостьОборот - ЗакупкиОбороты.НДСОборот КАК ЗакупкиСтоимостьБезНДС,
	|			ЗакупкиОбороты.НДСОборот КАК ЗакупкиНДС,
	|			ЗакупкиОбороты.СтоимостьОборот КАК ЗакупкиСтоимостьСНДС
	|		ИЗ
	|			РегистрНакопления.Закупки.Обороты(&ДатаНач1, &ДатаКон1, Регистратор, {Организация.* КАК Организация, Проект.* КАК Проект, Подразделение.* КАК Подразделение, Контрагент.* КАК Контрагент, ДоговорКонтрагента.* КАК Договор, ЗаказПоставщику.* КАК Заказ, ДокументЗакупки.* КАК ДокументЗакупки, Номенклатура.НоменклатурнаяГруппа.* КАК НоменклатурнаяГруппа, Номенклатура.* КАК Номенклатура, ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры, ДокументЗакупки.Ответственный.* КАК Ответственный}) КАК ЗакупкиОбороты) КАК АнализируемыеДанные
	|	СГРУППИРОВАТЬ ПО
	|		АнализируемыеДанные.Проект,
	|		АнализируемыеДанные.Подразделение,
	|		АнализируемыеДанные.Контрагент,
	|		АнализируемыеДанные.Договор,
	|		АнализируемыеДанные.Заказ,
	|		АнализируемыеДанные.НоменклатурнаяГруппа,
	|		АнализируемыеДанные.Номенклатура,
	|		АнализируемыеДанные.ХарактеристикаНоменклатуры,
	|		АнализируемыеДанные.Ответственный,
	|		АнализируемыеДанные.Регистратор,
	|		АнализируемыеДанные.Период,
	|		АнализируемыеДанные.ПериодДень,
	|		АнализируемыеДанные.ПериодНеделя,
	|		АнализируемыеДанные.ПериодДекада,
	|		АнализируемыеДанные.ПериодМесяц,
	|		АнализируемыеДанные.ПериодКвартал,
	|		АнализируемыеДанные.ПериодПолугодие,
	|		АнализируемыеДанные.ПериодГод) КАК РезультатАнализа
	|	//СОЕДИНЕНИЯ
	|{ГДЕ
	|	РезультатАнализа.Регистратор КАК Регистратор,
	|	РезультатАнализа.Период КАК Период,
	|	РезультатАнализа.ПериодДень КАК ПериодДень,
	|	РезультатАнализа.ПериодНеделя КАК ПериодНеделя,
	|	РезультатАнализа.ПериодДекада КАК ПериодДекада,
	|	РезультатАнализа.ПериодМесяц КАК ПериодМесяц,
	|	РезультатАнализа.ПериодКвартал КАК ПериодКвартал,
	|	РезультатАнализа.ПериодПолугодие КАК ПериодПолугодие,
	|	РезультатАнализа.ПериодГод КАК ПериодГод,
	|	РезультатАнализа.Количество КАК Количество,
	|	РезультатАнализа.КоличествоБазовыхЕдиниц КАК КоличествоБазовыхЕдиниц,
	|	РезультатАнализа.КоличествоЕдиницОтчетов КАК КоличествоЕдиницОтчетов,
	|	РезультатАнализа.КоличествоОтклонение КАК КоличествоОтклонение,
	|	РезультатАнализа.КоличествоБазовыхЕдиницОтклонение КАК КоличествоБазовыхЕдиницОтклонение,
	|	РезультатАнализа.КоличествоЕдиницОтчетовОтклонение КАК КоличествоЕдиницОтчетовОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.КоличествоОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.Количество = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.Количество - РезультатАнализа.КоличествоОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.КоличествоОтклонение * 100 / РезультатАнализа.Количество - РезультатАнализа.КоличествоОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК КоличествоОтклонениеПроцент,
	|	РезультатАнализа.СтоимостьБезНДС КАК СтоимостьБезНДС,
	|	РезультатАнализа.НДС КАК НДС,
	|	РезультатАнализа.СтоимостьСНДС КАК СтоимостьСНДС,
	|	РезультатАнализа.СтоимостьБезНДСОтклонение КАК СтоимостьБезНДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.СтоимостьБезНДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.СтоимостьБезНДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.СтоимостьБезНДС - РезультатАнализа.СтоимостьБезНДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.СтоимостьБезНДСОтклонение * 100 / РезультатАнализа.СтоимостьБезНДС - РезультатАнализа.СтоимостьБезНДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК СтоимостьБезНДСОтклонениеПроцент,
	|	РезультатАнализа.НДСОтклонение КАК НДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.НДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.НДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.НДС - РезультатАнализа.НДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.НДСОтклонение * 100 / РезультатАнализа.НДС - РезультатАнализа.НДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК НДСОтклонениеПроцент,
	|	РезультатАнализа.СтоимостьСНДСОтклонение КАК СтоимостьСНДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.СтоимостьСНДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.СтоимостьСНДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.СтоимостьСНДС - РезультатАнализа.СтоимостьСНДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.СтоимостьСНДСОтклонение * 100 / РезультатАнализа.СтоимостьСНДС - РезультатАнализа.СтоимостьСНДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК СтоимостьСНДСОтклонениеПроцент
	|	//УСЛОВИЯ_СВОЙСТВА
	|	//УСЛОВИЯ_КАТЕГОРИИ
	|}";
		
КонецПроцедуры // ДобавитьПлан_Факт()

// Эталонные данные - "План", текущие данные - "Факт"
Процедура ДобавитьФакт_План(ТекстЗапроса, СравниваемыеДанные, ЭталонныеДанные)
	
	НомерСтроки = СравниваемыеДанные.НомерСтроки;
	
	Если НомерСтроки > 1 Тогда
			
		ТекстЗапроса = ТекстЗапроса + "
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|";
			
	КонецЕсли;
	
	ТекстЗапроса = ТекстЗапроса + 
	"ВЫБРАТЬ " + ?(ПустаяСтрока(ТекстЗапроса), "РАЗРЕШЕННЫЕ", "") + "
	|	&ТипДанных" + Формат(НомерСтроки, "ЧГ=0") + " КАК ТипДанных,
	|	РезультатАнализа.Проект КАК Проект,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Проект) КАК ПроектПредставление,
	|	РезультатАнализа.Подразделение КАК Подразделение,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Подразделение) КАК ПодразделениеПредставление,
	|	РезультатАнализа.Контрагент КАК Контрагент,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Контрагент) КАК КонтрагентПредставление,
	|	РезультатАнализа.Договор КАК Договор,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Договор) КАК ДоговорПредставление,
	|	РезультатАнализа.Заказ КАК Заказ,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Заказ) КАК ЗаказПредставление,
	|	РезультатАнализа.НоменклатурнаяГруппа КАК НоменклатурнаяГруппа,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.НоменклатурнаяГруппа) КАК НоменклатурнаяГруппаПредставление,
	|	РезультатАнализа.Номенклатура КАК Номенклатура,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Номенклатура) КАК НоменклатураПредставление,
	|	РезультатАнализа.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.ХарактеристикаНоменклатуры) КАК ХарактеристикаНоменклатурыПредставление,
	|	РезультатАнализа.Ответственный КАК Ответственный,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Ответственный) КАК ОтветственныйПредставление,
	|	РезультатАнализа.Регистратор КАК Регистратор,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Регистратор) КАК РегистраторПредставление,
	|	РезультатАнализа.Период КАК Период,
	|	РезультатАнализа.ПериодДень КАК ПериодДень,
	|	РезультатАнализа.ПериодНеделя КАК ПериодНеделя,
	|	РезультатАнализа.ПериодДекада КАК ПериодДекада,
	|	РезультатАнализа.ПериодМесяц КАК ПериодМесяц,
	|	РезультатАнализа.ПериодКвартал КАК ПериодКвартал,
	|	РезультатАнализа.ПериодПолугодие КАК ПериодПолугодие,
	|	РезультатАнализа.ПериодГод КАК ПериодГод,
	|	РезультатАнализа.Количество КАК Количество,
	|	РезультатАнализа.КоличествоБазовыхЕдиниц КАК КоличествоБазовыхЕдиниц,
	|	РезультатАнализа.КоличествоЕдиницОтчетов КАК КоличествоЕдиницОтчетов,
	|	РезультатАнализа.КоличествоОтклонение КАК КоличествоОтклонение,
	|	РезультатАнализа.КоличествоБазовыхЕдиницОтклонение КАК КоличествоБазовыхЕдиницОтклонение,
	|	РезультатАнализа.КоличествоЕдиницОтчетовОтклонение КАК КоличествоЕдиницОтчетовОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.КоличествоОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.Количество = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.Количество - РезультатАнализа.КоличествоОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.КоличествоОтклонение * 100 / РезультатАнализа.Количество - РезультатАнализа.КоличествоОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК КоличествоОтклонениеПроцент,
	|	РезультатАнализа.СтоимостьБезНДС КАК СтоимостьБезНДС,
	|	РезультатАнализа.НДС КАК НДС,
	|	РезультатАнализа.СтоимостьСНДС КАК СтоимостьСНДС,
	|	РезультатАнализа.СтоимостьБезНДСОтклонение КАК СтоимостьБезНДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.СтоимостьБезНДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.СтоимостьБезНДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.СтоимостьБезНДС - РезультатАнализа.СтоимостьБезНДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.СтоимостьБезНДСОтклонение * 100 / РезультатАнализа.СтоимостьБезНДС - РезультатАнализа.СтоимостьБезНДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК СтоимостьБезНДСОтклонениеПроцент,
	|	РезультатАнализа.НДСОтклонение КАК НДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.НДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.НДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.НДС - РезультатАнализа.НДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.НДСОтклонение * 100 / РезультатАнализа.НДС - РезультатАнализа.НДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК НДСОтклонениеПроцент,
	|	РезультатАнализа.СтоимостьСНДСОтклонение КАК СтоимостьСНДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.СтоимостьСНДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.СтоимостьСНДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.СтоимостьСНДС - РезультатАнализа.СтоимостьСНДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.СтоимостьСНДСОтклонение * 100 / РезультатАнализа.СтоимостьСНДС - РезультатАнализа.СтоимостьСНДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК СтоимостьСНДСОтклонениеПроцент
	|	//ПОЛЯ_СВОЙСТВА
	|	//ПОЛЯ_КАТЕГОРИИ
	|{ВЫБРАТЬ
	|	Проект.*,
	|	Подразделение.*,
	|	Контрагент.*,
	|	Договор.*,
	|	Заказ.*,
	|	НоменклатурнаяГруппа.*,
	|	Номенклатура.*,
	|	ХарактеристикаНоменклатуры.*,
	|	Ответственный.*,
	|	Регистратор.*,
	|	Период,
	|	ПериодДень,
	|	ПериодНеделя,
	|	ПериодДекада,
	|	ПериодМесяц,
	|	ПериодКвартал,
	|	ПериодПолугодие,
	|	ПериодГод,
	|	Количество,
	|	КоличествоБазовыхЕдиниц,
	|	КоличествоЕдиницОтчетов,
	|	КоличествоОтклонение,
	|	КоличествоБазовыхЕдиницОтклонение,
	|	КоличествоЕдиницОтчетовОтклонение,
	|	КоличествоОтклонениеПроцент,
	|	СтоимостьБезНДС,
	|	НДС,
	|	СтоимостьСНДС,
	|	СтоимостьБезНДСОтклонение,
	|	СтоимостьБезНДСОтклонениеПроцент,
	|	НДСОтклонение,
	|	НДСОтклонениеПроцент,
	|	СтоимостьСНДСОтклонение,
	|	СтоимостьСНДСОтклонениеПроцент
	|	//ПСЕВДОНИМЫ_СВОЙСТВА
	|	//ПСЕВДОНИМЫ_КАТЕГОРИИ
	|}
	|ИЗ
	|	(ВЫБРАТЬ
	|		АнализируемыеДанные.Проект КАК Проект,
	|		АнализируемыеДанные.Подразделение КАК Подразделение,
	|		АнализируемыеДанные.Контрагент КАК Контрагент,
	|		АнализируемыеДанные.Договор КАК Договор,
	|		АнализируемыеДанные.Заказ КАК Заказ,
	|		АнализируемыеДанные.НоменклатурнаяГруппа КАК НоменклатурнаяГруппа,
	|		АнализируемыеДанные.Номенклатура КАК Номенклатура,
	|		АнализируемыеДанные.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	|		АнализируемыеДанные.Ответственный КАК Ответственный,
	|		АнализируемыеДанные.Регистратор КАК Регистратор,
	|		АнализируемыеДанные.Период КАК Период,
	|		АнализируемыеДанные.ПериодДень КАК ПериодДень,
	|		АнализируемыеДанные.ПериодНеделя КАК ПериодНеделя,
	|		АнализируемыеДанные.ПериодДекада КАК ПериодДекада,
	|		АнализируемыеДанные.ПериодМесяц КАК ПериодМесяц,
	|		АнализируемыеДанные.ПериодКвартал КАК ПериодКвартал,
	|		АнализируемыеДанные.ПериодПолугодие КАК ПериодПолугодие,
	|		АнализируемыеДанные.ПериодГод КАК ПериодГод,
	|		СУММА(АнализируемыеДанные.ЗакупкиКоличество) КАК Количество,
	|		СУММА(АнализируемыеДанные.ЗакупкиКоличествоБазовыхЕдиниц) КАК КоличествоБазовыхЕдиниц,
	|		СУММА(АнализируемыеДанные.ЗакупкиКоличествоЕдиницОтчетов) КАК КоличествоЕдиницОтчетов,
	|		СУММА(АнализируемыеДанные.ЗакупкиКоличество) - СУММА(АнализируемыеДанные.ПланыЗакупокКоличество) КАК КоличествоОтклонение,
	|		СУММА(АнализируемыеДанные.ЗакупкиКоличествоБазовыхЕдиниц) - СУММА(АнализируемыеДанные.ПланыЗакупокКоличествоБазовыхЕдиниц) КАК КоличествоБазовыхЕдиницОтклонение,
	|		СУММА(АнализируемыеДанные.ЗакупкиКоличествоЕдиницОтчетов) - СУММА(АнализируемыеДанные.ПланыЗакупокКоличествоЕдиницОтчетов) КАК КоличествоЕдиницОтчетовОтклонение,
	|		СУММА(АнализируемыеДанные.ЗакупкиСтоимостьБезНДС) КАК СтоимостьБезНДС,
	|		СУММА(АнализируемыеДанные.ЗакупкиНДС) КАК НДС,
	|		СУММА(АнализируемыеДанные.ЗакупкиСтоимостьСНДС) КАК СтоимостьСНДС,
	|		СУММА(АнализируемыеДанные.ЗакупкиСтоимостьБезНДС) - СУММА(АнализируемыеДанные.ПланыЗакупокСтоимостьБезНДС) КАК СтоимостьБезНДСОтклонение,
	|		СУММА(АнализируемыеДанные.ЗакупкиНДС) - СУММА(АнализируемыеДанные.ПланыЗакупокНДС) КАК НДСОтклонение,
	|		СУММА(АнализируемыеДанные.ЗакупкиСтоимостьСНДС) - СУММА(АнализируемыеДанные.ПланыЗакупокСтоимостьСНДС) КАК СтоимостьСНДСОтклонение
	|	ИЗ
	|		(ВЫБРАТЬ
	|			ЗакупкиОбороты.Проект КАК Проект,
	|			ЗакупкиОбороты.Подразделение КАК Подразделение,
	|			ЗакупкиОбороты.Контрагент КАК Контрагент,
	|			ЗакупкиОбороты.ДоговорКонтрагента КАК Договор,
	|			ЗакупкиОбороты.ЗаказПоставщику КАК Заказ,
	|			ЗакупкиОбороты.Номенклатура.НоменклатурнаяГруппа КАК НоменклатурнаяГруппа,
	|			ЗакупкиОбороты.Номенклатура КАК Номенклатура,
	|			ЗакупкиОбороты.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	|			ЗакупкиОбороты.ДокументЗакупки.Ответственный КАК Ответственный,
	|			ЗакупкиОбороты.Регистратор КАК Регистратор,
	|			ЗакупкиОбороты.Период КАК Период,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОбороты.Период, ДЕНЬ) КАК ПериодДень,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОбороты.Период, НЕДЕЛЯ) КАК ПериодНеделя,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОбороты.Период, ДЕКАДА) КАК ПериодДекада,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОбороты.Период, МЕСЯЦ) КАК ПериодМесяц,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОбороты.Период, КВАРТАЛ) КАК ПериодКвартал,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОбороты.Период, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОбороты.Период, ГОД) КАК ПериодГод,
	|			ЗакупкиОбороты.КоличествоОборот КАК ЗакупкиКоличество,
	|			ЗакупкиОбороты.КоличествоОборот * ЗакупкиОбороты.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент КАК ЗакупкиКоличествоБазовыхЕдиниц,
	|			ЗакупкиОбороты.КоличествоОборот * ЗакупкиОбороты.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент / ЗакупкиОбороты.Номенклатура.ЕдиницаДляОтчетов.Коэффициент КАК ЗакупкиКоличествоЕдиницОтчетов,
	|			0 КАК ПланыЗакупокКоличество,
	|			0 КАК ПланыЗакупокКоличествоБазовыхЕдиниц,
	|			0 КАК ПланыЗакупокКоличествоЕдиницОтчетов,
	|			ЗакупкиОбороты.СтоимостьОборот - ЗакупкиОбороты.НДСОборот КАК ЗакупкиСтоимостьБезНДС,
	|			ЗакупкиОбороты.НДСОборот КАК ЗакупкиНДС,
	|			ЗакупкиОбороты.СтоимостьОборот КАК ЗакупкиСтоимостьСНДС,
	|			0 КАК ПланыЗакупокСтоимостьБезНДС,
	|			0 КАК ПланыЗакупокНДС,
	|			0 КАК ПланыЗакупокСтоимостьСНДС
	|		ИЗ
	|			РегистрНакопления.Закупки.Обороты(&ДатаНач" + Формат(НомерСтроки, "ЧГ=0") + ", &ДатаКон" + Формат(НомерСтроки, "ЧГ=0") + ", Регистратор, {Организация.* КАК Организация, Проект.* КАК Проект, Подразделение.* КАК Подразделение, Контрагент.* КАК Контрагент, ДоговорКонтрагента.* КАК Договор, ЗаказПоставщику.* КАК Заказ, ДокументЗакупки.* КАК ДокументЗакупки, Номенклатура.НоменклатурнаяГруппа.* КАК НоменклатурнаяГруппа, Номенклатура.* КАК Номенклатура, ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры, ДокументЗакупки.Ответственный.* КАК Ответственный}) КАК ЗакупкиОбороты
	|
	|		ОБЪЕДИНИТЬ ВСЕ
	|
	|		ВЫБРАТЬ
	|			ПланыЗакупокОбороты.Проект КАК Проект,
	|			ПланыЗакупокОбороты.Подразделение КАК Подразделение,
	|			ПланыЗакупокОбороты.Контрагент КАК Контрагент,
	|			ПланыЗакупокОбороты.Договор КАК Договор,
	|			ПланыЗакупокОбороты.Заказ КАК Заказ,
	|			ВЫРАЗИТЬ(ВЫБОР
	|					КОГДА ПланыЗакупокОбороты.Номенклатура ССЫЛКА Справочник.Номенклатура
	|						ТОГДА ПланыЗакупокОбороты.Номенклатура.НоменклатурнаяГруппа
	|					ИНАЧЕ ПланыЗакупокОбороты.Номенклатура
	|				КОНЕЦ КАК Справочник.НоменклатурныеГруппы) КАК НоменклатурнаяГруппа,
	|			ВЫРАЗИТЬ(ВЫБОР
	|					КОГДА ПланыЗакупокОбороты.Номенклатура ССЫЛКА Справочник.НоменклатурныеГруппы
	|						ТОГДА &СправочникНоменклатураПустаяСсылка
	|					ИНАЧЕ ПланыЗакупокОбороты.Номенклатура
	|				КОНЕЦ КАК Справочник.Номенклатура) КАК Номенклатура,
	|			ПланыЗакупокОбороты.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	|			ПланыЗакупокОбороты.ДокументПланирования.Ответственный КАК Ответственный,
	|			ПланыЗакупокОбороты.Регистратор КАК Регистратор,
	|			ПланыЗакупокОбороты.Период КАК Период,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОбороты.Период, ДЕНЬ) КАК ПериодДень,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОбороты.Период, НЕДЕЛЯ) КАК ПериодНеделя,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОбороты.Период, ДЕКАДА) КАК ПериодДекада,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОбороты.Период, МЕСЯЦ) КАК ПериодМесяц,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОбороты.Период, КВАРТАЛ) КАК ПериодКвартал,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОбороты.Период, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОбороты.Период, ГОД) КАК ПериодГод,
	|			0 КАК ЗакупкиКоличество,
	|			0 КАК ЗакупкиКоличествоБазовыхЕдиниц,
	|			0 КАК ЗакупкиКоличествоЕдиницОтчетов,
	|			ПланыЗакупокОбороты.КоличествоОборот КАК ПланыЗакупокКоличество,
	|			ПланыЗакупокОбороты.КоличествоОборот * ПланыЗакупокОбороты.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент КАК ПланыЗакупокКоличествоБазовыхЕдиниц,
	|			ПланыЗакупокОбороты.КоличествоОборот * ПланыЗакупокОбороты.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент / ЕСТЬNULL(ПланыЗакупокОбороты.Номенклатура.ЕдиницаДляОтчетов.Коэффициент, 1) КАК ПланыЗакупокКоличествоЕдиницОтчетов,
	|			0 КАК ЗакупкиСтоимостьБезНДС,
	|			0 КАК ЗакупкиНДС,
	|			0 КАК ЗакупкиСтоимостьСНДС,
	|			ПланыЗакупокОбороты.СтоимостьОборот КАК ПланыЗакупокСтоимостьБезНДС,
	|			ПланыЗакупокОбороты.НДСОборот КАК ПланыЗакупокНДС,
	|			ПланыЗакупокОбороты.СтоимостьОборот + ПланыЗакупокОбороты.НДСОборот КАК ПланыЗакупокСтоимостьСНДС
	|		ИЗ
	|			РегистрНакопления.ПланыЗакупок.Обороты(&ДатаНач1, &ДатаКон1, Регистратор, ВЫБОР КОГДА &Сценарий1 = НЕОПРЕДЕЛЕНО ТОГДА ИСТИНА ИНАЧЕ Сценарий = &Сценарий1 КОНЕЦ {Проект.* КАК Проект, Подразделение.* КАК Подразделение, Контрагент.* КАК Контрагент, Договор.* КАК Договор, Заказ.* КАК Заказ, ДокументПланирования.* КАК ДокументПланирования, ВЫРАЗИТЬ((ВЫБОР КОГДА Номенклатура ССЫЛКА Справочник.Номенклатура ТОГДА Номенклатура.НоменклатурнаяГруппа ИНАЧЕ Номенклатура КОНЕЦ) КАК Справочник.НоменклатурныеГруппы).* КАК НоменклатурнаяГруппа, ВЫРАЗИТЬ(Номенклатура КАК Справочник.Номенклатура).* КАК Номенклатура, ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры, ДокументПланирования.Ответственный.* КАК Ответственный, ВариантРаспределения.* КАК ВариантРаспределения}) КАК ПланыЗакупокОбороты) КАК АнализируемыеДанные
	|	СГРУППИРОВАТЬ ПО
	|		АнализируемыеДанные.Проект,
	|		АнализируемыеДанные.Подразделение,
	|		АнализируемыеДанные.Контрагент,
	|		АнализируемыеДанные.Договор,
	|		АнализируемыеДанные.Заказ,
	|		АнализируемыеДанные.НоменклатурнаяГруппа,
	|		АнализируемыеДанные.Номенклатура,
	|		АнализируемыеДанные.ХарактеристикаНоменклатуры,
	|		АнализируемыеДанные.Ответственный,
	|		АнализируемыеДанные.Регистратор,
	|		АнализируемыеДанные.Период,
	|		АнализируемыеДанные.ПериодДень,
	|		АнализируемыеДанные.ПериодНеделя,
	|		АнализируемыеДанные.ПериодДекада,
	|		АнализируемыеДанные.ПериодМесяц,
	|		АнализируемыеДанные.ПериодКвартал,
	|		АнализируемыеДанные.ПериодПолугодие,
	|		АнализируемыеДанные.ПериодГод) КАК РезультатАнализа
	|	//СОЕДИНЕНИЯ
	|{ГДЕ
	|	РезультатАнализа.Регистратор КАК Регистратор,
	|	РезультатАнализа.Период КАК Период,
	|	РезультатАнализа.ПериодДень КАК ПериодДень,
	|	РезультатАнализа.ПериодНеделя КАК ПериодНеделя,
	|	РезультатАнализа.ПериодДекада КАК ПериодДекада,
	|	РезультатАнализа.ПериодМесяц КАК ПериодМесяц,
	|	РезультатАнализа.ПериодКвартал КАК ПериодКвартал,
	|	РезультатАнализа.ПериодПолугодие КАК ПериодПолугодие,
	|	РезультатАнализа.ПериодГод КАК ПериодГод,
	|	РезультатАнализа.Количество КАК Количество,
	|	РезультатАнализа.КоличествоБазовыхЕдиниц КАК КоличествоБазовыхЕдиниц,
	|	РезультатАнализа.КоличествоЕдиницОтчетов КАК КоличествоЕдиницОтчетов,
	|	РезультатАнализа.КоличествоОтклонение КАК КоличествоОтклонение,
	|	РезультатАнализа.КоличествоБазовыхЕдиницОтклонение КАК КоличествоБазовыхЕдиницОтклонение,
	|	РезультатАнализа.КоличествоЕдиницОтчетовОтклонение КАК КоличествоЕдиницОтчетовОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.КоличествоОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.Количество = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.Количество - РезультатАнализа.КоличествоОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.КоличествоОтклонение * 100 / РезультатАнализа.Количество - РезультатАнализа.КоличествоОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК КоличествоОтклонениеПроцент,
	|	РезультатАнализа.СтоимостьБезНДС КАК СтоимостьБезНДС,
	|	РезультатАнализа.НДС КАК НДС,
	|	РезультатАнализа.СтоимостьСНДС КАК СтоимостьСНДС,
	|	РезультатАнализа.СтоимостьБезНДСОтклонение КАК СтоимостьБезНДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.СтоимостьБезНДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.СтоимостьБезНДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.СтоимостьБезНДС - РезультатАнализа.СтоимостьБезНДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.СтоимостьБезНДСОтклонение * 100 / РезультатАнализа.СтоимостьБезНДС - РезультатАнализа.СтоимостьБезНДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК СтоимостьБезНДСОтклонениеПроцент,
	|	РезультатАнализа.НДСОтклонение КАК НДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.НДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.НДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.НДС - РезультатАнализа.НДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.НДСОтклонение * 100 / РезультатАнализа.НДС - РезультатАнализа.НДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК НДСОтклонениеПроцент,
	|	РезультатАнализа.СтоимостьСНДСОтклонение КАК СтоимостьСНДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.СтоимостьСНДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.СтоимостьСНДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.СтоимостьСНДС - РезультатАнализа.СтоимостьСНДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.СтоимостьСНДСОтклонение * 100 / РезультатАнализа.СтоимостьСНДС - РезультатАнализа.СтоимостьСНДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК СтоимостьСНДСОтклонениеПроцент
	|	//УСЛОВИЯ_СВОЙСТВА
	|	//УСЛОВИЯ_КАТЕГОРИИ
	|}";
	
КонецПроцедуры // ДобавитьФакт_План()

// Эталонные данные - "План", текущие данные - "План"
Процедура ДобавитьПлан_План(ТекстЗапроса, СравниваемыеДанные, ЭталонныеДанные)
	
	НомерСтроки = СравниваемыеДанные.НомерСтроки;
	
	Если НомерСтроки > 1 Тогда
			
		ТекстЗапроса = ТекстЗапроса + "
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|";
			
	КонецЕсли;
	
	ТекстЗапроса = ТекстЗапроса + 
	"ВЫБРАТЬ " + ?(ПустаяСтрока(ТекстЗапроса), "РАЗРЕШЕННЫЕ", "") + "
	|	&ТипДанных" + Формат(НомерСтроки, "ЧГ=0") + " КАК ТипДанных,
	|	РезультатАнализа.Проект КАК Проект,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Проект) КАК ПроектПредставление,
	|	РезультатАнализа.Подразделение КАК Подразделение,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Подразделение) КАК ПодразделениеПредставление,
	|	РезультатАнализа.Контрагент КАК Контрагент,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Контрагент) КАК КонтрагентПредставление,
	|	РезультатАнализа.Договор КАК Договор,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Договор) КАК ДоговорПредставление,
	|	РезультатАнализа.Заказ КАК Заказ,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Заказ) КАК ЗаказПредставление,
	|	РезультатАнализа.НоменклатурнаяГруппа КАК НоменклатурнаяГруппа,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.НоменклатурнаяГруппа) КАК НоменклатурнаяГруппаПредставление,
	|	РезультатАнализа.Номенклатура КАК Номенклатура,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Номенклатура) КАК НоменклатураПредставление,
	|	РезультатАнализа.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.ХарактеристикаНоменклатуры) КАК ХарактеристикаНоменклатурыПредставление,
	|	РезультатАнализа.Ответственный КАК Ответственный,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Ответственный) КАК ОтветственныйПредставление,
	|	РезультатАнализа.Регистратор КАК Регистратор,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Регистратор) КАК РегистраторПредставление,
	|	РезультатАнализа.Период КАК Период,
	|	РезультатАнализа.ПериодДень КАК ПериодДень,
	|	РезультатАнализа.ПериодНеделя КАК ПериодНеделя,
	|	РезультатАнализа.ПериодДекада КАК ПериодДекада,
	|	РезультатАнализа.ПериодМесяц КАК ПериодМесяц,
	|	РезультатАнализа.ПериодКвартал КАК ПериодКвартал,
	|	РезультатАнализа.ПериодПолугодие КАК ПериодПолугодие,
	|	РезультатАнализа.ПериодГод КАК ПериодГод,
	|	РезультатАнализа.Количество КАК Количество,
	|	РезультатАнализа.КоличествоБазовыхЕдиниц КАК КоличествоБазовыхЕдиниц,
	|	РезультатАнализа.КоличествоЕдиницОтчетов КАК КоличествоЕдиницОтчетов,
	|	РезультатАнализа.КоличествоОтклонение КАК КоличествоОтклонение,
	|	РезультатАнализа.КоличествоБазовыхЕдиницОтклонение КАК КоличествоБазовыхЕдиницОтклонение,
	|	РезультатАнализа.КоличествоЕдиницОтчетовОтклонение КАК КоличествоЕдиницОтчетовОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.КоличествоОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.Количество = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.Количество - РезультатАнализа.КоличествоОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.КоличествоОтклонение * 100 / РезультатАнализа.Количество - РезультатАнализа.КоличествоОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК КоличествоОтклонениеПроцент,
	|	РезультатАнализа.СтоимостьБезНДС КАК СтоимостьБезНДС,
	|	РезультатАнализа.НДС КАК НДС,
	|	РезультатАнализа.СтоимостьСНДС КАК СтоимостьСНДС,
	|	РезультатАнализа.СтоимостьБезНДСОтклонение КАК СтоимостьБезНДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.СтоимостьБезНДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.СтоимостьБезНДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.СтоимостьБезНДС - РезультатАнализа.СтоимостьБезНДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.СтоимостьБезНДСОтклонение * 100 / РезультатАнализа.СтоимостьБезНДС - РезультатАнализа.СтоимостьБезНДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК СтоимостьБезНДСОтклонениеПроцент,
	|	РезультатАнализа.НДСОтклонение КАК НДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.НДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.НДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.НДС - РезультатАнализа.НДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.НДСОтклонение * 100 / РезультатАнализа.НДС - РезультатАнализа.НДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК НДСОтклонениеПроцент,
	|	РезультатАнализа.СтоимостьСНДСОтклонение КАК СтоимостьСНДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.СтоимостьСНДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.СтоимостьСНДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.СтоимостьСНДС - РезультатАнализа.СтоимостьСНДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.СтоимостьСНДСОтклонение * 100 / РезультатАнализа.СтоимостьСНДС - РезультатАнализа.СтоимостьСНДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК СтоимостьСНДСОтклонениеПроцент
	|	//ПОЛЯ_СВОЙСТВА
	|	//ПОЛЯ_КАТЕГОРИИ
	|{ВЫБРАТЬ
	|	Проект.*,
	|	Подразделение.*,
	|	Контрагент.*,
	|	Договор.*,
	|	Заказ.*,
	|	НоменклатурнаяГруппа.*,
	|	Номенклатура.*,
	|	ХарактеристикаНоменклатуры.*,
	|	Ответственный.*,
	|	Регистратор.*,
	|	Период,
	|	ПериодДень,
	|	ПериодНеделя,
	|	ПериодДекада,
	|	ПериодМесяц,
	|	ПериодКвартал,
	|	ПериодПолугодие,
	|	ПериодГод,
	|	Количество,
	|	КоличествоБазовыхЕдиниц,
	|	КоличествоЕдиницОтчетов,
	|	КоличествоОтклонение,
	|	КоличествоБазовыхЕдиницОтклонение,
	|	КоличествоЕдиницОтчетовОтклонение,
	|	КоличествоОтклонениеПроцент,
	|	СтоимостьБезНДС,
	|	НДС,
	|	СтоимостьСНДС,
	|	СтоимостьБезНДСОтклонение,
	|	СтоимостьБезНДСОтклонениеПроцент,
	|	НДСОтклонение,
	|	НДСОтклонениеПроцент,
	|	СтоимостьСНДСОтклонение,
	|	СтоимостьСНДСОтклонениеПроцент
	|	//ПСЕВДОНИМЫ_СВОЙСТВА
	|	//ПСЕВДОНИМЫ_КАТЕГОРИИ
	|}
	|ИЗ
	|	(ВЫБРАТЬ
	|		АнализируемыеДанные.Проект КАК Проект,
	|		АнализируемыеДанные.Подразделение КАК Подразделение,
	|		АнализируемыеДанные.Контрагент КАК Контрагент,
	|		АнализируемыеДанные.Договор КАК Договор,
	|		АнализируемыеДанные.Заказ КАК Заказ,
	|		АнализируемыеДанные.НоменклатурнаяГруппа КАК НоменклатурнаяГруппа,
	|		АнализируемыеДанные.Номенклатура КАК Номенклатура,
	|		АнализируемыеДанные.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	|		АнализируемыеДанные.Ответственный КАК Ответственный,
	|		АнализируемыеДанные.Регистратор КАК Регистратор,
	|		АнализируемыеДанные.Период КАК Период,
	|		АнализируемыеДанные.ПериодДень КАК ПериодДень,
	|		АнализируемыеДанные.ПериодНеделя КАК ПериодНеделя,
	|		АнализируемыеДанные.ПериодДекада КАК ПериодДекада,
	|		АнализируемыеДанные.ПериодМесяц КАК ПериодМесяц,
	|		АнализируемыеДанные.ПериодКвартал КАК ПериодКвартал,
	|		АнализируемыеДанные.ПериодПолугодие КАК ПериодПолугодие,
	|		АнализируемыеДанные.ПериодГод КАК ПериодГод,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокКоличествоТекущие) КАК Количество,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокКоличествоБазовыхЕдиницТекущие) КАК КоличествоБазовыхЕдиниц,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокКоличествоЕдиницОтчетовТекущие) КАК КоличествоЕдиницОтчетов,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокКоличествоТекущие) - СУММА(АнализируемыеДанные.ПланыЗакупокКоличествоЭталонные) КАК КоличествоОтклонение,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокКоличествоБазовыхЕдиницТекущие) - СУММА(АнализируемыеДанные.ПланыЗакупокКоличествоБазовыхЕдиницЭталонные) КАК КоличествоБазовыхЕдиницОтклонение,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокКоличествоЕдиницОтчетовТекущие) - СУММА(АнализируемыеДанные.ПланыЗакупокКоличествоЕдиницОтчетовЭталонные) КАК КоличествоЕдиницОтчетовОтклонение,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокСтоимостьБезНДСТекущие) КАК СтоимостьБезНДС,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокНДСТекущие) КАК НДС,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокСтоимостьСНДСТекущие) КАК СтоимостьСНДС,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокСтоимостьБезНДСТекущие) - СУММА(АнализируемыеДанные.ПланыЗакупокСтоимостьБезНДСЭталонные) КАК СтоимостьБезНДСОтклонение,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокНДСТекущие) - СУММА(АнализируемыеДанные.ПланыЗакупокНДСЭталонные) КАК НДСОтклонение,
	|		СУММА(АнализируемыеДанные.ПланыЗакупокСтоимостьСНДСТекущие) - СУММА(АнализируемыеДанные.ПланыЗакупокСтоимостьСНДСЭталонные) КАК СтоимостьСНДСОтклонение
	|	ИЗ
	|		(ВЫБРАТЬ
	|			ПланыЗакупокОборотыТекущие.Проект КАК Проект,
	|			ПланыЗакупокОборотыТекущие.Подразделение КАК Подразделение,
	|			ПланыЗакупокОборотыТекущие.Контрагент КАК Контрагент,
	|			ПланыЗакупокОборотыТекущие.Договор КАК Договор,
	|			ПланыЗакупокОборотыТекущие.Заказ КАК Заказ,
	|			ВЫРАЗИТЬ(ВЫБОР
	|					КОГДА ПланыЗакупокОборотыТекущие.Номенклатура ССЫЛКА Справочник.Номенклатура
	|						ТОГДА ПланыЗакупокОборотыТекущие.Номенклатура.НоменклатурнаяГруппа
	|					ИНАЧЕ ПланыЗакупокОборотыТекущие.Номенклатура
	|				КОНЕЦ КАК Справочник.НоменклатурныеГруппы) КАК НоменклатурнаяГруппа,
	|			ВЫРАЗИТЬ(ВЫБОР
	|					КОГДА ПланыЗакупокОборотыТекущие.Номенклатура ССЫЛКА Справочник.НоменклатурныеГруппы
	|						ТОГДА &СправочникНоменклатураПустаяСсылка
	|					ИНАЧЕ ПланыЗакупокОборотыТекущие.Номенклатура
	|				КОНЕЦ КАК Справочник.Номенклатура) КАК Номенклатура,
	|			ПланыЗакупокОборотыТекущие.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	|			ПланыЗакупокОборотыТекущие.ДокументПланирования.Ответственный КАК Ответственный,
	|			ПланыЗакупокОборотыТекущие.Регистратор КАК Регистратор,
	|			ПланыЗакупокОборотыТекущие.Период КАК Период,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОборотыТекущие.Период, ДЕНЬ) КАК ПериодДень,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОборотыТекущие.Период, НЕДЕЛЯ) КАК ПериодНеделя,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОборотыТекущие.Период, ДЕКАДА) КАК ПериодДекада,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОборотыТекущие.Период, МЕСЯЦ) КАК ПериодМесяц,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОборотыТекущие.Период, КВАРТАЛ) КАК ПериодКвартал,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОборотыТекущие.Период, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОборотыТекущие.Период, ГОД) КАК ПериодГод,
	|			ПланыЗакупокОборотыТекущие.КоличествоОборот КАК ПланыЗакупокКоличествоТекущие,
	|			ПланыЗакупокОборотыТекущие.КоличествоОборот * ПланыЗакупокОборотыТекущие.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент КАК ПланыЗакупокКоличествоБазовыхЕдиницТекущие,
	|			ПланыЗакупокОборотыТекущие.КоличествоОборот * ПланыЗакупокОборотыТекущие.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент / ЕСТЬNULL(ПланыЗакупокОборотыТекущие.Номенклатура.ЕдиницаДляОтчетов.Коэффициент, 1) КАК ПланыЗакупокКоличествоЕдиницОтчетовТекущие,
	|			0 КАК ПланыЗакупокКоличествоЭталонные,
	|			0 КАК ПланыЗакупокКоличествоБазовыхЕдиницЭталонные,
	|			0 КАК ПланыЗакупокКоличествоЕдиницОтчетовЭталонные,
	|			ПланыЗакупокОборотыТекущие.СтоимостьОборот КАК ПланыЗакупокСтоимостьБезНДСТекущие,
	|			ПланыЗакупокОборотыТекущие.НДСОборот КАК ПланыЗакупокНДСТекущие,
	|			ПланыЗакупокОборотыТекущие.СтоимостьОборот + ПланыЗакупокОборотыТекущие.НДСОборот КАК ПланыЗакупокСтоимостьСНДСТекущие,
	|			0 КАК ПланыЗакупокСтоимостьБезНДСЭталонные,
	|			0 КАК ПланыЗакупокНДСЭталонные,
	|			0 КАК ПланыЗакупокСтоимостьСНДСЭталонные
	|		ИЗ
	|			РегистрНакопления.ПланыЗакупок.Обороты(&ДатаНач" + Формат(НомерСтроки, "ЧГ=0") + ", &ДатаКон" + Формат(НомерСтроки, "ЧГ=0") + ", Регистратор, ВЫБОР КОГДА &Сценарий" + Формат(НомерСтроки, "ЧГ=0") + " = НЕОПРЕДЕЛЕНО ТОГДА ИСТИНА ИНАЧЕ Сценарий = &Сценарий" + Формат(НомерСтроки, "ЧГ=0") + " КОНЕЦ {Проект.* КАК Проект, Подразделение.* КАК Подразделение, Контрагент.* КАК Контрагент, Договор.* КАК Договор, Заказ.* КАК Заказ, ДокументПланирования.* КАК ДокументПланирования, ВЫРАЗИТЬ((ВЫБОР КОГДА Номенклатура ССЫЛКА Справочник.Номенклатура ТОГДА Номенклатура.НоменклатурнаяГруппа ИНАЧЕ Номенклатура КОНЕЦ) КАК Справочник.НоменклатурныеГруппы).* КАК НоменклатурнаяГруппа, ВЫРАЗИТЬ(Номенклатура КАК Справочник.Номенклатура).* КАК Номенклатура, ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры, ДокументПланирования.Ответственный.* КАК Ответственный, ВариантРаспределения.* КАК ВариантРаспределения}) КАК ПланыЗакупокОборотыТекущие
	|
	|		ОБЪЕДИНИТЬ ВСЕ
	|
	|		ВЫБРАТЬ
	|			ПланыЗакупокОборотыЭталонные.Проект КАК Проект,
	|			ПланыЗакупокОборотыЭталонные.Подразделение КАК Подразделение,
	|			ПланыЗакупокОборотыЭталонные.Контрагент КАК Контрагент,
	|			ПланыЗакупокОборотыЭталонные.Договор КАК Договор,
	|			ПланыЗакупокОборотыЭталонные.Заказ КАК Заказ,
	|			ВЫРАЗИТЬ(ВЫБОР
	|					КОГДА ПланыЗакупокОборотыЭталонные.Номенклатура ССЫЛКА Справочник.Номенклатура
	|						ТОГДА ПланыЗакупокОборотыЭталонные.Номенклатура.НоменклатурнаяГруппа
	|					ИНАЧЕ ПланыЗакупокОборотыЭталонные.Номенклатура
	|				КОНЕЦ КАК Справочник.НоменклатурныеГруппы) КАК НоменклатурнаяГруппа,
	|			ВЫРАЗИТЬ(ВЫБОР
	|					КОГДА ПланыЗакупокОборотыЭталонные.Номенклатура ССЫЛКА Справочник.НоменклатурныеГруппы
	|						ТОГДА &СправочникНоменклатураПустаяСсылка
	|					ИНАЧЕ ПланыЗакупокОборотыЭталонные.Номенклатура
	|				КОНЕЦ КАК Справочник.Номенклатура) КАК Номенклатура,
	|			ПланыЗакупокОборотыЭталонные.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	|			ПланыЗакупокОборотыЭталонные.ДокументПланирования.Ответственный КАК Ответственный,
	|			ПланыЗакупокОборотыЭталонные.Регистратор КАК Регистратор,
	|			ПланыЗакупокОборотыЭталонные.Период КАК Период,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОборотыЭталонные.Период, ДЕНЬ) КАК ПериодДень,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОборотыЭталонные.Период, НЕДЕЛЯ) КАК ПериодНеделя,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОборотыЭталонные.Период, ДЕКАДА) КАК ПериодДекада,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОборотыЭталонные.Период, МЕСЯЦ) КАК ПериодМесяц,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОборотыЭталонные.Период, КВАРТАЛ) КАК ПериодКвартал,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОборотыЭталонные.Период, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|			НАЧАЛОПЕРИОДА(ПланыЗакупокОборотыЭталонные.Период, ГОД) КАК ПериодГод,
	|			0 КАК ПланыЗакупокКоличествоТекущие,
	|			0 КАК ПланыЗакупокКоличествоБазовыхЕдиницТекущие,
	|			0 КАК ПланыЗакупокКоличествоЕдиницОтчетовТекущие,
	|			ПланыЗакупокОборотыЭталонные.КоличествоОборот КАК ПланыЗакупокКоличествоЭталонные,
	|			ПланыЗакупокОборотыЭталонные.КоличествоОборот * ПланыЗакупокОборотыЭталонные.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент КАК ПланыЗакупокКоличествоБазовыхЕдиницЭталонные,
	|			ПланыЗакупокОборотыЭталонные.КоличествоОборот * ПланыЗакупокОборотыЭталонные.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент / ЕСТЬNULL(ПланыЗакупокОборотыЭталонные.Номенклатура.ЕдиницаДляОтчетов.Коэффициент, 1) КАК ПланыЗакупокКоличествоЕдиницОтчетовЭталонные,
	|			0 КАК ПланыЗакупокСтоимостьБезНДСТекущие,
	|			0 КАК ПланыЗакупокНДСТекущие,
	|			0 КАК ПланыЗакупокСтоимостьСНДСТекущие,
	|			ПланыЗакупокОборотыЭталонные.СтоимостьОборот КАК ПланыЗакупокСтоимостьБезНДСЭталонные,
	|			ПланыЗакупокОборотыЭталонные.НДСОборот КАК ПланыЗакупокНДСЭталонные,
	|			ПланыЗакупокОборотыЭталонные.СтоимостьОборот + ПланыЗакупокОборотыЭталонные.НДСОборот КАК ПланыЗакупокСтоимостьСНДСЭталонные
	|		ИЗ
	|			РегистрНакопления.ПланыЗакупок.Обороты(&ДатаНач1, &ДатаКон1, Регистратор, ВЫБОР КОГДА &Сценарий1 = НЕОПРЕДЕЛЕНО ТОГДА ИСТИНА ИНАЧЕ Сценарий = &Сценарий1 КОНЕЦ {Проект.* КАК Проект, Подразделение.* КАК Подразделение, Контрагент.* КАК Контрагент, Договор.* КАК Договор, Заказ.* КАК Заказ, ДокументПланирования.* КАК ДокументПланирования, ВЫРАЗИТЬ((ВЫБОР КОГДА Номенклатура ССЫЛКА Справочник.Номенклатура ТОГДА Номенклатура.НоменклатурнаяГруппа ИНАЧЕ Номенклатура КОНЕЦ) КАК Справочник.НоменклатурныеГруппы).* КАК НоменклатурнаяГруппа, ВЫРАЗИТЬ(Номенклатура КАК Справочник.Номенклатура).* КАК Номенклатура, ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры, ДокументПланирования.Ответственный.* КАК Ответственный, ВариантРаспределения.* КАК ВариантРаспределения}) КАК ПланыЗакупокОборотыЭталонные) КАК АнализируемыеДанные
	|	СГРУППИРОВАТЬ ПО
	|		АнализируемыеДанные.Проект,
	|		АнализируемыеДанные.Подразделение,
	|		АнализируемыеДанные.Контрагент,
	|		АнализируемыеДанные.Договор,
	|		АнализируемыеДанные.Заказ,
	|		АнализируемыеДанные.НоменклатурнаяГруппа,
	|		АнализируемыеДанные.Номенклатура,
	|		АнализируемыеДанные.ХарактеристикаНоменклатуры,
	|		АнализируемыеДанные.Ответственный,
	|		АнализируемыеДанные.Регистратор,
	|		АнализируемыеДанные.Период,
	|		АнализируемыеДанные.ПериодДень,
	|		АнализируемыеДанные.ПериодНеделя,
	|		АнализируемыеДанные.ПериодДекада,
	|		АнализируемыеДанные.ПериодМесяц,
	|		АнализируемыеДанные.ПериодКвартал,
	|		АнализируемыеДанные.ПериодПолугодие,
	|		АнализируемыеДанные.ПериодГод) КАК РезультатАнализа
	|	//СОЕДИНЕНИЯ
	|{ГДЕ
	|	РезультатАнализа.Регистратор КАК Регистратор,
	|	РезультатАнализа.Период КАК Период,
	|	РезультатАнализа.ПериодДень КАК ПериодДень,
	|	РезультатАнализа.ПериодНеделя КАК ПериодНеделя,
	|	РезультатАнализа.ПериодДекада КАК ПериодДекада,
	|	РезультатАнализа.ПериодМесяц КАК ПериодМесяц,
	|	РезультатАнализа.ПериодКвартал КАК ПериодКвартал,
	|	РезультатАнализа.ПериодПолугодие КАК ПериодПолугодие,
	|	РезультатАнализа.ПериодГод КАК ПериодГод,
	|	РезультатАнализа.Количество КАК Количество,
	|	РезультатАнализа.КоличествоБазовыхЕдиниц КАК КоличествоБазовыхЕдиниц,
	|	РезультатАнализа.КоличествоЕдиницОтчетов КАК КоличествоЕдиницОтчетов,
	|	РезультатАнализа.КоличествоОтклонение КАК КоличествоОтклонение,
	|	РезультатАнализа.КоличествоБазовыхЕдиницОтклонение КАК КоличествоБазовыхЕдиницОтклонение,
	|	РезультатАнализа.КоличествоЕдиницОтчетовОтклонение КАК КоличествоЕдиницОтчетовОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.КоличествоОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.Количество = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.Количество - РезультатАнализа.КоличествоОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.КоличествоОтклонение * 100 / РезультатАнализа.Количество - РезультатАнализа.КоличествоОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК КоличествоОтклонениеПроцент,
	|	РезультатАнализа.СтоимостьБезНДС КАК СтоимостьБезНДС,
	|	РезультатАнализа.НДС КАК НДС,
	|	РезультатАнализа.СтоимостьСНДС КАК СтоимостьСНДС,
	|	РезультатАнализа.СтоимостьБезНДСОтклонение КАК СтоимостьБезНДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.СтоимостьБезНДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.СтоимостьБезНДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.СтоимостьБезНДС - РезультатАнализа.СтоимостьБезНДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.СтоимостьБезНДСОтклонение * 100 / РезультатАнализа.СтоимостьБезНДС - РезультатАнализа.СтоимостьБезНДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК СтоимостьБезНДСОтклонениеПроцент,
	|	РезультатАнализа.НДСОтклонение КАК НДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.НДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.НДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.НДС - РезультатАнализа.НДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.НДСОтклонение * 100 / РезультатАнализа.НДС - РезультатАнализа.НДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК НДСОтклонениеПроцент,
	|	РезультатАнализа.СтоимостьСНДСОтклонение КАК СтоимостьСНДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.СтоимостьСНДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.СтоимостьСНДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.СтоимостьСНДС - РезультатАнализа.СтоимостьСНДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.СтоимостьСНДСОтклонение * 100 / РезультатАнализа.СтоимостьСНДС - РезультатАнализа.СтоимостьСНДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК СтоимостьСНДСОтклонениеПроцент
	|	//УСЛОВИЯ_СВОЙСТВА
	|	//УСЛОВИЯ_КАТЕГОРИИ
	|}";
	
КонецПроцедуры // ДобавитьПлан_План()

// Эталонные данные - "Факт", текущие данные - "Факт"
Процедура ДобавитьФакт_Факт(ТекстЗапроса, СравниваемыеДанные, ЭталонныеДанные)

	НомерСтроки = СравниваемыеДанные.НомерСтроки;
	
	Если НомерСтроки > 1 Тогда
			
		ТекстЗапроса = ТекстЗапроса + "
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|";
			
	КонецЕсли;
	
	ТекстЗапроса = ТекстЗапроса + 
	"ВЫБРАТЬ " + ?(ПустаяСтрока(ТекстЗапроса), "РАЗРЕШЕННЫЕ", "") + "
	|	&ТипДанных" + Формат(НомерСтроки, "ЧГ=0") + " КАК ТипДанных,
	|	РезультатАнализа.Проект КАК Проект,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Проект) КАК ПроектПредставление,
	|	РезультатАнализа.Подразделение КАК Подразделение,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Подразделение) КАК ПодразделениеПредставление,
	|	РезультатАнализа.Контрагент КАК Контрагент,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Контрагент) КАК КонтрагентПредставление,
	|	РезультатАнализа.Договор КАК Договор,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Договор) КАК ДоговорПредставление,
	|	РезультатАнализа.Заказ КАК Заказ,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Заказ) КАК ЗаказПредставление,
	|	РезультатАнализа.НоменклатурнаяГруппа КАК НоменклатурнаяГруппа,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.НоменклатурнаяГруппа) КАК НоменклатурнаяГруппаПредставление,
	|	РезультатАнализа.Номенклатура КАК Номенклатура,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Номенклатура) КАК НоменклатураПредставление,
	|	РезультатАнализа.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.ХарактеристикаНоменклатуры) КАК ХарактеристикаНоменклатурыПредставление,
	|	РезультатАнализа.Ответственный КАК Ответственный,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Ответственный) КАК ОтветственныйПредставление,
	|	РезультатАнализа.Регистратор КАК Регистратор,
	|	ПРЕДСТАВЛЕНИЕ(РезультатАнализа.Регистратор) КАК РегистраторПредставление,
	|	РезультатАнализа.Период КАК Период,
	|	РезультатАнализа.ПериодДень КАК ПериодДень,
	|	РезультатАнализа.ПериодНеделя КАК ПериодНеделя,
	|	РезультатАнализа.ПериодДекада КАК ПериодДекада,
	|	РезультатАнализа.ПериодМесяц КАК ПериодМесяц,
	|	РезультатАнализа.ПериодКвартал КАК ПериодКвартал,
	|	РезультатАнализа.ПериодПолугодие КАК ПериодПолугодие,
	|	РезультатАнализа.ПериодГод КАК ПериодГод,
	|	РезультатАнализа.Количество КАК Количество,
	|	РезультатАнализа.КоличествоБазовыхЕдиниц КАК КоличествоБазовыхЕдиниц,
	|	РезультатАнализа.КоличествоЕдиницОтчетов КАК КоличествоЕдиницОтчетов,
	|	РезультатАнализа.КоличествоОтклонение КАК КоличествоОтклонение,
	|	РезультатАнализа.КоличествоБазовыхЕдиницОтклонение КАК КоличествоБазовыхЕдиницОтклонение,
	|	РезультатАнализа.КоличествоЕдиницОтчетовОтклонение КАК КоличествоЕдиницОтчетовОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.КоличествоОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.Количество = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.Количество - РезультатАнализа.КоличествоОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.КоличествоОтклонение * 100 / РезультатАнализа.Количество - РезультатАнализа.КоличествоОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК КоличествоОтклонениеПроцент,
	|	РезультатАнализа.СтоимостьБезНДС КАК СтоимостьБезНДС,
	|	РезультатАнализа.НДС КАК НДС,
	|	РезультатАнализа.СтоимостьСНДС КАК СтоимостьСНДС,
	|	РезультатАнализа.СтоимостьБезНДСОтклонение КАК СтоимостьБезНДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.СтоимостьБезНДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.СтоимостьБезНДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.СтоимостьБезНДС - РезультатАнализа.СтоимостьБезНДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.СтоимостьБезНДСОтклонение * 100 / РезультатАнализа.СтоимостьБезНДС - РезультатАнализа.СтоимостьБезНДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК СтоимостьБезНДСОтклонениеПроцент,
	|	РезультатАнализа.НДСОтклонение КАК НДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.НДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.НДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.НДС - РезультатАнализа.НДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.НДСОтклонение * 100 / РезультатАнализа.НДС - РезультатАнализа.НДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК НДСОтклонениеПроцент,
	|	РезультатАнализа.СтоимостьСНДСОтклонение КАК СтоимостьСНДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.СтоимостьСНДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.СтоимостьСНДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.СтоимостьСНДС - РезультатАнализа.СтоимостьСНДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.СтоимостьСНДСОтклонение * 100 / РезультатАнализа.СтоимостьСНДС - РезультатАнализа.СтоимостьСНДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК СтоимостьСНДСОтклонениеПроцент
	|	//ПОЛЯ_СВОЙСТВА
	|	//ПОЛЯ_КАТЕГОРИИ
	|{ВЫБРАТЬ
	|	Проект.*,
	|	Подразделение.*,
	|	Контрагент.*,
	|	Договор.*,
	|	Заказ.*,
	|	НоменклатурнаяГруппа.*,
	|	Номенклатура.*,
	|	ХарактеристикаНоменклатуры.*,
	|	Ответственный.*,
	|	Регистратор.*,
	|	Период,
	|	ПериодДень,
	|	ПериодНеделя,
	|	ПериодДекада,
	|	ПериодМесяц,
	|	ПериодКвартал,
	|	ПериодПолугодие,
	|	ПериодГод,
	|	Количество,
	|	КоличествоБазовыхЕдиниц,
	|	КоличествоЕдиницОтчетов,
	|	КоличествоОтклонение,
	|	КоличествоБазовыхЕдиницОтклонение,
	|	КоличествоЕдиницОтчетовОтклонение,
	|	КоличествоОтклонениеПроцент,
	|	СтоимостьБезНДС,
	|	НДС,
	|	СтоимостьСНДС,
	|	СтоимостьБезНДСОтклонение,
	|	СтоимостьБезНДСОтклонениеПроцент,
	|	НДСОтклонение,
	|	НДСОтклонениеПроцент,
	|	СтоимостьСНДСОтклонение,
	|	СтоимостьСНДСОтклонениеПроцент
	|	//ПСЕВДОНИМЫ_СВОЙСТВА
	|	//ПСЕВДОНИМЫ_КАТЕГОРИИ
	|}
	|ИЗ
	|	(ВЫБРАТЬ
	|		АнализируемыеДанные.Проект КАК Проект,
	|		АнализируемыеДанные.Подразделение КАК Подразделение,
	|		АнализируемыеДанные.Контрагент КАК Контрагент,
	|		АнализируемыеДанные.Договор КАК Договор,
	|		АнализируемыеДанные.Заказ КАК Заказ,
	|		АнализируемыеДанные.НоменклатурнаяГруппа КАК НоменклатурнаяГруппа,
	|		АнализируемыеДанные.Номенклатура КАК Номенклатура,
	|		АнализируемыеДанные.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	|		АнализируемыеДанные.Ответственный КАК Ответственный,
	|		АнализируемыеДанные.Регистратор КАК Регистратор,
	|		АнализируемыеДанные.Период КАК Период,
	|		АнализируемыеДанные.ПериодДень КАК ПериодДень,
	|		АнализируемыеДанные.ПериодНеделя КАК ПериодНеделя,
	|		АнализируемыеДанные.ПериодДекада КАК ПериодДекада,
	|		АнализируемыеДанные.ПериодМесяц КАК ПериодМесяц,
	|		АнализируемыеДанные.ПериодКвартал КАК ПериодКвартал,
	|		АнализируемыеДанные.ПериодПолугодие КАК ПериодПолугодие,
	|		АнализируемыеДанные.ПериодГод КАК ПериодГод,
	|		СУММА(АнализируемыеДанные.ЗакупкиКоличествоТекущие) КАК Количество,
	|		СУММА(АнализируемыеДанные.ЗакупкиКоличествоБазовыхЕдиницТекущие) КАК КоличествоБазовыхЕдиниц,
	|		СУММА(АнализируемыеДанные.ЗакупкиКоличествоЕдиницОтчетовТекущие) КАК КоличествоЕдиницОтчетов,
	|		СУММА(АнализируемыеДанные.ЗакупкиКоличествоТекущие) - СУММА(АнализируемыеДанные.ЗакупкиКоличествоЭталонные) КАК КоличествоОтклонение,
	|		СУММА(АнализируемыеДанные.ЗакупкиКоличествоБазовыхЕдиницТекущие) - СУММА(АнализируемыеДанные.ЗакупкиКоличествоБазовыхЕдиницЭталонные) КАК КоличествоБазовыхЕдиницОтклонение,
	|		СУММА(АнализируемыеДанные.ЗакупкиКоличествоЕдиницОтчетовТекущие) - СУММА(АнализируемыеДанные.ЗакупкиКоличествоЕдиницОтчетовЭталонные) КАК КоличествоЕдиницОтчетовОтклонение,
	|		СУММА(АнализируемыеДанные.ЗакупкиСтоимостьБезНДСТекущие) КАК СтоимостьБезНДС,
	|		СУММА(АнализируемыеДанные.ЗакупкиНДСТекущие) КАК НДС,
	|		СУММА(АнализируемыеДанные.ЗакупкиСтоимостьСНДСТекущие) КАК СтоимостьСНДС,
	|		СУММА(АнализируемыеДанные.ЗакупкиСтоимостьБезНДСТекущие) - СУММА(АнализируемыеДанные.ЗакупкиСтоимостьБезНДСЭталонные) КАК СтоимостьБезНДСОтклонение,
	|		СУММА(АнализируемыеДанные.ЗакупкиНДСТекущие) - СУММА(АнализируемыеДанные.ЗакупкиНДСЭталонные) КАК НДСОтклонение,
	|		СУММА(АнализируемыеДанные.ЗакупкиСтоимостьСНДСТекущие) - СУММА(АнализируемыеДанные.ЗакупкиСтоимостьСНДСЭталонные) КАК СтоимостьСНДСОтклонение
	|	ИЗ
	|		(ВЫБРАТЬ
	|			ЗакупкиОборотыТекущие.Проект КАК Проект,
	|			ЗакупкиОборотыТекущие.Подразделение КАК Подразделение,
	|			ЗакупкиОборотыТекущие.Контрагент КАК Контрагент,
	|			ЗакупкиОборотыТекущие.ДоговорКонтрагента КАК Договор,
	|			ЗакупкиОборотыТекущие.ЗаказПоставщику КАК Заказ,
	|			ЗакупкиОборотыТекущие.Номенклатура.НоменклатурнаяГруппа КАК НоменклатурнаяГруппа,
	|			ЗакупкиОборотыТекущие.Номенклатура КАК Номенклатура,
	|			ЗакупкиОборотыТекущие.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	|			ЗакупкиОборотыТекущие.ДокументЗакупки.Ответственный КАК Ответственный,
	|			ЗакупкиОборотыТекущие.Регистратор КАК Регистратор,
	|			ЗакупкиОборотыТекущие.Период КАК Период,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОборотыТекущие.Период, ДЕНЬ) КАК ПериодДень,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОборотыТекущие.Период, НЕДЕЛЯ) КАК ПериодНеделя,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОборотыТекущие.Период, ДЕКАДА) КАК ПериодДекада,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОборотыТекущие.Период, МЕСЯЦ) КАК ПериодМесяц,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОборотыТекущие.Период, КВАРТАЛ) КАК ПериодКвартал,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОборотыТекущие.Период, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОборотыТекущие.Период, ГОД) КАК ПериодГод,
	|			ЗакупкиОборотыТекущие.КоличествоОборот КАК ЗакупкиКоличествоТекущие,
	|			ЗакупкиОборотыТекущие.КоличествоОборот * ЗакупкиОборотыТекущие.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент КАК ЗакупкиКоличествоБазовыхЕдиницТекущие,
	|			ЗакупкиОборотыТекущие.КоличествоОборот * ЗакупкиОборотыТекущие.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент / ЗакупкиОборотыТекущие.Номенклатура.ЕдиницаДляОтчетов.Коэффициент КАК ЗакупкиКоличествоЕдиницОтчетовТекущие,
	|			0 КАК ЗакупкиКоличествоЭталонные,
	|			0 КАК ЗакупкиКоличествоБазовыхЕдиницЭталонные,
	|			0 КАК ЗакупкиКоличествоЕдиницОтчетовЭталонные,
	|			ЗакупкиОборотыТекущие.СтоимостьОборот - ЗакупкиОборотыТекущие.НДСОборот КАК ЗакупкиСтоимостьБезНДСТекущие,
	|			ЗакупкиОборотыТекущие.НДСОборот КАК ЗакупкиНДСТекущие,
	|			ЗакупкиОборотыТекущие.СтоимостьОборот КАК ЗакупкиСтоимостьСНДСТекущие,
	|			0 КАК ЗакупкиСтоимостьБезНДСЭталонные,
	|			0 КАК ЗакупкиНДСЭталонные,
	|			0 КАК ЗакупкиСтоимостьСНДСЭталонные
	|		ИЗ
	|			РегистрНакопления.Закупки.Обороты(&ДатаНач" + Формат(НомерСтроки, "ЧГ=0") + ", &ДатаКон" + Формат(НомерСтроки, "ЧГ=0") + ", Регистратор, {Организация.* КАК Организация, Проект.* КАК Проект, Подразделение.* КАК Подразделение, Контрагент.* КАК Контрагент, ДоговорКонтрагента.* КАК Договор, ЗаказПоставщику.* КАК Заказ, ДокументЗакупки.* КАК ДокументЗакупки, Номенклатура.НоменклатурнаяГруппа.* КАК НоменклатурнаяГруппа, Номенклатура.* КАК Номенклатура, ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры, ДокументЗакупки.Ответственный.* КАК Ответственный}) КАК ЗакупкиОборотыТекущие
	|
	|		ОБЪЕДИНИТЬ ВСЕ
	|
	|		ВЫБРАТЬ
	|			ЗакупкиОборотыЭталонные.Проект КАК Проект,
	|			ЗакупкиОборотыЭталонные.Подразделение КАК Подразделение,
	|			ЗакупкиОборотыЭталонные.Контрагент КАК Контрагент,
	|			ЗакупкиОборотыЭталонные.ДоговорКонтрагента КАК Договор,
	|			ЗакупкиОборотыЭталонные.ЗаказПоставщику КАК Заказ,
	|			ЗакупкиОборотыЭталонные.Номенклатура.НоменклатурнаяГруппа КАК НоменклатурнаяГруппа,
	|			ЗакупкиОборотыЭталонные.Номенклатура КАК Номенклатура,
	|			ЗакупкиОборотыЭталонные.ХарактеристикаНоменклатуры КАК ХарактеристикаНоменклатуры,
	|			ЗакупкиОборотыЭталонные.ДокументЗакупки.Ответственный КАК Ответственный,
	|			ЗакупкиОборотыЭталонные.Регистратор КАК Регистратор,
	|			ЗакупкиОборотыЭталонные.Период КАК Период,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОборотыЭталонные.Период, ДЕНЬ) КАК ПериодДень,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОборотыЭталонные.Период, НЕДЕЛЯ) КАК ПериодНеделя,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОборотыЭталонные.Период, ДЕКАДА) КАК ПериодДекада,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОборотыЭталонные.Период, МЕСЯЦ) КАК ПериодМесяц,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОборотыЭталонные.Период, КВАРТАЛ) КАК ПериодКвартал,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОборотыЭталонные.Период, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|			НАЧАЛОПЕРИОДА(ЗакупкиОборотыЭталонные.Период, ГОД) КАК ПериодГод,
	|			0 КАК ЗакупкиКоличествоТекущие,
	|			0 КАК ЗакупкиКоличествоБазовыхЕдиницТекущие,
	|			0 КАК ЗакупкиКоличествоЕдиницОтчетовТекущие,
	|			ЗакупкиОборотыЭталонные.КоличествоОборот КАК ЗакупкиКоличествоЭталонные,
	|			ЗакупкиОборотыЭталонные.КоличествоОборот * ЗакупкиОборотыЭталонные.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент КАК ЗакупкиКоличествоБазовыхЕдиницЭталонные,
	|			ЗакупкиОборотыЭталонные.КоличествоОборот * ЗакупкиОборотыЭталонные.Номенклатура.ЕдиницаХраненияОстатков.Коэффициент / ЗакупкиОборотыЭталонные.Номенклатура.ЕдиницаДляОтчетов.Коэффициент КАК ЗакупкиКоличествоЕдиницОтчетовЭталонные,
	|			0 КАК ЗакупкиСтоимостьБезНДСТекущие,
	|			0 КАК ЗакупкиНДСТекущие,
	|			0 КАК ЗакупкиСтоимостьСНДСТекущие,
	|			ЗакупкиОборотыЭталонные.СтоимостьОборот - ЗакупкиОборотыЭталонные.НДСОборот КАК ЗакупкиСтоимостьБезНДСЭталонные,
	|			ЗакупкиОборотыЭталонные.НДСОборот КАК ЗакупкиНДСЭталонные,
	|			ЗакупкиОборотыЭталонные.СтоимостьОборот КАК ЗакупкиСтоимостьСНДСЭталонные
	|		ИЗ
	|			РегистрНакопления.Закупки.Обороты(&ДатаНач1, &ДатаКон1, Регистратор, {Организация.* КАК Организация, Проект.* КАК Проект, Подразделение.* КАК Подразделение, Контрагент.* КАК Контрагент, ДоговорКонтрагента.* КАК Договор, ЗаказПоставщику.* КАК Заказ, ДокументЗакупки.* КАК ДокументЗакупки, Номенклатура.НоменклатурнаяГруппа.* КАК НоменклатурнаяГруппа, Номенклатура.* КАК Номенклатура, ХарактеристикаНоменклатуры.* КАК ХарактеристикаНоменклатуры, ДокументЗакупки.Ответственный.* КАК Ответственный}) КАК ЗакупкиОборотыЭталонные) КАК АнализируемыеДанные
	|	СГРУППИРОВАТЬ ПО
	|		АнализируемыеДанные.Проект,
	|		АнализируемыеДанные.Подразделение,
	|		АнализируемыеДанные.Контрагент,
	|		АнализируемыеДанные.Договор,
	|		АнализируемыеДанные.Заказ,
	|		АнализируемыеДанные.НоменклатурнаяГруппа,
	|		АнализируемыеДанные.Номенклатура,
	|		АнализируемыеДанные.ХарактеристикаНоменклатуры,
	|		АнализируемыеДанные.Ответственный,
	|		АнализируемыеДанные.Регистратор,
	|		АнализируемыеДанные.Период,
	|		АнализируемыеДанные.ПериодДень,
	|		АнализируемыеДанные.ПериодНеделя,
	|		АнализируемыеДанные.ПериодДекада,
	|		АнализируемыеДанные.ПериодМесяц,
	|		АнализируемыеДанные.ПериодКвартал,
	|		АнализируемыеДанные.ПериодПолугодие,
	|		АнализируемыеДанные.ПериодГод) КАК РезультатАнализа
	|	//СОЕДИНЕНИЯ
	|{ГДЕ
	|	РезультатАнализа.Регистратор КАК Регистратор,
	|	РезультатАнализа.Период КАК Период,
	|	РезультатАнализа.ПериодДень КАК ПериодДень,
	|	РезультатАнализа.ПериодНеделя КАК ПериодНеделя,
	|	РезультатАнализа.ПериодДекада КАК ПериодДекада,
	|	РезультатАнализа.ПериодМесяц КАК ПериодМесяц,
	|	РезультатАнализа.ПериодКвартал КАК ПериодКвартал,
	|	РезультатАнализа.ПериодПолугодие КАК ПериодПолугодие,
	|	РезультатАнализа.ПериодГод КАК ПериодГод,
	|	РезультатАнализа.Количество КАК Количество,
	|	РезультатАнализа.КоличествоБазовыхЕдиниц КАК КоличествоБазовыхЕдиниц,
	|	РезультатАнализа.КоличествоЕдиницОтчетов КАК КоличествоЕдиницОтчетов,
	|	РезультатАнализа.КоличествоОтклонение КАК КоличествоОтклонение,
	|	РезультатАнализа.КоличествоБазовыхЕдиницОтклонение КАК КоличествоБазовыхЕдиницОтклонение,
	|	РезультатАнализа.КоличествоЕдиницОтчетовОтклонение КАК КоличествоЕдиницОтчетовОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.КоличествоОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.Количество = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.Количество - РезультатАнализа.КоличествоОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.КоличествоОтклонение * 100 / РезультатАнализа.Количество - РезультатАнализа.КоличествоОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК КоличествоОтклонениеПроцент,
	|	РезультатАнализа.СтоимостьБезНДС КАК СтоимостьБезНДС,
	|	РезультатАнализа.НДС КАК НДС,
	|	РезультатАнализа.СтоимостьСНДС КАК СтоимостьСНДС,
	|	РезультатАнализа.СтоимостьБезНДСОтклонение КАК СтоимостьБезНДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.СтоимостьБезНДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.СтоимостьБезНДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.СтоимостьБезНДС - РезультатАнализа.СтоимостьБезНДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.СтоимостьБезНДСОтклонение * 100 / РезультатАнализа.СтоимостьБезНДС - РезультатАнализа.СтоимостьБезНДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК СтоимостьБезНДСОтклонениеПроцент,
	|	РезультатАнализа.НДСОтклонение КАК НДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.НДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.НДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.НДС - РезультатАнализа.НДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.НДСОтклонение * 100 / РезультатАнализа.НДС - РезультатАнализа.НДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК НДСОтклонениеПроцент,
	|	РезультатАнализа.СтоимостьСНДСОтклонение КАК СтоимостьСНДСОтклонение,
	|	ВЫБОР
	|		КОГДА РезультатАнализа.СтоимостьСНДСОтклонение = 0
	|			ТОГДА 0
	|		ИНАЧЕ ВЫБОР
	|				КОГДА РезультатАнализа.СтоимостьСНДС = 0
	|					ТОГДА -100
	|				ИНАЧЕ ВЫБОР
	|						КОГДА РезультатАнализа.СтоимостьСНДС - РезультатАнализа.СтоимостьСНДСОтклонение = 0
	|							ТОГДА ""-""
	|						ИНАЧЕ РезультатАнализа.СтоимостьСНДСОтклонение * 100 / РезультатАнализа.СтоимостьСНДС - РезультатАнализа.СтоимостьСНДСОтклонение
	|					КОНЕЦ
	|			КОНЕЦ
	|	КОНЕЦ КАК СтоимостьСНДСОтклонениеПроцент
	|	//УСЛОВИЯ_СВОЙСТВА
	|	//УСЛОВИЯ_КАТЕГОРИИ
	|}";
	
КонецПроцедуры // ДобавитьФакт_Факт()

Функция ПолучитьПредставлениеДанных(Данные)
	
	Результат = Формат(Данные.НомерСтроки, "ЧГ=0") + ". ";
	
	Если Данные.НомерСтроки = 1 Тогда
		
		Результат = Результат + "Эталонный период.";
		
	Иначе
		
		Результат = Результат + "Сравниваемый период.";
		
	КонецЕсли;
	
	Результат = Результат + Символы.ПС + Данные.ТипДанных + ". " + Символы.ПС;
	
	Если НЕ Данные.Сценарий.Пустая() Тогда
		
		Результат = Результат + Строка(Данные.Сценарий) + Символы.ПС;
		
	КонецЕсли;
	
	Если Данные.ДатаНач = Дата('00010101') И Данные.ДатаКон = Дата('00010101') Тогда
		
		Если УниверсальныйОтчет.ДатаНач = Дата('00010101') И УниверсальныйОтчет.ДатаКон = Дата('00010101') Тогда
			
			Результат = Результат + "Без ограничения периода.";
			
		Иначе
			
			Результат = Результат + "С " + Формат(УниверсальныйОтчет.ДатаНач, "ДЛФ=Д; ДП = ""...""") + " по " + Формат(УниверсальныйОтчет.ДатаКон, "ДЛФ=Д; ДП = ""...""");
			
		КонецЕсли;
		
	Иначе
		
		Результат = Результат + "С " + Формат(Данные.ДатаНач, "ДЛФ=Д; ДП = ""...""") + " по " + Формат(Данные.ДатаКон, "ДЛФ=Д; ДП = ""...""");
		
	КонецЕсли;
	
	Возврат Результат;
	
КонецФункции // ПолучитьПредставлениеДанных()

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ ФОРМИРОВАНИЯ ОТЧЕТА 
	
// Процедура формирования отчета
//
Процедура СформироватьОтчет(ТабличныйДокумент) Экспорт
	
	Перем ТекущиеНастройкиОтчета;
	
	СформироватьСтруктуруДляСохраненияНастроек(ТекущиеНастройкиОтчета);
	УстановитьНачальныеНастройки();
	ВосстановитьНастройкиИзСтруктуры(ТекущиеНастройкиОтчета);
	
	УниверсальныйОтчет.ПостроительОтчета.Параметры.Вставить("СправочникНоменклатураПустаяСсылка", Справочники.Номенклатура.ПустаяСсылка());
	
	Для каждого Данные из ДанныеОтчета Цикл
		
		УниверсальныйОтчет.ПостроительОтчета.Параметры.Вставить("ТипДанных" + Формат(Данные.НомерСтроки, "ЧГ=0"), ПолучитьПредставлениеДанных(Данные));
		УниверсальныйОтчет.ПостроительОтчета.Параметры.Вставить("Сценарий" + Формат(Данные.НомерСтроки, "ЧГ=0"), ?(Данные.Сценарий.Пустая(), Неопределено, Данные.Сценарий));
		
		Если Данные.ДатаНач = Дата('00010101') И Данные.ДатаКон = Дата('00010101') Тогда
			
			УниверсальныйОтчет.ПостроительОтчета.Параметры.Вставить("ДатаНач" + Формат(Данные.НомерСтроки, "ЧГ=0"), ?(УниверсальныйОтчет.ДатаНач = Дата('00010101'), УниверсальныйОтчет.ДатаНач, Новый Граница(НачалоДня(УниверсальныйОтчет.ДатаНач), ВидГраницы.Включая)));
			УниверсальныйОтчет.ПостроительОтчета.Параметры.Вставить("ДатаКон" + Формат(Данные.НомерСтроки, "ЧГ=0"), ?(УниверсальныйОтчет.ДатаКон = Дата('00010101'), УниверсальныйОтчет.ДатаКон, Новый Граница(КонецДня(УниверсальныйОтчет.ДатаКон), ВидГраницы.Включая)));
			
		Иначе
			
			УниверсальныйОтчет.ПостроительОтчета.Параметры.Вставить("ДатаНач" + Формат(Данные.НомерСтроки, "ЧГ=0"), ?(Данные.ДатаНач = Дата('00010101'), Данные.ДатаНач, Новый Граница(НачалоДня(Данные.ДатаНач), ВидГраницы.Включая)));
			УниверсальныйОтчет.ПостроительОтчета.Параметры.Вставить("ДатаКон" + Формат(Данные.НомерСтроки, "ЧГ=0"), ?(Данные.ДатаКон = Дата('00010101'), Данные.ДатаКон, Новый Граница(КонецДня(Данные.ДатаКон), ВидГраницы.Включая)));
			
		КонецЕсли;
		
	КонецЦикла;
	
	УниверсальныйОтчет.СформироватьОтчет(ТабличныйДокумент,,, ЭтотОбъект);
	
	ОбластьЭталонныйПериод = Неопределено;
	
	Пока Истина Цикл
		
		ОбластьЭталонныйПериод = ТабличныйДокумент.НайтиТекст(ПолучитьПредставлениеДанных(ДанныеОтчета[0]), ОбластьЭталонныйПериод);
		
		Если ОбластьЭталонныйПериод = Неопределено Тогда
			
			Прервать;
			
		Иначе
			
			Для каждого Показатель из УниверсальныйОтчет.Показатели.Строки Цикл
						
				Если (Показатель.Имя = "ОтклонениеКоличества" ИЛИ Показатель.Имя = "ОтклонениеСтоимости") И Показатель.Использование Тогда
							
					Результат = ТабличныйДокумент.НайтиТекст(Показатель.ПредставлениеВОтчете,, ТабличныйДокумент.Область(ОбластьЭталонныйПериод.Верх, ОбластьЭталонныйПериод.Лево, ТабличныйДокумент.ВысотаТаблицы, ТабличныйДокумент.ШиринаТаблицы));
					
					Если Результат <> Неопределено Тогда
						
						Индекс = 0;
						
						Для каждого ТекущийПоказатель из Показатель.Строки Цикл
							
							Если ТекущийПоказатель.Использование Тогда
								
								ТабличныйДокумент.Область(, Результат.Лево + Индекс,, Результат.Лево + Индекс).Видимость = Ложь;
								Индекс = Индекс + 1;
								
							КонецЕсли;
							
						КонецЦикла;
						
					КонецЕсли;
					
				КонецЕсли;
						
			КонецЦикла;
			
		КонецЕсли;
		
	КонецЦикла;
		
КонецПроцедуры // СформироватьОтчет()

Функция ПолучитьТекстСправкиФормы() Экспорт
	
	Возврат "";
	
КонецФункции


////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ ОБЩЕГО НАЗНАЧЕНИЯ

// Процедура обработки расшифровки
//
Процедура ОбработкаРасшифровки(Расшифровка, Объект) Экспорт
	
	// Дополнительные параметры в расшифровывающий отчет можно передать
	// посредством инициализации переменной "ДополнительныеПараметры".
	
	ДополнительныеПараметры = УправлениеОтчетами.СохранитьРеквизитыОтчета(ЭтотОбъект);
	УниверсальныйОтчет.ОбработкаРасшифровкиУниверсальногоОтчета(Расшифровка, Объект, ДополнительныеПараметры);
	
КонецПроцедуры // ОбработкаРасшифровки()

// Формирует структуру для сохранения настроек отчета
//
Процедура СформироватьСтруктуруДляСохраненияНастроек(СтруктураСНастройками) Экспорт
	
	УниверсальныйОтчет.СформироватьСтруктуруДляСохраненияНастроек(СтруктураСНастройками);
	УправлениеОтчетами.СохранитьРеквизитыОтчета(ЭтотОбъект, СтруктураСНастройками);
	
КонецПроцедуры // СформироватьСтруктуруДляСохраненияНастроек()

// Заполняет настройки отчета из структуры сохраненных настроек
//
Функция ВосстановитьНастройкиИзСтруктуры(СтруктураСНастройками) Экспорт
	
	УправлениеОтчетами.ВосстановитьРеквизитыОтчета(ЭтотОбъект, СтруктураСНастройками);
	Возврат УниверсальныйОтчет.ВосстановитьНастройкиИзСтруктуры(СтруктураСНастройками, ЭтотОбъект);
	
КонецФункции // ВосстановитьНастройкиИзСтруктуры()

// Содержит значение используемого режима ввода периода.
// Тип: Число.
// Возможные значения: // (-1) - не выбирать период, 0 - произвольный период, 1 - на дату, 2 - неделя, 3 - декада, 4 - месяц, 5 - квартал, 6 - полугодие, 7 - год
// Значение по умолчанию: 0
// Пример:
// УниверсальныйОтчет.мРежимВводаПериода = 1;

#КонецЕсли