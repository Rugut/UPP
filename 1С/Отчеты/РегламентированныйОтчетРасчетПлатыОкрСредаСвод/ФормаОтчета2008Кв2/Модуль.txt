////////////////////////////////////////////////////////////////////////////////
// ПЕРЕМЕННЫЕ МОДУЛЯ
// Поля табличного документа
Перем мТитульный;
Перем мРасчет;
Перем мРаздел1;
Перем мРаздел2;
Перем мРаздел3;
Перем мРаздел4;
Перем мРаздел5;

// Хранят данные в квадратиках на Разделе 1, сохраняются в структурах

// Хранит структуру многостраничных разделов.
Перем мСтруктураМногостраничныхРазделов Экспорт;

// Хранят структуру многострочных разделов
Перем мСтруктураМногострочныхРазделов Экспорт;

Перем мСтруктураИсхКолвоСтрокРазделов Экспорт;

// Хранит дерево значений - список
// выводимых на печать страниц
Перем мДеревоВыбранныхСтраниц Экспорт;

// Хранит форматн\ую строку представления
// денежных показателей отчета
Перем мСтрокаФормата Экспорт;
            
// Для явной установки типа значения 17, 2 - менять нельзя!
Перем мОписаниеТиповЧислоЕ Экспорт;
Перем мОписаниеТиповБулево;

// Переменная для механизма обхода номеров страниц, при вводе показателей.
Перем мСтруктураВзаимныхПереходов Экспорт;

// Хранит значение делителя при представлении
// чисел в назначенной размерности
Перем мДелитель Экспорт;
// Хранит код отчета по КНД
Перем мКодОтчета;
// Хранит коллекцию цветов раскраски автоматически
// заполняемых ячеек табличного документа
Перем мСтруктураЦветовРаскраски Экспорт;

Перем мКодыБюджетнойКлассификации2005;
Перем мКодыБюджетнойКлассификации2012;
Перем мРасположениеОбъекта;
Перем мДополнительныйКоэф12;
Перем мКЭЗ_Раздел1;
Перем мКЭЗ_ВодныеОбъекты;
Перем мКлассыОпасности;
Перем мЭкологическийКлассРаздел2;
Перем мНормативыПлатыРаздел2;
Перем мВредныеВеществаРаздел1;
Перем мВредныеВеществаРаздел3;
Перем мФКТОРаздел4;
Перем мКоэфИнфляция;
Перем мКЭЗ_Раздел4;
Перем мДопКоэфТЗ;

Перем ТаблицаСообщений Экспорт;

// Инициализируется при открытии формы
// используется в ЗаполнитьСведенияОбОрганизации
Перем мВПрограммеИзмененаОрганизация;

Перем мПечатныеФормы Экспорт;
Перем мПечатаемыеРазделы Экспорт;

Перем мСвойстваРазделовДекларации Экспорт;
Перем мСоставПоказателей Экспорт;

Перем мДокументВосстановлен;

Перем мРежимПечати Экспорт;

Перем мСтруктураПеременных;

Перем мИдГруппы1; // Раздел 1
Перем мИдГруппы2; // Раздел 2
Перем мИдГруппы3; // Раздел 3
Перем мИдГруппы4; // Раздел 4
Перем мИдГруппы5; // Раздел 5

Перем мТекстыСтрок;
Перем мБезОткрытияФормы Экспорт;

// Структура для определения колонок, которые не очищаются при вставки и удаления доп. строк.
Перем мСтруктураНеОчищаемыхКолонок;

////////////////////////////////////
// Стандартные процедуры и функции
////////////////////////////////////

// Очистить
// Процедура очищает содержимое редактируемых и вычисляемых
// ячеек табличного документа.
//
Процедура Очистить() Экспорт

	Если РегламентированнаяОтчетность.роОчистить(ЭтаФорма) Тогда

		РегламентированнаяОтчетность.роОчиститьВариантыЗаполнения(ЭтаФорма);
		РегламентированнаяОтчетность.ОтключитьОбработчикАвтосохранения(ЭтаФорма);
		РегламентированнаяОтчетность.ВключитьОбработчикАвтосохранения(ЭтаФорма);
	КонецЕсли;

КонецПроцедуры // Очистить()

// Формирует дерево значений - структуру страниц отчета,
// содержащей настройки показа страниц, вывода на печать и выгрузки в ИФНС.
//
//
Процедура ФормироватьСтруктуруСвойствСтраниц() Экспорт

	ОписаниеТиповСтрока100 = ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(100);

	ОписаниеТиповСтрока50 = ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(50);

	ОписаниеТиповЧисло1    = ОбщегоНазначения.ПолучитьОписаниеТиповЧисла(1);


	мСвойстваРазделовДекларации           = Новый ДеревоЗначений;

	мСвойстваРазделовДекларации.Колонки.Добавить("ИмяСтраницы",              ОписаниеТиповСтрока100);

	мСвойстваРазделовДекларации.Колонки.Добавить("МногострочностьВРазделе",  ОписаниеТиповЧисло1);
	// 0 - нет
	// 1 - есть одна многострочная часть
	// 2 - и более, точное кол-во число многострочных частей на листе

	// Позволяет записывать многострочность в многостраничных документ либо как ТаблицуЗначений, либо как Структуру
	// В случае, если как Структура, то необходима еще одна процедура СформироватьСтруктуруДанныхДопСтрокСтраницы
	// Только для Многостраничных документов !
	мСвойстваРазделовДекларации.Колонки.Добавить("СохранятьМногострКакТЗ",  мОписаниеТиповБулево);

	мСвойстваРазделовДекларации.Колонки.Добавить("МногостраничностьВРазделе",  мОписаниеТиповБулево);
	// Ложь   - нет
	// Истина - да

	// 3. Будет ли очищаться раздел по кнопки "Очистить"
	// Название параметра
	мСвойстваРазделовДекларации.Колонки.Добавить("ОчищатьРаздел",  мОписаниеТиповБулево);
	// Ложь   - нет
	// Истина - да

	// 4. Если раздел многостраничный, параметр МногостраничностьВРазделе = Истина, тогда имя поля, по которому
	// будет осуществляться Представление доп. страницы
	// Название параметра
	мСвойстваРазделовДекларации.Колонки.Добавить("ИмяПредставления",  ОписаниеТиповСтрока50);

	// 5. Есть ли в разделе значения, отображаемые в квадратном представлении
	// Название параметра
	мСвойстваРазделовДекларации.Колонки.Добавить("ПредставлениеДанных",  мОписаниеТиповБулево);

	// 6. Обязательный раздел для выгрузки или нет
	// Название параметра
	мСвойстваРазделовДекларации.Колонки.Добавить("РазделОбязателеньДляВыгрузки",  мОписаниеТиповБулево);
	// Ложь   - нет
	// Истина - да

	// 7. Обязательный раздел для выгрузки или нет
	// Название параметра
	мСвойстваРазделовДекларации.Колонки.Добавить("НазваниеПанелиТабличногоПоляРаздела",  ОписаниеТиповСтрока50);

	мСвойстваРазделовДекларации.Колонки.Добавить("РазделЯвляетсяАвтозаполняемым", мОписаниеТиповБулево);

	мСвойстваРазделовДекларации.Строки.Очистить();

	СтрокаУровня1 = мСвойстваРазделовДекларации.Строки.Добавить();

	// Добавим св-ва Титульного листа
	СтрокаУровня1.ИмяСтраницы                          = "Титульный";
	СтрокаУровня1.МногострочностьВРазделе              = 0;
	СтрокаУровня1.СохранятьМногострКакТЗ               = Неопределено;
	СтрокаУровня1.МногостраничностьВРазделе            = Ложь;
	СтрокаУровня1.ОчищатьРаздел                        = Ложь;
	СтрокаУровня1.ИмяПредставления                     = "";
	СтрокаУровня1.ПредставлениеДанных                  = Ложь;
	СтрокаУровня1.РазделОбязателеньДляВыгрузки         = Неопределено;
	СтрокаУровня1.НазваниеПанелиТабличногоПоляРаздела  = "ОсновнаяПанель";
	СтрокаУровня1.РазделЯвляетсяАвтозаполняемым        = Ложь;

	СтрокаУровня1 = мСвойстваРазделовДекларации.Строки.Добавить();

	// Добавим св-ва Расчет
	СтрокаУровня1.ИмяСтраницы                          = "Расчет";
	СтрокаУровня1.МногострочностьВРазделе              = 0;
	СтрокаУровня1.СохранятьМногострКакТЗ               = Неопределено;
	СтрокаУровня1.МногостраничностьВРазделе            = Истина;
	СтрокаУровня1.ОчищатьРаздел                        = Истина;
	СтрокаУровня1.ИмяПредставления                     = "ОКАТОРасчет";
	СтрокаУровня1.ПредставлениеДанных                  = Истина;
	СтрокаУровня1.РазделОбязателеньДляВыгрузки         = Неопределено;
	СтрокаУровня1.НазваниеПанелиТабличногоПоляРаздела  = "ОсновнаяПанель";
	СтрокаУровня1.РазделЯвляетсяАвтозаполняемым        = Ложь;

	СтрокаУровня1 = мСвойстваРазделовДекларации.Строки.Добавить();

	// Добавим св-ва Раздела1
	СтрокаУровня1.ИмяСтраницы                          = "Раздел1";
	СтрокаУровня1.МногострочностьВРазделе              = 1;
	СтрокаУровня1.СохранятьМногострКакТЗ               = Истина;
	СтрокаУровня1.МногостраничностьВРазделе            = Истина;
	СтрокаУровня1.ОчищатьРаздел                        = Истина;
	СтрокаУровня1.ИмяПредставления                     = "_нет";
	СтрокаУровня1.ПредставлениеДанных                  = Ложь;
	СтрокаУровня1.РазделОбязателеньДляВыгрузки         = Неопределено;
	СтрокаУровня1.НазваниеПанелиТабличногоПоляРаздела  = "ОсновнаяПанель";
	СтрокаУровня1.РазделЯвляетсяАвтозаполняемым        = Ложь;

	СтрокаУровня1 = мСвойстваРазделовДекларации.Строки.Добавить();

	// Добавим св-ва Раздела2
	СтрокаУровня1.ИмяСтраницы                          = "Раздел2";
	СтрокаУровня1.МногострочностьВРазделе              = 1;
	СтрокаУровня1.СохранятьМногострКакТЗ               = Истина;
	СтрокаУровня1.МногостраничностьВРазделе            = Истина;
	СтрокаУровня1.ОчищатьРаздел                        = Истина;
	СтрокаУровня1.ИмяПредставления                     = "_нет";
	СтрокаУровня1.ПредставлениеДанных                  = Ложь;
	СтрокаУровня1.РазделОбязателеньДляВыгрузки         = Неопределено;
	СтрокаУровня1.НазваниеПанелиТабличногоПоляРаздела  = "ОсновнаяПанель";
	СтрокаУровня1.РазделЯвляетсяАвтозаполняемым        = Ложь;

	СтрокаУровня1 = мСвойстваРазделовДекларации.Строки.Добавить();

	// Добавим св-ва Раздела3
	СтрокаУровня1.ИмяСтраницы                          = "Раздел3";
	СтрокаУровня1.МногострочностьВРазделе              = 1;
	СтрокаУровня1.СохранятьМногострКакТЗ               = Истина;
	СтрокаУровня1.МногостраничностьВРазделе            = Истина;
	СтрокаУровня1.ОчищатьРаздел                        = Истина;
	СтрокаУровня1.ИмяПредставления                     = "_нет";
	СтрокаУровня1.ПредставлениеДанных                  = Ложь;
	СтрокаУровня1.РазделОбязателеньДляВыгрузки         = Неопределено;
	СтрокаУровня1.НазваниеПанелиТабличногоПоляРаздела  = "ОсновнаяПанель";
	СтрокаУровня1.РазделЯвляетсяАвтозаполняемым        = Ложь;

	СтрокаУровня1 = мСвойстваРазделовДекларации.Строки.Добавить();

	// Добавим св-ва Раздела4
	СтрокаУровня1.ИмяСтраницы                          = "Раздел4";
	СтрокаУровня1.МногострочностьВРазделе              = 1;
	СтрокаУровня1.СохранятьМногострКакТЗ               = Истина;
	СтрокаУровня1.МногостраничностьВРазделе            = Истина;
	СтрокаУровня1.ОчищатьРаздел                        = Истина;
	СтрокаУровня1.ИмяПредставления                     = "П000040000002";
	СтрокаУровня1.ПредставлениеДанных                  = Ложь;
	СтрокаУровня1.РазделОбязателеньДляВыгрузки         = Неопределено;
	СтрокаУровня1.НазваниеПанелиТабличногоПоляРаздела  = "ОсновнаяПанель";
	СтрокаУровня1.РазделЯвляетсяАвтозаполняемым        = Ложь;

	СтрокаУровня1 = мСвойстваРазделовДекларации.Строки.Добавить();

	// Добавим св-ва Раздела5
	СтрокаУровня1.ИмяСтраницы                          = "Раздел5";
	СтрокаУровня1.МногострочностьВРазделе              = 1;
	СтрокаУровня1.СохранятьМногострКакТЗ               = Истина;
	СтрокаУровня1.МногостраничностьВРазделе            = Истина;
	СтрокаУровня1.ОчищатьРаздел                        = Истина;
	СтрокаУровня1.ИмяПредставления                     = "";
	СтрокаУровня1.ПредставлениеДанных                  = Ложь;
	СтрокаУровня1.РазделОбязателеньДляВыгрузки         = Неопределено;
	СтрокаУровня1.НазваниеПанелиТабличногоПоляРаздела  = "ОсновнаяПанель";
	СтрокаУровня1.РазделЯвляетсяАвтозаполняемым        = Ложь;

КонецПроцедуры // ФормироватьСтруктуруСтраницОтчета()

// ОбнулитьПеременныеМодуляХранящиеЗначенияКвадратногоПредставления
// Процедура обнуляем переменные модуля, используемые для отображения в квадратиках
// в разделе 1
// запускается при добавлении новой страницы, а также при инициализации формы
//
Процедура ОбнулитьПеременныеМодуляХранящиеЗначенияКвадратногоПредставленияПоРазделу(Знач ИмяРаздела) Экспорт

	ИмяСтраницы = СтрЗаменить(ИмяРаздела, "ПолеТабличногоДокумента", "");

	Если ИмяСтраницы = "Расчет" Тогда

		// Вставим КБК
		мСтруктураПеременных.Вставить("КБКРасчет", "");

		// Вставим коды ОКАТО
		мСтруктураПеременных.Вставить("ОКАТОРасчет", "");

		// Строки 030.
		Для Инд = 1 По 9 Цикл
			мСтруктураПеременных.Вставить("СуммаСтрока3" + Строка(Инд), 0);
		КонецЦикла;

		мСтруктураПеременных.Вставить("СуммаБезЛьготРасчет", 0);

		мСтруктураПеременных.Вставить("СуммаЗачетРасчет", 0);

		мСтруктураПеременных.Вставить("СуммаЛьготОргСоцРасчет", 0);

		мСтруктураПеременных.Вставить("СуммаЛьготОргРасчет", 0);

		мСтруктураПеременных.Вставить("СуммаПлатРасчет", 0);

	КонецЕсли;

КонецПроцедуры // ОбнулитьПеременныеМодуляХранящиеЗначенияКвадратногоПредставления

// Окончание блока обязательных функций

// Функция определяет поле табличного документа формы, содержащее 
// многострочный раздел.по имени ИдГруппы.
//
// Параметры:
//  ИдГруппы - строка, имя многострочного раздела.
//
// Возвращаемое значение:
//  Поле табличного документа.
//
Функция ОпределитьТабличноеПолеПоИдМногострочногоРаздела(ИдГруппы) Экспорт
	Перем ТекТабличноеПоле;
	
	Если ИдГруппы = мИдГруппы1 Тогда
		ТекТабличноеПоле = мРаздел1;
	ИначеЕсли ИдГруппы = мИдГруппы2 Тогда
		ТекТабличноеПоле = мРаздел2;
	ИначеЕсли ИдГруппы = мИдГруппы3 Тогда
		ТекТабличноеПоле = мРаздел3;
	ИначеЕсли ИдГруппы = мИдГруппы4 Тогда
		ТекТабличноеПоле = мРаздел4;
	ИначеЕсли ИдГруппы = мИдГруппы5 Тогда
		ТекТабличноеПоле = мРаздел5;
	КонецЕсли;

	Возврат ТекТабличноеПоле;

КонецФункции // ОпределитьТабличноеПолеПоИдМногострочногоРаздела()

// Обновляет пользовательские настройки по вариантам заполнения
// показателей отчета в случае изменения версии формы отчета.
//
// Возвращаемое значение:
//   Булево - признак модифицированность пользовательских настроек.
//
Функция ОбновитьВариантыЗаполнения()
	Перем МассивВариантовЗаполненияСтраниц;

	ЕстьИзменения = Ложь;

	// Подлежат обновлению следующие структуры:
	// 1.Пользовательские настройки вариантов заполнения таблиц

	// Сначала создадим эталонные модели вариантов автозаполнения таблиц.
	// Их определяем по макету СоставПоказателей
	МакетСоставаПоказателей = ЭтотОбъект.ПолучитьМакет(мСоставПоказателей);

	ОписаниеТиповСтрока15  = ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(15);

	ОписаниеТиповСтрока50  = ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(50);

	ОписаниеТиповСтрока100 = ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(100);

	ОписаниеТиповЧисло1    = ОбщегоНазначения.ПолучитьОписаниеТиповЧисла(1);

	ЕстьИзменения = Ложь;

	Для ПереборныйИнд = 0 По МакетСоставаПоказателей.Области.Количество() - 1 Цикл
		// организован Цикл по именованным областям макета,
		// содержащим состав показателей и варианты автозаполнения
		// таблиц на каждой странице основной панели формы.

		ТекОбласть  = МакетСоставаПоказателей.Области[ПереборныйИнд];
		ИмяСтраницы = ТекОбласть.Имя;

		// Таблица значений содержит информацию о вариантах заполнения показателя отчета.
		// В колонках таблицы значений отображается следующая информация:
		//   - имя ячейки (код показателя);
		//   - вариант заполнения ячейки;
		//   - вычисленное по данным ИБ значение ячейки;
		//   - величина автокорректировки значения ячейки;
		//   - примечание к ячейке.
		//
		ТаблицаВариантыЗаполнения = Новый ТаблицаЗначений;
		ТаблицаВариантыЗаполнения.Колонки.Добавить( "КодПоказателя",     ОписаниеТиповСтрока50  );
		ТаблицаВариантыЗаполнения.Колонки.Добавить( "ВариантЗаполнения", ОписаниеТиповЧисло1    );
		ТаблицаВариантыЗаполнения.Колонки.Добавить( "ЗначениеАвто",      мОписаниеТиповЧислоЕ   );
		ТаблицаВариантыЗаполнения.Колонки.Добавить( "Дельта",            мОписаниеТиповЧислоЕ   );
		ТаблицаВариантыЗаполнения.Колонки.Добавить( "Комментарий",       ОписаниеТиповСтрока100 );
		ТаблицаВариантыЗаполнения.Колонки.Добавить( "КодПоказателяПоСтруктуре",     ОписаниеТиповСтрока50  );

		Для Ном = ТекОбласть.Верх По ТекОбласть.Низ Цикл
			// перебираем строки макета

			// Код показателя (по составу показателей) определяется по первой колонке макета
			КодПоказателя = СокрП(МакетСоставаПоказателей.Область(Ном, 1).Текст);
			ИмяПоказателя = КодПоказателя;

			Если КодПоказателя = "===" Тогда         // признак конечной строки
				Прервать;
			КонецЕсли;

			Если Лев(КодПоказателя, 2) = "//" Тогда  // пропускаем комментарии
				Продолжить;
			КонецЕсли;

			// код показателя по форме отчете (имя ячейки в полях табличного документа формы)
			КодПоказателяПоФорме = СокрЛП(МакетСоставаПоказателей.Область(Ном, 2).Текст);
			// вариант заполнения ячейки определяется по колонке 6 макета
			стрВариантЗаполнения = РегламентированнаяОтчетность.ПолучитьВариантЗаполненияПоказателяРегОтчета(МакетСоставаПоказателей, Ном);

			чВариантЗаполнения   = ? (ПустаяСтрока(стрВариантЗаполнения), 0, Число(стрВариантЗаполнения));
			Если чВариантЗаполнения <> 0 Тогда
				// Если в колонке 6 задан варианет заполнения показателя, 
				// то его значение может определяться по данным ИБ.
				// Дополняем таблицу значений вариантов заполнения
				НоваяСтрока = ТаблицаВариантыЗаполнения.Добавить();
				НоваяСтрока.КодПоказателя      = ? (Не ПустаяСтрока(КодПоказателяПоФорме), КодПоказателяПоФорме, КодПоказателя);
				НоваяСтрока.ВариантЗаполнения  = чВариантЗаполнения;
				НоваяСтрока.КодПоказателяПоСтруктуре  = чВариантЗаполнения;
			КонецЕсли;

		КонецЦикла;

		Если Не мСтруктураВариантыЗаполнения.Свойство(ИмяСтраницы, МассивВариантовЗаполненияСтраниц) Тогда
			Если ТаблицаВариантыЗаполнения.Количество() > 0 Тогда
				// Рассмотрим вариант, когда в предыдущей версии формы по данной странице
				// не было предусмотрено автозаполнение по данным ИБ.
				// Добавим такую возможность в пользовательскую настройку

				// Для обеспечения назначения разных вариантов заполнения одного и того же показателя
				// на разных страницах, создаем массив, хранящий информацию о вариантах заполнения
				// таблиц по каждой странице многостраничного раздела.
				МассивВариантовЗаполненияСтраниц = Новый Массив;
				// Первым элементом массива является "эталонная" таблица значений вариантов заполнения
				МассивВариантовЗаполненияСтраниц.Добавить(ТаблицаВариантыЗаполнения);

				// сохраняем варианты заполнения таблиц на данной странице
				мСтруктураВариантыЗаполнения.Вставить(ИмяСтраницы, МассивВариантовЗаполненияСтраниц);

				ЕстьИзменения = Истина;
			КонецЕсли;
		Иначе
			Если ТаблицаВариантыЗаполнения.Количество() = 0 Тогда
				// Рассмотрим вариант, когда в предыдущей версии формы по данной странице
				// было предусмотрено автозаполнение таблицы, а в текущей версии - отключено.
				// В этом случае из структуры вариантов автозаполнения удаляем элемент,
				// хранящий настройки вариантов автозаполнения текущей станицы.
				мСтруктураВариантыЗаполнения.Удалить(ИмяСтраницы);

				ЕстьИзменения = Истина;
			Иначе
				// Рассмотрим вариант, когда и в предыдущей, и в текущей версии формы было предусмотрено
				// автозаполнение текущей страницы. В этом случае обновляем таблицу значений, содержащей
				// пользовательские настройки вариантов автозаполнения текущей страницы.

				Для каждого ЭлементМассива Из МассивВариантовЗаполненияСтраниц Цикл
					Для каждого СтрокаТаблицы Из ТаблицаВариантыЗаполнения Цикл
						КодПоказателя     = СтрокаТаблицы.КодПоказателя;
						ВариантЗаполнения = СтрокаТаблицы.ВариантЗаполнения;

						Если ЭлементМассива.Найти(КодПоказателя, "КодПоказателя") = Неопределено Тогда
							// Рассмотри вариант, когда в новой версии формы список реквизитов,
							// заполняемых автоматически по данным ИБ, дополнен новым реквизитом.
							НоваяСтрока = ЭлементМассива.Добавить();
							НоваяСтрока.КодПоказателя     = КодПоказателя;
							НоваяСтрока.ВариантЗаполнения = ВариантЗаполнения;

							ЕстьИзменения = Истина;
						КонецЕсли;
					КонецЦикла;

					ТаблДляЦикла = ЭлементМассива.Скопировать();
					//Для каждого СтрокаТаблицы Из ЭлементМассива Цикл
					Для каждого СтрокаТаблицы Из ТаблДляЦикла Цикл
						КодПоказателя = СтрокаТаблицы.КодПоказателя;

						Если ТаблицаВариантыЗаполнения.Найти(КодПоказателя, "КодПоказателя") = Неопределено Тогда
							// Рассмотрим вариант, когда в предыдущей версии отчета для данной страницы
							// было предусмотрено автозаполнение ячейки по коду КодПоказателя,
							// а в текущей версии - отключено. В этом случае удаляем эту ячейку
							// из таблицы пользовательских настроек вариантов автозаполнения.
							СтрокаВЭлементеМассива = ЭлементМассива.Найти(КодПоказателя, "КодПоказателя");
							Если  СтрокаВЭлементеМассива <> Неопределено Тогда
								ЭлементМассива.Удалить(СтрокаВЭлементеМассива);
								ЕстьИзменения = Истина;
							КонецЕсли;
						КонецЕсли;
					КонецЦикла;
				КонецЦикла;
			КонецЕсли;
		КонецЕсли;

	КонецЦикла;

	Возврат ЕстьИзменения;

КонецФункции // ОбновитьВариантыЗаполнения()

// Обновляет пользовательские настройки страниц отчета
// в случае изменения версии формы отчета.
//
// Возвращаемое значение:
//   Булево - признак модифицированность пользовательских настроек.
//
Функция ОбновитьНастройкиСтраниц()

	ЕстьИзменения = Ложь;

	// формируем дерево значений - пользовательских настройки страниц отчета
	мПользовательскиеНастройкиСтраниц = мДеревоСтраницОтчета.Скопировать();
                                     
	// формируем дерево значений - настройки страниц отчета обновленной формы
	ФормироватьСтруктуруСтраницОтчета();

	// Сначала проверяем, не изменилась ли структура настроек страниц (колонки дерева)
	Для каждого ИсхКолонка Из мДеревоСтраницОтчета.Колонки Цикл

		Если мПользовательскиеНастройкиСтраниц.Колонки.Найти(ИсхКолонка.Имя) = Неопределено Тогда
			// добавиляем новую колонку
			мПользовательскиеНастройкиСтраниц.Колонки.Добавить(ИсхКолонка.Имя, ИсхКолонка.ТипЗначения, ИсхКолонка.Заголовок, ИсхКолонка.Ширина);
			мПользовательскиеНастройкиСтраниц.ЗагрузитьКолонку(мДеревоСтраницОтчета.ВыгрузитьКолонку(ИсхКолонка.Имя), ИсхКолонка.Имя);

			ЕстьИзменения = Истина;
		КонецЕсли;

	КонецЦикла;

	// Выполняем обратную задачу:
	// удаляем отсутствующие колонки
	Для каждого ТекКолонка Из мПользовательскиеНастройкиСтраниц.Колонки Цикл

		Если мДеревоСтраницОтчета.Колонки.Найти(ТекКолонка.Имя) = Неопределено Тогда
			// удаляем отсутствующую колонку
			мПользовательскиеНастройкиСтраниц.Колонки.Удалить(мПользовательскиеНастройкиСтраниц.Колонки.Индекс(ТекКолонка));

			ЕстьИзменения = Истина;
		КонецЕсли;

	КонецЦикла;

	// Обновляем строки дерева значений - пользовательских настроек:
	//
	// добавляем новые строки и удаляем лишние:
	Если мДеревоСтраницОтчета.Строки.Количество() <> мПользовательскиеНастройкиСтраниц.Строки.Количество() Тогда

		КолвоКолонок     = мДеревоСтраницОтчета.Колонки.Количество();

		// добавляем новые строки
		Для каждого Строка Из мДеревоСтраницОтчета Цикл

			Если мПользовательскиеНастройкиСтраниц.Найти(Строка.ИмяСтраницы, "ИмяСтраницы") = Неопределено Тогда

				НоваяСтрока = мПользовательскиеНастройкиСтраниц.Строки.Добавить();
				Для НомКолонки = 0 По (КолвоКолонок - 1) Цикл
				
					НоваяСтрока[НомКолонки] = Строка[НомКолонки];
				
				КонецЦикла;

			КонецЕсли;

			// обновляем строки второго уровня
			Если Строка.Строки.Количество() > 0 Тогда

				Для каждого Строка2 Из Строка.Строки Цикл

					Если мПользовательскиеНастройкиСтраниц.Найти(Строка2.ИмяСтраницы, "ИмяСтраницы") = Неопределено Тогда

						НоваяСтрока2 = НоваяСтрока.Строки.Добавить();
						Для НомКолонки = 0 По (КолвоКолонок - 1) Цикл

							НоваяСтрока2[НомКолонки] = Строка2[НомКолонки];

						КонецЦикла;

					КонецЕсли;

				КонецЦикла; 

			КонецЕсли; 

		КонецЦикла;

		// удаляем лишние строки
		Для каждого Строка Из мПользовательскиеНастройкиСтраниц Цикл

			Если мДеревоСтраницОтчета.Найти(Строка.ИмяСтраницы, "ИмяСтраницы") = Неопределено Тогда

				мПользовательскиеНастройкиСтраниц.Строки.Удалить(мПользовательскиеНастройкиСтраниц.Строки.Индекс(Строка));

			КонецЕсли;

		КонецЦикла;

		ЕстьИзменения = Истина;
	КонецЕсли;

	Для каждого ТекСтрока Из мДеревоСтраницОтчета.Строки Цикл

		НомСтр = мДеревоСтраницОтчета.Строки.Индекс(ТекСтрока);

		// устанавливаем признаки предопределенных установок выгружаемых страниц (значение флажка = 2);
		Если ТекСтрока.ВыгрузитьСтраницу = 2 Тогда
			
			Если мПользовательскиеНастройкиСтраниц.Строки[НомСтр].ВыгрузитьСтраницу <> 2 Тогда
				мПользовательскиеНастройкиСтраниц.Строки[НомСтр].ВыгрузитьСтраницу = 2;
				ЕстьИзменения = Истина;
			КонецЕсли;

		КонецЕсли;

		// обновляем представление
		Если ТекСтрока.Представление <> мПользовательскиеНастройкиСтраниц.Строки[НомСтр].Представление Тогда
			мПользовательскиеНастройкиСтраниц.Строки[НомСтр].Представление = ТекСтрока.Представление;
			ЕстьИзменения = Истина;
		КонецЕсли;

		// обновляем имя поля табличного документа
		Если ТекСтрока.ИмяПоляТабличногоДокум <> мПользовательскиеНастройкиСтраниц.Строки[НомСтр].ИмяПоляТабличногоДокум Тогда
			мПользовательскиеНастройкиСтраниц.Строки[НомСтр].ИмяПоляТабличногоДокум = ТекСтрока.ИмяПоляТабличногоДокум;
			ЕстьИзменения = Истина;
		КонецЕсли;

	КонецЦикла; 

	мДеревоСтраницОтчета =  мПользовательскиеНастройкиСтраниц.Скопировать();

	Возврат ЕстьИзменения;

КонецФункции // ОбновитьНастройкиСтраниц()

// Процедура управляет цветом фона автозаполняемых ячеек при:
//  а) автозаполнении;
//  б) ручном выборе другого варианта заполнения;
//  в) добавлении/удалении и листании дополнительных страниц.
//
// Цвет фона устанавливается в зависимости от варианта заполнения ячейки.
//
// Параметры:
//  ИмяЯчейки                - строка, имя ячейки, для которой устанавливаем цвет фона;
//  ВариантЗаполнения        - число,  вариант заполнения ячейки;
//  ИмяТекущейСтраницыПанели - строка, имя страницы основной панели, на которой для всех автозаполняемых
//                             ячеек табличного документа следует установить цвет фона.
//
Процедура УстановитьЦветФонаЯчейки(ИмяЯчейки = Неопределено, ВариантЗаполнения = Неопределено, ИмяТекущейСтраницыПанели = "") Экспорт
	РегламентированнаяОтчетность.роУстановитьЦветФонаЯчейки(ЭтаФорма, ИмяЯчейки, ВариантЗаполнения, ИмяТекущейСтраницыПанели);
КонецПроцедуры // УстановитьЦветФонаЯчейки()

// ОбновитьПеременныеМодуля
// Обновляет переменные модуля из переменных структур
// Вызывается при показе и листании доп. страниц
//
Функция ОбновитьПеременныеМодуля(ИмяПоказателя, ЗначениеПоказателя) Экспорт

	ИзмененияПроизошли = Ложь;

	Если Лев(ИмяПоказателя, 1) = "_" Тогда
		ИзмененияПроизошли = Истина;
		Возврат ИзмененияПроизошли;
	КонецЕсли;

	Если (ИмяПоказателя = "СуммаБезЛьготРасчет")
	 Или (ИмяПоказателя = "СуммаСтрока31")
	 Или (ИмяПоказателя = "СуммаСтрока32")
	 Или (ИмяПоказателя = "СуммаСтрока33")
	 Или (ИмяПоказателя = "СуммаСтрока34")
	 Или (ИмяПоказателя = "СуммаСтрока35")
	 Или (ИмяПоказателя = "СуммаСтрока36")
	 Или (ИмяПоказателя = "СуммаСтрока37")
	 Или (ИмяПоказателя = "СуммаСтрока38")
	 Или (ИмяПоказателя = "СуммаСтрока39")
	 Или (ИмяПоказателя = "СуммаЗачетРасчет")
	 Или (ИмяПоказателя = "СуммаЛьготОргСоцРасчет")
	 Или (ИмяПоказателя = "СуммаЛьготОргРасчет")
	 Или (ИмяПоказателя = "СуммаПлатРасчет") Тогда
		мСтруктураПеременных.Вставить(ИмяПоказателя, ЗначениеПоказателя);
		ИзмененияПроизошли = Истина;
	ИначеЕсли ИмяПоказателя = "КБКРасчет" Тогда
		мСтруктураПеременных.Вставить(ИмяПоказателя, ЗначениеПоказателя);
		ИзмененияПроизошли = Истина;
	ИначеЕсли ИмяПоказателя = "ОКАТОРасчет" Тогда
		мСтруктураПеременных.Вставить(ИмяПоказателя, ЗначениеПоказателя);
		ИзмененияПроизошли = Истина;
	//ИначеЕсли ИмяПоказателя = "РегНомРасчет" Тогда
	//	мСтруктураПеременных.Вставить(ИмяПоказателя, ЗначениеПоказателя);
	//	ИзмененияПроизошли = Истина;
	//ИначеЕсли ИмяПоказателя = "КолвоОбъектовРасчет" Тогда
	//	мСтруктураПеременных.Вставить(ИмяПоказателя, ЗначениеПоказателя);
	//	ИзмененияПроизошли = Истина;
	КонецЕсли;

	Возврат ИзмененияПроизошли;

КонецФункции // ОбновитьПеременныеМодуля

// Обновляет структуру многострочных разделов.
// Заполняет таблицу значений многострочного раздела
// значениями соответствующих ячеек.
//
Процедура ОбновитьСтруктуруМногострочныхРазделов()
	// Заполняет таблицу значений многострочного раздела
	// указанными в соответствующих ячейках значениями

	// Заполнение выполняется синхронно для всех многострочных разделов
	Для Каждого ЭлементСтруктуры Из мСтруктураМногострочныхРазделов Цикл
		ИмяГруппы = ЭлементСтруктуры.Ключ;

		ОбновитьСтруктуруМногострочногоРаздела(ИмяГруппы);
	КонецЦикла;

КонецПроцедуры // ОбновитьСтруктуруМногострочныхРазделов()

// Процедура управляет показом в форме периода построения отчета,
//
Процедура ПоказатьПериод()

	НомерМесяца   = Формат(мДатаКонцаПериодаОтчета, "ДФ=М");
	Если НомерМесяца = "12" Тогда
		НомерМесяца = "0";
	КонецЕсли;

	НомерКвартала = Формат(мДатаКонцаПериодаОтчета, "ДФ=к");
	НомерГода     = Формат(мДатаКонцаПериодаОтчета, "ДФ=гггг");

	мТитульный.Области.ГодОтчета.Значение   = НомерГода;
	мТитульный.Области.НомерКвартала.Значение   = НомерКвартала;

	СтрПериодОтчета = ПредставлениеПериода( НачалоДня(мДатаНачалаПериодаОтчета), КонецДня(мДатаКонцаПериодаОтчета), "ФП = Истина" );

	// Период в заголовке отчета
	Заголовок = СтрЗаменить(ЭтотОбъект.Метаданные().Формы.ОсновнаяФорма.Представление(), " (сводная форма)", "") + " (за " + СтрПериодОтчета + ")";

КонецПроцедуры // ПоказатьПериод()

// Заполняет дату подписания отчета должностными лицами, в зависимости от
// наличия данных по этим лицам.
//
Процедура ЗаполнитьДатуВЯчейках() Экспорт

	ДатаПодписиРук     = "";
	ДатаПодписиБух     = "";
	ДатаПодписиИП      = "";

	ДатаПодписиРукОбособ     = "";
	ДатаПодписиБухОбособ     = "";

	Если НЕ ПустаяСтрока(мТитульный.Области.ОргДиректор.Значение) Тогда
		ДатаПодписиРук = ДатаПодписи;
	КонецЕсли;

	Если НЕ ПустаяСтрока(мТитульный.Области.ОргБухгалтер.Значение) Тогда
		ДатаПодписиБух = ДатаПодписи;
	КонецЕсли;

	Если НЕ ПустаяСтрока(мТитульный.Области.ОргДиректорОбособ.Значение) Тогда
		ДатаПодписиРукОбособ = ДатаПодписи;
	КонецЕсли;

	Если НЕ ПустаяСтрока(мТитульный.Области.ОргБухгалтерОбособ.Значение) Тогда
		ДатаПодписиБухОбособ = ДатаПодписи;
	КонецЕсли;

	ЧП = РегламентированнаяОтчетность.ЭтоПБОЮЛ(Организация);

	Для НомЯчейки = 1 По 8 Цикл

		Если НЕ ЧП Тогда
			//Если НЕ ((НомЯчейки = 5) Или (НомЯчейки = 6)) Тогда
				мТитульный.Области["ДатаПодписиРук" + НомЯчейки].Значение = Сред(Формат(ДатаПодписиРук, "ДФ = 'ддММгггг'"), НомЯчейки, 1);
				мТитульный.Области["ДатаПодписиБух" + НомЯчейки].Значение = Сред(Формат(ДатаПодписиБух, "ДФ = 'ддММгггг'"), НомЯчейки, 1);
				мТитульный.Области["ДатаПодписиРукОбособ" + НомЯчейки].Значение = Сред(Формат(ДатаПодписиРукОбособ, "ДФ = 'ддММгггг'"), НомЯчейки, 1);
				мТитульный.Области["ДатаПодписиБухОбособ" + НомЯчейки].Значение = Сред(Формат(ДатаПодписиБухОбособ, "ДФ = 'ддММгггг'"), НомЯчейки, 1);
			//КонецЕсли;

		Иначе             

			//Если НЕ ((НомЯчейки = 5) Или (НомЯчейки = 6)) Тогда
				мТитульный.Области["ДатаПодписиРук" + НомЯчейки].Значение = "";
				мТитульный.Области["ДатаПодписиБух" + НомЯчейки].Значение = "";
				мТитульный.Области["ДатаПодписиРукОбособ" + НомЯчейки].Значение = "";
				мТитульный.Области["ДатаПодписиБухОбособ" + НомЯчейки].Значение = "";
			//КонецЕсли;
		КонецЕсли;
	КонецЦикла;

	РегламентированнаяОтчетность.роПроставитьНаВсехЛистах(ЭтаФорма, Формат(ДатаПодписи, "ДФ = 'ддММгггг'"), "Дата",, "Расчет",, Ложь);
	//в новой версии нет даты подписи
	//ДатаДляРазделов = Формат(ДатаПодписи, "ДФ=дд.ММ.гггг");

	//Для каждого Стр Из мСтруктураМногостраничныхРазделов Цикл
	//	Если Стр.Ключ = "Расчет" Тогда
	//		Продолжить;
	//	КонецЕсли;
	//	ЭлементыФормы["ПолеТабличногоДокумента" + Стр.Ключ].Области.ДатаПодписанияОтчета.Значение = ДатаДляРазделов;
	//	Если Стр.Значение.Количество() > 1 Тогда
	//		Для каждого Лист Из Стр.Значение Цикл
	//			Если Лист.АктивнаяСтраница Тогда
	//				Продолжить;
	//			КонецЕсли;
	//			Лист.Данные.Вставить("ДатаПодписанияОтчета", ДатаДляРазделов);
	//		КонецЦикла;
	//	КонецЕсли;
	//КонецЦикла;

КонецПроцедуры // ЗаполнитьДатуВЯчейках()

// Процедура управляет выводом сведений о выбранной организации
// в соответствующие ячейки табличного документа.
//
// Параметры:
// ВПрограммеИзмененаДатаПодписи - Истина, если процедура запускается для обновления параметров завясящих
// от даты подписания документа, например ФИО должностных лиц
//
Процедура ЗаполнитьСведенияОбОрганизации(ВПрограммеИзмененаДатаПодписи = Ложь)
	
	// Составляем список данных, необходимых для вывода в декларацию
	Сведения = "";
	
	Если НЕ ВПрограммеИзмененаДатаПодписи Тогда
		Сведения = "НаимЮЛПол, ТелОрганизации, ОКАТО, АдрЮР, ";
	КонецЕсли;
	
	Сведения = Сведения + "ФИОРук, ФИОБух, ТипНП";
	
	Результат = РегламентированнаяОтчетность.роЗаполнитьСведенияОбОрганизации(ЭтаФорма, Сведения);
	
	// Отдельно запросим ИНН и КПП организации, чтобы проставить на тит. лист без процедуры роЗаполнитьСведения- оптимизация.
	
	ИННКПП = РегламентированнаяОтчетность.ПолучитьСведенияОбОрганизации(Организация, ДатаПодписи, "ИННЮЛ, КППЮЛ");
	Если НЕ РегламентированнаяОтчетность.ПустоеЗначение(ИННКПП.ИННЮЛ) Тогда
		ИННЮЛ = РегламентированнаяОтчетность.ДополнитьСтроку(ИННКПП.ИННЮЛ, 12, "0");
	Иначе
		ИННЮЛ = РегламентированнаяОтчетность.ДополнитьСтроку(ИННКПП.ИННЮЛ, 12, " ");
	КонецЕсли;
	
	КППЮЛ = РегламентированнаяОтчетность.ДополнитьСтроку(ИННКПП.КППЮЛ, 9, " ");
	
	РегламентированнаяОтчетность.роПроставитьВКвадратыЗначения(ЭтаФорма, "Титульный", "ИНН1_", 12, ИННЮЛ);
	РегламентированнаяОтчетность.роПроставитьВКвадратыЗначения(ЭтаФорма, "Титульный", "КПП1_", 9, КППЮЛ);
	
	// Окончание
	
	Если (НЕ ВПрограммеИзмененаДатаПодписи) И (Результат <> Неопределено) Тогда
		
		// Код окато заполняем только при открытии декларации, через кнопку Обновить
		// код окато не заполняется, т.к. лист раздела 1 многостраничный.
		
		Если (НЕ мВПрограммеИзмененаОрганизация) И (НЕ мДокументВосстановлен) Тогда
			// Не будем ОКАТО заполнять. т.к. раздел многостраничный.
			//мСтруктураПеременных.Вставить("ОКАТОРасчет", Результат.ОКАТО);
			//роПроставитьВКвадратыЗначения(ЭтаФорма, "Расчет", "ОКАТО1_", 11, Результат.ОКАТО);
			Если ДатаПодписи >= '20120101' Тогда
				КБК = ""; // с 2012 года невозможно определить КБК при автозаполнении
			Иначе
				КБК = "04811201000010000120";
			КонецЕсли;
			мСтруктураПеременных.Вставить("КБКРасчет", КБК);
			РегламентированнаяОтчетность.роПроставитьВКвадратыЗначения(ЭтаФорма, "Расчет", "КБК1_", 20, КБК);
			
		КонецЕсли;
		
		Если РегламентированнаяОтчетность.ПустоеЗначение(СтрЗаменить(Результат.АдрЮР, ",","")) Тогда
			мТитульный.Области.АдрЮР.Значение = "";
		Иначе
			мТитульный.Области.АдрЮР.Значение = РегламентированнаяОтчетность.ПредставлениеАдресаВФормате9Запятых(Результат.АдрЮР);
		КонецЕсли;
		
		Если Результат.ТипНП = 2 Тогда
			мТитульный.Области.ОргДиректорОбособ.Значение = мТитульный.Области.ОргДиректор.Значение;
			мТитульный.Области.ОргДиректор.Значение = "";
			мТитульный.Области.ОргБухгалтерОбособ.Значение = мТитульный.Области.ОргБухгалтер.Значение;
			мТитульный.Области.ОргБухгалтер.Значение = "";
			ЗаполнитьДатуВЯчейках();
		КонецЕсли;
		
	КонецЕсли;
	Если ВПрограммеИзмененаДатаПодписи Тогда
		Если Результат.ТипНП = 2 Тогда
			мТитульный.Области.ОргДиректорОбособ.Значение = мТитульный.Области.ОргДиректор.Значение;
			мТитульный.Области.ОргДиректор.Значение = "";
			мТитульный.Области.ОргБухгалтерОбособ.Значение = мТитульный.Области.ОргБухгалтер.Значение;
			мТитульный.Области.ОргБухгалтер.Значение = "";
			ЗаполнитьДатуВЯчейках();
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры // ЗаполнитьСведенияОбОрганизации2

// Процедура контролирует корректность установленной точности указания
// суммовых (денежных) показателей при выборе единицы измерения.
//
Процедура ПроверитьТочность()
	
	Если ЕдиницаИзмерения = Перечисления.ПорядкиОкругленияОтчетности.Окр1 Тогда

		Если ТочностьЕдиницыИзмерения > 2 Тогда
			Сообщить(ЭтаФорма.Заголовок+": при выводе сумм в рублях точность не может превышать 2 знака", СтатусСообщения.Внимание);
			ТочностьЕдиницыИзмерения = 2;
		КонецЕсли;

	ИначеЕсли ЕдиницаИзмерения = Перечисления.ПорядкиОкругленияОтчетности.Окр1000 Тогда

		Если ТочностьЕдиницыИзмерения > 3 Тогда
			Сообщить(ЭтаФорма.Заголовок+": при выводе сумм в тысячах рублей точность не может превышать 3 знака", СтатусСообщения.Внимание);
			ТочностьЕдиницыИзмерения = 3;
		КонецЕсли;

	ИначеЕсли ЕдиницаИзмерения = Перечисления.ПорядкиОкругленияОтчетности.Окр1000000 Тогда

		Если ТочностьЕдиницыИзмерения > 6 Тогда
			Сообщить(ЭтаФорма.Заголовок+": при выводе сумм в миллионах рублей точность не может превышать 6 знаков", СтатусСообщения.Внимание);
			ТочностьЕдиницыИзмерения = 6;
		КонецЕсли;

	КонецЕсли;

КонецПроцедуры // ПроверитьТочность()

// ПоказатьСтраницуМногостраничногоРаздела
// Вариант версия 10.05.2005
// Выводит в табличный документ данные страницы многостраничного раздела формы.
// Одновременно убирая признак у активной страницы и сохраняя в неё данные текущего табличного поля
// Параметры:
//  Шаг                      - число,  количество перелистываемых страниц;
//  ИмяТекущейСтраницыПанели - строка, имя страницы основной панели формы, содержащий многостраничный раздел;
//  ПоказатьПоИндексу        - булево, управляет выводом страницы по заданному индексу в коллекции страниц.
//
Процедура ПоказатьСтраницуМногостраничногоРаздела(Шаг, ИмяТекущейСтраницыПанели, ПоказатьПоИндексу = Ложь) Экспорт

	РегламентированнаяОтчетность.роПоказатьСтраницуМногостраничногоРаздела(ЭтаФорма, Шаг, ИмяТекущейСтраницыПанели, ПоказатьПоИндексу);

	// В режиме печати, не показываем листы парой, т.к. в этом нет необходимости.
	// Не нужно этот код убирать!
	Если НЕ мРежимПечати Тогда
		// Обеспечим показ альтернативной страницы, с учетом связки разделов 4 и 5
		// Важно для процедуры роАктивизироватьЯчейку.

		Если (ИмяТекущейСтраницыПанели = "Раздел4") Или (ИмяТекущейСтраницыПанели = "Раздел5") Тогда
			АльтернативнаяСтраница = ?(ИмяТекущейСтраницыПанели = "Раздел4", "Раздел5", "Раздел4");
			РегламентированнаяОтчетность.роПоказатьСтраницуМногостраничногоРаздела(ЭтаФорма, Шаг, АльтернативнаяСтраница, ПоказатьПоИндексу);
		КонецЕсли;
	КонецЕсли;

КонецПроцедуры // ПоказатьСтраницуМногостраничногоРаздела()

// ЗаполнениеЗначенийВКвадратиках
//
Процедура ЗаполнениеЗначенийВКвадратиках(Знач ИмяСтраницы) Экспорт

	Если Найти(ИмяСтраницы, "ПолеТабличногоДокумента") > 0 Тогда
		ИмяСтраницыП = СтрЗаменить(ИмяСтраницы, "ПолеТабличногоДокумента", "");
	Иначе
		ИмяСтраницыП = ИмяСтраницы;
	КонецЕсли;

	Если ИмяСтраницыП = "Расчет" Тогда
		РегламентированнаяОтчетность.роПроставитьВКвадратыЗначения(ЭтаФорма, "Расчет", "СуммаБезЛьгот1_", 12, мСтруктураПеременных.СуммаБезЛьготРасчет, Истина);

		РегламентированнаяОтчетность.роПроставитьВКвадратыЗначения(ЭтаФорма, "Расчет", "СуммаЗачет1_", 12, мСтруктураПеременных.СуммаЗачетРасчет, Истина);

		РегламентированнаяОтчетность.роПроставитьВКвадратыЗначения(ЭтаФорма, "Расчет", "СуммаЛьготОргСоц1_", 12, мСтруктураПеременных.СуммаЛьготОргСоцРасчет, Истина);

		РегламентированнаяОтчетность.роПроставитьВКвадратыЗначения(ЭтаФорма, "Расчет", "СуммаЛьготОрг1_", 12, мСтруктураПеременных.СуммаЛьготОргРасчет, Истина);

		РегламентированнаяОтчетность.роПроставитьВКвадратыЗначения(ЭтаФорма, "Расчет", "СуммаПлат1_", 12, мСтруктураПеременных.СуммаПлатРасчет, Истина);

		Для Инд = 1 По 9 Цикл
			РегламентированнаяОтчетность.роПроставитьВКвадратыЗначения(ЭтаФорма, "Расчет", "Сумма03" + Строка(Инд) + "_", 12, мСтруктураПеременных["СуммаСтрока3" + Строка(Инд)], Истина);
		КонецЦикла;

	КонецЕсли;

КонецПроцедуры // ЗаполнениеЗначенийВКвадратиках

// Обновляет пользовательские настройки при изменении версии формы.
//
Процедура ОбновитьПользовательскиеНастройки()

	Сообщить("Изменилась версия формы отчета.
				|Выполняется обновление пользовательских настроек.", СтатусСообщения.Информация);

	// Обновляем варианты заполнения показателей отчета
	ЕстьИзмененияВариантыЗаполнения = ОбновитьВариантыЗаполнения();

	// Обновляем настройки страниц отчета (содержание отчета)
	ЕстьИзмененияНастройкаСтраниц   = ОбновитьНастройкиСтраниц();

	Если ЕстьИзмененияВариантыЗаполнения ИЛИ ЕстьИзмененияНастройкаСтраниц Тогда
		// Если были изменения в пользовательских настройках,
		// то устанавливаем флаг модифицированности формы.
		Модифицированность = Истина;

		Сообщить("Обновление пользовательских настроек успешно завершено!");

	Иначе

		Сообщить("Изменения в структуре пользовательских настроек не обнаружены!");

	КонецЕсли;

КонецПроцедуры // ОбновитьПользовательскиеНастройки()

// Открывает форму документа ФормаНастройкиОтчета с целью выбора 
// выводимых на печать листов отчета.
//
// Параметры:
//   ВариантВыбора - строка, назначение выбора страниц.
//
Процедура ОткрытьФормуВыбораСтраниц(ВариантВыбора)

	ФормаНастройкиОтчета = РегламентированнаяОтчетность.роПолучитьОбщуюФорму("НастройкиОтчета", ЭтаФорма, "дляВыбораСтраницОтчета");

	Если ФормаНастройкиОтчета.Открыта() Тогда
		ФормаНастройкиОтчета.Активизировать();
		Если Вопрос("Предыдущая операция выбора листов не завершена.
			|Завершить?",РежимДиалогаВопрос.ДаНет,30,КодВозвратаДиалога.Да)=КодВозвратаДиалога.Да Тогда
			ФормаНастройкиОтчета.Закрыть();
		КонецЕсли;
	КонецЕсли;

	мДеревоВыбранныхСтраниц = "";

	ДеревоСтраницОтчета = мДеревоСтраницОтчета.Скопировать();

	ФормаНастройкиОтчета.НачальноеЗначениеВыбора = ДеревоСтраницОтчета;

	ФормаНастройкиОтчета.мПараметры.Выгрузка = Ложь;
	//ФормаНастройкиОтчета.мПараметры.ЗначенияИзСписка = Ложь;

	РезультатВыбора = ФормаНастройкиОтчета.ОткрытьМодально();
	Если РезультатВыбора <> Неопределено Тогда
		мДеревоВыбранныхСтраниц = РезультатВыбора;
		Модифицированность = Истина;
	Иначе
		мДеревоВыбранныхСтраниц = ДеревоСтраницОтчета;
	КонецЕсли;

КонецПроцедуры // ОткрытьФормуВыбораСтраниц()

// УправлениеЛистами
// Процедура раскрашивает ячейки листов, в зависимости от типов организаций.
// Запускается в ЗаполнитьСведенияОбОрганизации и при отрктыии всегда.
// Параметры:
//  ТипНП          - число, тип налогоплательщика, если не указано, то берется из ИБ.
//
Процедура УправлениеЛистами(ТипНП = Неопределено) Экспорт

	Если ТипНП = Неопределено Тогда
		ТипНП = 0;

		Если (Организация  = Неопределено) Или (Организация = ОбщегоНазначения.ПустоеЗначениеТипа("СправочникСсылка.Организации")) Тогда
			Возврат
		КонецЕсли;

		ОргСведения = РегламентированнаяОтчетность.ПолучитьСведенияОбОрганизации(Организация, ДатаПодписи, "ТипНП");
		ОргСведения.Свойство("ТипНП", ТипНП);
	КонецЕсли;

	// Управление цветами
	Если ТипНП = 3 Тогда
		УстановитьСвойстваВалидныхЯчеек("Блокировать ячейки ЮЛ", мВпрограммеИзмененаОрганизация);
	ИначеЕсли ТипНП <> 3 Тогда
		УстановитьСвойстваВалидныхЯчеек("Блокировать ячейки ЧП", мВпрограммеИзмененаОрганизация);
	КонецЕсли;

КонецПроцедуры // УправлениеЛистами

// УстановитьСвойстваВалидныхЯчеек
// Блокирует необходимые ячейки, в зависимости от комманды
//
// Параметры:
// КоммандаТекст = может принимать значения "Блокировать ячейки ЮЛ" или "Блокировать ячейки ЧП"
Процедура УстановитьСвойстваВалидныхЯчеек(Знач КоммандаТекст, Знач Очищать)

	// Процедура "заглушка", для совместимости общих механизмов.
	Возврат;

КонецПроцедуры // УстановитьСвойстваВалидныхЯчеек

// Процедура управляет выводом отдельных страниц отчета на печать.
//
// Параметры:
//   Парам1 - структура, содержащая параметры печаты страницы:
//      - Имя выводимого на печать листа;
//      - ориентация страницы;
//      - имя табличного поля, который выводится на печать;
//      - имя области дабличного документа, выводимой на печать;
//      - строка, задающая способ печати.Принимает значения:
//           "ПечататьСразу" - непосредственный вывод на печать;
//           "ПечататьБланк" - с предварительным просмотром.
//
Процедура ВывестиНаПечатьЛист(Парам1)
	
	Если Парам1.ЧтоИскать <> Неопределено Тогда
		РегламентированнаяОтчетность.роНайтиЗначение(ЭтаФорма, Парам1);
	Иначе
		РегламентированнаяОтчетность.ВывестиНаПечатьЛистОбщая(ЭтаФорма, Парам1);
	КонецЕсли;
	
КонецПроцедуры

// Процедура управляет выводом всех страниц многостраничного раздела на печать.
//
// Параметры:
//   СтруктураПараметровСтраницы - структура, содержащая параметры печаты отчета:
//
//      - имя страницы основной панели формы (многостраничного раздела);
//      - имя выводимого на печать листа;
//      - ориентация страницы;
//      - имя табличного документа, который выводится на печать;
//      - имя области табличного документа, выводимой на печать (содержит не пустое значение,
//        когда выводится на печать не весь табличный документ, а часть его);
//      - строка, задающая способ печати.Принимает значения:
//           "ПечататьСразу" - непосредственный вывод на печать;
//           "ПечататьБланк" - с предварительным просмотром.
//
Процедура ВывестиНаПечатьДополнительныеСтраницы(СтруктураПараметровСтраницы)
	Перем ИмяСтраницы; // имя страницы основной панели формы;
	Перем ТаблицаСтраницРаздела;
	
	СтруктураПараметровСтраницы.Свойство("ИмяСтраницыПанели", ИмяСтраницы);

	Если Не мСтруктураМногостраничныхРазделов.Свойство(ИмяСтраницы, ТаблицаСтраницРаздела) Тогда
		Возврат;
	КонецЕсли;

	АктивнаяСтраницаРаздела = ТаблицаСтраницРаздела.Найти(Истина, "АктивнаяСтраница");
	Если АктивнаяСтраницаРаздела = Неопределено Тогда
		ВывестиНаПечатьЛист(СтруктураПараметровСтраницы);

		Возврат;
	КонецЕсли;

	ИсходныйИндекс = ТаблицаСтраницРаздела.Индекс(АктивнаяСтраницаРаздела);

	Для Каждого Страница Из ТаблицаСтраницРаздела Цикл
		// выводим на печать каждую страницу многостраничного раздела
		ТекущийИндекс = ТаблицаСтраницРаздела.Индекс(Страница);
		ПоказатьСтраницуМногостраничногоРаздела(ТекущийИндекс, ИмяСтраницы, Истина);
		ВывестиНаПечатьЛист(СтруктураПараметровСтраницы);
	КонецЦикла;

	// В случае, если в многостраничном блоке находится 1 страница, то не следует ещё раз запускать ПоказатьСтраницуМногостраничногоРаздела
	// т.к. листов в разделе общее ко-во 1.

	Если мСтруктураМногостраничныхРазделов[ИмяСтраницы].Количество() <> 1 Тогда
		// вывод в форму данных исходной (активной) страницы
		ПоказатьСтраницуМногостраничногоРаздела(ИсходныйИндекс, ИмяСтраницы, Истина);
	КонецЕсли;

КонецПроцедуры // ВывестиНаПечатьДополнительныеСтраницы()

// Функция определяет многострочный раздел табличного документа
// на заданном табличном поле.
//
// Параметры:
//  ТекТабличноеПоле - поле тбличного документа.
//
// Возвращаемое значение:
//  строка, имя многострочного раздела.
//
Функция ОпределитьИдМногострочногоРазделаПоТабличномуПолю(ТекТабличноеПоле)
	Перем ИдГруппы;

	Если ТекТабличноеПоле = мРаздел1 Тогда
		ИдГруппы = мИдГруппы1;
	ИначеЕсли ТекТабличноеПоле = мРаздел2 Тогда
		ИдГруппы = мИдГруппы2;
	ИначеЕсли ТекТабличноеПоле = мРаздел3 Тогда
		ИдГруппы = мИдГруппы3;
	ИначеЕсли ТекТабличноеПоле = мРаздел4 Тогда
		ИдГруппы = мИдГруппы4;
	ИначеЕсли ТекТабличноеПоле = мРаздел5 Тогда
		ИдГруппы = мИдГруппы5;
	КонецЕсли;

	Возврат ИдГруппы;

КонецФункции // ОпределитьИдМногострочногоРазделаПоТабличномуПолю()

// Процедура очищает содержимое редактируемых и вычисляемых ячеек
// поля табличного документа, переданного параметром ВыбТабличноеПоле.
//
// Параметры:
//  ВыбТабличноеПоле - поле табличного документа.
//
Процедура ОчиститьТабличноеПоле( ВыбТабличноеПоле) Экспорт

	// Предварительно проверим наличие дополнительных строк,
	// в заданном поле табличного документа.
	// При наличии таких строк удаляем их.
	
	ИмяГруппыДопСтрок = ОпределитьИдМногострочногоРазделаПоТабличномуПолю(ВыбТабличноеПоле);
	Если ИмяГруппыДопСтрок <> Неопределено Тогда
		// Поле табличного документа содержит многострочный раздел.

		// Получим таблицу значений, содержащую данные дополнительных строк.
		ПромТаблицаДопСтрокРаздела = Новый ТаблицаЗначений;
		мСтруктураМногострочныхРазделов.Свойство(ИмяГруппыДопСтрок, ПромТаблицаДопСтрокРаздела);

		ИсходноеКоличествоСтрокГруппы = 0;
		мСтруктураИсхКолвоСтрокРазделов.Свойство(ИмяГруппыДопСтрок, ИсходноеКоличествоСтрокГруппы);

		ТекущееКоличествоСтрок = ПромТаблицаДопСтрокРаздела.Количество();

		Если ТекущееКоличествоСтрок > ИсходноеКоличествоСтрокГруппы Тогда
			// Имеются дополнительные строки.
			// Удаляем их.

			НСтр = ПромТаблицаДопСтрокРаздела.Количество();
			Пока НСтр > ИсходноеКоличествоСтрокГруппы Цикл

				ТекСтрокаТаблицы = ПромТаблицаДопСтрокРаздела[НСтр - 1];

				ИмяПервойКолонки = ПромТаблицаДопСтрокРаздела.Колонки[0].Имя;
				ИмяПервойЯчейкиУдаляемойСтроки  = ИмяПервойКолонки + "_" + Формат(НСтр, "ЧГ=0");

				// область первой ячейки удаляемой строки многострочного раздела
				ОбластьЯчейки = ВыбТабличноеПоле.Области[ИмяПервойЯчейкиУдаляемойСтроки];

				// номера строк удаляемой области
				НомерВерхЯчейкиОбласти = ОбластьЯчейки.Верх;
				НомерНижнЯчейкиОбласти = ОбластьЯчейки.Низ;

				// Определим область удаляемой строки
				УдаляемаяОбласть = ВыбТабличноеПоле.Область(НомерВерхЯчейкиОбласти, , НомерНижнЯчейкиОбласти, );

				// непосредственно удаляем область строки табличного документа
				ВыбТабличноеПоле.УдалитьОбласть( УдаляемаяОбласть,ТипСмещенияТабличногоДокумента.ПоВертикали );

				// удаляем из структуры многострочного раздела соответствующую строку
				ПромТаблицаДопСтрокРаздела.Удалить(ТекСтрокаТаблицы);

				НСтр = НСтр - 1;

			КонецЦикла;

		КонецЕсли;

	КонецЕсли;

	// Непосредственно очищаем ячейки табличного документа.
	Для Инд = 0 По ВыбТабличноеПоле.Области.Количество() - 1 Цикл
		ТекущаяОбласть = ВыбТабличноеПоле.Области[Инд];

		Если Не ТекущаяОбласть.ТипОбласти = ТипОбластиЯчеекТабличногоДокумента.Прямоугольник Тогда
			Продолжить;
		КонецЕсли;

		Если ТекущаяОбласть.СодержитЗначение <> Истина Тогда
			Продолжить;
		КонецЕсли;

		Если ТекущаяОбласть.Защита Тогда
			Продолжить;
		КонецЕсли;

		ТекущаяОбласть.Очистить();

	КонецЦикла;

	ОбнулитьПеременныеМодуляХранящиеЗначенияКвадратногоПредставленияПоРазделу(СтрЗаменить(ВыбТабличноеПоле.Имя, "ПолеТабличногоДокумента", ""));

	Если ИмяГруппыДопСтрок <> Неопределено Тогда
		ОбновитьСтруктуруМногострочногоРаздела(ИмяГруппыДопСтрок);

		ИмяСтраницыПанели = СтрЗаменить(ВыбТабличноеПоле.Имя, "ПолеТабличногоДокумента", "");
		Расчет(ИмяСтраницыПанели);

	КонецЕсли;

КонецПроцедуры // ОчиститьТабличноеПоле()

// Обрабатывает полученный из формы ФормаНастройкиОтчета дерево значений,
// определяет состав помеченных для вывода на печать листов.
//
// Параметры:
//  ВидПечати - строка, задающая способ печати:
//              "ПоказатьБланк" - непосредственный вывод на печать;
//              "ПечататьСразу" - с предварительным просмотром.
//
Процедура Печать(ВидПечати, ЧтоИскать = Неопределено) Экспорт

	Если ЧтоИскать = Неопределено Тогда
		Отказ = Ложь;
		РегламентированнаяОтчетность.ПередПечатьюРегламентированногоОтчета(ЭтаФорма, Отказ);
		Если Отказ Тогда
			Возврат;
		КонецЕсли;
	КонецЕсли;

	Если ЧтоИскать = Неопределено И НЕ РегламентированнаяОтчетность.ПринтерДоступен() Тогда
		Предупреждение("Перед формированием печатных форм необходимо определить в системе принтер и
						|задать его в качестве используемого по умолчанию!");
		Возврат;
	КонецЕсли;
	
	//ОткрытьФормуВыбораСтраниц("ВыбратьДляПечати");

	Если ТипЗнч(мДеревоВыбранныхСтраниц) <> Тип("ДеревоЗначений") Тогда
		Возврат;
	КонецЕсли;

	мПечатныеФормы.Очистить();

	СтруктураПараметров = Новый Структура;

	мРежимПечати = Истина;
	Для Каждого СтрокаУровня1 Из мДеревоВыбранныхСтраниц.Строки Цикл
		Пометка = РегламентированнаяОтчетность.ПечататьРаздел(ЭтаФорма, СтрокаУровня1);

		ИмяСтраницыПанели  = СтрокаУровня1.ИмяСтраницы;
		НаименованиеЛиста  = СтрокаУровня1.Представление;
		ОриентацияЛиста    = СтрокаУровня1.ОриентацияСтраницы;
		ИмяТабличногоПоля  = СтрокаУровня1.ИмяПоляТабличногоДокум;
		ИмяОбластиТаблПоля = СтрокаУровня1.ИмяОбластиТабличногоПоля;

		Если СтрокаУровня1.Строки.Количество() > 0 Тогда

			Для Каждого СтрокаУровня2 Из СтрокаУровня1.Строки Цикл
				Пометка = РегламентированнаяОтчетность.ПечататьРаздел(ЭтаФорма, СтрокаУровня2);

				ИмяСтраницыПанели  = СтрокаУровня2.ИмяСтраницы;
				НаименованиеЛиста  = СтрокаУровня2.Представление;
				ОриентацияЛиста    = СтрокаУровня2.ОриентацияСтраницы;
				ИмяТабличногоПоля  = СтрокаУровня2.ИмяПоляТабличногоДокум;
				ИмяОбластиТаблПоля = СтрокаУровня2.ИмяОбластиТабличногоПоля;

				Если СтрокаУровня2.Строки.Количество() > 0 Тогда
					Для Каждого СтрокаУровня3 Из СтрокаУровня2.Строки Цикл

						Пометка = РегламентированнаяОтчетность.ПечататьРаздел(ЭтаФорма, СтрокаУровня3);
						Если Пометка = 0 И ЧтоИскать = Неопределено Тогда
							Продолжить;
						КонецЕсли;

						ИмяСтраницыПанели  = СтрокаУровня3.ИмяСтраницы;
						НаименованиеЛиста  = СтрокаУровня3.Представление;
						ОриентацияЛиста    = СтрокаУровня3.ОриентацияСтраницы;
						ИмяТабличногоПоля  = СтрокаУровня3.ИмяПоляТабличногоДокум;
						ИмяОбластиТаблПоля = СтрокаУровня3.ИмяОбластиТабличногоПоля;

						СтруктураПараметров.Очистить();
						СтруктураПараметров.Вставить("НаименованиеЛиста",  НаименованиеЛиста);
						СтруктураПараметров.Вставить("ОриентацияЛиста",    ОриентацияЛиста);
						СтруктураПараметров.Вставить("ИмяТабличногоПоля",  ИмяТабличногоПоля);
						Структурапараметров.Вставить("ИмяОбластиТаблПоля", ИмяОбластиТаблПоля);
						СтруктураПараметров.Вставить("ВидПечати",          ВидПечати);
						СтруктураПараметров.Вставить("ЧтоИскать",	       ЧтоИскать);

						Если Не мСтруктураМногостраничныхРазделов.Свойство(ИмяСтраницыПанели) Тогда
							ВывестиНаПечатьЛист(СтруктураПараметров);
						Иначе
							// выводим на печать все созданные страницы многостраничного раздела
							СтруктураПараметров.Вставить("ИмяСтраницыПанели", ИмяСтраницыПанели);
							ВывестиНаПечатьДополнительныеСтраницы(СтруктураПараметров);
						КонецЕсли;
					КонецЦикла;

					Продолжить;

				КонецЕсли;

				Если Пометка = 0 И ЧтоИскать = Неопределено Тогда
					Продолжить;
				КонецЕсли;

				СтруктураПараметров.Очистить();
				СтруктураПараметров.Вставить("НаименованиеЛиста",  НаименованиеЛиста);
				СтруктураПараметров.Вставить("ОриентацияЛиста",    ОриентацияЛиста);
				СтруктураПараметров.Вставить("ИмяТабличногоПоля",  ИмяТабличногоПоля);
				Структурапараметров.Вставить("ИмяОбластиТаблПоля", ИмяОбластиТаблПоля);
				СтруктураПараметров.Вставить("ВидПечати",          ВидПечати);
				СтруктураПараметров.Вставить("ЧтоИскать",	       ЧтоИскать);

				Если Не мСтруктураМногостраничныхРазделов.Свойство(ИмяСтраницыПанели) Тогда
					ВывестиНаПечатьЛист(СтруктураПараметров);
				Иначе
					// выводим на печать все созданные страницы многостраничного раздела
					СтруктураПараметров.Вставить("ИмяСтраницыПанели", ИмяСтраницыПанели);
					ВывестиНаПечатьДополнительныеСтраницы(СтруктураПараметров);
				КонецЕсли;
			КонецЦикла;

			Продолжить;

		КонецЕсли;

		Если Пометка = 0 И ЧтоИскать = Неопределено Тогда
			Продолжить;
		КонецЕсли;

		СтруктураПараметров.Очистить();
		СтруктураПараметров.Вставить("НаименованиеЛиста",  НаименованиеЛиста);
		СтруктураПараметров.Вставить("ОриентацияЛиста",    ОриентацияЛиста);
		СтруктураПараметров.Вставить("ИмяТабличногоПоля",  ИмяТабличногоПоля);
		Структурапараметров.Вставить("ИмяОбластиТаблПоля", ИмяОбластиТаблПоля);
		СтруктураПараметров.Вставить("ВидПечати",          ВидПечати);
		СтруктураПараметров.Вставить("ЧтоИскать",	       ЧтоИскать);

		Если Не мСтруктураМногостраничныхРазделов.Свойство(ИмяСтраницыПанели) Тогда
			ВывестиНаПечатьЛист(СтруктураПараметров);
		Иначе
			// выводим на печать все созданные страницы многостраничного раздела
			СтруктураПараметров.Вставить("ИмяСтраницыПанели", ИмяСтраницыПанели);
			ВывестиНаПечатьДополнительныеСтраницы(СтруктураПараметров);
		КонецЕсли;
	КонецЦикла;

	// обновляем исходное дерево значений 
	мДеревоСтраницОтчета = мДеревоВыбранныхСтраниц.Скопировать();

	Если ЧтоИскать = Неопределено Тогда
		РегламентированнаяОтчетность.ПроставитьНомераЛистов(ЭтаФорма, ВидПечати);
	КонецЕсли;

	мРежимПечати = Ложь;

КонецПроцедуры // Печать()

// Формирует структуру данных отчета и помещает в реквизит типа ХранилищеЗначения
// документа РегламентированныйОтчет.
// 
// При первом сохранении данных отчета создает новый документ этого вида.
// Структура данных отчета состоит из элементов:
//   - значения редактируемых реквизитов отчета;
//   - данные по многострочным разделам отчета;
//   - данные по  многостраничным разделам отчета;
//   - данные по вариантам заполнения реквизитов,
//     участвующих в автозаполнении.
//
Функция Сохранить(Автосохранение = Ложь) Экспорт

	Перем ТаблицаСтраниц;

	Вариант = ВидДокумента * НомерКорректировки;

	Если НЕ РегламентированнаяОтчетность.ПриЗаписиРегламентированногоОтчета(ЭтаФорма, , Автосохранение, Вариант) Тогда
		Возврат Ложь;
	КонецЕсли;

	// установим текущие значения реквизитов документа
	мСохраненныйДок.ИсточникОтчета             = ЭтотОбъект.Метаданные().Имя;
	мСохраненныйДок.НаименованиеОтчета         = СтрЗаменить(ЭтотОбъект.Метаданные().Формы.ОсновнаяФорма.Представление(), " (сводная форма)", "");
	мСохраненныйДок.ДатаНачала                 = мДатаНачалаПериодаОтчета;
	мСохраненныйДок.ДатаОкончания              = мДатаКонцаПериодаОтчета;
	мСохраненныйДок.Периодичность              = мПериодичность;
	мСохраненныйДок.ВыбраннаяФорма             = мВыбраннаяФорма;
	мСохраненныйДок.Организация                = Организация;
	мСохраненныйДок.ДатаПодписи                = ДатаПодписи;
	мСохраненныйДок.ЕдиницаИзмерения           = ЕдиницаИзмерения;
	мСохраненныйДок.ТочностьЕдиницыИзмерения   = ТочностьЕдиницыИзмерения;
	мСохраненныйДок.ВидОтчетности              = Перечисления.ВидыОтчетности.РегламентированнаяОтчетность;
	мСохраненныйДок.Комментарий                = Комментарий;
	мСохраненныйДок.Вид                        = Вариант;

	мВариант = Вариант;

	РегламентированнаяОтчетность.роОбновитьСтруктуруМногостраничныхРазделов(ЭтаФорма);
	ОбновитьСтруктуруМногострочныхРазделов();

	// формируем данные редактируемых ячеек таблицы
	ПоказателиОтчета = Новый Структура();

	Для Каждого СтраницаПанели из ЭлементыФормы.ОсновнаяПанель.Страницы Цикл

		// Многостраничность - не записываем в Показатели отчета !!!
		//
		Если Не мСтруктураМногостраничныхРазделов.Свойство(СтраницаПанели.Имя, ТаблицаСтраниц) Тогда
			ИмяТекТабличногоПоля    = "ПолеТабличногоДокумента" + СтраницаПанели.Имя;
			ТекТабличноеПоле        = ЭлементыФормы[ИмяТекТабличногоПоля];

			ПоказателиТекущегоЛиста = СобратьДанныеТекущегоТаблПоля(ТекТабличноеПоле);
			ПоказателиОтчета.Вставить(ИмяТекТабличногоПоля, ПоказателиТекущегоЛиста);
		КонецЕсли;

	КонецЦикла;

	// формируем список сохранения
	СписокСохранения = Новый Структура();

	// вставляем данные редактируемых ячеек таблицы	
	СписокСохранения.Вставить("ПоказателиОтчета", ПоказателиОтчета);

	// вставляем данные многострочных разделов
	СписокСохранения.Вставить("ДанныеМногострочныхРазделов", мСтруктураМногострочныхРазделов);

	// вставляем данные многостраничных разделов
	СписокСохранения.Вставить("ДанныеМногостраничныхРазделов", мСтруктураМногостраничныхРазделов);

	// вставляем данные вариантов автозаполнения ячеек
	СписокСохранения.Вставить("ДанныеВариантовАвтоЗаполнения", мСтруктураВариантыЗаполнения);

	// вствляем версию формы
	СписокСохранения.Вставить("ВерсияФормы", мВерсияФормы);
	
	// вствляем флажок пересчета страниц
	СписокСохранения.Вставить("ФлПодсчетСтраниц", мСчетчикСтраниц);

	// вствляем флажок отключения
	СписокСохранения.Вставить("ФлОтклВыборЗначений", мАвтоВыборКодов);

	// вствляем флажок ручной ввод ВРЕМЕННАЯ ОТМЕНА
	СписокСохранения.Вставить("Автозаполнение", ФлажокОтклАвтоРасчет);

	ХранилищеДанных = Новый ХранилищеЗначения(СписокСохранения);
	мСохраненныйДок.ДанныеОтчета = ХранилищеДанных;

	// записываем документ, хранящий данные отчета	
	Попытка
		мСохраненныйДок.Записать();
	Исключение
		Если НЕ Автосохранение Тогда
			Предупреждение(ОбщегоНазначения.СформироватьТекстСообщения(ОписаниеОшибки()));
		КонецЕсли;
		РегламентированнаяОтчетность.СкрытьКартинкуСохранение(ЭтаФорма);
		Возврат Ложь;
	КонецПопытки;

	РегламентированнаяОтчетность.ПослеЗаписиРегламентированногоОтчета(ЭтаФорма);

	СохранитьДеревоНастройкиСтраниц();

	КлючУникальности = мСохраненныйДок.Ссылка;

	Модифицированность = Ложь;

	Возврат Истина;

КонецФункции // Сохранить()

// Восстанавливает сохраненные данные отчета.
//
Процедура ВосстановитьСохраненныеДанные()
	Перем ДанныеМногострочныхРазделов;
	Перем ДанныеМногостраничныхРазделов;
	Перем ДанныеВариановАвтоЗаполнения;
	Перем ПоказателиОтчета;
	Перем ВерсияФормы;
	Перем ТаблицаМногостраничногоДокумента;
	Перем Автозаполнение;

	// В случае, если формы была скопирована по F9, то проверим, не изменилась ли организация.
	Если Организация <> мСохраненныйДок.Организация
	   И Организация <> ОбщегоНазначения.ПустоеЗначениеТипа("СправочникСсылка.Организации")
	   И Организация <> Неопределено Тогда
		// Меняем переменную, для того, чтобы запустилась процедура ЗаполнитьСведенияОбОрганизации
		мВПрограммеИзмененаОрганизация = Истина;
		мСохраненныйДок.Организация = Организация;
	Иначе
		// восстанавливаем реквизиты отчета
		Организация              = мСохраненныйДок.Организация;
	КонецЕсли;

	ДатаПодписи              = мСохраненныйДок.ДатаПодписи;
	ЕдиницаИзмерения         = мСохраненныйДок.ЕдиницаИзмерения;
	ТочностьЕдиницыИзмерения = мСохраненныйДок.ТочностьЕдиницыИзмерения;
	Комментарий              = мСохраненныйДок.Комментарий;

	// восстанавливаем сохраненные данные отчета
	СписокСохранения = мСохраненныйДок.ДанныеОтчета.Получить();

	// список листов, выводимых на печать
	ДеревоНастройкиСтраниц = мСохраненныйДок.ДеревоНастройкиСтраниц.Получить();
	мДеревоСтраницОтчета   = ДеревоНастройкиСтраниц.Скопировать();

	// восстанавливаем сохраненные данные вариантов автозаполнения ячеек
	Если СписокСохранения.Свойство("ДанныеВариантовАвтоЗаполнения", ДанныеВариановАвтоЗаполнения) Тогда
		мСтруктураВариантыЗаполнения = ДанныеВариановАвтоЗаполнения;
	КонецЕсли;

	// восстановим сохраненные данные редактируемых ячеек
	СписокСохранения.Свойство( "ПоказателиОтчета", ПоказателиОтчета );

	// восстанавливаем версию формы
	Если СписокСохранения.Свойство("ВерсияФормы", ВерсияФормы) Тогда
		Если ВерсияФормы <> мВерсияФормы Тогда
			// Версия формы изменилась.
			// Обновляем пользовательские настройки.
			ОбновитьПользовательскиеНастройки();
		КонецЕсли;
	КонецЕсли;

	// восстанавливаем сохраненные данные многострочных разделов
	Если СписокСохранения.Свойство( "ДанныеМногострочныхРазделов", ДанныеМногострочныхРазделов) Тогда
		мСтруктураМногострочныхРазделов = ДанныеМногострочныхРазделов;

		Для Каждого ЭлементСтруктуры Из мСтруктураМногострочныхРазделов Цикл
			ИмяГруппы       = ЭлементСтруктуры.Ключ;
			СтруктураГруппы = ЭлементСтруктуры.Значение;
			ТаблПоле = ОпределитьТабличноеПолеПоИдМногострочногоРаздела(ИмяГруппы);

			// Если лист многостраничный, то всегда выведется текущий на момент сохранения блок многострочности
			// а в процедуре вывести активную страницу, выведутся оставшиеся данные.
			ВывестиРазделВТабличныйДокумент(ИмяГруппы, СтруктураГруппы);

		КонецЦикла;
	КонецЕсли;

	// восстанавливаем сохраненные данные многостраничных разделов
	Если СписокСохранения.Свойство("ДанныеМногостраничныхРазделов", ДанныеМногостраничныхРазделов) Тогда
		мСтруктураМногостраничныхРазделов = ДанныеМногостраничныхРазделов;

		// Отображаем данные, хранящиеся в структуре многостраничных разделов
		Для Каждого ЭлементСтруктуры Из мСтруктураМногостраничныхРазделов Цикл
			// 1 Нужно найти Активную страницу по индексу
			// и ей отобразить в табличном документе

			мСтруктураМногостраничныхРазделов.Свойство(ЭлементСтруктуры.Ключ, ТаблицаМногостраничногоДокумента);
			АктивнаяСтраница = ТаблицаМногостраничногоДокумента.Найти(Истина, "АктивнаяСтраница");
			ИндАктивнаяСтраница = ТаблицаМногостраничногоДокумента.Индекс(АктивнаяСтраница);
			РегламентированнаяОтчетность.роПоказатьСтраницуМногостраничногоРазделаПриВосстановлении(ЭтаФорма, ИндАктивнаяСтраница, ЭлементСтруктуры.Ключ);
		КонецЦикла;

	КонецЕсли;

	// восстанавливаем флажок ПодсчетаСтраниц       
	СписокСохранения.Свойство("ФлПодсчетСтраниц", мСчетчикСтраниц);

	СписокСохранения.Свойство("ФлОтклВыборЗначений", мАвтоВыборКодов);
	Если мАвтоВыборКодов = Неопределено Тогда
		мАвтоВыборКодов = Ложь;
	КонецЕсли;

	СписокСохранения.Свойство("Автозаполнение", Автозаполнение);
	ФлажокОтклАвтоРасчет = Автозаполнение;

	Для Каждого ПоказателиСтраницы Из ПоказателиОтчета Цикл
		ИмяТекТабличноеПоле = ПоказателиСтраницы.Ключ;
		ТекТабличноеПоле    = ЭлементыФормы[ИмяТекТабличноеПоле];
		ПоказателиТаблПоле  = ПоказателиСтраницы.Значение;

		ПредставлениеДанных = РегламентированнаяОтчетность.роПолучитьСвойствоРаздела(ЭтаФорма, ИмяТекТабличноеПоле, "ПредставлениеДанных");

		Для Каждого Показатель Из ПоказателиТаблПоле Цикл
			ИмяПоказателя       = Показатель.Ключ;
			ЗначениеПоказателя  = Показатель.Значение;
			ИмяСтраницыПанели   = СтрЗаменить(ИмяТекТабличноеПоле, "ПолеТабличногоДокумента", "");

			Если мСтруктураМногостраничныхРазделов.Свойство(ИмяСтраницыПанели, ТаблицаМногостраничногоДокумента) Тогда
				// Обрабатываем случай, когда старые данные открываются новой версией, где не предусмотрено
				// хранение данных многостраничных разделов в ПоказателяхОтчета, в этой процедуре ранее
				// данные многостраничных разделов уже были выведены в соответствующие листы
				Продолжить;
			КонецЕсли;

			Если ПредставлениеДанных Тогда
				Если ОбновитьПеременныеМодуля(ИмяПоказателя, ЗначениеПоказателя) Тогда
					Продолжить;
				КонецЕсли;
			КонецЕсли;

			Попытка
				ТекТабличноеПоле.Области[ИмяПоказателя].Значение = ЗначениеПоказателя;
			Исключение
			КонецПопытки;

		КонецЦикла;

	КонецЦикла;

	РегламентированнаяОтчетность.ОперацииПриВосстановленииРегламентированногоОтчета(ЭтаФорма);

	мДеревоВыбранныхСтраниц = мДеревоСтраницОтчета.Скопировать();

	РегламентированнаяОтчетность.роУстановитьФорматВывода(ЭтаФорма);

	// Управляем видимостью страниц основной панели формы
	РегламентированнаяОтчетность.роПоказатьСтраницыОтчета(ЭтаФорма);

	Модифицированность = Ложь;

	мДокументВосстановлен = Истина;

КонецПроцедуры // ВосстановитьСохраненныеДанные()

// Процедура выводит строки многострочного раздела в табличный документ.
// При отсутствии в табличном документе необходимого количества строк
// добавляет отсутствующие строки.
//
// Параметры:
//  ИмяГруппы       - строка, имя многострочного раздела;
//  СтруктураГруппы - таблица значений, содержащая значения показателей многострочного раздела.
//
Процедура ВывестиРазделВТабличныйДокумент(ИмяГруппы, СтруктураГруппы) Экспорт
	Перем ИсходноеКоличествоСтрокГруппы;

	// определим исходное колво строк многострочного раздела,
	// соответствующее бумажной форме отчета
	мСтруктураИсхКолвоСтрокРазделов.Свойство(ИмяГруппы, ИсходноеКоличествоСтрокГруппы);

	// реальное кол-во строк (колво заполненных строк)
	ТекущееКоличествоСтрокГруппы = СтруктураГруппы.Количество();

	ТекТабличноеПоле = ОпределитьТабличноеПолеПоИдМногострочногоРаздела(ИмяГруппы);

	// При восстановлении сохраненных данных отчета сравниваем исходное кол-во
	// отображаемых в форме строк многострочного раздела с реальным количеством
	// созданных строк в сохраненном отчете.
	Если ТекущееКоличествоСтрокГруппы > ИсходноеКоличествоСтрокГруппы Тогда

		// При превышении реального кол-ва строк над исходным кол-вом (по шаблону),
		// автоматически добавляем необходимое колво строк.
		Для НомНовойСтроки = ИсходноеКоличествоСтрокГруппы + 1 По ТекущееКоличествоСтрокГруппы Цикл

			НомИсходнойСтроки = НомНовойСтроки - 1;

			// определяем имя первой ячейки последней из исходных строк
			ИмяПервойЯчейкиПоследнейСтроки = СтруктураГруппы.Колонки[0].Имя + "_" + Формат(НомИсходнойСтроки, "ЧГ=0");

			// область первой ячейки последней из исходных строк
			ОбластьЯчейки = ТекТабличноеПоле.Области[ИмяПервойЯчейкиПоследнейСтроки];

			// номера строк исходной области
			НомерВерхЯчейкиОбласти = ОбластьЯчейки.Верх;
			НомерНижнЯчейкиОбласти = ОбластьЯчейки.Низ;

			СдвигСтрок = НомерНижнЯчейкиОбласти - НомерВерхЯчейкиОбласти + 1;

			// номера строк вставляемой области
			НомерВерхЯчейкиНовойОбласти = НомерВерхЯчейкиОбласти + СдвигСтрок;
			НомерНижнЯчейкиНовойОбласти = НомерНижнЯчейкиОбласти + СдвигСтрок;

			// определяем вставляемую область
			ВставляемаяОбласть = ТекТабличноеПоле.Область(НомерВерхЯчейкиОбласти, , НомерНижнЯчейкиОбласти, );

			// добавляем в таблицу новую строку
			ТекТабличноеПоле.ВставитьОбласть( ВставляемаяОбласть,,ТипСмещенияТабличногоДокумента.ПоВертикали );

			// переопределяем имена вставленной области
			Для Каждого Колонка Из СтруктураГруппы.Колонки Цикл

				ИмяКолонки          = Колонка.Имя;
				ИмяОбластиЯчейки    = ИмяКолонки + "_" + Формат(НомИсходнойСтроки, "ЧГ=0");
				ИмяНовОбластиЯчейки = ИмяКолонки + "_" + Формат(НомНовойСтроки, "ЧГ=0");

				ОбластьЯчейки = ТекТабличноеПоле.Области[ИмяОбластиЯчейки];
				ОбластьЯчейки.Имя = ИмяНовОбластиЯчейки;

				// определяем границы ячейки исходной области
				НомерВерхСтрокиЯчейки  = ОбластьЯчейки.Верх - СдвигСтрок;
				НомерНижнСтрокиЯчейки  = ОбластьЯчейки.Низ  - СдвигСтрок;
				НомерЛевоКолонкиЯчейки = ОбластьЯчейки.Лево;
				НомерПравКолонкиЯчейки = ОбластьЯчейки.Право;

				// Назначаем имя ячейки исходной области,
				// (т.к. в результате вставки новой области оно было очищено)
				ОбластьЯчейкиИсходнойОбласти = ТекТабличноеПоле.Область(НомерВерхСтрокиЯчейки, НомерЛевоКолонкиЯчейки, НомерНижнСтрокиЯчейки, НомерПравКолонкиЯчейки);
				ОбластьЯчейкиИсходнойОбласти.Имя = ИмяОбластиЯчейки;

				// очищаем значения ячеек вставленной области
				Если ОбластьЯчейки.СодержитЗначение = Истина Тогда
					ОбластьЯчейки.Очистить();
				Иначе
					// порядковый номер последней строки перед вставкой
					ИсходныйНомер        = Число("0"+ОбластьЯчейки.Текст);
					НовыйПорядковыйНомер = ИсходныйНомер + 1;

					ОбластьЯчейки.Текст  = Строка(НовыйПорядковыйНомер);
				КонецЕсли;

			КонецЦикла;
		КонецЦикла;
	КонецЕсли;

	// выводим значения строк
	Для Каждого СтрокаТаблицы Из СтруктураГруппы Цикл
		Для Каждого КолонкаТаблицы Из СтруктураГруппы.Колонки Цикл

			НомерСтрокиВТаблице      = СтруктураГруппы.Индекс(СтрокаТаблицы);
			НомерСтрокиВФормеТаблицы = НомерСтрокиВТаблице + 1;
			ИмяЯчейки                = КолонкаТаблицы.Имя + "_" + Формат(НомерСтрокиВФормеТаблицы, "ЧГ=0");
			ОбластьЯчейкиТаблицы     = ТекТабличноеПоле.Области[ИмяЯчейки];
			ЗначениеЯчейки           = СтрокаТаблицы[КолонкаТаблицы.Имя];

			Если ОбластьЯчейкиТаблицы.СодержитЗначение = Истина Тогда
				// задаем значение ячейки
				ОбластьЯчейкиТаблицы.Значение = ЗначениеЯчейки;

			Иначе
				// устанавливаем порядковый номер строки
				ОбластьЯчейкиТаблицы.Текст    = ЗначениеЯчейки;

			КонецЕсли;

		КонецЦикла;
	КонецЦикла;

КонецПроцедуры // ВывестиРазделВТабличныйДокумент()

// Процедура создает(удаляет) таблицу значений, содержащий параметры
// автозаполнения показателей дополнительного листа многолистового раздела.
//
// Параметры:
//  Парам - число, принимает значение:
//           1 - при создании дополнительного листа;
//          -1 - при удалении дополнительного листа;
// Лист - имя листа, необходимо для интерактивного добавления
// если Лист - неопределно, то текущий берется, равносильно нажатию на кнопку Добавить или Удалить
//
Процедура ИзменитьТаблицуПараметровАвтозаполнения(Парам, Лист = Неопределено)
	Перем МассивВариантовЗаполненияСтраниц;
	Перем ТаблицаВариантыЗаполнения;
	Перем ТаблицаСтраницРаздела;

	Если Лист = Неопределено Тогда
		ТекущаяСтраницаПанели    = ЭлементыФормы.ОсновнаяПанель.ТекущаяСтраница;
		ИмяТекущейСтраницыПанели = ТекущаяСтраницаПанели.Имя;
		Иначе
		//ТекущаяСтраницаПанели    = ЭлементыФормы.ОсновнаяПанель.ТекущаяСтраница;
		ИмяТекущейСтраницыПанели = Лист;
	КонецЕсли;

	Если Не мСтруктураВариантыЗаполнения.Свойство(ИмяТекущейСтраницыПанели, МассивВариантовЗаполненияСтраниц) Тогда
		Возврат;                 
	КонецЕсли;

	НомерТекущейСтраницы = 1;

	Если мСтруктураМногостраничныхРазделов.Свойство(ИмяТекущейСтраницыПанели, ТаблицаСтраницРаздела) Тогда
		// Раздел является многостраничным, определим активную страницу раздела:
		СтрТаблицаСтраницы = ТаблицаСтраницРаздела.Найти(Истина, "АктивнаяСтраница");
		Если СтрТаблицаСтраницы <> Неопределено Тогда
			НомерТекущейСтраницы = ТаблицаСтраницРаздела.Индекс(СтрТаблицаСтраницы) + 1;
		КонецЕсли;
	КонецЕсли;

	Если Парам = 1 Тогда // создаем таблицу параметров автозаполнения ячеек добавленного листа

		// При добавлении новой страницы параметры автозаполнения ее ячеек определяем
		// по эталонной модели
		НоваяТаблицаВариантыЗаполнения = РегламентированнаяОтчетность.роПолучитьТаблицуВариантовЗаполнения(ЭтаФорма, ИмяТекущейСтраницыПанели, НЕ ФлажокОтклАвтоРасчет, мОписаниеТиповЧислоЕ);

		Если НоваяТаблицаВариантыЗаполнения <> Неопределено Тогда

			ТаблВариантов = НоваяТаблицаВариантыЗаполнения.Скопировать();
			// Добавляем в массив таблицу значений, содержащей варианты заполнения
			// для добавленной страницы.
			МассивВариантовЗаполненияСтраниц.Добавить(ТаблВариантов);

		КонецЕсли;

	Иначе // Парам = -1. Удаляем таблицу параметров автозаполнения ячеек удаленного листа

		Если МассивВариантовЗаполненияСтраниц.Количество() > 1 Тогда 
			МассивВариантовЗаполненияСтраниц.Удалить(НомерТекущейСтраницы - 1);
		КонецЕсли;

	КонецЕсли;

КонецПроцедуры // ИзменитьТаблицуПараметровАвтозаполнения()

// ОткрытьФормуСпискаДопСтраниц
// Открывает форму документа ФормаСпискаДопСтраниц для выбора из списка и
// последующего отображения дополнительной страницы многостраничного раздела.
//
Процедура ОткрытьФормуСпискаДопСтраниц(ИмяСтраницы = Неопределено)

	Если ИмяСтраницы = Неопределено Тогда
		ТекущаяСтраницаПанели    = ЭлементыФормы.ОсновнаяПанель.ТекущаяСтраница.Имя;
	Иначе
		ТекущаяСтраницаПанели = ИмяСтраницы;
	КонецЕсли;

	// Обеспечим синхронность страниц раздела 4 и 4 лист 2
	Если (ТекущаяСтраницаПанели = "Раздел4") Или (ТекущаяСтраницаПанели = "Раздел5") Тогда

		АльтернативнаяСтраница = ?(ТекущаяСтраницаПанели = "Раздел4", "Раздел5", "Раздел4");
		РегламентированнаяОтчетность.роОткрытьФормуСпискаДопСтраниц(ЭтаФорма, ТекущаяСтраницаПанели);
		ТаблицаСтраницРаздела = Неопределено;
		мСтруктураМногостраничныхРазделов.Свойство(ТекущаяСтраницаПанели, ТаблицаСтраницРаздела);
		АктивнаяСтраницаРаздела = ТаблицаСтраницРаздела.Найти(Истина, "АктивнаяСтраница");
		АктивнаяСтраницаВИнд = ТаблицаСтраницРаздела.Индекс(АктивнаяСтраницаРаздела);
		ПоказатьСтраницуМногостраничногоРаздела(АктивнаяСтраницаВИнд, АльтернативнаяСтраница, Истина);

	КонецЕсли;

КонецПроцедуры // ОткрытьФормуСпискаДопСтраниц()

// Функция округляет число согласно установленной размерности чисел.
//
// Параметры:
//  ИсходноеЧисло - заданное число;
//
// Возвращаемое значение:
//  число, округленное с заданной точностью с учетом установленной единицы измерения.
//
Функция ОкруглитьЧислоПоФормату(ИсходноеЧисло)

	ОкругленноеЧисло = Окр(ИсходноеЧисло / мДелитель, ТочностьЕдиницыИзмерения) * мДелитель; 

	Возврат ОкругленноеЧисло;

КонецФункции // ОкруглитьЧислоПоФормату()

// Функция вычисляет итоговую сумму по конкретной графе по всем строкам
// многострочного раздела.
//
// Параметры:
// 	 Парам - строка  - показатель ячейки, по которой суммируются значения
//                     по всем строкам многострочного раздела.
//
// Возвращаемое значение:
//   число.
//
Функция РасчетСуммМногострочнойЧасти(Парам, НомерКолонки)
	
	Перем СтруктураГруппы;
	Перем МаксимальноеКоличествоСтрокГруппы;

	СуммаПоГрафе = 0; 

	// идентификатор многострочного раздела
	ИмяГруппы = Лев(Парам, 11);

	// Исходное количество строк группы
	мСтруктураИсхКолвоСтрокРазделов.Свойство(ИмяГруппы, МаксимальноеКоличествоСтрокГруппы);

	ТекТабличноеПоле = ОпределитьТабличноеПолеПоИдМногострочногоРаздела(ИмяГруппы);
	мСтруктураМногострочныхРазделов.Свойство(ИмяГруппы, СтруктураГруппы);

	// определяем последнюю строку многострочной группы
	КолСтрок = СтруктураГруппы.Количество();
	Для Инд = 1 по КолСтрок Цикл
		ИмяЯчейкиСтроки = СтруктураГруппы.Колонки[НомерКолонки - 1].Имя + "_" + Инд;
		ОбластьЯчейки 	= ТекТабличноеПоле.Области[ИмяЯчейкиСтроки];
		СуммаПоГрафе 	= СуммаПоГрафе + ОкруглитьЧислоПоФормату(ОбластьЯчейки.Значение);
	КонецЦикла;

	Возврат СуммаПоГрафе;
	
КонецФункции  // РасчетСуммМнч()

// ЗаписатьВМногострочныйБлок
//
Процедура ЗаписатьВМногострочныйБлок(Группа, Колонка, НомерСтроки, Значение)

	СтруктураГруппы = Неопределено;
	мСтруктураМногострочныхРазделов.Свойство(Группа, СтруктураГруппы);
	СтруктураГруппы[Число(НомерСтроки) - 1][Колонка] = Значение;

КонецПроцедуры // ЗаписатьВМногострочныйБлок

// ЧислоУмещается
// Функция проверяет, уместится ли переданное число в нужное кол-во квадратиков
// в разделе.
//
// Параметры:
//  ЧисловоеЗначение - число, необходимое для проверки.
//  КритическоеКолвоСимволов - кол-во квадратиков, в которое должно уместиться число.
//
// Возвращаемое значение:
//  Истина         - число умещается,
//  Ложь           - число не умещается.
//
Функция ЧислоУмещается(Знач ЧисловоеЗначение, Знач КритическоеКолвоСимволов)

	ПервоначальноеЗначениеСтр = Формат(ЧисловоеЗначение, мСтрокаФормата + ";ЧГ=0");
	Если СтрДлина(ПервоначальноеЗначениеСтр) > КритическоеКолвоСимволов Тогда
		Возврат Ложь;
	Иначе
		Возврат Истина;
	КонецЕсли;

КонецФункции // ЧислоУмещается

// Выполняет расчет вычисляемых показателей на заданной странице отчета
// (ячеек, выделенных зеленым цветом). 
// В случае неуказания листа, ничего происходить не будет.
//
// Параметры:
//  ИмяТекущейСтраницыПанели - строка, имя страницы основной панели формы.
//
Процедура Расчет(ИмяТекущейСтраницыПанели = "") Экспорт

	Если ФлажокОтклАвтоРасчет Или мРежимПечати Тогда
		Возврат;
	КонецЕсли;

	Если ИмяТекущейСтраницыПанели = "Расчет" Тогда

		// Расчет строки 030.
		мСтруктураПеременных.СуммаБезЛьготРасчет = ОкруглитьЧислоПоФормату(мСтруктураПеременных.СуммаСтрока31)
		                                         + ОкруглитьЧислоПоФормату(мСтруктураПеременных.СуммаСтрока32)
		                                         + ОкруглитьЧислоПоФормату(мСтруктураПеременных.СуммаСтрока33)
		                                         + ОкруглитьЧислоПоФормату(мСтруктураПеременных.СуммаСтрока34)
		                                         + ОкруглитьЧислоПоФормату(мСтруктураПеременных.СуммаСтрока35)
		                                         + ОкруглитьЧислоПоФормату(мСтруктураПеременных.СуммаСтрока36)
		                                         + ОкруглитьЧислоПоФормату(мСтруктураПеременных.СуммаСтрока37)
		                                         + ОкруглитьЧислоПоФормату(мСтруктураПеременных.СуммаСтрока38)
		                                         + ОкруглитьЧислоПоФормату(мСтруктураПеременных.СуммаСтрока39);
		РегламентированнаяОтчетность.роПроставитьВКвадратыЗначения(ЭтаФорма, "Расчет", "СуммаБезЛьгот1_", 12, мСтруктураПеременных.СуммаБезЛьготРасчет, Истина);

		мСтруктураПеременных.СуммаПлатРасчет = Макс(ОкруглитьЧислоПоФормату(мСтруктураПеременных.СуммаБезЛьготРасчет)
		                                      - ОкруглитьЧислоПоФормату(мСтруктураПеременных.СуммаЗачетРасчет)
		                                      - ОкруглитьЧислоПоФормату(мСтруктураПеременных.СуммаЛьготОргСоцРасчет)
		                                      - ОкруглитьЧислоПоФормату(мСтруктураПеременных.СуммаЛьготОргРасчет), 0);

		РегламентированнаяОтчетность.роПроставитьВКвадратыЗначения(ЭтаФорма, "Расчет", "СуммаПлат1_", 12, мСтруктураПеременных.СуммаПлатРасчет, Истина);
	ИначеЕсли ИмяТекущейСтраницыПанели = "Раздел1" Тогда

		СтруктураГруппы1 = Неопределено;
		мСтруктураМногострочныхРазделов.Свойство(мИдГруппы1, СтруктураГруппы1);

		Счетчик = 0;
		Для Каждого Стр Из СтруктураГруппы1 Цикл
			Счетчик = Счетчик + 1;

			// Колонка 7. ПДВ = Мин(Колонка4, Колонка6)
			Стр.П000010001007 = Мин(Стр.П000010001004, Стр.П000010001006);
			мРаздел1.Области["П000010001007_" + Формат(Счетчик, "ЧГ=0")].Значение = Стр.П000010001007;

			// Колонка 8 = // Строка 090 = Мин(6-7, 5)
			Стр.П000010001008 = Мин(Стр.П000010001006 - Стр.П000010001007, Стр.П000010001005);
			мРаздел1.Области["П000010001008_" + Формат(Счетчик, "ЧГ=0")].Значение = Стр.П000010001008;

			// Колонка 9 = Колонка6 - Колонка7 - Колонка8
			Стр.П000010001009 = Стр.П000010001006 - Стр.П000010001007 - Стр.П000010001008;
			мРаздел1.Области["П000010001009_" + Формат(Счетчик, "ЧГ=0")].Значение = Стр.П000010001009;

			Стр.П000010001017 = Стр.П000010001007 * Стр.П000010001010 * Стр.П000010001013 * Стр.П000010001014 * ?(Стр.П000010001015 = 0, 1, Стр.П000010001015) * Стр.П000010001016;
			Стр.П000010001018 = Стр.П000010001008 * Стр.П000010001011 * Стр.П000010001013 * Стр.П000010001014 * ?(Стр.П000010001015 = 0, 1, Стр.П000010001015) * Стр.П000010001016;
			Стр.П000010001019 = Стр.П000010001009 * Стр.П000010001011 * 5 * Стр.П000010001013 * Стр.П000010001014 * ?(Стр.П000010001015 = 0, 1, Стр.П000010001015) * Стр.П000010001016;

			Стр.П000010001020 = Стр.П000010001017
			                  + Стр.П000010001018
			                  + Стр.П000010001019;

			мРаздел1.Области["П000010001017_" + Формат(Счетчик, "ЧГ=0")].Значение = ОкруглитьЧислоПоФормату(Стр.П000010001017);
			мРаздел1.Области["П000010001018_" + Формат(Счетчик, "ЧГ=0")].Значение = ОкруглитьЧислоПоФормату(Стр.П000010001018);
			мРаздел1.Области["П000010001019_" + Формат(Счетчик, "ЧГ=0")].Значение = ОкруглитьЧислоПоФормату(Стр.П000010001019);
			мРаздел1.Области["П000010001020_" + Формат(Счетчик, "ЧГ=0")].Значение = ОкруглитьЧислоПоФормату(Стр.П000010001020);

		КонецЦикла;

		мРаздел1.Области.П000010002017.Значение = РасчетСуммМногострочнойЧасти("П000010001017", 17);
		мРаздел1.Области.П000010002018.Значение = РасчетСуммМногострочнойЧасти("П000010001018", 18);
		мРаздел1.Области.П000010002019.Значение = РасчетСуммМногострочнойЧасти("П000010001019", 19);
		мРаздел1.Области.П000010002020.Значение = РасчетСуммМногострочнойЧасти("П000010001020", 20);

	ИначеЕсли ИмяТекущейСтраницыПанели = "Раздел2" Тогда

		СтруктураГруппы2 = Неопределено;
		мСтруктураМногострочныхРазделов.Свойство(мИдГруппы2, СтруктураГруппы2);

		Счетчик = 0;
		Для Каждого Стр Из СтруктураГруппы2 Цикл
			Счетчик = Счетчик + 1;

			Итог10 = Стр.П000020001003 * Стр.П000020001005 * Стр.П000020001006 * Стр.П000020001007 * ?(Стр.П000020001008 = 0, 1, Стр.П000020001008) * Стр.П000020001009;

			Стр.П000020001010 = Итог10;
			мРаздел2.Области["П000020001010_" + Формат(Счетчик, "ЧГ=0")].Значение = ОкруглитьЧислоПоФормату(Стр.П000020001010);

		КонецЦикла;

		мРаздел2.Области.П000020002010.Значение = РасчетСуммМногострочнойЧасти("П000020001010", 10);

	ИначеЕсли ИмяТекущейСтраницыПанели = "Раздел3" Тогда
		
		СтруктураГруппы3 = Неопределено;
		мСтруктураМногострочныхРазделов.Свойство(мИдГруппы3, СтруктураГруппы3);

		Счетчик = 0;
		Для Каждого Стр Из СтруктураГруппы3 Цикл
			Счетчик = Счетчик + 1;
			СчетчикСтр = Формат(Счетчик, "ЧГ=0");

			// Колонка 6 = Мин(3, 5)
			Стр.П000030001006 = Мин(Стр.П000030001003, Стр.П000030001005);
			мРаздел3.Области["П000030001006_" + СчетчикСтр].Значение = Стр.П000030001006;

			// Колонка 7 = Мин(5-6, 4)
			Стр.П000030001007 = Мин(Стр.П000030001005 - Стр.П000030001006, Стр.П000030001004);
			мРаздел3.Области["П000030001007_" + СчетчикСтр].Значение = Стр.П000030001007;

			// Колонка 8 = 5-6-7
			Стр.П000030001008 = Макс(Стр.П000030001005 - Стр.П000030001006 - Стр.П000030001007,0);
			мРаздел3.Области["П000030001008_" + СчетчикСтр].Значение = Стр.П000030001008;

			Стр.П000030001016 = Стр.П000030001006 * Стр.П000030001009 * Стр.П000030001012 * Стр.П000030001013 * Стр.П000030001014 * Стр.П000030001015;
			Стр.П000030001017 = Стр.П000030001007 * Стр.П000030001010 * Стр.П000030001012 * Стр.П000030001013 * Стр.П000030001014 * Стр.П000030001015;
			Стр.П000030001018 = Стр.П000030001008 * Стр.П000030001010 * 5 * Стр.П000030001012 * Стр.П000030001013 * Стр.П000030001014 * Стр.П000030001015;

			Стр.П000030001019 = Стр.П000030001016
			                  + Стр.П000030001017
			                  + Стр.П000030001018;

			мРаздел3.Области["П000030001016_" + СчетчикСтр].Значение = ОкруглитьЧислоПоФормату(Стр.П000030001016);
			мРаздел3.Области["П000030001017_" + СчетчикСтр].Значение = ОкруглитьЧислоПоФормату(Стр.П000030001017);
			мРаздел3.Области["П000030001018_" + СчетчикСтр].Значение = ОкруглитьЧислоПоФормату(Стр.П000030001018);
			мРаздел3.Области["П000030001019_" + СчетчикСтр].Значение = ОкруглитьЧислоПоФормату(Стр.П000030001019);

		КонецЦикла;

		мРаздел3.Области.П000030002019.Значение = РасчетСуммМногострочнойЧасти("П000030001019", 19);

		мРаздел3.Области.П000030002016.Значение = РасчетСуммМногострочнойЧасти("П000030001016", 16);
		мРаздел3.Области.П000030002017.Значение = РасчетСуммМногострочнойЧасти("П000030001017", 17);
		мРаздел3.Области.П000030002018.Значение = РасчетСуммМногострочнойЧасти("П000030001018", 18);

	ИначеЕсли ИмяТекущейСтраницыПанели = "Раздел4" Тогда

		//нет расчета
		
	ИначеЕсли ИмяТекущейСтраницыПанели = "Раздел5" Тогда

		СтруктураГруппы4 = Неопределено;
		мСтруктураМногострочныхРазделов.Свойство(мИдГруппы4, СтруктураГруппы4);

		СтруктураГруппы5 = Неопределено;
		мСтруктураМногострочныхРазделов.Свойство(мИдГруппы5, СтруктураГруппы5);

		Счетчик = 0;

		Для Каждого Стр Из СтруктураГруппы5 Цикл
			Счетчик = Счетчик + 1;
			СчетчикСтр = Формат(Счетчик, "ЧГ=0");

			// Колонка 15.
			Стр.П000050001015 = Макс(СтруктураГруппы4[Счетчик - 1].П000040001009
								   + СтруктураГруппы4[Счетчик - 1].П000040001010 
								   - СтруктураГруппы4[Счетчик - 1].П000040001011
								   - СтруктураГруппы4[Счетчик - 1].П000040001012 
								   - СтруктураГруппы4[Счетчик - 1].П000040001013
			                       - СтруктураГруппы4[Счетчик - 1].П000040001014, 0);
			мРаздел5.Области["П000050001015_" + СчетчикСтр].Значение = Стр.П000050001015;

			// Колонка 25
			Стр.П000050001025 = Макс(ОкруглитьЧислоПоФормату((Стр.П000050001016
															-Стр.П000050001018)
															*Стр.П000050001019
															*Стр.П000050001021
															*Стр.П000050001022
															*Стр.П000050001023
															*Стр.П000050001024),0);
			мРаздел5.Области["П000050001025_" + СчетчикСтр].Значение = Стр.П000050001025;
			
			// Колонка 26
			Стр.П000050001026 = ОкруглитьЧислоПоФормату(Стр.П000050001017
													   *Стр.П000050001019
													   *Стр.П000050001020
													   *Стр.П000050001021
													   *Стр.П000050001022
													   *Стр.П000050001023
													   *Стр.П000050001024);
			мРаздел5.Области["П000050001026_" + СчетчикСтр].Значение = Стр.П000050001026;
			
			// Колонка 27
			Стр.П000050001027 = ОкруглитьЧислоПоФормату(Стр.П000050001025)
							   +ОкруглитьЧислоПоФормату(Стр.П000050001026);
			мРаздел5.Области["П000050001027_" + СчетчикСтр].Значение = Стр.П000050001027;

		КонецЦикла;
		мРаздел5.Области.П000050002025.Значение = РасчетСуммМногострочнойЧасти("П000050001025", 11);
		мРаздел5.Области.П000050002026.Значение = РасчетСуммМногострочнойЧасти("П000050001026", 12);
		мРаздел5.Области.П000050002027.Значение = РасчетСуммМногострочнойЧасти("П000050001027", 13);

	Иначе
		Расчет("Расчет");
		Расчет("Раздел5");
		Расчет("Раздел4");
		Расчет("Раздел3");
		Расчет("Раздел2");
		Расчет("Раздел1");
	КонецЕсли;

КонецПроцедуры // Расчет()

// УстановитьТочностьДляПДВ
//
Процедура УстановитьТочностьДляПДВ()
	Тип20_10 = Новый ОписаниеТипов("Число", Новый КвалификаторыЧисла(20, 10));
	Для Инд = 1 По 16 Цикл
		// Раздел 1.
		мРаздел1.Области["П000010001004_" + Строка(Инд)].ТипЗначения = Тип20_10;
		мРаздел1.Области["П000010001005_" + Строка(Инд)].ТипЗначения = Тип20_10;
		мРаздел1.Области["П000010001006_" + Строка(Инд)].ТипЗначения = Тип20_10;
		мРаздел1.Области["П000010001007_" + Строка(Инд)].ТипЗначения = Тип20_10;
		мРаздел1.Области["П000010001008_" + Строка(Инд)].ТипЗначения = Тип20_10;
		мРаздел1.Области["П000010001009_" + Строка(Инд)].ТипЗначения = Тип20_10;
        // Раздел 2.
		мРаздел2.Области["П000020001003_" + Строка(Инд)].ТипЗначения = Тип20_10;
        // Раздел 3.
		мРаздел3.Области["П000030001003_" + Строка(Инд)].ТипЗначения = Тип20_10;
		мРаздел3.Области["П000030001004_" + Строка(Инд)].ТипЗначения = Тип20_10;
		мРаздел3.Области["П000030001005_" + Строка(Инд)].ТипЗначения = Тип20_10;
		мРаздел3.Области["П000030001006_" + Строка(Инд)].ТипЗначения = Тип20_10;
		мРаздел3.Области["П000030001007_" + Строка(Инд)].ТипЗначения = Тип20_10;
		мРаздел3.Области["П000030001008_" + Строка(Инд)].ТипЗначения = Тип20_10;
        // Раздел 4.
		мРаздел4.Области["П000040001006_" + Строка(Инд)].ТипЗначения = Тип20_10;
		мРаздел4.Области["П000040001007_" + Строка(Инд)].ТипЗначения = Тип20_10;
		мРаздел4.Области["П000040001008_" + Строка(Инд)].ТипЗначения = Тип20_10;
		мРаздел4.Области["П000040001009_" + Строка(Инд)].ТипЗначения = Тип20_10;
		мРаздел4.Области["П000040001010_" + Строка(Инд)].ТипЗначения = Тип20_10;
		мРаздел4.Области["П000040001011_" + Строка(Инд)].ТипЗначения = Тип20_10;
		мРаздел4.Области["П000040001012_" + Строка(Инд)].ТипЗначения = Тип20_10;
		мРаздел4.Области["П000040001013_" + Строка(Инд)].ТипЗначения = Тип20_10;
		мРаздел4.Области["П000040001014_" + Строка(Инд)].ТипЗначения = Тип20_10;
        // Раздел 5.
		мРаздел5.Области["П000050001015_" + Строка(Инд)].ТипЗначения = Тип20_10;
		мРаздел5.Области["П000050001016_" + Строка(Инд)].ТипЗначения = Тип20_10;
		мРаздел5.Области["П000050001017_" + Строка(Инд)].ТипЗначения = Тип20_10;
		мРаздел5.Области["П000050001018_" + Строка(Инд)].ТипЗначения = Тип20_10;
	КонецЦикла;

КонецПроцедуры // УстановитьТочностьДляПДВ

// Инициализация
//
Процедура Инициализация(БезОткрытияФормы = Ложь) Экспорт
	Перем ИсходноеКоличествоСтрокГруппы;

	мБезОткрытияФормы = БезОткрытияФормы;

	// формируем список элементов подменю, связанное с кнопкой <Печать>
	ЭлементМеню = ЭлементыФормы.КоманднаяПанельДействий.Кнопки.ПодменюПечати;

	ЭлементМеню.Кнопки.Добавить("ПечататьСразу", ТипКнопкиКоманднойПанели.Действие,
	                            "Печатать сразу", Новый Действие("КоманднаяПанельДействийДействиеВыбратьПечатнуюФормы"));

	ЭлементМеню.Кнопки.Добавить("ПоказатьБланк", ТипКнопкиКоманднойПанели.Действие,
	                            "Показать бланк", Новый Действие("КоманднаяПанельДействийДействиеВыбратьПечатнуюФормы"));

	// Объявим структуру для хранения представлений.
	мСтруктураПеременных = Новый Структура;

	// выполняем начальные настройки
	ЗаполнитьНачальныеНастройки();
	
	// ФормируемСтруктуруСтраницОтчета
	ФормироватьСтруктуруСтраницОтчета();

	ФормироватьСтруктуруСвойствСтраниц();

	мТитульный      = ЭлементыФормы.ПолеТабличногоДокументаТитульный;
	мРасчет        = ЭлементыФормы.ПолеТабличногоДокументаРасчет;
	мРаздел1        = ЭлементыФормы.ПолеТабличногоДокументаРаздел1;
	мРаздел2        = ЭлементыФормы.ПолеТабличногоДокументаРаздел2;
	мРаздел3        = ЭлементыФормы.ПолеТабличногоДокументаРаздел3;
	мРаздел4        = ЭлементыФормы.ПолеТабличногоДокументаРаздел4;
	мРаздел5        = ЭлементыФормы.ПолеТабличногоДокументаРаздел5;

	ВидДокумента = 0;
	ЭлементыФормы.НомерКорректировки.Доступность = (ВидДокумента = 1);
	НомерКорректировки = 1;

	// ФлОтклВыборЗначений
	мАвтоВыборКодов = Ложь;

	Если НЕ БезОткрытияФормы Тогда

		РегламентированнаяОтчетность.СформироватьСоставКнопкиОчиститьДляРегОтчетов(ЭтаФорма);
		ЗагрузитьПоказателиИзМакета("КодыКБК2005");
		ЗагрузитьПоказателиИзМакета("КБК_2012Кв1");
		ЗагрузитьПоказателиИзМакета("РасположениеОбъекта");
		ЗагрузитьПоказателиИзМакета("ДополнительныйКоэф12");
		ЗагрузитьПоказателиИзМакета("КЭЗ_Раздел1");
		ЗагрузитьПоказателиИзМакета("КЭЗ_ВодныеОбъекты");
		ЗагрузитьПоказателиИзМакета("КлассыОпасности");
		ЗагрузитьПоказателиИзМакета("ЭкологическийКлассРаздел2");
		ЗагрузитьПоказателиИзМакета("НормативыПлатыРаздел2");
		ЗагрузитьПоказателиИзМакета("ВредныеВеществаРаздел1");
		ЗагрузитьПоказателиИзМакета("ВредныеВеществаРаздел3");
		ЗагрузитьПоказателиИзМакета("ФКТОРаздел4");
		ЗагрузитьПоказателиИзМакета("КоэфИнфляция");
		ЗагрузитьПоказателиИзМакета("КЭЗ_Раздел4");
		ЗагрузитьПоказателиИзМакета("ДопКоэфТЗ");

		// Установим маски на ввод только чисел.
		РегламентированнаяОтчетность.СтандратныеОперацииПоУстановкамМасок(ЭтаФорма);

	КонецЕсли;
	УстановитьТочностьДляПДВ();

	// Данная операция должна выполняться и при открытии отчета и при печати не открывая,
	// т.к.она инициализирует структуру переменных мСтруктураПеременных.
	РегламентированнаяОтчетность.роОбнулитьПеременныеМодуляХранящиеЗначенияКвадратногоПредставления(ЭтаФорма);
                                                     
	// для обновления листа о ФЛ, если Истина, то обновлять перезаписывать данные на листе
	мВПрограммеИзмененаОрганизация = Ложь;
	мДокументВосстановлен = Ложь;
	мРежимПечати = Ложь;

	Если мСохраненныйДок = Неопределено Тогда

		// создаем исходную структуру многострочных разделов
		Для Каждого ЭлементСтруктуры Из мСтруктураМногострочныхРазделов Цикл
			ИмяГруппы = ЭлементСтруктуры.Ключ;
			СтруктураГруппы = ЭлементСтруктуры.Значение;

			ТекТабличноеПоле = ОпределитьТабличноеПолеПоИдМногострочногоРаздела(ИмяГруппы);

			мСтруктураИсхКолвоСтрокРазделов.Свойство(ИмяГруппы, ИсходноеКоличествоСтрокГруппы);

			Для НСтр = 1 По  ИсходноеКоличествоСтрокГруппы Цикл

				СтрокаГруппы = СтруктураГруппы.Добавить();

				Для Каждого Колонка Из СтруктураГруппы.Колонки Цикл

					ИмяКолонки    = Колонка.Имя;
					КодПоказателя = ИмяКолонки + "_" + Формат(НСтр, "ЧГ=0");
					ОбластьЯчейки = ТекТабличноеПоле.Области[КодПоказателя];

					Если ОбластьЯчейки.СодержитЗначение = Истина Тогда
						ЗначениеЯчейки = ОбластьЯчейки.Значение;
					Иначе
						ЗначениеЯчейки = ОбластьЯчейки.Текст;
					КонецЕсли;

					СтрокаГруппы[ИмяКолонки] = ЗначениеЯчейки;

				КонецЦикла;
			КонецЦикла;
		КонецЦикла;

		Если мСкопированаФорма <> Неопределено Тогда
			// документ скопирован
			ВосстановитьСохраненныеДанные();
		Иначе
			// Это новый документ.
			// Установим реквизиты формы по умолчанию
			ЕдиницаИзмерения         = Перечисления.ПорядкиОкругленияОтчетности.Окр1;
			ТочностьЕдиницыИзмерения = 2;

			мТитульный.Области.ВидДок.Значение = "V";

			// По умолчанию - выбраны все листы
			// при восстановлении - сохраненные ранее
			мДеревоВыбранныхСтраниц = мДеревоСтраницОтчета.Скопировать();
			РегламентированнаяОтчетность.роУстановитьФорматВывода(ЭтаФорма);
		КонецЕсли;

	Иначе
		// При открытии или при копировании сохраненного
		// отчета восстанавливаем сохраненные данные.
		ВосстановитьСохраненныеДанные();

	КонецЕсли;

	ПоказатьПериод();

	Если мСохраненныйДок = Неопределено Или мВПрограммеИзмененаОрганизация Тогда
		ЗаполнитьСведенияОбОрганизации();
	Иначе
		УправлениеЛистами();
	КонецЕсли;

	// устанавливаем раскраску ячеек, участвующих в автозаполнении
	Для Каждого СтрокаУровня1 Из мСвойстваРазделовДекларации.Строки Цикл
		// Считываем название раздела и его свойство в системе автозаполнения
		НазваниеСтраницы           = СтрокаУровня1.ИмяСтраницы;
		МногостраничностьВРазделе  = СтрокаУровня1.МногостраничностьВРазделе;

		// Пропустим титульный лист, физлица, т.к. они не входят в систему автозаполнения
		Если НазваниеСтраницы = "Титульный" Тогда

			Продолжить;

		КонецЕсли;

		// Если док-т восстановлен и многостраничный, то пропустим установку цветности, т.к. при восстановлении многостраничного раздела
		// цветность проставляется, чтобы дважды не выполнялся код, поставим ограничение
		Если (мДокументВосстановлен) И (МногостраничностьВРазделе) Тогда

			Продолжить;

		КонецЕсли;

		УстановитьЦветФонаЯчейки(,, НазваниеСтраницы);

	КонецЦикла;

	РегламентированнаяОтчетность.ПриИнициализацииФормыРегламентированногоОтчета(ЭтаФорма);
	
КонецПроцедуры // Инициализация

// ЗаполнитьАвто
//
Процедура ЗаполнитьАвто();
	
	РегламентированнаяОтчетность.роОбновитьСтруктуруМногостраничныхРазделов(ЭтаФорма);
	
	ТаблДанных= Новый ТаблицаЗначений;
	ТаблДанных.Колонки.Добавить("КодОКАТО");
	ТаблДанных.Колонки.Добавить("СуммаПДВ");
	ТаблДанных.Колонки.Добавить("СуммаВСВ");
	ТаблДанных.Колонки.Добавить("СуммаСверхЛимВыброс");
	ТаблДанных.Колонки.Добавить("СуммаПлатыОтПередвижногоОбъекта");
	ТаблДанных.Колонки.Добавить("СуммаПДС");
	ТаблДанных.Колонки.Добавить("СуммаВСС");
	ТаблДанных.Колонки.Добавить("СуммаСверхЛимСброс");
	ТаблДанных.Колонки.Добавить("СуммаУстанЛимит");
	ТаблДанных.Колонки.Добавить("СуммаСверхЛимит");
	
	// Сбор данных по разделу 1. Заполняемые строки в расчете - 031, 032, 033.
	Для каждого Экз Из мСтруктураМногостраничныхРазделов.Раздел1 Цикл
		ОКАТО = Экз.Данные.ОКАТО1 + Экз.Данные.ОКАТО2 + Экз.Данные.ОКАТО3 + Экз.Данные.ОКАТО4 + Экз.Данные.ОКАТО5
		+ Экз.Данные.ОКАТО6 + Экз.Данные.ОКАТО7 + Экз.Данные.ОКАТО8 + Экз.Данные.ОКАТО9 + Экз.Данные.ОКАТО10 + Экз.Данные.ОКАТО11;
		ОКАТО = СокрЛП(ОКАТО);
		Если ПустаяСтрока(ОКАТО) Тогда
			ОКАТО = "";
		КонецЕсли;
		
		НовСтр = ТаблДанных.Добавить();
		
		НовСтр.КодОКАТО 			= ОКАТО;
		НовСтр.СуммаПДВ 			= Экз.Данные.П000010002017;
		НовСтр.СуммаВСВ 			= Экз.Данные.П000010002018;
		НовСтр.СуммаСверхЛимВыброс 	= Экз.Данные.П000010002019;
	КонецЦикла;
	
	// Сбор данных по разделу 2. Заполняемые строки в расчете 034
	Для каждого Экз Из мСтруктураМногостраничныхРазделов.Раздел2 Цикл
		ОКАТО = Экз.Данные.ОКАТО1 + Экз.Данные.ОКАТО2 + Экз.Данные.ОКАТО3 + Экз.Данные.ОКАТО4 + Экз.Данные.ОКАТО5
		+ Экз.Данные.ОКАТО6 + Экз.Данные.ОКАТО7 + Экз.Данные.ОКАТО8 + Экз.Данные.ОКАТО9 + Экз.Данные.ОКАТО10 + Экз.Данные.ОКАТО11;
		ОКАТО = СокрЛП(ОКАТО);
		Если ПустаяСтрока(ОКАТО) Тогда
			ОКАТО = "";
		КонецЕсли;
		
		НовСтр = ТаблДанных.Добавить();
		
		НовСтр.КодОКАТО 						= ОКАТО;
		НовСтр.СуммаПлатыОтПередвижногоОбъекта	= Экз.Данные.П000020002010;
	КонецЦикла;
	
	// Сбор данных по разделу 3. Заполняемые строки в расчете 035, 036, 037.
	Для каждого Экз Из мСтруктураМногостраничныхРазделов.Раздел3 Цикл
		ОКАТО = Экз.Данные.ОКАТО1 + Экз.Данные.ОКАТО2 + Экз.Данные.ОКАТО3 + Экз.Данные.ОКАТО4 + Экз.Данные.ОКАТО5
		+ Экз.Данные.ОКАТО6 + Экз.Данные.ОКАТО7 + Экз.Данные.ОКАТО8 + Экз.Данные.ОКАТО9 + Экз.Данные.ОКАТО10 + Экз.Данные.ОКАТО11;
		ОКАТО = СокрЛП(ОКАТО);
		Если ПустаяСтрока(ОКАТО) Тогда
			ОКАТО = "";
		КонецЕсли;
		
		НовСтр = ТаблДанных.Добавить();
		
		НовСтр.КодОКАТО 			= ОКАТО;
		НовСтр.СуммаПДС 			= Экз.Данные.П000030002016;
		НовСтр.СуммаВСС 			= Экз.Данные.П000030002017;
		НовСтр.СуммаСверхЛимСброс 	= Экз.Данные.П000030002018;
	КонецЦикла;
	
	// Сбор данных по разделу 4 и 5. Заполняемые строки в расчете 038, 039.
	Для каждого Экз Из мСтруктураМногостраничныхРазделов.Раздел4 Цикл
		ОКАТО = Экз.Данные.ОКАТО1 + Экз.Данные.ОКАТО2 + Экз.Данные.ОКАТО3 + Экз.Данные.ОКАТО4 + Экз.Данные.ОКАТО5
		+ Экз.Данные.ОКАТО6 + Экз.Данные.ОКАТО7 + Экз.Данные.ОКАТО8 + Экз.Данные.ОКАТО9 + Экз.Данные.ОКАТО10 + Экз.Данные.ОКАТО11;
		ОКАТО = СокрЛП(ОКАТО);
		Если ПустаяСтрока(ОКАТО) Тогда
			ОКАТО = "";
		КонецЕсли;
		
		НовСтр = ТаблДанных.Добавить();
		
		НовСтр.КодОКАТО 		= ОКАТО;
		
		ИндексСтр = мСтруктураМногостраничныхРазделов.Раздел4.Индекс(Экз);
		НовСтр.СуммаУстанЛимит	= мСтруктураМногостраничныхРазделов.Раздел5[ИндексСтр].Данные.П000050002025;
		НовСтр.СуммаСверхЛимит	= мСтруктураМногостраничныхРазделов.Раздел5[ИндексСтр].Данные.П000050002026;
	КонецЦикла;	
	
	ТаблДанных.Свернуть("КодОКАТО", "СуммаПДВ, СуммаВСВ, СуммаСверхЛимВыброс, СуммаПлатыОтПередвижногоОбъекта, СуммаПДС, СуммаВСС, СуммаСверхЛимСброс, СуммаУстанЛимит, СуммаСверхЛимит");
	
	// Обеспечим заполнение листа Расчет в отчете.
	
	// Удалим страницы в экземпляре Расчет
	ТаблРасчет = Неопределено;
	мСтруктураМногостраничныхРазделов.Свойство("Расчет", ТаблРасчет);
	ИндексСтраницы = 0;
	Пока Не (ИндексСтраницы > (ТаблРасчет.Количество()-1)) Цикл
		СтрокаТаблицы = ТаблРасчет[ИндексСтраницы];
		Если НЕ СтрокаТаблицы.АктивнаяСтраница Тогда
			// удаляем дополнительную страницу
			ТаблРасчет.Удалить(СтрокаТаблицы);
			ИзменитьТаблицуПараметровАвтозаполнения(-1, "Расчет"); // Удалим варианты заполнения.
			Продолжить;
		КонецЕсли;
		ИндексСтраницы = ИндексСтраницы + 1;
	КонецЦикла;
	
	ОчиститьТабличноеПоле(мРасчет);
	РегламентированнаяОтчетность.роСохранитьДанныеМногостраничногоРазделаВактивнойСтранице(ЭтаФорма, "Расчет", Ложь);
	
	Если ДатаПодписи >= '20120101' Тогда
		КБК = ""; // с 2012 года невозможно определить КБК при автозаполнении
	Иначе
		КБК = "04811201000010000120";
	КонецЕсли;
	
	Для каждого Зап Из ТаблДанных Цикл
		Если ТаблДанных.Индекс(Зап) > 0 Тогда
			ИзменитьТаблицуПараметровАвтозаполнения(1, "Расчет");
			РегламентированнаяОтчетность.роВставитьДополнительнуюСтраницу(ЭтаФорма, "Расчет");
		КонецЕсли;
		
		мСтруктураПеременных.Вставить("КБКРасчет", КБК);
		РегламентированнаяОтчетность.роПроставитьВКвадратыЗначения(ЭтаФорма, "Расчет", "КБК1_", 20, КБК);
		
		РегламентированнаяОтчетность.роПроставитьВКвадратыЗначения(ЭтаФорма, "Расчет", "ОКАТО1_", 11, Зап.КодОКАТО);
		мСтруктураПеременных.ОКАТОРасчет = Зап.КодОКАТО;
		
		Если ЧислоУмещается(Зап.СуммаПДВ, 12) Тогда
			мСтруктураПеременных.СуммаСтрока31 = Зап.СуммаПДВ;
		КонецЕсли;
		
		Если ЧислоУмещается(Зап.СуммаВСВ, 12) Тогда
			мСтруктураПеременных.СуммаСтрока32 = Зап.СуммаВСВ;
		КонецЕсли;
		
		Если ЧислоУмещается(Зап.СуммаСверхЛимВыброс, 12) Тогда
			мСтруктураПеременных.СуммаСтрока33 = Зап.СуммаСверхЛимВыброс;
		КонецЕсли;
		
		Если ЧислоУмещается(Зап.СуммаПлатыОтПередвижногоОбъекта, 12) Тогда
			мСтруктураПеременных.СуммаСтрока34 = Зап.СуммаПлатыОтПередвижногоОбъекта;
		КонецЕсли;
		
		Если ЧислоУмещается(Зап.СуммаПДС, 12) Тогда
			мСтруктураПеременных.СуммаСтрока35 = Зап.СуммаПДС;
		КонецЕсли;
		
		Если ЧислоУмещается(Зап.СуммаВСС, 12) Тогда
			мСтруктураПеременных.СуммаСтрока36 = Зап.СуммаВСС;
		КонецЕсли;
		
		Если ЧислоУмещается(Зап.СуммаСверхЛимСброс, 12) Тогда
			мСтруктураПеременных.СуммаСтрока37 = Зап.СуммаСверхЛимСброс;
		КонецЕсли;
		
		Если ЧислоУмещается(Зап.СуммаУстанЛимит, 12) Тогда
			мСтруктураПеременных.СуммаСтрока38 = Зап.СуммаУстанЛимит;
		КонецЕсли;
		
		Если ЧислоУмещается(Зап.СуммаСверхЛимит, 12) Тогда
			мСтруктураПеременных.СуммаСтрока39 = Зап.СуммаСверхЛимит;
		КонецЕсли;
		
		Расчет("Расчет");
		ЗаполнениеЗначенийВКвадратиках("Расчет");
	КонецЦикла;
	
	Расчет("Расчет");
	
	Модифицированность = Истина;
	
КонецПроцедуры 

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

// КоманднаяПанельФормыЗаполнить
//
Процедура КоманднаяПанельФормыЗаполнить(Кнопка)
	ЗаполнитьАвто();
КонецПроцедуры // КоманднаяПанельФормыЗаполнить

// КнопкаПерейтиНаСтраницуРаздел1Нажатие
//
Процедура КнопкаПерейтиНаСтраницуРаздел1Нажатие(Элемент)

	РегламентированнаяОтчетность.роОткрытьФормуСпискаДопСтраниц(ЭтаФорма, "Раздел1");

КонецПроцедуры // КнопкаПерейтиНаСтраницуРаздел1Нажатие

// КнопкаУдалитьДопСтраницуРаздел1Нажатие
//
Процедура КнопкаУдалитьДопСтраницуРаздел1Нажатие(Элемент)
	ИзменитьТаблицуПараметровАвтозаполнения(-1, "Раздел1");
	РегламентированнаяОтчетность.роУдалитьДополнительнуюСтраницу(ЭтаФорма, "Раздел1");
КонецПроцедуры // КнопкаУдалитьДопСтраницуРаздел1Нажатие

// КнопкаДобавитьДопСтраницуРаздел1Нажатие
//
Процедура КнопкаДобавитьДопСтраницуРаздел1Нажатие(Элемент)
	ИзменитьТаблицуПараметровАвтозаполнения(1, "Раздел1");
	РегламентированнаяОтчетность.роВставитьДополнительнуюСтраницу(ЭтаФорма, "Раздел1");
КонецПроцедуры // КнопкаДобавитьДопСтраницуРаздел1Нажатие

// КнопкаСледующаяСтраницаРаздел1Нажатие
//
Процедура КнопкаСледующаяСтраницаРаздел1Нажатие(Элемент)
	ПоказатьСтраницуМногостраничногоРаздела(1, "Раздел1");
КонецПроцедуры // КнопкаСледующаяСтраницаРаздел1Нажатие

// КнопкаПредыдущаяСтраницаРаздел1Нажатие
//
Процедура КнопкаПредыдущаяСтраницаРаздел1Нажатие(Элемент)
	ПоказатьСтраницуМногостраничногоРаздела(-1, "Раздел1");
КонецПроцедуры // КнопкаПредыдущаяСтраницаРаздел1Нажатие

// КнопкаПерейтиНаСтраницуРаздел2Нажатие
//
Процедура КнопкаПерейтиНаСтраницуРаздел2Нажатие(Элемент)

	РегламентированнаяОтчетность.роОткрытьФормуСпискаДопСтраниц(ЭтаФорма, "Раздел2");

КонецПроцедуры // КнопкаПерейтиНаСтраницуРаздел2Нажатие

// КнопкаУдалитьДопСтраницуРаздел2Нажатие
//
Процедура КнопкаУдалитьДопСтраницуРаздел2Нажатие(Элемент)
	ИзменитьТаблицуПараметровАвтозаполнения(-1, "Раздел2");
	РегламентированнаяОтчетность.роУдалитьДополнительнуюСтраницу(ЭтаФорма, "Раздел2");
КонецПроцедуры // КнопкаУдалитьДопСтраницуРаздел2Нажатие

// КнопкаДобавитьДопСтраницуРаздел2Нажатие
//
Процедура КнопкаДобавитьДопСтраницуРаздел2Нажатие(Элемент)
	ИзменитьТаблицуПараметровАвтозаполнения(1, "Раздел2");
	РегламентированнаяОтчетность.роВставитьДополнительнуюСтраницу(ЭтаФорма, "Раздел2");
КонецПроцедуры // КнопкаДобавитьДопСтраницуРаздел2Нажатие

// КнопкаСледующаяСтраницаРаздел2Нажатие
//
Процедура КнопкаСледующаяСтраницаРаздел2Нажатие(Элемент)
	ПоказатьСтраницуМногостраничногоРаздела(1, "Раздел2");
КонецПроцедуры // КнопкаСледующаяСтраницаРаздел2Нажатие

// КнопкаПредыдущаяСтраницаРаздел2Нажатие
//
Процедура КнопкаПредыдущаяСтраницаРаздел2Нажатие(Элемент)
	ПоказатьСтраницуМногостраничногоРаздела(-1, "Раздел2");
КонецПроцедуры // КнопкаПредыдущаяСтраницаРаздел2Нажатие

// КнопкаУдалитьДопСтрокиРаздел2Нажатие
//
Процедура КнопкаУдалитьДопСтрокиРаздел2Нажатие(Элемент)
	УдалитьДополнительнуюСтроку();
КонецПроцедуры // КнопкаУдалитьДопСтрокиРаздел2Нажатие

// КнопкаДобавитьДопСтрокиРаздел2Нажатие
//
Процедура КнопкаДобавитьДопСтрокиРаздел2Нажатие(Элемент)
	ВставитьДополнительнуюСтроку();
КонецПроцедуры // КнопкаДобавитьДопСтрокиРаздел2Нажатие

// КнопкаПерейтиНаСтраницуРаздел3Нажатие
//
Процедура КнопкаПерейтиНаСтраницуРаздел3Нажатие(Элемент)

	РегламентированнаяОтчетность.роОткрытьФормуСпискаДопСтраниц(ЭтаФорма, "Раздел3");

КонецПроцедуры // КнопкаПерейтиНаСтраницуРаздел3Нажатие

// КнопкаУдалитьДопСтраницуРаздел3Нажатие
//
Процедура КнопкаУдалитьДопСтраницуРаздел3Нажатие(Элемент)
	ИзменитьТаблицуПараметровАвтозаполнения(-1, "Раздел3");
	РегламентированнаяОтчетность.роУдалитьДополнительнуюСтраницу(ЭтаФорма, "Раздел3");
КонецПроцедуры // КнопкаУдалитьДопСтраницуРаздел3Нажатие

// КнопкаДобавитьДопСтраницуРаздел3Нажатие
//
Процедура КнопкаДобавитьДопСтраницуРаздел3Нажатие(Элемент)
	ИзменитьТаблицуПараметровАвтозаполнения(1, "Раздел3");
	РегламентированнаяОтчетность.роВставитьДополнительнуюСтраницу(ЭтаФорма, "Раздел3");
КонецПроцедуры // КнопкаДобавитьДопСтраницуРаздел3Нажатие

// КнопкаСледующаяСтраницаРаздел3Нажатие
//
Процедура КнопкаСледующаяСтраницаРаздел3Нажатие(Элемент)
	ПоказатьСтраницуМногостраничногоРаздела(1, "Раздел3");
КонецПроцедуры // КнопкаСледующаяСтраницаРаздел3Нажатие

// КнопкаПредыдущаяСтраницаРаздел3Нажатие
//
Процедура КнопкаПредыдущаяСтраницаРаздел3Нажатие(Элемент)
	ПоказатьСтраницуМногостраничногоРаздела(-1, "Раздел3");
КонецПроцедуры // КнопкаПредыдущаяСтраницаРаздел3Нажатие

// КнопкаУдалитьДопСтрокиРаздел3Нажатие
//
Процедура КнопкаУдалитьДопСтрокиРаздел3Нажатие(Элемент)
	УдалитьДополнительнуюСтроку();
КонецПроцедуры // КнопкаУдалитьДопСтрокиРаздел3Нажатие

// КнопкаДобавитьДопСтрокиРаздел3Нажатие
//
Процедура КнопкаДобавитьДопСтрокиРаздел3Нажатие(Элемент)
	ВставитьДополнительнуюСтроку();
КонецПроцедуры // КнопкаДобавитьДопСтрокиРаздел3Нажатие

// КнопкаПерейтиНаСтраницуРаздел4Нажатие
//
Процедура КнопкаПерейтиНаСтраницуРаздел4Нажатие(Элемент)

	ОткрытьФормуСпискаДопСтраниц("Раздел4");

КонецПроцедуры // КнопкаПерейтиНаСтраницуРаздел4Нажатие

// КнопкаУдалитьДопСтраницуРаздел4Нажатие
//
Процедура КнопкаУдалитьДопСтраницуРаздел4Нажатие(Элемент)
	ИзменитьТаблицуПараметровАвтозаполнения(-1, "Раздел4");
	РегламентированнаяОтчетность.роУдалитьДополнительнуюСтраницу(ЭтаФорма, "Раздел4");

	ИзменитьТаблицуПараметровАвтозаполнения(-1, "Раздел5");
	РегламентированнаяОтчетность.роУдалитьДополнительнуюСтраницу(ЭтаФорма, "Раздел5");

КонецПроцедуры // КнопкаУдалитьДопСтраницуРаздел4Нажатие

// КнопкаДобавитьДопСтраницуРаздел4Нажатие
//
Процедура КнопкаДобавитьДопСтраницуРаздел4Нажатие(Элемент)
	ИзменитьТаблицуПараметровАвтозаполнения(1, "Раздел4");
	РегламентированнаяОтчетность.роВставитьДополнительнуюСтраницу(ЭтаФорма, "Раздел4");

	ИзменитьТаблицуПараметровАвтозаполнения(1, "Раздел5");
	РегламентированнаяОтчетность.роВставитьДополнительнуюСтраницу(ЭтаФорма, "Раздел5");
КонецПроцедуры // КнопкаДобавитьДопСтраницуРаздел4Нажатие

// КнопкаСледующаяСтраницаРаздел4Нажатие
//
Процедура КнопкаСледующаяСтраницаРаздел4Нажатие(Элемент)
	ПоказатьСтраницуМногостраничногоРаздела(1, "Раздел4");
КонецПроцедуры // КнопкаСледующаяСтраницаРаздел4Нажатие

// КнопкаПредыдущаяСтраницаРаздел4Нажатие
//
Процедура КнопкаПредыдущаяСтраницаРаздел4Нажатие(Элемент)
	ПоказатьСтраницуМногостраничногоРаздела(-1, "Раздел4");
КонецПроцедуры // КнопкаПредыдущаяСтраницаРаздел4Нажатие

// КнопкаУдалитьДопСтрокиРаздел4Нажатие
//
Процедура КнопкаУдалитьДопСтрокиРаздел4Нажатие(Элемент)
	УдалитьДополнительнуюСтроку();
	УдалитьДополнительнуюСтрокуПарныхГрупп(мИдГруппы5, мРаздел5.ТекущаяОбласть.Имя);
КонецПроцедуры // КнопкаУдалитьДопСтрокиРаздел4Нажатие

// КнопкаДобавитьДопСтрокиРаздел4Нажатие
//
Процедура КнопкаДобавитьДопСтрокиРаздел4Нажатие(Элемент)
	ВставитьДополнительнуюСтроку();
	ВставитьДополнительнуюСтроку(мИдГруппы5, Истина);
КонецПроцедуры // КнопкаДобавитьДопСтрокиРаздел4Нажатие

// КнопкаПерейтиНаСтраницуРаздел5Нажатие
//
Процедура КнопкаПерейтиНаСтраницуРаздел5Нажатие(Элемент)

	ОткрытьФормуСпискаДопСтраниц("Раздел5");

КонецПроцедуры // КнопкаПерейтиНаСтраницуРаздел5Нажатие

// КнопкаУдалитьДопСтраницуРаздел5Нажатие
//
Процедура КнопкаУдалитьДопСтраницуРаздел5Нажатие(Элемент)
	ИзменитьТаблицуПараметровАвтозаполнения(-1, "Раздел5");
	РегламентированнаяОтчетность.роУдалитьДополнительнуюСтраницу(ЭтаФорма, "Раздел5");

	ИзменитьТаблицуПараметровАвтозаполнения(-1, "Раздел4");
	РегламентированнаяОтчетность.роУдалитьДополнительнуюСтраницу(ЭтаФорма, "Раздел4");
КонецПроцедуры // КнопкаУдалитьДопСтраницуРаздел5Нажатие

// КнопкаДобавитьДопСтраницуРаздел5Нажатие
//
Процедура КнопкаДобавитьДопСтраницуРаздел5Нажатие(Элемент)
	ИзменитьТаблицуПараметровАвтозаполнения(1, "Раздел5");
	РегламентированнаяОтчетность.роВставитьДополнительнуюСтраницу(ЭтаФорма, "Раздел5");

	ИзменитьТаблицуПараметровАвтозаполнения(1, "Раздел4");
	РегламентированнаяОтчетность.роВставитьДополнительнуюСтраницу(ЭтаФорма, "Раздел4");
	Расчет("Раздел5");
КонецПроцедуры // КнопкаДобавитьДопСтраницуРаздел5Нажатие

// КнопкаСледующаяСтраницаРаздел5Нажатие
//
Процедура КнопкаСледующаяСтраницаРаздел5Нажатие(Элемент)
	ПоказатьСтраницуМногостраничногоРаздела(1, "Раздел5");
КонецПроцедуры // КнопкаСледующаяСтраницаРаздел5Нажатие

// КнопкаПредыдущаяСтраницаРаздел5Нажатие
//
Процедура КнопкаПредыдущаяСтраницаРаздел5Нажатие(Элемент)
	ПоказатьСтраницуМногостраничногоРаздела(-1, "Раздел5");
КонецПроцедуры // КнопкаПредыдущаяСтраницаРаздел5Нажатие

// КнопкаУдалитьДопСтрокиРаздел5Нажатие
//
Процедура КнопкаУдалитьДопСтрокиРаздел5Нажатие(Элемент)
	УдалитьДополнительнуюСтроку();
	УдалитьДополнительнуюСтрокуПарныхГрупп(мИдГруппы4, мРаздел5.ТекущаяОбласть.Имя);
КонецПроцедуры // КнопкаУдалитьДопСтрокиРаздел5Нажатие

// КнопкаДобавитьДопСтрокиРаздел5Нажатие
//
Процедура КнопкаДобавитьДопСтрокиРаздел5Нажатие(Элемент)
	ВставитьДополнительнуюСтроку();
	ВставитьДополнительнуюСтроку(мИдГруппы4, Истина);
КонецПроцедуры // КнопкаДобавитьДопСтрокиРаздел5Нажатие

// ФлажокОтклАвтоРасчетПриИзменении
//
Процедура ФлажокОтклАвтоРасчетПриИзменении(Элемент)
	РегламентированнаяОтчетность.роИзменитьТаблицуВариантовЗаполнения(ЭтаФорма, НЕ ФлажокОтклАвтоРасчет);
КонецПроцедуры // ФлажокОтклАвтоРасчетПриИзменении

// КнопкаПерейтиНаСтраницуРасчетНажатие
//
Процедура КнопкаПерейтиНаСтраницуРасчетНажатие(Элемент)
	РегламентированнаяОтчетность.роОткрытьФормуСпискаДопСтраниц(ЭтаФорма, "Расчет");
КонецПроцедуры // КнопкаПерейтиНаСтраницуРасчетНажатие

// КнопкаУдалитьДопСтраницуРасчетНажатие
//
Процедура КнопкаУдалитьДопСтраницуРасчетНажатие(Элемент)
	ИзменитьТаблицуПараметровАвтозаполнения(-1, "Расчет");
	РегламентированнаяОтчетность.роУдалитьДополнительнуюСтраницу(ЭтаФорма, "Расчет");
КонецПроцедуры // КнопкаУдалитьДопСтраницуРасчетНажатие

// КнопкаДобавитьДопСтраницуРасчетНажатие
//
Процедура КнопкаДобавитьДопСтраницуРасчетНажатие(Элемент)
	ИзменитьТаблицуПараметровАвтозаполнения(1, "Расчет");
	РегламентированнаяОтчетность.роВставитьДополнительнуюСтраницу(ЭтаФорма, "Расчет");
КонецПроцедуры // КнопкаДобавитьДопСтраницуРасчетНажатие

// КнопкаСледующаяСтраницаРасчетНажатие
//
Процедура КнопкаСледующаяСтраницаРасчетНажатие(Элемент)
	ПоказатьСтраницуМногостраничногоРаздела(1, "Расчет");
КонецПроцедуры // КнопкаСледующаяСтраницаРасчетНажатие

// КнопкаПредыдущаяСтраницаРасчетНажатие
//
Процедура КнопкаПредыдущаяСтраницаРасчетНажатие(Элемент)
	ПоказатьСтраницуМногостраничногоРаздела(-1, "Расчет");
КонецПроцедуры // КнопкаПредыдущаяСтраницаРасчетНажатие

// ПолеТабличногоДокументаРаздел1ПриАктивизацииОбласти
//
Процедура ПолеТабличногоДокументаРаздел1ПриАктивизацииОбласти(Элемент)

	РегламентированнаяОтчетность.роПриАктивизацииОбластиРегламентированногоОтчета(ЭтаФорма, Элемент);

КонецПроцедуры // ПолеТабличногоДокументаРаздел1ПриАктивизацииОбласти

// ПолеТабличногоДокументаРаздел4ПриАктивизацииОбласти
//
Процедура ПолеТабличногоДокументаРаздел4ПриАктивизацииОбласти(Элемент)

	РегламентированнаяОтчетность.роПриАктивизацииОбластиРегламентированногоОтчета(ЭтаФорма, Элемент);

	Попытка
		// Определим номер активной строки, чтобы спозиционировать курсор в разделе 4, лист 2
		Если РегламентированнаяОтчетность.роРазделТекущейОбласти(ЭтаФорма, Элемент.ТекущаяОбласть) <> Неопределено Тогда
			ОбластьИмя = Элемент.ТекущаяОбласть.Имя;
			НомерСтроки = Сред(ОбластьИмя, 15);

			// Определим строку в разделе 5
			Если РегламентированнаяОтчетность.роРазделТекущейОбласти(ЭтаФорма, мРаздел5.ТекущаяОбласть) = Неопределено Тогда
				мРаздел5.ТекущаяОбласть = мРаздел5.Области["П000050001015_" + НомерСтроки];
			Иначе
				ОбластьИмяРаздел5 = мРаздел5.ТекущаяОбласть.Имя;
				НомерСтрокиРаздел5 = Сред(ОбластьИмяРаздел5, 15);
				Если НомерСтрокиРаздел5 <> НомерСтроки Тогда
					// В ту же колонки, нужно нам строки
					мРаздел5.ТекущаяОбласть = мРаздел5.Области[СтрЗаменить(ОбластьИмяРаздел5, "_" + НомерСтрокиРаздел5, "_" + НомерСтроки)];
				КонецЕсли;

			КонецЕсли;
		КонецЕсли;

	Исключение
		// Возможны ситуации, когда вставленная строка в лист 2 раздела 4, если не вставлена в раздел 4 как парная.
	КонецПопытки;

КонецПроцедуры // ПолеТабличногоДокументаРаздел4ПриАктивизацииОбласти

// ПолеТабличногоДокументаРаздел5ПриАктивизацииОбласти
//
Процедура ПолеТабличногоДокументаРаздел5ПриАктивизацииОбласти(Элемент)

	РегламентированнаяОтчетность.роПриАктивизацииОбластиРегламентированногоОтчета(ЭтаФорма, Элемент);

	Попытка

		// Определим номер активной строки, чтобы спозиционировать курсор в разделе 4, лист 2
		Если РегламентированнаяОтчетность.роРазделТекущейОбласти(ЭтаФорма, Элемент.ТекущаяОбласть) <> Неопределено Тогда
			ОбластьИмя = Элемент.ТекущаяОбласть.Имя;
			НомерСтроки = Сред(ОбластьИмя, 15);

			// Определим строку в разделе 4
			Если РегламентированнаяОтчетность.роРазделТекущейОбласти(ЭтаФорма, мРаздел4.ТекущаяОбласть) = Неопределено Тогда
				мРаздел4.ТекущаяОбласть = мРаздел4.Области["П000040001001_" + НомерСтроки];
			Иначе
				ОбластьИмяРаздел4 = мРаздел4.ТекущаяОбласть.Имя;
				НомерСтрокиРаздел4 = Сред(ОбластьИмяРаздел4, 15);
				Если НомерСтрокиРаздел4 <> НомерСтроки Тогда
					// В ту же колонки, нужно нам строки
					мРаздел4.ТекущаяОбласть = мРаздел4.Области[СтрЗаменить(ОбластьИмяРаздел4, "_" + НомерСтрокиРаздел4, "_" + НомерСтроки)];
				КонецЕсли;

			КонецЕсли;
		КонецЕсли;
	Исключение
		// Возможны ситуации, когда вставленная строка в лист 2 раздела 4, если не вставлена в раздел 4 как парная.
	КонецПопытки;

КонецПроцедуры // ПолеТабличногоДокументаРаздел5ПриАктивизацииОбласти

// ПолеТабличногоДокументаРаздел3ПриАктивизацииОбласти
//
Процедура ПолеТабличногоДокументаРаздел3ПриАктивизацииОбласти(Элемент)

	РегламентированнаяОтчетность.роПриАктивизацииОбластиРегламентированногоОтчета(ЭтаФорма, Элемент);

КонецПроцедуры // ПолеТабличногоДокументаРаздел3ПриАктивизацииОбласти

// ПолеТабличногоДокументаРаздел2ПриАктивизацииОбласти
//
Процедура ПолеТабличногоДокументаРаздел2ПриАктивизацииОбласти(Элемент)

	РегламентированнаяОтчетность.роПриАктивизацииОбластиРегламентированногоОтчета(ЭтаФорма, Элемент);

КонецПроцедуры // ПолеТабличногоДокументаРаздел2ПриАктивизацииОбласти

// Процедура - обработчик события "ПередОткрытием" формы.
//
Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)

	РегламентированнаяОтчетность.ПередОткрытиемФормыРегламентированногоОтчета(ЭтаФорма, Отказ);
	Если Отказ Тогда
		Возврат;
	КонецЕсли;

	Инициализация();
	
КонецПроцедуры // ПередОткрытием()

// Процедура - обработчик события "ПриОткрытии" формы.
//
Процедура ПриОткрытии()

	РегламентированнаяОтчетность.ВключитьОбработчикАвтосохранения(ЭтаФорма);

КонецПроцедуры // ПриОткрытии()

// Процедура - обработчик события "ПередЗакрытием" формы.
//
Процедура ПередЗакрытием(Отказ, СтандартнаяОбработка)

	РегламентированнаяОтчетность.ПередЗакрытиемРегламентированногоОтчета(ЭтаФорма, Отказ, СтандартнаяОбработка);
	
КонецПроцедуры // ПередЗакрытием()

Процедура СохранитьДеревоНастройкиСтраниц()
	
	Если мСохраненныйДок <> Неопределено Тогда

		Если Не мСохраненныйДок.ЭтоНовый() Тогда
			// Сохраняем выбранные листы для печати в хранилище
			ХранилищеДанных = Новый ХранилищеЗначения(мДеревоСтраницОтчета);
			мСохраненныйДок.ДеревоНастройкиСтраниц = ХранилищеДанных;
			Попытка
				мСохраненныйДок.Записать();
			Исключение
			КонецПопытки;
		КонецЕсли;

	КонецЕсли;
	
Конецпроцедуры

// Процедура - обработчик события "ПриЗакрытии" формы.
//
Процедура ПриЗакрытии()

    СохранитьДеревоНастройкиСтраниц();

	РегламентированнаяОтчетность.ПриЗакрытииРегламентированногоОтчета(ЭтаФорма);
	
КонецПроцедуры // ПриЗакрытии()

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ДЕЙСТВИЯ КОМАНДНЫХ ПАНЕЛЕЙ ФОРМЫ

// Процедура - обработчик события Нажатие кнопки Очистить командной панели КоманднаяПанельФормы
// Производит очистку отчета в целом, или текущего листа или текущего экземпляра многостраничного раздела.
//
Процедура КоманднаяПанельФормыВыбратьВариантОчисткиОтчета(Кнопка)
	РегламентированнаяОтчетность.МеханизмыОчисткиРегламентированныхОтчетов(ЭтаФорма, Кнопка);
КонецПроцедуры // КоманднаяПанельФормыВыбратьВариантОчисткиОтчета

// Процедура - действие кнопки Поиск командной панели КоманднаяПанельФормы.
//
Процедура КоманднаяПанельФормыПоиск(Кнопка)
	
	РегламентированнаяОтчетность.роПоискВРегламентированномОтчете(ЭтаФорма);

КонецПроцедуры

// Процедура вызывается при выборе пункта подменю "Печать" командной панели
// действий формы. 
// Отрабатывает выбор печатной формы.
//
Процедура КоманднаяПанельДействийДействиеВыбратьПечатнуюФормы(Кнопка)// Не является ошибкой проверки конфигурации

	Если Кнопка <> Неопределено Тогда 
		Печать(Кнопка.Имя);
	КонецЕсли;

КонецПроцедуры // КоманднаяПанельДействийДействиеВыбратьПечатнуюФормы()

// Процедура вызывается при нажатии кнопки "Настройка страниц"  командной панели
// действий формы.
//
// Вызывает диалог настройки вывода на печать, показа и выгрузки.страниц отчета,
// а также процедуру управления видимостью страниц.
//
Процедура КоманднаяПанельФормыКнопкаНастройкаСтраниц(Кнопка)

	ОткрытьФормуВыбораСтраниц("ВыбратьДляНастройки");

	// Управляем видимостью страниц основной панели формы
	РегламентированнаяОтчетность.роПоказатьСтраницыОтчета(ЭтаФорма);

КонецПроцедуры // КоманднаяПанельФормыКнопкаНастройкаСтраниц()

// Процедура вызывается нажатием кнопки "ОК" командной панели действий формы.
// Выполняет сохранение данных отчета и закрывает текущую форму.
//
Процедура КоманднаяПанельДействийСохранитьИЗакрыть(Кнопка)

	Если Сохранить() Тогда
		Закрыть();
	КонецЕсли;

КонецПроцедуры // КоманднаяПанельДействийСохранитьИЗакрыть()

// Процедура вызывается нажатием кнопки "Записать" командной панели действий формы.
// Выполняет сохранение данных отчета.
//
Процедура КоманднаяПанельДействийЗаписать(Кнопка)

	Сохранить();

КонецПроцедуры // КоманднаяПанельДействийЗаписать()

//////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ЭЛЕМЕНТОВ ДИАЛОГА И ВСПОМОГАТЕЛЬНЫЕ ФУНКЦИИ/ПРОЦЕДУРЫ

// ПолеВыбораВидДокументаОчистка
// Процедура-обработчик события "Очистка"
//
Процедура ПолеВыбораВидДокументаОчистка(Элемент, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	
КонецПроцедуры // ПолеВыбораВидДокументаОчистка

// ПолеВыбораВидДокументаПриИзменении
// Процедура-обработчик события "ПриИзменении"
//
Процедура ПолеВыбораВидДокументаПриИзменении(Элемент)

	ВыбранКорректирующийВидДок = (ВидДокумента = 1);
	мТитульный.Области.ВидДок.Значение = ?(ВыбранКорректирующийВидДок, "", "V");
	мТитульный.Области.Корректировка.Значение = ?(ВыбранКорректирующийВидДок, "V", "");

	мТитульный.Области.НомКоррект.Значение = НомерКорректировки;

	Если НЕ ВыбранКорректирующийВидДок Тогда
		мТитульный.Области.НомКоррект.Значение = "";
	Иначе
		мТитульный.Области.НомКоррект.Значение = НомерКорректировки;
	КонецЕсли;

	ЭлементыФормы.НомерКорректировки.Доступность = ВыбранКорректирующийВидДок;

КонецПроцедуры // ПолеВыбораВидДокументаПриИзменении

// НомерКорректировкиПриИзменении
// Процедура-обработчик события "ПриИзменении" номер корректировки декларации.
//
Процедура НомерКорректировкиПриИзменении(Элемент)

	ВыбранКорректирующийВидДок = (ВидДокумента = 1);
	мТитульный.Области.ВидДок.Значение = ?(ВыбранКорректирующийВидДок, "", "V");
	мТитульный.Области.Корректировка.Значение = ?(ВыбранКорректирующийВидДок, "V", "");

	мТитульный.Области.НомКоррект.Значение = НомерКорректировки;

	Если НЕ ВыбранКорректирующийВидДок Тогда
		мТитульный.Области.НомКоррект.Значение = "";
	Иначе
		мТитульный.Области.НомКоррект.Значение = НомерКорректировки;
	КонецЕсли;

	ЭлементыФормы.НомерКорректировки.Доступность = ВыбранКорректирующийВидДок;

КонецПроцедуры // НомерКорректировкиПриИзменении

// КнопкаЗаполнитьСведенияОбОрганизацииНажатие
// Процедура-обработчик "Нажатие". Активизируется при нажатии на кнопку
// ЗаполнитьСведенияОбОрганизации
//
Процедура КнопкаЗаполнитьСведенияОбОрганизацииНажатие(Элемент)

	мВпрограммеИзмененаОрганизация = Истина;
	ЗаполнитьСведенияОбОрганизации();
	мВпрограммеИзмененаОрганизация = Ложь;
	Модифицированность = Истина;

КонецПроцедуры // КнопкаЗаполнитьСведенияОбОрганизацииНажатие

// Процедура - обработчик события при смене текущей страницы основной
// панели формы.
//
Процедура ОсновнаяПанельПриСменеСтраницы(Элемент, ТекущаяСтраница) Экспорт
	Перем ТекущаяОбласть;

	РегламентированнаяОтчетность.СформироватьСоставКнопкиОчиститьДляРегОтчетов(ЭтаФорма);

	ИмяТекущейСтраницыПанели = ЭлементыФормы.ОсновнаяПанель.Страницы[ТекущаяСтраница].Имя;

	Если РегламентированнаяОтчетность.роПолучитьСвойствоРаздела(ЭтаФорма, ИмяТекущейСтраницыПанели, "МногострочностьВРазделе") > 0 Тогда
		ИдГруппы = ОпределитьИдМногострочногоРазделаПоАктивнойСтранице();
		Если ИдГруппы <> Неопределено Тогда
			ТекТабличноеПоле = ОпределитьТабличноеПолеПоИдМногострочногоРаздела(ИдГруппы);
			ТекущаяОбласть = ТекТабличноеПоле.ТекущаяОбласть;
		КонецЕсли;
		// управляем доступностью кнопок "Добавить" и "Удалить"
		РегламентированнаяОтчетность.роДоступностьКнопокДобавитьУдалить(ЭтаФорма, ТекущаяОбласть, ИмяТекущейСтраницыПанели);
	КонецЕсли;

	Если РегламентированнаяОтчетность.роПолучитьСвойствоРаздела(ЭтаФорма, ИмяТекущейСтраницыПанели, "МногостраничностьВРазделе") Тогда

		// управляем показом статика, отображающего номер текущей страницы
		РегламентированнаяОтчетность.роПоказатьСтатикСтраницРаздела(ЭтаФорма, ИмяТекущейСтраницыПанели);
	КонецЕсли;

	Если РегламентированнаяОтчетность.роПолучитьСвойствоРаздела(ЭтаФорма, ИмяТекущейСтраницыПанели, "РазделЯвляетсяАвтозаполняемым") Тогда
		// управляем доступностью и выводом значений в поля отображения варианта заполнения ячеек
		ТекущаяОбласть = ЭлементыФормы["ПолеТабличногоДокумента" + ИмяТекущейСтраницыПанели].ТекущаяОбласть;
		РегламентированнаяОтчетность.роВывестиЭлементыВариантаЗаполнения(ЭтаФорма, ТекущаяОбласть);
	КонецЕсли;

КонецПроцедуры // ОсновнаяПанельПриСменеСтраницы()

// КнопкаДобавитьДопСтраницуНажатие
// единая процедура добавить страницу в раздел 
//
Процедура КнопкаДобавитьДопСтрокиРаздел1Нажатие(Элемент)

	ВставитьДополнительнуюСтроку();

КонецПроцедуры // КнопкаДобавитьДопСтраницуНажатие

// Процедура КнопкаУдалитьДопСтрокиРаздел4Нажатие(Элемент)
// единая кнопка на всех разделах УдалитьДопСтраницуНажатие
//
Процедура КнопкаУдалитьДопСтрокиРаздел1Нажатие(Элемент)

	УдалитьДополнительнуюСтроку();

КонецПроцедуры // КнопкаУдалитьДопСтрокиРаздел4Нажатие

// Процедура - обработчик события при изменении значения единицы измерения.
//
Процедура ПолеВыбораЕдиницаИзмеренияПриИзменении(Элемент)

	ПроверитьТочность();
	РегламентированнаяОтчетность.роУстановитьФорматВывода(ЭтаФорма);
	Модифицированность = Истина;
	Расчет("");

КонецПроцедуры // ПолеВыбораЕдиницаИзмеренияПриИзменении()

// Процедура - обработчик события "ПриИзменении" поля ввода точности
// единицы измерения.
//
Процедура ПолеВводаТочностьЕдиницыИзмеренияПриИзменении(Элемент)

	ПроверитьТочность();
	РегламентированнаяОтчетность.роУстановитьФорматВывода(ЭтаФорма);
	Модифицированность = Истина;

КонецПроцедуры // ПолеВводаТочностьЕдиницыИзмеренияПриИзменении()

// Процедура - обработчик события "ПриИзменении" поля ввода даты
// представления отчета.
//
Процедура ПолеВводаДатаСдачиПриИзменении(Элемент)

	//Проставим Новые ИНН и ФИО на титульный лист
	ЗаполнитьСведенияОбОрганизации(Истина);

	// Возведем признак модифицированности
	Модифицированность = Истина;

КонецПроцедуры // ПолеВводаДатаСдачиПриИзменении()

// Функция определяет многострочный раздел табличного документа
// на активной странице основной панели формы.
//
// Параметры:
//  Нет;
//
// Возвращаемое значение:
//  строка, имя многострочного раздела.
//
Функция ОпределитьИдМногострочногоРазделаПоАктивнойСтранице(ИмяЛиста = Неопределено) Экспорт
	Перем ИмяГруппы;

	Если ИмяЛиста = Неопределено Тогда

		ТекущаяСтраницаПанели    = ЭлементыФормы.ОсновнаяПанель.ТекущаяСтраница;
		ИмяТекущейСтраницыПанели = ТекущаяСтраницаПанели.Имя;
	Иначе
		ИмяТекущейСтраницыПанели = ИмяЛиста;

	КонецЕсли;

	Если ИмяТекущейСтраницыПанели = "Раздел1" Тогда
		ИмяГруппы = мИдГруппы1;
	ИначеЕсли ИмяТекущейСтраницыПанели = "Раздел2" Тогда
		ИмяГруппы = мИдГруппы2;
	ИначеЕсли ИмяТекущейСтраницыПанели = "Раздел3" Тогда
		ИмяГруппы = мИдГруппы3;
	ИначеЕсли ИмяТекущейСтраницыПанели = "Раздел4" Тогда
		ИмяГруппы = мИдГруппы4;
	ИначеЕсли ИмяТекущейСтраницыПанели = "Раздел5" Тогда
		ИмяГруппы = мИдГруппы5;
	КонецЕсли;

	Возврат ИмяГруппы;

КонецФункции // ОпределитьИдМногострочногоРазделаПоАктивнойСтранице()

// загружает данные стандартные данные из Макет.Списки
//
Процедура ЗагрузитьПоказателиИзМакета(Знач РазделВМакете)
	
	МакетСоставаПоказателей = ЭтотОбъект.ПолучитьМакет("Списки2008Кв2");
	
	ГодОтчета = Год(мДатаКонцаПериодаОтчета);
	
	Если РазделВМакете = "КоэфИнфляция" Тогда
		Если ГодОтчета >= 2012 Тогда
			РазделВМакете = РазделВМакете + "2012";
		ИначеЕсли ГодОтчета >= 2011 Тогда
			РазделВМакете = РазделВМакете + "2011";
		ИначеЕсли ГодОтчета >= 2010 Тогда
			РазделВМакете = РазделВМакете + "2010";
		ИначеЕсли ГодОтчета >= 2009 Тогда
			РазделВМакете = РазделВМакете + "2009";
		ИначеЕсли ГодОтчета >= 2008 Тогда
			РазделВМакете = РазделВМакете + "2008";
		ИначеЕсли ГодОтчета >= 2007 Тогда
			РазделВМакете = РазделВМакете + "2007";
		КонецЕсли;
	КонецЕсли;
	
	ТекОбласть = МакетСоставаПоказателей.Области.Найти(РазделВМакете);
	
	Если ТекОбласть <> Неопределено Тогда
		
		Для Ном = ТекОбласть.Верх По ТекОбласть.Низ Цикл
			// Перебираем строки макета.
			КодПоказателя = СокрП(МакетСоставаПоказателей.Область(Ном, 1).Текст);
			Название = СокрП(МакетСоставаПоказателей.Область(Ном, 2).Текст);
			Если КодПоказателя = "###" Тогда
				Прервать;
			Иначе
				
				Если РазделВМакете = "КодыКБК2005" Тогда
					НовСтрока = мКодыБюджетнойКлассификации2005.Добавить();
				ИначеЕсли РазделВМакете = "КБК_2012Кв1" Тогда
					НовСтрока = мКодыБюджетнойКлассификации2012.Добавить();
				ИначеЕсли РазделВМакете = "РасположениеОбъекта" Тогда
					НовСтрока = мРасположениеОбъекта.Добавить();
				ИначеЕсли РазделВМакете = "ДополнительныйКоэф12" Тогда
					НовСтрока = мДополнительныйКоэф12.Добавить();
				ИначеЕсли РазделВМакете = "КЭЗ_Раздел1" Тогда
					НовСтрока = мКЭЗ_Раздел1.Добавить();
				ИначеЕсли РазделВМакете = "КЭЗ_ВодныеОбъекты" Тогда
					НовСтрока = мКЭЗ_ВодныеОбъекты.Добавить();
				ИначеЕсли РазделВМакете = "КлассыОпасности" Тогда
					НовСтрока = мКлассыОпасности.Добавить();
				ИначеЕсли РазделВМакете = "ЭкологическийКлассРаздел2" Тогда
					НовСтрока = мЭкологическийКлассРаздел2.Добавить();
				ИначеЕсли РазделВМакете = "НормативыПлатыРаздел2" Тогда
					НовСтрока = мНормативыПлатыРаздел2.Добавить();
				ИначеЕсли РазделВМакете = "ВредныеВеществаРаздел1" Тогда
					НовСтрока = мВредныеВеществаРаздел1.Добавить();
					Строка110 = СокрП(МакетСоставаПоказателей.Область(Ном, 3).Текст);
					Строка120 = СокрП(МакетСоставаПоказателей.Область(Ном, 4).Текст);
					НовСтрока.Строка110 = Строка110;
					НовСтрока.Строка120 = Строка120;
				ИначеЕсли РазделВМакете = "ВредныеВеществаРаздел3" Тогда
					НовСтрока = мВредныеВеществаРаздел3.Добавить();
					Строка110 = СокрП(МакетСоставаПоказателей.Область(Ном, 3).Текст);
					Строка120 = СокрП(МакетСоставаПоказателей.Область(Ном, 4).Текст);
					НовСтрока.Строка110 = Строка110;
					НовСтрока.Строка120 = Строка120;
				ИначеЕсли РазделВМакете = "ФКТОРаздел4" Тогда
					НовСтрока = мФКТОРаздел4.Добавить();
				ИначеЕсли Лев(РазделВМакете, СтрДлина("КоэфИнфляция")) = "КоэфИнфляция" Тогда
					НовСтрока = мКоэфИнфляция.Добавить();
				ИначеЕсли РазделВМакете = "КЭЗ_Раздел4" Тогда
					НовСтрока = мКЭЗ_Раздел4.Добавить();
				ИначеЕсли РазделВМакете = "ДопКоэфТЗ" Тогда
					НовСтрока = мДопКоэфТЗ.Добавить();
					
				КонецЕсли;
				
				НовСтрока.Код= КодПоказателя;
				НовСтрока.Название = Название;
				
			КонецЕсли;
			
		КонецЦикла;
	КонецЕсли;
КонецПроцедуры // ЗагрузитьПоказателиИзМакета

// Выполняет начальные настройки параметров отчета.
// По данным макета "СоствПоказателей" формирует:
//   - состав показателей отчета;
//   - варианты заполнения показателей отчета;
//   - дерево выводимых на печать листов отчета.
//
Процедура ЗаполнитьНачальныеНастройки()

	МакетСоставаПоказателей = ЭтотОбъект.ПолучитьМакет(мСоставПоказателей);

	ОписаниеТиповСтрока15  = ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(15);

	ОписаниеТиповСтрока50  = ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(50);

	ОписаниеТиповСтрока100 = ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(100);

	ОписаниеТиповЧисло1    = ОбщегоНазначения.ПолучитьОписаниеТиповЧисла(1);

	Для Инд = 0 По МакетСоставаПоказателей.Области.Количество() - 1 Цикл

		ТекОбласть    = МакетСоставаПоказателей.Области[Инд];
		ИмяСтраницы   = ТекОбласть.Имя;

		// Таблица значений содержит информацию о вариантах заполнения показателя отчета.
		// В колонках таблицы значений отображается следующая информация:
		//   - имя ячейки (код показателя);
		//   - вариант заполнения ячейки;
		//   - вычисленное по данным ИБ значение ячейки;
		//   - величина автокорректировки значения ячейки;
		//   - примечание к ячейке.
		//
		
		ТаблицаВариантыЗаполнения = Новый ТаблицаЗначений;
		ТаблицаВариантыЗаполнения.Колонки.Добавить( "КодПоказателя",     ОписаниеТиповСтрока50  );
		ТаблицаВариантыЗаполнения.Колонки.Добавить( "ВариантЗаполнения", ОписаниеТиповЧисло1    );
		ТаблицаВариантыЗаполнения.Колонки.Добавить( "ЗначениеАвто",      мОписаниеТиповЧислоЕ   );
		ТаблицаВариантыЗаполнения.Колонки.Добавить( "Дельта",            мОписаниеТиповЧислоЕ   );
		ТаблицаВариантыЗаполнения.Колонки.Добавить( "Комментарий",       ОписаниеТиповСтрока100 );
		ТаблицаВариантыЗаполнения.Колонки.Добавить( "КодПоказателяПоСтруктуре", ОписаниеТиповСтрока50 );

		Для Ном = ТекОбласть.Верх По ТекОбласть.Низ Цикл
			// перебираем строки макета

			// Код показателя (по составу показателей) определяется по первой колонке макета
			КодПоказателя = СокрП(МакетСоставаПоказателей.Область(Ном, 1).Текст);
			ИмяПоказателя = КодПоказателя;

			Если КодПоказателя = "===" Тогда         // признак конечной строки
				Прервать;
			КонецЕсли;

			Если Лев(КодПоказателя, 2) = "//" Тогда  // пропускаем комментарии
				Продолжить;
			КонецЕсли;

			// код показателя по форме отчете (имя ячейки в полях табличного документа формы)
			КодПоказателяПоФорме = СокрЛП(МакетСоставаПоказателей.Область(Ном, 2).Текст);
			// признак многострочности определяется по третьей колонке макета
			ПризнМногострочность = СокрЛП(МакетСоставаПоказателей.Область(Ном, 3).Текст);
			// по четвертой колонке определяется тип данных реквизита
			ТипДанныхРеквизита   = СокрЛП(МакетСоставаПоказателей.Область(Ном, 4).Текст);
			// по колонке 5 определяется исходное количество строк многострочного раздела
			стрКолСтрокИсходный  = СокрЛП(МакетСоставаПоказателей.Область(Ном, 5).Текст);
			// вариант заполнения ячейки определяется по колонке 6 макета
			стрВариантЗаполнения = РегламентированнаяОтчетность.ПолучитьВариантЗаполненияПоказателяРегОтчета(МакетСоставаПоказателей, Ном);
			// Код показателя по структуре определяется по колонке 9 макета
			КодПоказателяПоСтруктуре = СокрЛП(МакетСоставаПоказателей.Область(Ном, 9).Текст);

			чКолСтрокИсходный    = ? (ПустаяСтрока(стрКолСтрокИсходный),  0, Число(стрКолСтрокИсходный));
			чВариантЗаполнения   = ? (ПустаяСтрока(стрВариантЗаполнения), 0, Число(стрВариантЗаполнения));

			// формируем таблицу значений, содержащей состав показателей отчета
			НоваяСтрока = мТаблицаСоставПоказателей.Добавить();
			НоваяСтрока.ИмяПоляТаблДокумента   = ИмяСтраницы;
			НоваяСтрока.КодПоказателяПоСоставу = КодПоказателя;
			НоваяСтрока.КодПоказателяПоФорме   = КодПоказателяПоФорме;
			НоваяСтрока.ПризнМногострочности   = ПризнМногострочность;
			НоваяСтрока.ТипДанныхПоказателя    = ТипДанныхРеквизита;
			НоваяСтрока.КодПоказателяПоСтруктуре  = КодПоказателяПоСтруктуре;

			Если чВариантЗаполнения <> 0 Тогда
				// Если в колонке 6 задан варианет заполнения показателя, 
				// то его значение может определяться по данным ИБ.
				// Дополняем таблицу значений вариантов заполнения
				НоваяСтрока = ТаблицаВариантыЗаполнения.Добавить();
				НоваяСтрока.КодПоказателя      = ? (Не ПустаяСтрока(КодПоказателяПоФорме), КодПоказателяПоФорме, КодПоказателя);
				НоваяСтрока.ВариантЗаполнения  = чВариантЗаполнения;
				НоваяСтрока.КодПоказателяПоСтруктуре  = КодПоказателяПоСтруктуре;
			КонецЕсли;

		КонецЦикла;

		Если ТаблицаВариантыЗаполнения.Количество() > 0 Тогда
			// имеются автоматически заполняемые ячейки

			// Для обеспечения возможности назначения разных вариантов заполнения одного и того же показателя
			// на разных страницах, создаем массив, хранящий информацию о вариантах заполнения ячеек по каждой
			// странице многостраничного раздела.
			МассивВариантовЗаполненияСтраниц = Новый Массив;
			МассивВариантовЗаполненияСтраниц.Добавить(ТаблицаВариантыЗаполнения);

			// Создаем структуру, содержащей варианты заполнения показателей отчета.
			//
			// В качестве ключа используется имя страницы основной панели формы, содержащей
			//   табличный документ с автоматически заполняемыми показателями.
			// В качестве значения принимаем Массив из таблицы значений - вариантов заполнения
			//   показателей по каждой странице многостраничного раздела.
			//
			мСтруктураВариантыЗаполнения.Вставить(ИмяСтраницы, МассивВариантовЗаполненияСтраниц);
		Конецесли;

	КонецЦикла;

КонецПроцедуры // ЗаполнитьНачальныеНастройки()

// Создает новую строку многострочного раздела.
//
Процедура ВставитьДополнительнуюСтроку(БлокГруппы = Неопределено, НеАктивизировать = Неопределено)
	Перем СтруктураГруппы;
	Перем МаксимальноеКоличествоСтрокГруппы;

	Если БлокГруппы = Неопределено Тогда
		// Сначала выполним проверку на активную страницу панели формы,
		// которая содержит многострочный раздел
		ИмяГруппы = ОпределитьИдМногострочногоРазделаПоАктивнойСтранице();
	Иначе
		ИмяГруппы = БлокГруппы;
	КонецЕсли;

	Если ИмяГруппы = Неопределено Тогда
		Сообщить("Не выбран многострочный раздел, в который необходимо добавить строку.", СтатусСообщения.Внимание);
		Возврат;
	КонецЕсли;

	// Исходное количество строк группы
	мСтруктураИсхКолвоСтрокРазделов.Свойство(ИмяГруппы, МаксимальноеКоличествоСтрокГруппы);

	ТекТабличноеПоле = ОпределитьТабличноеПолеПоИдМногострочногоРаздела(ИмяГруппы);
	мСтруктураМногострочныхРазделов.Свойство(ИмяГруппы, СтруктураГруппы);

	// определяем последнюю строку многострочной группы
	КолСтрок = СтруктураГруппы.Количество();
	ИмяПервойЯчейкиПоследнейСтроки = СтруктураГруппы.Колонки[0].Имя + "_" + Формат(КолСтрок, "ЧГ=0");

	// область первой ячейки последней строки многострочного раздела
	ОбластьЯчейки = ТекТабличноеПоле.Области[ИмяПервойЯчейкиПоследнейСтроки];

	// номера строк исходной области
	НомерВерхЯчейкиОбласти = ОбластьЯчейки.Верх;
	НомерНижнЯчейкиОбласти = ОбластьЯчейки.Низ;

	СдвигСтрок = НомерНижнЯчейкиОбласти - НомерВерхЯчейкиОбласти + 1;

	// номера строк вставляемой области
	НомерВерхЯчейкиНовойОбласти = НомерВерхЯчейкиОбласти + СдвигСтрок;
	НомерНижнЯчейкиНовойОбласти = НомерНижнЯчейкиОбласти + СдвигСтрок;

	// определяем вставляемую область
	ВставляемаяОбласть = ТекТабличноеПоле.Область(НомерВерхЯчейкиОбласти, , НомерНижнЯчейкиОбласти, );

	// добавляем в таблицу новую строку
	ТекТабличноеПоле.ВставитьОбласть( ВставляемаяОбласть,,ТипСмещенияТабличногоДокумента.ПоВертикали );

	// переопределяем имена вставленной области
	Для Каждого Колонка Из СтруктураГруппы.Колонки Цикл

		ИмяКолонки          = Колонка.Имя;
		ИмяОбластиЯчейки    = ИмяКолонки + "_" + Формат(КолСтрок, "ЧГ=0");
		ИмяНовОбластиЯчейки = ИмяКолонки + "_" + Формат((КолСтрок + 1), "ЧГ=0");

		ОбластьЯчейки = ТекТабличноеПоле.Области[ИмяОбластиЯчейки];
		ОбластьЯчейки.Имя = ИмяНовОбластиЯчейки;

		// определяем границы ячейки исходной области
		НомерВерхСтрокиЯчейки  = ОбластьЯчейки.Верх - СдвигСтрок;
		НомерНижнСтрокиЯчейки  = ОбластьЯчейки.Низ  - СдвигСтрок;
		НомерЛевоКолонкиЯчейки = ОбластьЯчейки.Лево;
		НомерПравКолонкиЯчейки = ОбластьЯчейки.Право;

		// Назначаем имя ячейки исходной области,
		// (т.к. в результате вставки новой области оно было очищено)
		ОбластьЯчейкиИсходнойОбласти = ТекТабличноеПоле.Область(НомерВерхСтрокиЯчейки, НомерЛевоКолонкиЯчейки, НомерНижнСтрокиЯчейки, НомерПравКолонкиЯчейки);
		ОбластьЯчейкиИсходнойОбласти.Имя = ИмяОбластиЯчейки;

		// очищаем значения ячеек вставленной области
		Если ОбластьЯчейки.СодержитЗначение = Истина Тогда
			Если НЕ мСтруктураНеОчищаемыхКолонок.Свойство(Лев(ОбластьЯчейки.Имя, 13)) Тогда
				ОбластьЯчейки.Очистить();
			КонецЕсли;
		Иначе
			// порядековый номер последней строки перед вставкой
			ИсходныйНомер        = Число("0" + ОбластьЯчейки.Текст);
			НовыйПорядковыйНомер = ИсходныйНомер + 1;

			ОбластьЯчейки.Текст  = ? (НЕ НовыйПорядковыйНомер > МаксимальноеКоличествоСтрокГруппы, Строка(НовыйПорядковыйНомер), "");

		КонецЕсли;
	КонецЦикла;

	// Назначим текущей областью таблицы первую редактируемую ячейку добавленной строки.
	// Определяем текущую область таблицы
	ИмяТекущейОбласти = СтруктураГруппы.Колонки[0].Имя + "_" + Формат((КолСтрок + 1), "ЧГ=0");

	ТекТабличноеПоле.ТекущаяОбласть = ТекТабличноеПоле.Области[ИмяТекущейОбласти];

	Если НеАктивизировать = Неопределено Тогда
		// установим фокус на поле табличн. документа
		ТекущийЭлемент = ТекТабличноеПоле;
	КонецЕсли;

	// добавляем в структуру многострочной группы новую строку
	СтруктураГруппы.Добавить();

	Модифицированность = Истина;

КонецПроцедуры // ВставитьДополнительнуюСтроку()

// Удаляет строку многострочного раздела формы.
//
Процедура УдалитьДополнительнуюСтроку()
	Перем ИсходноеКоличествоСтрокГруппы;
	Перем СтруктураГруппы;

	// Сначала выполним проверку на активную страницу панели формы,
	// которая содержит многострочный раздел
	ИмяГруппы = ОпределитьИдМногострочногоРазделаПоАктивнойСтранице();

	Если ИмяГруппы = Неопределено Тогда
		Сообщить("Не выбрана удаляемая строка многострочного раздела.", СтатусСообщения.Внимание);
		Возврат;
	КонецЕсли;

	// исходное количество строк группы
	мСтруктураИсхКолвоСтрокРазделов.Свойство(ИмяГруппы, ИсходноеКоличествоСтрокГруппы);

	ТекТабличноеПоле = ОпределитьТабличноеПолеПоИдМногострочногоРаздела(ИмяГруппы);
	мСтруктураМногострочныхРазделов.Свойство(ИмяГруппы, СтруктураГруппы);

	// Выполним также проверку вхождения текущей (выделенной) ячейки в многострочный раздел
	ТекущаяОбласть = ТекТабличноеПоле.ТекущаяОбласть;
	ИмяЯчейки      = ТекущаяОбласть.Имя;
	ИмяГруппы      = РегламентированнаяОтчетность.роРазделТекущейОбласти(ЭтаФорма, ТекущаяОбласть);

	Если ИмяГруппы = Неопределено Тогда
		Сообщить("Не выбрана удаляемая строка многострочного раздела.", СтатусСообщения.Внимание);
		Возврат;
	КонецЕсли;

	Ответ = Вопрос("Удалить выбранную строку?" + Символы.ПС
	      + "(Внимание! данная операция необратима)", РежимДиалогаВопрос.ДаНет, , КодВозвратаДиалога.Да);

	Если Ответ <> КодВозвратаДиалога.Да Тогда
		Возврат;
	КонецЕсли;

	// предварительно обновим структуру многострочного раздела
	ОбновитьСтруктуруМногострочногоРаздела(ИмяГруппы);

	// номер строки многострочного раздела определим
	// по имени выделенной ячейки
	НомУдаляемойСтроки = Число( Сред( ИмяЯчейки, Найти( ИмяЯчейки, "_") + 1));
	НомерСтрокиТаблицы = НомУдаляемойСтроки - 1; // нумерация строк в таблице значений начинается с нуля

	Если СтруктураГруппы.Количество() > ИсходноеКоличествоСтрокГруппы Тогда
		// удаляется добавленная строка
		ИмяПервойЯчейкиУдаляемойСтроки = СтруктураГруппы.Колонки[0].Имя + "_" + Формат(НомУдаляемойСтроки, "ЧГ=0");

		// область первой ячейки удаляемой строки многострочного раздела
		ОбластьЯчейки = ТекТабличноеПоле.Области[ИмяПервойЯчейкиУдаляемойСтроки];

		// номера строк удаляемой области
		НомерВерхЯчейкиОбласти = ОбластьЯчейки.Верх;
		НомерНижнЯчейкиОбласти = ОбластьЯчейки.Низ;

		// Определим область удаляемой строки
		УдаляемаяОбласть = ТекТабличноеПоле.Область(НомерВерхЯчейкиОбласти, , НомерНижнЯчейкиОбласти, );

		// непосредственно удаляем область строки табличного документа
		ТекТабличноеПоле.УдалитьОбласть( УдаляемаяОбласть,ТипСмещенияТабличногоДокумента.ПоВертикали );

		КолвоСдвигаемыхСтрок = СтруктураГруппы.Количество() - НомУдаляемойСтроки;

		// обновим имена ячеек сдвинутых строк
		Если КолвоСдвигаемыхСтрок > 0 Тогда

			Для НСтр = НомУдаляемойСтроки + 1 По СтруктураГруппы.Количество() Цикл

				ТекСтрока = СтруктураГруппы[НСтр-1];

				Для Каждого Колонка Из СтруктураГруппы.Колонки Цикл
					ИмяСдвинутойЯчейки = Колонка.Имя + "_" + Формат(НСтр, "ЧГ=0");
					НовоеИмяСдвинутойЯчейки = Колонка.Имя + "_" + Формат((НСтр - 1), "ЧГ=0");

					ОбластьСдвинутойЯчейки     = ТекТабличноеПоле.Области[ИмяСдвинутойЯчейки];
					ОбластьСдвинутойЯчейки.Имя = НовоеИмяСдвинутойЯчейки;

					Если ОбластьСдвинутойЯчейки.СодержитЗначение <> Истина Тогда
						// обновляем порядковый номер строки

						СтарыйНомер = Число(ТекСтрока[Колонка.Имя]);
						НовыйПорядковыйНомер = Строка(Макс(СтарыйНомер - 1, 0));
						ОбластьСдвинутойЯчейки.Текст = НовыйПорядковыйНомер;

						// обновляем значение элемента таблицы значений
						ТекСтрока[Колонка.Имя] = НовыйПорядковыйНомер;
					КонецЕсли;
				КонецЦикла;

			КонецЦикла;
		КонецЕсли;

		// обновляем структуру многострочного раздела
		СтруктураГруппы.Удалить(НомерСтрокиТаблицы);

	Иначе
		// строка не удаляется в форме табличного документа,
		// а должна осуществляться сдвиг строк

		// обновляем структуру многострочного раздела
		// методом удаления выбранной строки и добавления пустой строки
		СтруктураГруппы.Удалить(НомерСтрокиТаблицы);

		ДобавляемаяСтрока = СтруктураГруппы.Добавить();
		// Особенность.
		// Если в многострочном блоке есть колонки, защищенные и содержащие нужное значение,
		// тогда при удалении доп. строк не вставленных, данное значение обнуляется.
		// Поэтому добавим искусственно.
		Если ИмяГруппы = "П0000100010" Тогда
			ДобавляемаяСтрока.П000010001012 = 5;
		ИначеЕсли ИмяГруппы = "П0000300010" Тогда
			ДобавляемаяСтрока.П000030001011 = 5;
		ИначеЕсли ИмяГруппы = "П0000500010" Тогда
			ДобавляемаяСтрока.П000050001020 = 5;
		КонецЕсли;

		// обновляем порядковые номера строк, выводимых в табличный документ
		Для Каждого СтрокаТаблицы Из СтруктураГруппы Цикл
			Для Каждого КолонкаТаблицы Из СтруктураГруппы.Колонки Цикл

				НомерСтрокиВТаблице      = СтруктураГруппы.Индекс(СтрокаТаблицы);
				НомерСтрокиВФормеТаблицы = НомерСтрокиВТаблице + 1;
				ИмяЯчейки                = КолонкаТаблицы.Имя + "_" + Формат(НомерСтрокиВФормеТаблицы, "ЧГ=0");
				ОбластьЯчейкиТаблицы     = ТекТабличноеПоле.Области[ИмяЯчейки];

				Если ОбластьЯчейкиТаблицы.СодержитЗначение <> Истина Тогда

					ПервыйНомерВГруппе = 1;
					
					// обновляем порядковый номер строки
					НовыйПорядковыйНомер = Строка(ПервыйНомерВГруппе + НомерСтрокиВТаблице);

					СтрокаТаблицы[КолонкаТаблицы.Имя] = НовыйПорядковыйНомер;
				КонецЕсли;
			КонецЦикла;
		КонецЦикла;

		// Обновляем экранную форму табличного документа
		ВывестиРазделВТабличныйДокумент(ИмяГруппы, СтруктураГруппы);

	КонецЕсли;

	// назначим текущей областью таблицы первую редактируемую ячейку
	// удаленной строки, если ее порядковый номер меньше кол-ва строк
	// многострочного раздела, или последней строки раздела в противном случае

	// определяем текущую область таблицы
	НомТекущейСтроки  = Мин( НомУдаляемойСтроки, СтруктураГруппы.Количество() );
	ИмяТекущейОбласти = СтруктураГруппы.Колонки[0].Имя + "_" + Формат(НомТекущейСтроки, "ЧГ=0");

	ТекТабличноеПоле.ТекущаяОбласть = ТекТабличноеПоле.Области[ИмяТекущейОбласти];

	// установим фокус на поле табличн. документа
	ТекущийЭлемент = ТекТабличноеПоле;

	Модифицированность = Истина;

КонецПроцедуры // УдалитьДополнительнуюСтроку()

// Удаляет строку многострочного раздела формы.
//
Процедура УдалитьДополнительнуюСтрокуПарныхГрупп(Знач ИмяГруппы, Знач ИмяЯчейки)
	Перем ИсходноеКоличествоСтрокГруппы;
	Перем СтруктураГруппы;

	// исходное количество строк группы
	мСтруктураИсхКолвоСтрокРазделов.Свойство(ИмяГруппы, ИсходноеКоличествоСтрокГруппы);

	ТекТабличноеПоле = ОпределитьТабличноеПолеПоИдМногострочногоРаздела(ИмяГруппы);
	мСтруктураМногострочныхРазделов.Свойство(ИмяГруппы, СтруктураГруппы);

	// Выполним также проверку вхождения текущей (выделенной) ячейки в многострочный раздел
	// ТекущаяОбласть = ТекТабличноеПоле.ТекущаяОбласть;
	//ИмяЯчейки      = ТекущаяОбласть.Имя;
	//ИмяГруппы      = РегламентированнаяОтчетность.роРазделТекущейОбласти(ЭтаФорма, ТекущаяОбласть);

	// предварительно обновим структуру многострочного раздела
	ОбновитьСтруктуруМногострочногоРаздела(ИмяГруппы);

	// номер строки многострочного раздела определим
	// по имени выделенной ячейки
	НомУдаляемойСтроки = Число( Сред( ИмяЯчейки, Найти( ИмяЯчейки, "_") + 1));
	НомерСтрокиТаблицы = НомУдаляемойСтроки - 1; // нумерация строк в таблице значений начинается с нуля

	Если СтруктураГруппы.Количество() > ИсходноеКоличествоСтрокГруппы Тогда
		// удаляется добавленная строка
		ИмяПервойЯчейкиУдаляемойСтроки = СтруктураГруппы.Колонки[0].Имя + "_" + Формат(НомУдаляемойСтроки, "ЧГ=0");

		// область первой ячейки удаляемой строки многострочного раздела
		ОбластьЯчейки = ТекТабличноеПоле.Области[ИмяПервойЯчейкиУдаляемойСтроки];

		// номера строк удаляемой области
		НомерВерхЯчейкиОбласти = ОбластьЯчейки.Верх;
		НомерНижнЯчейкиОбласти = ОбластьЯчейки.Низ;

		// Определим область удаляемой строки
		УдаляемаяОбласть = ТекТабличноеПоле.Область(НомерВерхЯчейкиОбласти, , НомерНижнЯчейкиОбласти, );

		// непосредственно удаляем область строки табличного документа
		ТекТабличноеПоле.УдалитьОбласть( УдаляемаяОбласть,ТипСмещенияТабличногоДокумента.ПоВертикали );

		КолвоСдвигаемыхСтрок = СтруктураГруппы.Количество() - НомУдаляемойСтроки;

		// обновим имена ячеек сдвинутых строк
		Если КолвоСдвигаемыхСтрок > 0 Тогда

			Для НСтр = НомУдаляемойСтроки + 1 По СтруктураГруппы.Количество() Цикл

				ТекСтрока = СтруктураГруппы[НСтр-1];

				Для Каждого Колонка Из СтруктураГруппы.Колонки Цикл
					ИмяСдвинутойЯчейки = Колонка.Имя + "_" + Формат(НСтр, "ЧГ=0");
					НовоеИмяСдвинутойЯчейки = Колонка.Имя + "_" + Формат((НСтр - 1), "ЧГ=0");

					ОбластьСдвинутойЯчейки     = ТекТабличноеПоле.Области[ИмяСдвинутойЯчейки];
					ОбластьСдвинутойЯчейки.Имя = НовоеИмяСдвинутойЯчейки;

					Если ОбластьСдвинутойЯчейки.СодержитЗначение <> Истина Тогда
						// обновляем порядковый номер строки

						СтарыйНомер = Число(ТекСтрока[Колонка.Имя]);
						НовыйПорядковыйНомер = Строка(Макс(СтарыйНомер - 1, 0));
						ОбластьСдвинутойЯчейки.Текст = НовыйПорядковыйНомер;

						// обновляем значение элемента таблицы значений
						ТекСтрока[Колонка.Имя] = НовыйПорядковыйНомер;
					КонецЕсли;
				КонецЦикла;

			КонецЦикла;
		КонецЕсли;

		// обновляем структуру многострочного раздела
		СтруктураГруппы.Удалить(НомерСтрокиТаблицы);

	Иначе
		// строка не удаляется в форме табличного документа,
		// а должна осуществляться сдвиг строк

		// обновляем структуру многострочного раздела
		// методом удаления выбранной строки и добавления пустой строки
		СтруктураГруппы.Удалить(НомерСтрокиТаблицы);

		ДобавляемаяСтрока = СтруктураГруппы.Добавить();

		// Особенность.
		// Если в многострочном блоке есть колонки, защищенные и содержащие нужное значение,
		// тогда при удалении доп. строк не вставленных, данное значение обнуляется.
		// Поэтому добавим искусственно.
		Если ИмяГруппы = "П0000500010" Тогда
			ДобавляемаяСтрока.П000050001020 = 5;
		КонецЕсли;

		// обновляем порядковые номера строк, выводимых в табличный документ
		Для Каждого СтрокаТаблицы Из СтруктураГруппы Цикл
			Для Каждого КолонкаТаблицы Из СтруктураГруппы.Колонки Цикл

				НомерСтрокиВТаблице      = СтруктураГруппы.Индекс(СтрокаТаблицы);
				НомерСтрокиВФормеТаблицы = НомерСтрокиВТаблице + 1;
				ИмяЯчейки                = КолонкаТаблицы.Имя + "_" + Формат(НомерСтрокиВФормеТаблицы, "ЧГ=0");
				ОбластьЯчейкиТаблицы     = ТекТабличноеПоле.Области[ИмяЯчейки];

				Если ОбластьЯчейкиТаблицы.СодержитЗначение <> Истина Тогда

					ПервыйНомерВГруппе = 1;
					
					// обновляем порядковый номер строки
					НовыйПорядковыйНомер = Строка(ПервыйНомерВГруппе + НомерСтрокиВТаблице);

					СтрокаТаблицы[КолонкаТаблицы.Имя] = НовыйПорядковыйНомер;
				КонецЕсли;
			КонецЦикла;
		КонецЦикла;

		// Обновляем экранную форму табличного документа
		ВывестиРазделВТабличныйДокумент(ИмяГруппы, СтруктураГруппы);

	КонецЕсли;

	// назначим текущей областью таблицы первую редактируемую ячейку
	// удаленной строки, если ее порядковый номер меньше кол-ва строк
	// многострочного раздела, или последней строки раздела в противном случае

	// определяем текущую область таблицы
	НомТекущейСтроки  = Мин( НомУдаляемойСтроки, СтруктураГруппы.Количество() );
	ИмяТекущейОбласти = СтруктураГруппы.Колонки[0].Имя + "_" + Формат(НомТекущейСтроки, "ЧГ=0");

	// ТекТабличноеПоле.ТекущаяОбласть = ТекТабличноеПоле.Области[ИмяТекущейОбласти];

	// установим фокус на поле табличн. документа
	// ТекущийЭлемент = ТекТабличноеПоле;

	Модифицированность = Истина;

КонецПроцедуры // УдалитьДополнительнуюСтрокуПарныхГрупп()

// Обновляет структуру многострочнго раздела, заданного
// уникальным идентификатором. Заполняет таблицу значений
// многострочного раздела значениями соответствующих ячеек.
//
// Параметры:
//  ИмяГруппы - строка - идентификатор многострочного раздела.
//
Процедура ОбновитьСтруктуруМногострочногоРаздела(ИмяГруппы) Экспорт
	Перем СтруктураГруппы;
	
	мСтруктураМногострочныхРазделов.Свойство(ИмяГруппы, СтруктураГруппы);
	// Заполняем таблицу значений многострочного раздела
	// указанными в соответствующих ячейках значениями.
	ТекТабличноеПоле = ОпределитьТабличноеПолеПоИдМногострочногоРаздела(ИмяГруппы);
	
	Для НСтр = 1 По СтруктураГруппы.Количество() Цикл
		
		ТекСтрокаТаблицы = СтруктураГруппы[НСтр - 1];
		
		Для Каждого Колонка Из СтруктураГруппы.Колонки Цикл
			ИмяКолонки    = Колонка.Имя;
			ИмяЯчейки     = ИмяКолонки + "_" + Формат(НСтр, "ЧГ=0");
			ОбластьЯчейки = ТекТабличноеПоле.Области[ИмяЯчейки];
			
			Если ОбластьЯчейки.СодержитЗначение = Истина Тогда
				ЗначениеЯчейки = ОбластьЯчейки.Значение;
			Иначе
				ЗначениеЯчейки = ОбластьЯчейки.Текст;
			КонецЕсли;
			
			ТекСтрокаТаблицы[ИмяКолонки] = ЗначениеЯчейки;
			
		КонецЦикла;
	КонецЦикла;

КонецПроцедуры // ОбновитьСтруктуруМногострочногоРаздела()

// ФормироватьСтруктуруСтраницОтчета
//
Процедура ФормироватьСтруктуруСтраницОтчета()

	ОписаниеТиповСтрока100 = ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(100);

	ОписаниеТиповЧисло1    = ОбщегоНазначения.ПолучитьОписаниеТиповЧисла(1);

	// Дерево содержит коллекцию страниц отчета.
	// В колонках дерева хранятся следующие данные:
	//    - представление листа;
	//    - имя страницы основной панели формы, содержащей выводимый на печать лист;
	//    - имя поля табличного документа;
	//    - имя области ячеек табличного документа (используется в случае вывода
	//      на печать отдельных страниц титульного листа);
	//    - ориентация страницы при печати;
	//    - число, метка вывода страницы на печать;
	//    - число, метка показа страницы на основной панели формы;
	//    - число, метка выгрузки данных страницы в ИМНС.
	//
	мДеревоСтраницОтчета               = Новый ДеревоЗначений;
	мДеревоСтраницОтчета.Колонки.Добавить("Представление",            ОписаниеТиповСтрока100);
	мДеревоСтраницОтчета.Колонки.Добавить("ИмяСтраницы",              ОписаниеТиповСтрока100);
	мДеревоСтраницОтчета.Колонки.Добавить("ИмяПоляТабличногоДокум",   ОписаниеТиповСтрока100);
	мДеревоСтраницОтчета.Колонки.Добавить("ИмяОбластиТабличногоПоля", ОписаниеТиповСтрока100);
	мДеревоСтраницОтчета.Колонки.Добавить("ОриентацияСтраницы");
	мДеревоСтраницОтчета.Колонки.Добавить("ВыводНаПечать",            ОписаниеТиповЧисло1);
	мДеревоСтраницОтчета.Колонки.Добавить("ПоказатьСтраницу",         ОписаниеТиповЧисло1);
	мДеревоСтраницОтчета.Колонки.Добавить("ВыгрузитьСтраницу",        ОписаниеТиповЧисло1);

	мДеревоСтраницОтчета.Строки.Очистить();

	СтрокаУровня1 = мДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы              = "Титульный";
	СтрокаУровня1.Представление            = "Титульный лист";
	СтрокаУровня1.ИмяПоляТабличногоДокум   = "ПолеТабличногоДокументаТитульный";
	СтрокаУровня1.ОриентацияСтраницы       = ОриентацияСтраницы.Портрет;
	СтрокаУровня1.ВыводНаПечать            = 1;
	СтрокаУровня1.ПоказатьСтраницу         = 1;
	СтрокаУровня1.ВыгрузитьСтраницу        = 2;

	СтрокаУровня1 = мДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы              = "Расчет";
	СтрокаУровня1.Представление            = "Расчет платы за негативное воздействие на окружающую среду";
	СтрокаУровня1.ИмяПоляТабличногоДокум   = "ПолеТабличногоДокументаРасчет";
	СтрокаУровня1.ОриентацияСтраницы       = ОриентацияСтраницы.Портрет;
	СтрокаУровня1.ВыводНаПечать            = 1;
	СтрокаУровня1.ПоказатьСтраницу         = 1;
	СтрокаУровня1.ВыгрузитьСтраницу        = 2;

	СтрокаУровня1 = мДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы              = "Раздел1";
	СтрокаУровня1.Представление            = "Раздел 1";
	СтрокаУровня1.ИмяПоляТабличногоДокум   = "ПолеТабличногоДокументаРаздел1";
	СтрокаУровня1.ОриентацияСтраницы       = ОриентацияСтраницы.Ландшафт;
	СтрокаУровня1.ВыводНаПечать            = 1;
	СтрокаУровня1.ПоказатьСтраницу         = 1;
	СтрокаУровня1.ВыгрузитьСтраницу        = 2;

	СтрокаУровня1 = мДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы              = "Раздел2";
	СтрокаУровня1.Представление            = "Раздел 2";
	СтрокаУровня1.ИмяПоляТабличногоДокум   = "ПолеТабличногоДокументаРаздел2";
	СтрокаУровня1.ОриентацияСтраницы       = ОриентацияСтраницы.Ландшафт;
	СтрокаУровня1.ВыводНаПечать            = 1;
	СтрокаУровня1.ПоказатьСтраницу         = 1;
	СтрокаУровня1.ВыгрузитьСтраницу        = 2;

	СтрокаУровня1 = мДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы              = "Раздел3";
	СтрокаУровня1.Представление            = "Раздел 3";
	СтрокаУровня1.ИмяПоляТабличногоДокум   = "ПолеТабличногоДокументаРаздел3";
	СтрокаУровня1.ОриентацияСтраницы       = ОриентацияСтраницы.Ландшафт;
	СтрокаУровня1.ВыводНаПечать            = 1;
	СтрокаУровня1.ПоказатьСтраницу         = 1;
	СтрокаУровня1.ВыгрузитьСтраницу        = 2;

	СтрокаУровня1 = мДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы              = "Раздел4";
	СтрокаУровня1.Представление            = "Раздел 4";
	СтрокаУровня1.ИмяПоляТабличногоДокум   = "ПолеТабличногоДокументаРаздел4";
	СтрокаУровня1.ОриентацияСтраницы       = ОриентацияСтраницы.Ландшафт;
	СтрокаУровня1.ВыводНаПечать            = 1;
	СтрокаУровня1.ПоказатьСтраницу         = 1;
	СтрокаУровня1.ВыгрузитьСтраницу        = 2;

	СтрокаУровня1 = мДеревоСтраницОтчета.Строки.Добавить();
	СтрокаУровня1.ИмяСтраницы              = "Раздел5";
	СтрокаУровня1.Представление            = "Раздел 4 лист 2";
	СтрокаУровня1.ИмяПоляТабличногоДокум   = "ПолеТабличногоДокументаРаздел5";
	СтрокаУровня1.ОриентацияСтраницы       = ОриентацияСтраницы.Ландшафт;
	СтрокаУровня1.ВыводНаПечать            = 1;
	СтрокаУровня1.ПоказатьСтраницу         = 1;
	СтрокаУровня1.ВыгрузитьСтраницу        = 2;

КонецПроцедуры // ФормироватьСтруктуруСтраницОтчета()

// Функция собирает значения редактирукемых ячеек табличного документа
// в коллекцию значений типа "структура".
//
// Параметры:
//  ТабличноеПоле - поле табличного документа текущей формы.
//
// Возвращаемое значение:
//  Структура.
//
Функция СобратьДанныеТекущегоТаблПоля(ТабличноеПоле) Экспорт

	СтруктураДанныхПоля = Новый Структура;

	Для ПереборныйИнд = 0 По ТабличноеПоле.Области.Количество() - 1 Цикл
		ТекущаяОбласть = ТабличноеПоле.Области[ПереборныйИнд];

		
		Если Не ТекущаяОбласть.ТипОбласти = ТипОбластиЯчеекТабличногоДокумента.Прямоугольник Тогда
			Продолжить;
		КонецЕсли;

		Если ТекущаяОбласть.СодержитЗначение <> Истина Тогда
			Продолжить;
		КонецЕсли;

		ИмяПоказателя      = ТекущаяОбласть.Имя;
		ЗначениеПоказателя = ТекущаяОбласть.Значение;

		СтруктураДанныхПоля.Вставить(ИмяПоказателя, ЗначениеПоказателя);

	КонецЦикла;

	ТабличноеПолеИмя = ТабличноеПоле.Имя;
	Если ТабличноеПолеИмя = "ПолеТабличногоДокументаРасчет" Тогда
		// Перебираем структуру переменных, и вставим только те, которые относятся к листу Расчет
		Для Каждого Стр Из мСтруктураПеременных Цикл
			Если (Найти(Стр.Ключ, "Расчет") > 0) Или (Найти(Стр.Ключ, "СуммаСтрока") > 0) Тогда
				СтруктураДанныхПоля.Вставить(Стр.Ключ, Стр.Значение);
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;

	Возврат СтруктураДанныхПоля;

КонецФункции // СобратьДанныеТекущегоТаблПоля()

// Процедура активизирует область поля табличного документа формы,
// соответствующей заданному показателю. При необходимости,
// процедура устанавливает в качестве активной ту страницу раздела, на которой
// находится показатель.
//
// Параметры:
//	Ячейка - СтрокаТаблицыЗначений с "координатами" показателя
//
Процедура АктивизироватьЯчейку(Ячейка) Экспорт
	
	РегламентированнаяОтчетность.роАктивизироватьЯчейку(ЭтаФорма, Ячейка);
	
КонецПроцедуры

// ПолеТабличногоДокументаПриИзмененииСодержимогоОбласти
//
Процедура ПолеТабличногоДокументаПриИзмененииСодержимогоОбласти(Элемент, Область)
	Модифицированность = Истина;
	ИмяТекущейСтраницыПанели = ЭлементыФормы.ОсновнаяПанель.ТекущаяСтраница.Имя;

	ОбластьИмя = Элемент.ТекущаяОбласть.Имя;

	Если ИмяТекущейСтраницыПанели = "Раздел1" Тогда

		СтруктураГруппы1 = Неопределено;
		мСтруктураМногострочныхРазделов.Свойство(мИдГруппы1, СтруктураГруппы1);

		Если НЕ ((Найти(ОбластьИмя, "П000010001001") > 0) Или (Найти(ОбластьИмя, "П000010001002") > 0)
		 Или (Найти(ОбластьИмя, "П000010001003") > 0) 
		 Или ОбластьИмя = "П000010000001"
		 Или ОбластьИмя = "П000010000002"
		 Или ОбластьИмя = "П000010000003"
		 Или ОбластьИмя = "П000010000004"
		 Или ОбластьИмя = "ПоПроизТерр"
		 Или ОбластьИмя = "ПоХозСуб"
		 Или ОбластьИмя = "П000010002017"
		 Или ОбластьИмя = "П000010002018"
		 Или ОбластьИмя = "П000010002019"
		 Или ОбластьИмя = "П000010002020"
		 Или ОбластьИмя = "НомСтр1"
		 Или ОбластьИмя = "НомСтр2") Тогда
			НомерСтроки = Сред(ОбластьИмя, 15);
			Колонка = Сред(ОбластьИмя, 1, 13);
			СтруктураГруппы1[Число(НомерСтроки) - 1][Колонка] = Элемент.ТекущаяОбласть.Значение;
			Расчет("Раздел1");
		КонецЕсли;

	ИначеЕсли ИмяТекущейСтраницыПанели = "Раздел2" Тогда

		СтруктураГруппы2 = Неопределено;
		мСтруктураМногострочныхРазделов.Свойство(мИдГруппы2, СтруктураГруппы2);

		Если (Найти(ОбластьИмя, "П000020001003") > 0) Или (Найти(ОбластьИмя, "П000020001005") > 0)
		 Или (Найти(ОбластьИмя, "П000020001006") > 0) Или (Найти(ОбластьИмя, "П000020001007") > 0)
		 Или (Найти(ОбластьИмя, "П000020001008") > 0) Или (Найти(ОбластьИмя, "П000020001009") > 0) Тогда
			НомерСтроки = Сред(ОбластьИмя, 15);
			Колонка = Сред(ОбластьИмя, 1, 13);
			СтруктураГруппы2[Число(НомерСтроки) - 1][Колонка] = Элемент.ТекущаяОбласть.Значение;
			Расчет("Раздел2");
		КонецЕсли;

	ИначеЕсли ИмяТекущейСтраницыПанели = "Раздел3" Тогда

		СтруктураГруппы3 = Неопределено;
		мСтруктураМногострочныхРазделов.Свойство(мИдГруппы3, СтруктураГруппы3);

		Если (Найти(ОбластьИмя, "П000030001006") > 0) Или (Найти(ОбластьИмя, "П000030001007") > 0)
		 Или (Найти(ОбластьИмя, "П000030001008") > 0) Или (Найти(ОбластьИмя, "П000030001009") > 0)
		 Или (Найти(ОбластьИмя, "П000030001010") > 0) Или (Найти(ОбластьИмя, "П000030001011") > 0)
		 Или (Найти(ОбластьИмя, "П000030001012") > 0) Или (Найти(ОбластьИмя, "П000030001013") > 0)
		  Или (Найти(ОбластьИмя, "П000030001014") > 0) Или (Найти(ОбластьИмя, "П000030001015") > 0)
		  Или (Найти(ОбластьИмя, "П000030001003") > 0) Или (Найти(ОбластьИмя, "П000030001004") > 0)
		  Или (Найти(ОбластьИмя, "П000030001005") > 0) Тогда
			НомерСтроки = Сред(ОбластьИмя, 15);
			Колонка = Сред(ОбластьИмя, 1, 13);
			СтруктураГруппы3[Число(НомерСтроки) - 1][Колонка] = Элемент.ТекущаяОбласть.Значение;
			Расчет("Раздел3");
		КонецЕсли;

	ИначеЕсли ИмяТекущейСтраницыПанели = "Раздел4" Тогда

		СтруктураГруппы4 = Неопределено;
		мСтруктураМногострочныхРазделов.Свойство(мИдГруппы4, СтруктураГруппы4);

		Если (Найти(ОбластьИмя, "П000040001013") > 0) Или (Найти(ОбластьИмя, "П000040001014") > 0)
		 Или (Найти(ОбластьИмя, "П000040001006") > 0) Или (Найти(ОбластьИмя, "П000040001007") > 0)
		 Или (Найти(ОбластьИмя, "П000040001008") > 0) Или (Найти(ОбластьИмя, "П000040001009") > 0)
		 Или (Найти(ОбластьИмя, "П000040001010") > 0) Или (Найти(ОбластьИмя, "П000040001011") > 0)
		 Или (Найти(ОбластьИмя, "П000040001012") > 0) Тогда
			НомерСтроки = Сред(ОбластьИмя, 15);
			Колонка = Сред(ОбластьИмя, 1, 13);
			СтруктураГруппы4[Число(НомерСтроки) - 1][Колонка] = Элемент.ТекущаяОбласть.Значение;
			Расчет("Раздел4");
			Расчет("Раздел5"); // Связанные показатели.
		КонецЕсли;

	ИначеЕсли ИмяТекущейСтраницыПанели = "Раздел5" Тогда

		СтруктураГруппы5 = Неопределено;
		мСтруктураМногострочныхРазделов.Свойство(мИдГруппы5, СтруктураГруппы5);

		Если (Найти(ОбластьИмя, "П000050001015") > 0) Или (Найти(ОбластьИмя, "П000050001016") > 0)
		 Или (Найти(ОбластьИмя, "П000050001017") > 0) Или (Найти(ОбластьИмя, "П000050001018") > 0)
		 Или (Найти(ОбластьИмя, "П000050001019") > 0) Или (Найти(ОбластьИмя, "П000050001021") > 0)
		 Или (Найти(ОбластьИмя, "П000050001022") > 0) Или (Найти(ОбластьИмя, "П000050001023") > 0)
		 Или (Найти(ОбластьИмя, "П000050001024") > 0) Тогда
			НомерСтроки = Сред(ОбластьИмя, 15);
			Колонка = Сред(ОбластьИмя, 1, 13);
			СтруктураГруппы5[Число(НомерСтроки) - 1][Колонка] = Элемент.ТекущаяОбласть.Значение;
			Расчет("Раздел5");
		КонецЕсли;

	КонецЕсли;

КонецПроцедуры // ПолеТабличногоДокументаПриИзмененииСодержимогоОбласти

// ПолеТабличногоДокументаРасчетВыбор
//
Процедура ПолеТабличногоДокументаРасчетВыбор(Элемент, Область, СтандартнаяОбработка)

	Если РегламентированнаяОтчетность.ВыбраннаяОбластьРегламентированногоОтчетаНеВерна(ЭтаФорма, Область, СтандартнаяОбработка) Тогда
		Возврат;
	КонецЕсли;

	Ячейка = Область.Имя;

	// Строка 010, КБК.
	Если Найти(Ячейка,"КБК") > 0 Тогда
		СтандартнаяОбработка = Ложь;
		ПервоначальноеЗначение = мСтруктураПеременных.КБКРасчет;

		Если НЕ мАвтоВыборКодов Тогда
			
			Если ДатаПодписи >= '20120101' Тогда
				ПоисковаяТабл = мКодыБюджетнойКлассификации2012;
			Иначе
				ПоисковаяТабл = мКодыБюджетнойКлассификации2005;
			КонецЕсли;
			
			РезультирующийПоиск = ПоисковаяТабл.Найти(ПервоначальноеЗначение, "Код");

			Если РезультирующийПоиск <> Неопределено Тогда
				Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор КБК", РезультирующийПоиск);
			Иначе
				Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор КБК");
			КонецЕсли;

		Иначе

			Если ВвестиСтроку(ПервоначальноеЗначение,"Введите КБК (20 знаков)", 20) Тогда
				Результат = ПервоначальноеЗначение;
			Иначе
				Возврат;
			КонецЕсли;

		КонецЕсли;

		Если Результат <> Неопределено Тогда
			ВведенныйРезультат = ?(мАвтоВыборКодов, Результат, Результат.Получить(0));
			Если ОбновитьПеременныеМодуля("КБКРасчет", ВведенныйРезультат) Тогда
				РегламентированнаяОтчетность.роПроставитьВКвадратыЗначения(ЭтаФорма, "Расчет", "КБК1_", 20, ВведенныйРезультат);
				Модифицированность = Истина;
			КонецЕсли;
		Конецесли;

	// Строка 020, ОКАТО.
	ИначеЕсли Найти(Ячейка, "ОКАТО") > 0 Тогда

		СтандартнаяОбработка = Ложь;
		НомерОКАТО = Сред(Ячейка, 6, 1);
		ПервоначальноеЗначение = мСтруктураПеременных.ОКАТОРасчет;
		Если ВвестиСтроку(ПервоначальноеЗначение, "Введите код ОКАТО", 11) Тогда
			Если (ПервоначальноеЗначение = "") Или (ОбщегоНазначения.ТолькоЦифрыВСтроке(ПервоначальноеЗначение)) И (СтрДлина(ПервоначальноеЗначение) = 11) Тогда

				Если ОбновитьПеременныеМодуля("ОКАТОРасчет", ПервоначальноеЗначение) Тогда
					РегламентированнаяОтчетность.роПроставитьВКвадратыЗначения(ЭтаФорма, "Расчет", "ОКАТО1_", 11, ПервоначальноеЗначение);
					Модифицированность = Истина;
				КонецЕсли;

			Иначе

				Сообщить("Код ОКАТО должен состоять из 11 цифр.");

			КонецЕсли;

		КонецЕсли;

	// Строка 030.
	ИначеЕсли Найти(Ячейка, "СуммаБезЛьгот") > 0 Тогда
		СтандартнаяОбработка = Ложь;
		ПервоначальноеЗначение = мСтруктураПеременных.СуммаБезЛьготРасчет;

		Если ВвестиЧисло(ПервоначальноеЗначение, "Сумма платежа, исчисленная без учета льгот и зачетов", 14, 2) Тогда
			ПервоначальноеЗначениеСтр = Формат(ПервоначальноеЗначение, мСтрокаФормата + ";ЧГ=0");
			Если СтрДлина(ПервоначальноеЗначениеСтр) > 12 Тогда
				Сообщить("Введенное значение нельзя отобразить в отчете.", СтатусСообщения.Важное);
				Возврат;
			КонецЕсли;

			Если ОбновитьПеременныеМодуля("СуммаБезЛьготРасчет", ПервоначальноеЗначение) Тогда
				РегламентированнаяОтчетность.роПроставитьВКвадратыЗначения(ЭтаФорма, "Расчет", "СуммаБезЛьгот1_", 12, ПервоначальноеЗначение, Истина);
				Модифицированность = Истина;
				Расчет("Расчет");
			КонецЕсли;
		КонецЕсли;

	// Группа строк 03х
	ИначеЕсли Найти(Ячейка, "Сумма03") > 0 Тогда
		СтандартнаяОбработка = Ложь;
		НомерСтроки = Сред(Ячейка, 8, 1);
		ПервоначальноеЗначение = мСтруктураПеременных["СуммаСтрока3" + НомерСтроки];

		Если ВвестиЧисло(ПервоначальноеЗначение, мТекстыСтрок.Получить(НомерСтроки), 14, 2) Тогда

			ПервоначальноеЗначениеСтр = Формат(ПервоначальноеЗначение, мСтрокаФормата + ";ЧГ=0");
			Если СтрДлина(ПервоначальноеЗначениеСтр) > 12 Тогда
				Сообщить("Введенное значение нельзя отобразить в отчете.", СтатусСообщения.Важное);
				Возврат;
			КонецЕсли;

			Если ОбновитьПеременныеМодуля("СуммаСтрока3" + НомерСтроки, ПервоначальноеЗначение) Тогда
				РегламентированнаяОтчетность.роПроставитьВКвадратыЗначения(ЭтаФорма, "Расчет", "Сумма03" + НомерСтроки + "_", 12, ПервоначальноеЗначение, Истина);
				Модифицированность = Истина;
				Расчет("Расчет");
			КонецЕсли;
		КонецЕсли;

	// Строка 050.
	ИначеЕсли Найти(Ячейка, "СуммаЗачет") > 0 Тогда
		СтандартнаяОбработка = Ложь;
		ПервоначальноеЗначение = мСтруктураПеременных.СуммаЗачетРасчет;
		Если ВвестиЧисло(ПервоначальноеЗначение, "Сумма средств на выполнение природоохранных мероприятий, принимаемая к зачету в счет платы", 14, 2) Тогда

			ПервоначальноеЗначениеСтр = Формат(ПервоначальноеЗначение, мСтрокаФормата + ";ЧГ=0");
			Если СтрДлина(ПервоначальноеЗначениеСтр) > 12 Тогда
				Сообщить("Введенное значение нельзя отобразить в отчете.", СтатусСообщения.Важное);
				Возврат;
			КонецЕсли;

			Если ОбновитьПеременныеМодуля("СуммаЗачетРасчет", ПервоначальноеЗначение) Тогда
				РегламентированнаяОтчетность.роПроставитьВКвадратыЗначения(ЭтаФорма, "Расчет", "СуммаЗачет1_", 12, ПервоначальноеЗначение, Истина);
				Модифицированность = Истина;
				Расчет("Расчет");
			КонецЕсли;
		КонецЕсли;

	// Строка 060.
	ИначеЕсли Найти(Ячейка, "СуммаЛьготОргСоц") > 0 Тогда
		СтандартнаяОбработка = Ложь;
		ПервоначальноеЗначение = мСтруктураПеременных.СуммаЛьготОргСоцРасчет;
		Если ВвестиЧисло(ПервоначальноеЗначение, "Сумма льгот ... (строка 060)", 14, 2) Тогда

			ПервоначальноеЗначениеСтр = Формат(ПервоначальноеЗначение, мСтрокаФормата + ";ЧГ=0");
			Если СтрДлина(ПервоначальноеЗначениеСтр) > 12 Тогда
				Сообщить("Введенное значение нельзя отобразить в отчете.", СтатусСообщения.Важное);
				Возврат;
			КонецЕсли;

			Если ОбновитьПеременныеМодуля("СуммаЛьготОргСоцРасчет", ПервоначальноеЗначение) Тогда
				РегламентированнаяОтчетность.роПроставитьВКвадратыЗначения(ЭтаФорма, "Расчет", "СуммаЛьготОргСоц1_", 12, ПервоначальноеЗначение, Истина);
				Модифицированность = Истина;
				Расчет("Расчет");
			КонецЕсли;
		КонецЕсли;

	// Строка 070.
	ИначеЕсли Найти(Ячейка, "СуммаЛьготОрг") > 0 Тогда
		СтандартнаяОбработка = Ложь;
		ПервоначальноеЗначение = мСтруктураПеременных.СуммаЛьготОргРасчет;
		Если ВвестиЧисло(ПервоначальноеЗначение, "Сумма льгот ... (строка 070)", 14, 2) Тогда

			ПервоначальноеЗначениеСтр = Формат(ПервоначальноеЗначение, мСтрокаФормата + ";ЧГ=0");
			Если СтрДлина(ПервоначальноеЗначениеСтр) > 12 Тогда
				Сообщить("Введенное значение нельзя отобразить в отчете.", СтатусСообщения.Важное);
				Возврат;
			КонецЕсли;

			Если ОбновитьПеременныеМодуля("СуммаЛьготОргРасчет", ПервоначальноеЗначение) Тогда
				РегламентированнаяОтчетность.роПроставитьВКвадратыЗначения(ЭтаФорма, "Расчет", "СуммаЛьготОрг1_", 12, ПервоначальноеЗначение, Истина);
				Модифицированность = Истина;
				Расчет("Расчет");
			КонецЕсли;
		КонецЕсли;

	// Строка 080.
	ИначеЕсли Найти(Ячейка, "СуммаПлат") > 0 Тогда
		СтандартнаяОбработка = Ложь;
		ПервоначальноеЗначение = мСтруктураПеременных.СуммаПлатРасчет;

		Если ВвестиЧисло(ПервоначальноеЗначение, "Сумма платежа ... (строка 080)", 14, 2) Тогда

			ПервоначальноеЗначениеСтр = Формат(ПервоначальноеЗначение, мСтрокаФормата + ";ЧГ=0");
			Если СтрДлина(ПервоначальноеЗначениеСтр) > 12 Тогда
				Сообщить("Введенное значение нельзя отобразить в отчете.", СтатусСообщения.Важное);
				Возврат;
			КонецЕсли;

			Если ОбновитьПеременныеМодуля("СуммаПлатРасчет", ПервоначальноеЗначение) Тогда
				РегламентированнаяОтчетность.роПроставитьВКвадратыЗначения(ЭтаФорма, "Расчет", "СуммаПлат1_", 12, ПервоначальноеЗначение, Истина);
				Модифицированность = Истина;
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;

КонецПроцедуры // ПолеТабличногоДокументаРасчетВыбор

// ПолеТабличногоДокументаРаздел1Выбор
//
Процедура ПолеТабличногоДокументаРаздел1Выбор(Элемент, Область, СтандартнаяОбработка)

	Если РегламентированнаяОтчетность.ВыбраннаяОбластьРегламентированногоОтчетаНеВерна(ЭтаФорма, Область, СтандартнаяОбработка) Тогда
		Возврат;
	КонецЕсли;

	ОбластьИмя = Область.Имя;

	Если Найти(ОбластьИмя, "ОКАТО") > 0 Тогда

		СтандартнаяОбработка = Ложь;
		ПервоначальноеЗначение = РегламентированнаяОтчетность.роВернутьЗначениеПараметраСЛиста(ЭтаФорма, "Раздел1", "ОКАТО");
		РегламентированнаяОтчетность.ВвестиЗначениеПоказателяРеглОтчета(ЭтаФорма, "Раздел1", "ОКАТО", СокрЛП(ПервоначальноеЗначение), 11, 0, Ложь, "Введите код ОКАТО", "", Неопределено, Неопределено,СтандартнаяОбработка, 11);

	ИначеЕсли (Найти(Область.Имя, "П000010001002_") > 0) И (НЕ мАвтоВыборКодов) Тогда // Колонка 2, наименование

		СтандартнаяОбработка = Ложь;
		НомерСтроки = Сред(ОбластьИмя, 15);
		ПервоначальноеЗначение = Область.Значение;

		ВредныеВеществаРаздел1 = мВредныеВеществаРаздел1.Скопировать();
		ВредныеВеществаРаздел1.Колонки.Удалить("Код");

		РезультирующийПоиск = ВредныеВеществаРаздел1.Найти(ПервоначальноеЗначение, "Название");

		Если РезультирующийПоиск <> Неопределено Тогда
			Результат = ВредныеВеществаРаздел1.ВыбратьСтроку("Выбор загрязняющего вещества", РезультирующийПоиск);
		Иначе
			Результат = ВредныеВеществаРаздел1.ВыбратьСтроку("Выбор загрязняющего вещества");
		КонецЕсли;

		Если Результат = Неопределено Тогда
			Возврат;
		КонецЕсли;

		РезультатТекст = Результат.Получить(0); // Название.

		Результат = мВредныеВеществаРаздел1.Найти(РезультатТекст, "Название");

		Графа10 = ?(ПустаяСтрока(Результат.Получить(2)), 0, Число(Результат.Получить(2))); // Норматив для 10-й графы.
		Графа11 = ?(ПустаяСтрока(Результат.Получить(3)), 0, Число(Результат.Получить(3))); // Норматив для 11-й графы.

		Область.Значение = ?(РезультатТекст = "Пустое значение", "", РезультатТекст);
		Если ПустаяСтрока(Область.Значение) Тогда
			мРаздел1.Области["П000010001003_" + НомерСтроки].Значение = "";
		Иначе
			мРаздел1.Области["П000010001003_" + НомерСтроки].Значение = "Тонна";
		КонецЕсли;

		// Заполним нормативы: 10 и 11.
		мРаздел1.Области["П000010001010_" + НомерСтроки].Значение = Графа10;
		мРаздел1.Области["П000010001011_" + НомерСтроки].Значение = Графа11;
		ЗаписатьВМногострочныйБлок(мИдГруппы1, "П000010001010", НомерСтроки, Графа10);
		ЗаписатьВМногострочныйБлок(мИдГруппы1, "П000010001011", НомерСтроки, Графа11);

		Расчет("Раздел1");
		Модифицированность = Истина;

	ИначеЕсли (Найти(ОбластьИмя, "П000010001013_") > 0) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;
		НомерСтроки = Сред(ОбластьИмя, 15);

		ПоисковаяТабл = мКЭЗ_Раздел1;
		ПервоначальноеЗначение = Область.Значение;
		РезультирующийПоиск = ПоисковаяТабл.Найти(Формат(ПервоначальноеЗначение), "Код");

		Если РезультирующийПоиск <> Неопределено Тогда
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор коэффициента", РезультирующийПоиск);
		Иначе
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор коэффициента");
		КонецЕсли;

		Если Результат <> Неопределено Тогда
			Зн = Результат.Получить(0);
			Зн = ?(ПустаяСтрока(Зн), 0, Число(Зн));
			мРаздел1.Области["П000010001013_" + НомерСтроки].Значение = Зн;
			ЗаписатьВМногострочныйБлок(мИдГруппы1, "П000010001013", НомерСтроки, Зн);
			Расчет("Раздел1");
		КонецЕсли;

	ИначеЕсли (Найти(ОбластьИмя, "П000010001003") > 0) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;

		Список = Новый СписокЗначений;
		Список.Добавить("","Пустое значение");
		Список.Добавить("Тонна","Тонна");

		НайденнаяСтрока = Список.НайтиПоЗначению(Область.Значение);
		// выдаем стандартный диалог
		СписокЭлемент = ВыбратьИзСписка(Список,, НайденнаяСтрока);

		Если СписокЭлемент <> Неопределено  Тогда

			Область.Значение = СписокЭлемент.Значение;
			Модифицированность = Истина;
		КонецЕсли;

	ИначеЕсли (Найти(ОбластьИмя, "П000010001014") > 0) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;

		ПервоначальноеЗначение = Область.Значение;
		ПоисковаяТабл = мДопКоэфТЗ;
		РезультирующийПоиск = ПоисковаяТабл.Найти(Формат(ПервоначальноеЗначение), "Код");

		Если РезультирующийПоиск <> Неопределено Тогда
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор коэффициента", РезультирующийПоиск);
		Иначе
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор коэффициента");
		КонецЕсли;

		Если Результат = Неопределено Тогда
			Возврат;
		КонецЕсли;

		Область.Значение = ?(ПустаяСтрока(Результат.Получить(0)), 0, Число(Результат.Получить(0)));

		СтруктураГруппы1 = Неопределено;
		мСтруктураМногострочныхРазделов.Свойство(мИдГруппы1, СтруктураГруппы1);

		НомерСтроки = Сред(ОбластьИмя, 15);
		Колонка = Сред(ОбластьИмя, 1, 13);
		СтруктураГруппы1[Число(НомерСтроки) - 1][Колонка] = Область.Значение;

		Расчет("Раздел1");

		Модифицированность = Истина;

	ИначеЕсли (Найти(ОбластьИмя, "П000010001015") > 0) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;

		ПервоначальноеЗначение = Область.Значение;
		РезультатПоиска = мДополнительныйКоэф12.Найти(Формат(ПервоначальноеЗначение), "Код");
		Если РезультатПоиска <> Неопределено Тогда
			Результат = мДополнительныйКоэф12.ВыбратьСтроку("Выбор коэффициента", РезультатПоиска);
		Иначе
			Результат = мДополнительныйКоэф12.ВыбратьСтроку("Выбор коэффициента");
		КонецЕсли;

		Если Результат = Неопределено Тогда
			Возврат;
		КонецЕсли;

		Область.Значение = ?(ПустаяСтрока(Результат.Получить(0)), 0, Число(Результат.Получить(0)));
		НомерСтроки = Сред(ОбластьИмя, 15);
		ЗаписатьВМногострочныйБлок(мИдГруппы1, "П000010001015", НомерСтроки, Область.Значение);
		Расчет("Раздел1");
		Модифицированность = Истина;

	ИначеЕсли (Найти(ОбластьИмя, "П000010001016") > 0) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;

		ПервоначальноеЗначение = Область.Значение;
		РезультатПоиска = мКоэфИнфляция.Найти(Формат(ПервоначальноеЗначение), "Код");
		Если РезультатПоиска <> Неопределено Тогда
			Результат = мКоэфИнфляция.ВыбратьСтроку("Выбор коэффициента", РезультатПоиска);
		Иначе
			Результат = мКоэфИнфляция.ВыбратьСтроку("Выбор коэффициента");
		КонецЕсли;

		Если Результат = Неопределено Тогда
			Возврат;
		КонецЕсли;

		Область.Значение = ?(ПустаяСтрока(Результат.Получить(0)), 0, Число(Результат.Получить(0)));
		НомерСтроки = Сред(ОбластьИмя, 15);
		ЗаписатьВМногострочныйБлок(мИдГруппы1, "П000010001016", НомерСтроки, Область.Значение);
		Расчет("Раздел1");
		Модифицированность = Истина;

	ИначеЕсли ОбластьИмя = "ПоПроизТерр" Тогда
		СтандартнаяОбработка = Ложь;
		Модифицированность = Истина;
		Если Область.Значение = "V" Тогда
			Область.Значение = "";
		Иначе
			Область.Значение = "V";
			мРаздел1.Области.ПоХозСуб.Значение = "";
		КонецЕсли;
		
	ИначеЕсли ОбластьИмя = "ПоХозСуб" Тогда
		СтандартнаяОбработка = Ложь;
		Модифицированность = Истина;
		Если Область.Значение = "V" Тогда
			Область.Значение = "";
		Иначе
			Область.Значение = "V";
			мРаздел1.Области.ПоПроизТерр.Значение = "";
		КонецЕсли;
	
	КонецЕсли;

КонецПроцедуры // ПолеТабличногоДокументаРаздел1Выбор

// ПолеТабличногоДокументаРаздел4Выбор
//
Процедура ПолеТабличногоДокументаРаздел4Выбор(Элемент, Область, СтандартнаяОбработка)
	Если РегламентированнаяОтчетность.ВыбраннаяОбластьРегламентированногоОтчетаНеВерна(ЭтаФорма, Область, СтандартнаяОбработка) Тогда
		Возврат;
	КонецЕсли;

	ОбластьИмя = Область.Имя;

	
	Если Найти(ОбластьИмя, "ОКАТО") > 0 Тогда

		СтандартнаяОбработка = Ложь;
		ПервоначальноеЗначение = РегламентированнаяОтчетность.роВернутьЗначениеПараметраСЛиста(ЭтаФорма, "Раздел4", "ОКАТО");
		РегламентированнаяОтчетность.ВвестиЗначениеПоказателяРеглОтчета(ЭтаФорма, "Раздел4", "ОКАТО", СокрЛП(ПервоначальноеЗначение), 11, 0, Ложь, "Введите код ОКАТО", "", Неопределено, Неопределено,СтандартнаяОбработка, 11);

	ИначеЕсли ((Найти(ОбластьИмя, "П000040001002") > 0) Или     // Колонки 2 и 3
	      (Найти(ОбластьИмя, "П000040001003") > 0)) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;

		ПоисковаяТабл = мФКТОРаздел4;
		ПервоначальноеЗначение = Область.Значение;
		Колонка = ?(Найти(ОбластьИмя, "П000040001002") = 1, "Название", "Код");
		РезультирующийПоиск = ПоисковаяТабл.Найти(ПервоначальноеЗначение, Колонка);

		НомерСтроки = Сред(ОбластьИмя, 15);
		Если РезультирующийПоиск <> Неопределено Тогда
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор значения", РезультирующийПоиск);
		Иначе
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор значения");
		КонецЕсли;

		Если Результат <> Неопределено Тогда
			РезультатКод = Результат.Получить(0);
			РезультатНазв = Результат.Получить(1);
			РезультатНазв = ?(РезультатНазв = "Пустое значение", "", РезультатНазв);
			мРаздел4.Области["П000040001002_" + НомерСтроки].Значение = РезультатНазв;
			мРаздел4.Области["П000040001003_" + НомерСтроки].Значение = РезультатКод;
			Если ПустаяСтрока(РезультатКод) Тогда
				мРаздел4.Области["П000040001004_" + НомерСтроки].Значение = "";
			Иначе
				мРаздел4.Области["П000040001004_" + НомерСтроки].Значение = "Тонна";
			КонецЕсли;
		КонецЕсли;

	ИначеЕсли (Найти(ОбластьИмя, "П000040001005") > 0) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;

		ПоисковаяТабл = мКлассыОпасности;
		ПервоначальноеЗначение = Область.Значение;
		РезультирующийПоиск = ПоисковаяТабл.Найти(ПервоначальноеЗначение, "Код");

		НомерСтроки = Сред(ОбластьИмя, 15);
		Если РезультирующийПоиск <> Неопределено Тогда
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор значения", РезультирующийПоиск);
		Иначе
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор значения");
		КонецЕсли;

		Если Результат <> Неопределено Тогда

			РезСтрока = Результат.Получить(1);
			Если РезСтрока <> "Пустое значение" Тогда
				РезСтрока = СтрЗаменить(РезСтрока, " ", Символы.ПС);
				Зн = СтрПолучитьСтроку(РезСтрока, СтрЧислоСтрок(РезСтрока));
				Зн = СтрЗаменить(Зн, ")", "");
				Если РегламентированнаяОтчетность.роЯвляетсяЧислом(Зн) Тогда
					Зн = Число(Зн);
					мРаздел4.Области["П000040001005_" + НомерСтроки].Значение = Результат.Получить(0);
					мРаздел5.Области["П000050001019_" + НомерСтроки].Значение = Зн;
					ЗаписатьВМногострочныйБлок(мИдГруппы5, "П000050001019", НомерСтроки, Зн);
					Расчет("Раздел5");
				КонецЕсли;
			Иначе
				мРаздел4.Области["П000040001005_" + НомерСтроки].Значение = "";
				мРаздел5.Области["П000050001019_" + НомерСтроки].Значение = 0;
				ЗаписатьВМногострочныйБлок(мИдГруппы5, "П000050001019", НомерСтроки, 0);
				Расчет("Раздел5");
			КонецЕсли;
		КонецЕсли;

	ИначеЕсли ОбластьИмя = "Объект1" Тогда
		СтандартнаяОбработка = Ложь;
		Модифицированность = Истина;
		Если Область.Значение = "V" Тогда
			Область.Значение = "";
		Иначе
			Область.Значение = "V";
			мРаздел4.Области.Объект2.Значение = "";
		КонецЕсли;

	ИначеЕсли ОбластьИмя = "Объект2" Тогда
		СтандартнаяОбработка = Ложь;
		Модифицированность = Истина;
		Если Область.Значение = "V" Тогда
			Область.Значение = "";
		Иначе
			Область.Значение = "V";
			мРаздел4.Области.Объект1.Значение = "";
		КонецЕсли;

	ИначеЕсли ОбластьИмя = "Объект3" Тогда
		СтандартнаяОбработка = Ложь;
		Модифицированность = Истина;
		Если Область.Значение = "V" Тогда
			Область.Значение = "";
		Иначе
			Область.Значение = "V";
			мРаздел4.Области.Объект4.Значение = "";
		КонецЕсли;

	ИначеЕсли ОбластьИмя = "Объект4" Тогда
		СтандартнаяОбработка = Ложь;
		Модифицированность = Истина;
		Если Область.Значение = "V" Тогда
			Область.Значение = "";
		Иначе
			Область.Значение = "V";
			мРаздел4.Области.Объект3.Значение = "";
		КонецЕсли;

	ИначеЕсли (Найти(ОбластьИмя, "П000040001004") > 0) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;

		Список = Новый СписокЗначений;
		Список.Добавить("","Пустое значение");
		Список.Добавить("Тонна","Тонна");

		НайденнаяСтрока = Список.НайтиПоЗначению(Область.Значение);
		// выдаем стандартный диалог
		СписокЭлемент = ВыбратьИзСписка(Список,, НайденнаяСтрока);

		Если СписокЭлемент <> Неопределено  Тогда
			Область.Значение = СписокЭлемент.Значение;
			Модифицированность = Истина;
		КонецЕсли;
	КонецЕсли;

КонецПроцедуры // ПолеТабличногоДокументаРаздел4Выбор

// ПолеТабличногоДокументаРаздел3Выбор
//
Процедура ПолеТабличногоДокументаРаздел3Выбор(Элемент, Область, СтандартнаяОбработка)

	Если РегламентированнаяОтчетность.ВыбраннаяОбластьРегламентированногоОтчетаНеВерна(ЭтаФорма, Область, СтандартнаяОбработка) Тогда
		Возврат;
	КонецЕсли;

	ОбластьИмя = Область.Имя;

	Если Найти(ОбластьИмя, "ОКАТО") > 0 Тогда

		СтандартнаяОбработка = Ложь;
		ПервоначальноеЗначение = РегламентированнаяОтчетность.роВернутьЗначениеПараметраСЛиста(ЭтаФорма, "Раздел3", "ОКАТО");
		РегламентированнаяОтчетность.ВвестиЗначениеПоказателяРеглОтчета(ЭтаФорма, "Раздел3", "ОКАТО", СокрЛП(ПервоначальноеЗначение), 11, 0, Ложь, "Введите код ОКАТО", "", Неопределено, Неопределено,СтандартнаяОбработка, 11);

	ИначеЕсли (Найти(ОбластьИмя, "П000030001002") > 0) И (НЕ мАвтоВыборКодов) Тогда // Колонка 2

		СтандартнаяОбработка = Ложь;

		НомерСтроки = Сред(ОбластьИмя, 15);
		ПервоначальноеЗначение = Область.Значение;
		Колонка = Сред(ОбластьИмя, 1, 13);

		ВредныеВеществаРаздел3 = мВредныеВеществаРаздел3.Скопировать();
		ВредныеВеществаРаздел3.Колонки.Удалить("Код");

		РезультирующийПоиск = ВредныеВеществаРаздел3.Найти(ПервоначальноеЗначение, "Название");

		Если РезультирующийПоиск <> Неопределено Тогда
			Результат = ВредныеВеществаРаздел3.ВыбратьСтроку("Выбор загрязняющего вещества", РезультирующийПоиск);
		Иначе
			Результат = ВредныеВеществаРаздел3.ВыбратьСтроку("Выбор загрязняющего вещества");
		КонецЕсли;

		Если Результат = Неопределено Тогда
			Возврат;
		КонецЕсли;

		РезультатТекст = Результат.Получить(0); // Название.

		Результат = мВредныеВеществаРаздел3.Найти(РезультатТекст, "Название");

		Графа9 = Результат.Получить(2); // Норматив для 10-й строки.
		Графа10 = Результат.Получить(3); // Норматив для 11-й строки.

		Область.Значение = ?(РезультатТекст = "Пустое значение", "", РезультатТекст);

		Если (СтрДлина(Графа9) > 10) Или (СтрДлина(Графа10) > 10) Тогда
			Сообщить("Данный показатель не может быть отражен в отчете. Используйте печатную форму.", СтатусСообщения.Информация);
			Графа9 = "";
			Графа10 = "";
		КонецЕсли;

		Графа9 = ?(ПустаяСтрока(Графа9), 0, Число(Графа9));
		Графа10 = ?(ПустаяСтрока(Графа10), 0, Число(Графа10));

		ЗаписатьВМногострочныйБлок(мИдГруппы3, "П000030001009", НомерСтроки, Графа9);
		ЗаписатьВМногострочныйБлок(мИдГруппы3, "П000030001010", НомерСтроки, Графа10);

		мРаздел3.Области["П000030001009_" + НомерСтроки].Значение = Графа9;
		мРаздел3.Области["П000030001010_" + НомерСтроки].Значение = Графа10;

		Расчет("Раздел3");
		Модифицированность = Истина;

	// Колонка 13
	ИначеЕсли (Найти(ОбластьИмя, "П000030001012") > 0) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;
		ПервоначальноеЗначение = Область.Значение;
		НомерСтроки = Сред(ОбластьИмя, 15);

		ПоисковаяТабл = мКЭЗ_ВодныеОбъекты;
		РезультирующийПоиск = ПоисковаяТабл.Найти(Формат(ПервоначальноеЗначение), "Код");

		Если РезультирующийПоиск <> Неопределено Тогда
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор коэффициента", РезультирующийПоиск);
		Иначе
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор коэффициента");
		КонецЕсли;

		Если Результат <> Неопределено Тогда
			Зн = Результат.Получить(0);
			Зн = ?(ПустаяСтрока(Зн), 0, Число(Зн));
			мРаздел3.Области["П000030001012_" + НомерСтроки].Значение = Зн;
			ЗаписатьВМногострочныйБлок(мИдГруппы3, "П000030001012", НомерСтроки, Зн);
			Расчет("Раздел3");
		КонецЕсли;

	ИначеЕсли (Найти(Область.Имя, "П000030001013") > 0) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;

		ПервоначальноеЗначение = Область.Значение;
		ПоисковаяТабл = мДопКоэфТЗ;
		РезультирующийПоиск = ПоисковаяТабл.Найти(Формат(ПервоначальноеЗначение), "Код");

		Если РезультирующийПоиск <> Неопределено Тогда
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор коэффициента", РезультирующийПоиск);
		Иначе
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор коэффициента");
		КонецЕсли;

		Если Результат = Неопределено Тогда
			Возврат;
		КонецЕсли;

		Область.Значение = ?(ПустаяСтрока(Результат.Получить(0)), 0, Число(Результат.Получить(0)));

		НомерСтроки = Сред(ОбластьИмя, 15);
		ЗаписатьВМногострочныйБлок(мИдГруппы3, "П000030001013", НомерСтроки, Область.Значение);
		Расчет("Раздел3");
		Модифицированность = Истина;

	ИначеЕсли (Найти(ОбластьИмя, "П000030001015_") > 0) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;

		ПервоначальноеЗначение = Область.Значение;
		ПоисковаяТабл = мКоэфИнфляция;
		РезультирующийПоиск = ПоисковаяТабл.Найти(Формат(ПервоначальноеЗначение), "Код");

		Если РезультирующийПоиск <> Неопределено Тогда
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор коэффициента", РезультирующийПоиск);
		Иначе
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор коэффициента");
		КонецЕсли;

		Если Результат = Неопределено Тогда
			Возврат;
		КонецЕсли;

		Область.Значение = ?(ПустаяСтрока(Результат.Получить(0)), 0, Число(Результат.Получить(0)));

		НомерСтроки = Сред(ОбластьИмя, 15);
		ЗаписатьВМногострочныйБлок(мИдГруппы3, "П000030001015", НомерСтроки, Область.Значение);
		Расчет("Раздел3");
		Модифицированность = Истина;

	ИначеЕсли ОбластьИмя = "ПоПроизТерр" Тогда
		СтандартнаяОбработка = Ложь;
		Модифицированность = Истина;
		Если Область.Значение = "V" Тогда
			Область.Значение = "";
		Иначе
			Область.Значение = "V";
			мРаздел3.Области.ПоХозСуб.Значение = "";
		КонецЕсли;
		
	ИначеЕсли ОбластьИмя = "ПоХозСуб" Тогда
		СтандартнаяОбработка = Ложь;
		Модифицированность = Истина;
		Если Область.Значение = "V" Тогда
			Область.Значение = "";
		Иначе
			Область.Значение = "V";
			мРаздел3.Области.ПоПроизТерр.Значение = "";
        КонецЕсли;
			
	КонецЕсли;

КонецПроцедуры // ПолеТабличногоДокументаРаздел3Выбор

// ПолеТабличногоДокументаРаздел5Выбор
//
Процедура ПолеТабличногоДокументаРаздел5Выбор(Элемент, Область, СтандартнаяОбработка)
	Если РегламентированнаяОтчетность.ВыбраннаяОбластьРегламентированногоОтчетаНеВерна(ЭтаФорма, Область, СтандартнаяОбработка) Тогда
		Возврат;
	КонецЕсли;

	ОбластьИмя = Область.Имя;
	Если (Найти(ОбластьИмя, "П000050001022") > 0) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;

		ПервоначальноеЗначение = Область.Значение;
		ПоисковаяТабл = мДопКоэфТЗ;
		РезультирующийПоиск = ПоисковаяТабл.Найти(Формат(ПервоначальноеЗначение), "Код");

		Если РезультирующийПоиск <> Неопределено Тогда
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор коэффициента", РезультирующийПоиск);
		Иначе
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор коэффициента");
		КонецЕсли;

		Если Результат = Неопределено Тогда
			Возврат;
		КонецЕсли;

		Область.Значение = ?(ПустаяСтрока(Результат.Получить(0)), 0, Число(Результат.Получить(0)));
		НомерСтроки = Сред(ОбластьИмя, 15);
		ЗаписатьВМногострочныйБлок(мИдГруппы5, "П000050001022", НомерСтроки, Область.Значение);
		Расчет("Раздел5");

		Модифицированность = Истина;

	ИначеЕсли (Найти(ОбластьИмя, "П000050001021_") > 0) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;
		НомерСтроки = Сред(ОбластьИмя, 15);

		ПоисковаяТабл = мКЭЗ_Раздел4;
		ПервоначальноеЗначение = Область.Значение;
		РезультирующийПоиск = ПоисковаяТабл.Найти(Формат(ПервоначальноеЗначение), "Код");

		Если РезультирующийПоиск <> Неопределено Тогда
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор коэффициента", РезультирующийПоиск);
		Иначе
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор коэффициента");
		КонецЕсли;

		Если Результат <> Неопределено Тогда
			Зн = Результат.Получить(0);
			Зн = ?(ПустаяСтрока(Зн), 0, Число(Зн));
			мРаздел5.Области["П000050001021_" + НомерСтроки].Значение = Зн;
			ЗаписатьВМногострочныйБлок(мИдГруппы5, "П000050001021", НомерСтроки, Зн);
			Расчет("Раздел5");
		КонецЕсли;

	ИначеЕсли (Найти(ОбластьИмя, "П000050001023_") > 0) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;

		ПервоначальноеЗначение = Область.Значение;
		РезультатПоиска = мКоэфИнфляция.Найти(Формат(ПервоначальноеЗначение), "Код");
		Если РезультатПоиска <> Неопределено Тогда
			Результат = мКоэфИнфляция.ВыбратьСтроку("Выбор коэффициента", РезультатПоиска);
		Иначе
			Результат = мКоэфИнфляция.ВыбратьСтроку("Выбор коэффициента");
		КонецЕсли;

		Если Результат = Неопределено Тогда
			Возврат;
		КонецЕсли;

		Область.Значение = ?(ПустаяСтрока(Результат.Получить(0)), 0, Число(Результат.Получить(0)));
		НомерСтроки = Сред(ОбластьИмя, 15);
		ЗаписатьВМногострочныйБлок(мИдГруппы5, "П000050001023", НомерСтроки, Область.Значение);
		Расчет("Раздел5");
		Модифицированность = Истина;

	ИначеЕсли (Найти(ОбластьИмя, "П000050001024_") > 0) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;

		ПоисковаяТабл = мРасположениеОбъекта;
		РезультирующийПоиск = ПоисковаяТабл.Найти(Формат(Область.Значение), "Код");

		Если РезультирующийПоиск <> Неопределено Тогда
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор коэффициента", РезультирующийПоиск);
		Иначе
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор коэффициента");
		КонецЕсли;

		Если Результат <> Неопределено  Тогда

			Результат = Результат.Получить(0);
			Область.Значение = Результат;

			НомерСтроки = Сред(ОбластьИмя, 15);
			ЗаписатьВМногострочныйБлок(мИдГруппы5, "П000050001024", НомерСтроки, Область.Значение);
			Расчет("Раздел5");
			Модифицированность = Истина;

		КонецЕсли;
	КонецЕсли;

КонецПроцедуры // ПолеТабличногоДокументаРаздел5Выбор

// ПолеТабличногоДокументаРаздел2Выбор
//
Процедура ПолеТабличногоДокументаРаздел2Выбор(Элемент, Область, СтандартнаяОбработка)

	Если РегламентированнаяОтчетность.ВыбраннаяОбластьРегламентированногоОтчетаНеВерна(ЭтаФорма, Область, СтандартнаяОбработка) Тогда
		Возврат;
	КонецЕсли;

	ОбластьИмя = Область.Имя;

	Если Найти(ОбластьИмя, "ОКАТО") > 0 Тогда

		СтандартнаяОбработка = Ложь;
		ПервоначальноеЗначение = РегламентированнаяОтчетность.роВернутьЗначениеПараметраСЛиста(ЭтаФорма, "Раздел2", "ОКАТО");
		РегламентированнаяОтчетность.ВвестиЗначениеПоказателяРеглОтчета(ЭтаФорма, "Раздел2", "ОКАТО", СокрЛП(ПервоначальноеЗначение), 11, 0, Ложь, "Введите код ОКАТО", "", Неопределено, Неопределено,СтандартнаяОбработка, 11);

	ИначеЕсли (Найти(ОбластьИмя, "П000020001004") > 0) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;

		Список = Новый СписокЗначений;
		Список.Добавить("","Пустое значение");
		Список.Добавить("Тонна","Тонна");
		Список.Добавить("Тысяча. куб. метров","Тысяча куб. метров");

		НайденнаяСтрока = Список.НайтиПоЗначению(Область.Значение);
		// выдаем стандартный диалог
		СписокЭлемент = ВыбратьИзСписка(Список,, НайденнаяСтрока);

		Если СписокЭлемент <> Неопределено  Тогда
			Область.Значение = СписокЭлемент.Значение;
			Модифицированность = Истина;
		КонецЕсли;

	ИначеЕсли (Найти(ОбластьИмя, "П000020001007") > 0) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;

		ПервоначальноеЗначение = Область.Значение;
		ПоисковаяТабл = мДопКоэфТЗ;
		РезультирующийПоиск = ПоисковаяТабл.Найти(Формат(ПервоначальноеЗначение), "Код");

		Если РезультирующийПоиск <> Неопределено Тогда
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор коэффициента", РезультирующийПоиск);
		Иначе
			Результат = ПоисковаяТабл.ВыбратьСтроку("Выбор коэффициента");
		КонецЕсли;

		Если Результат = Неопределено Тогда
			Возврат;
		КонецЕсли;

		Область.Значение = ?(ПустаяСтрока(Результат.Получить(0)), 0, Число(Результат.Получить(0)));

		СтруктураГруппы2 = Неопределено;
		мСтруктураМногострочныхРазделов.Свойство(мИдГруппы2, СтруктураГруппы2);

		НомерСтроки = Сред(ОбластьИмя, 15);
		Колонка = Сред(ОбластьИмя, 1, 13);
		СтруктураГруппы2[Число(НомерСтроки) - 1][Колонка] = Область.Значение;
		Расчет("Раздел2");

		Модифицированность = Истина;

	ИначеЕсли (Найти(ОбластьИмя, "П000020001008") > 0) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;

		ПервоначальноеЗначение = Область.Значение;
		РезультатПоиска = мДополнительныйКоэф12.Найти(Формат(ПервоначальноеЗначение), "Код");
		Если РезультатПоиска <> Неопределено Тогда
			Результат = мДополнительныйКоэф12.ВыбратьСтроку("Выбор коэффициента", РезультатПоиска);
		Иначе
			Результат = мДополнительныйКоэф12.ВыбратьСтроку("Выбор коэффициента");
		КонецЕсли;

		Если Результат = Неопределено Тогда
			Возврат;
		КонецЕсли;

		Область.Значение = ?(ПустаяСтрока(Результат.Получить(0)), 0, Число(Результат.Получить(0)));
		НомерСтроки = Сред(ОбластьИмя, 15);
		ЗаписатьВМногострочныйБлок(мИдГруппы2, "П000020001008", НомерСтроки, Область.Значение);
		Расчет("Раздел2");
		Модифицированность = Истина;

	ИначеЕсли (Найти(ОбластьИмя, "П000020001002") > 0) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;
		НомерСтроки = Сред(ОбластьИмя, 15);

		ПервоначальноеЗначение = Область.Значение;
		ПоисковаяТабл = мНормативыПлатыРаздел2;
		РезультирующийПоиск = ПоисковаяТабл.Найти(ПервоначальноеЗначение, "Название");

		Если РезультирующийПоиск <> Неопределено Тогда
			Результат = ПоисковаяТабл.ВыбратьСтроку("Вид топлива", РезультирующийПоиск);
		Иначе
			Результат = ПоисковаяТабл.ВыбратьСтроку("Вид топлива");
		КонецЕсли;

		Если Результат = Неопределено Тогда
			Возврат;
		КонецЕсли;

		РезультатТекст = Результат.Получить(1);
		РезультатКоэф = Результат.Получить(0);

		РезультатТекст = ?(ПустаяСтрока(РезультатКоэф), "", РезультатТекст);
		РезультатКоэф = ?(ПустаяСтрока(РезультатКоэф), 0, Число(РезультатКоэф));

		Зн = РезультатКоэф;
		мРаздел2.Области["П000020001005_" + НомерСтроки].Значение = Зн;
		ЗаписатьВМногострочныйБлок(мИдГруппы2, "П000020001005", НомерСтроки, Зн);

		Область.Значение = РезультатТекст;

		Если ПустаяСтрока(РезультатТекст) Тогда
			Область.Значение = "";
			мРаздел2.Области["П000020001004_" + НомерСтроки].Значение = "";
			Расчет("Раздел2");
			Модифицированность = Истина;
			Возврат;
		КонецЕсли;

		Расчет("Раздел2");

		Если Область.Значение = "Сжатый природный газ" Тогда
			мРаздел2.Области["П000020001004_" + НомерСтроки].Значение = "Тысяча куб. метров";
		ИначеЕсли НЕ ПустаяСтрока(РезультатТекст) Тогда
			мРаздел2.Области["П000020001004_" + НомерСтроки].Значение = "Тонна";
		Иначе
			мРаздел2.Области["П000020001004_" + НомерСтроки].Значение = "";
		КонецЕсли;

		Модифицированность = Истина;

	// Графа 8
	ИначеЕсли (Найти(ОбластьИмя, "П000020001005_") > 0) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;
		НомерСтроки = Сред(ОбластьИмя, 15);
		Колонка = Сред(ОбластьИмя, 1, 13);
		ПервоначальноеЗначение = Область.Значение;

		// Т.к. два одинковых коэф. 2.5, то объединим названия.
		ПоисковаяТабл = мНормативыПлатыРаздел2.Скопировать();
		ПоисковаяТабл[2].Название = ПоисковаяТабл[2].Название + " и керосин";
		ПоисковаяТабл.Удалить(3);

		РезультирующийПоиск = ПоисковаяТабл.Найти(Формат(ПервоначальноеЗначение), "Код");

		Если РезультирующийПоиск <> Неопределено Тогда
			Результат = ПоисковаяТабл.ВыбратьСтроку("Введите норматив", РезультирующийПоиск);
		Иначе
			Результат = ПоисковаяТабл.ВыбратьСтроку("Введите норматив");
		КонецЕсли;

		Если Результат = Неопределено Тогда
			Возврат;
		КонецЕсли;

		Результат = ?(ПустаяСтрока(Результат.Получить(0)), 0, Число(Результат.Получить(0)));
		мРаздел2.Области["П000020001005_" + НомерСтроки].Значение = Результат;

		ЗаписатьВМногострочныйБлок(мИдГруппы2, Колонка, НомерСтроки, Результат);

		Расчет("Раздел2");

	// Графа 9
	ИначеЕсли (Найти(ОбластьИмя, "П000020001006_") > 0) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;
		НомерСтроки = Сред(ОбластьИмя, 15);
		ПервоначальноеЗначение = Область.Значение;
		Колонка = Сред(ОбластьИмя, 1, 13);

		ПоисковаяТабл = мКЭЗ_Раздел1;

		РезультирующийПоиск = ПоисковаяТабл.Найти(Формат(ПервоначальноеЗначение), "Код");

		Если РезультирующийПоиск <> Неопределено Тогда
			Результат = ПоисковаяТабл.ВыбратьСтроку("Введите норматив", РезультирующийПоиск);
		Иначе
			Результат = ПоисковаяТабл.ВыбратьСтроку("Введите норматив");
		КонецЕсли;

		Если Результат = Неопределено Тогда
			Возврат;
		КонецЕсли;

		Результат = ?(ПустаяСтрока(Результат.Получить(0)), 0, Число(Результат.Получить(0)));
		мРаздел2.Области["П000020001006_" + НомерСтроки].Значение = Результат;
		ЗаписатьВМногострочныйБлок(мИдГруппы2, Колонка, НомерСтроки, Результат);
		Расчет("Раздел2");

	ИначеЕсли (Найти(ОбластьИмя, "П000020001009_") > 0) И (НЕ мАвтоВыборКодов) Тогда
		СтандартнаяОбработка = Ложь;

		ПервоначальноеЗначение = Область.Значение;
		РезультатПоиска = мКоэфИнфляция.Найти(Формат(ПервоначальноеЗначение), "Код");
		Если РезультатПоиска <> Неопределено Тогда
			Результат = мКоэфИнфляция.ВыбратьСтроку("Выбор коэффициента", РезультатПоиска);
		Иначе
			Результат = мКоэфИнфляция.ВыбратьСтроку("Выбор коэффициента");
		КонецЕсли;

		Если Результат = Неопределено Тогда
			Возврат;
		КонецЕсли;

		Область.Значение = ?(ПустаяСтрока(Результат.Получить(0)), 0, Число(Результат.Получить(0)));
		НомерСтроки = Сред(ОбластьИмя, 15);
		ЗаписатьВМногострочныйБлок(мИдГруппы2, "П000020001009", НомерСтроки, Область.Значение);
		Расчет("Раздел2");
		Модифицированность = Истина;

	КонецЕсли;

КонецПроцедуры // ПолеТабличногоДокументаРаздел2Выбор

// ПолеТабличногоДокументаТитульныйВыбор
//
Процедура ПолеТабличногоДокументаТитульныйВыбор(Элемент, Область, СтандартнаяОбработка)
	Если РегламентированнаяОтчетность.ВыбраннаяОбластьРегламентированногоОтчетаНеВерна(ЭтаФорма, Область, СтандартнаяОбработка) Тогда
		Возврат;
	КонецЕсли;
КонецПроцедуры // ПолеТабличногоДокументаТитульныйВыбор

////////////////////////////////////////////////////////////////////////////////
//	ПРОЦЕДУРЫ И ФУНКЦИИ МЕХАНИЗМА АВТОСОХРАНЕНИЯ 
//                                                             

// Процедура является частью механизма автосохранения 
// и назначается динамически методом ПодключитьОбработчикОжидания()
// Обработчик может подключаться и отключаться из процедуры ПриОткрытии текущей формы и
// процедуры ОсновныеДействияФормыКнопкаВыбратьНажатие формы ФормаНастройки
Процедура ОбработчикСобытияПоТаймеру()
	
	Если РегламентированнаяОтчетность.АвтосохранениеВозможно(ЭтаФорма) Тогда
		Сохранить(Истина);
	КонецЕсли;
	
КонецПроцедуры

Процедура КоманднаяПанельФормыРасширитьПолеБланка(Кнопка)
	
	РегламентированнаяОтчетность.ПриНажатииНаКнопкуПереходаВРежимВводаДанных(ЭтаФорма);
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////

Процедура СтатусНачалоВыбора(Элемент, СтандартнаяОбработка)
	
	РегламентированнаяОтчетность.НачалоВыбораСтатусаВРегламентированномОтчете(ЭтаФорма, Элемент, СтандартнаяОбработка);
	
КонецПроцедуры

Процедура СтатусПриИзменении(Элемент)
	
	РегламентированнаяОтчетность.ПриИзмененииСтатусаВРегламентированномОтчете(ЭтаФорма, Элемент);
	
КонецПроцедуры

Процедура СтатусОчистка(Элемент, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	
КонецПроцедуры

Процедура ОбработкаОповещения(ИмяСобытия, Параметр, Источник)
	
	РегламентированнаяОтчетность.ОбработкаОповещенияОбИзмененииСтатусаРегламентированногоОтчета(ЭтаФорма, ИмяСобытия, Параметр, Источник);
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОПЕРАТОРЫ ОСНОВНОЙ ПРОГРАММЫ

мТекстыСтрок = Новый Соответствие;
мТекстыСтрок.Вставить("1", "Плата за выбросы от стационарного объекта в пределах ПДВ");
мТекстыСтрок.Вставить("2", "Плата за выбросы от стационарного объекта в пределах ВСВ");
мТекстыСтрок.Вставить("3", "Плата за сверхлимитные выбросы от стационарного объекта");
мТекстыСтрок.Вставить("4", "Плата за выбросы от передвижного объекта");
мТекстыСтрок.Вставить("5", "Плата за сбросы загрязняющих веществ в пределах ПДС");
мТекстыСтрок.Вставить("6", "Плата за сбросы загрязняющих веществ в пределах ВСС");
мТекстыСтрок.Вставить("7", "Плата за сверхлимитные сбросы загрязняющих веществ");
мТекстыСтрок.Вставить("8", "Плата за размещение отходов в пределах установленных лимитов");
мТекстыСтрок.Вставить("9", "Плата за сверхлимитное размещение отходов");

мСтруктураНеОчищаемыхКолонок = Новый Структура;
мСтруктураНеОчищаемыхКолонок.Вставить("П000010001012");
мСтруктураНеОчищаемыхКолонок.Вставить("П000030001011");
мСтруктураНеОчищаемыхКолонок.Вставить("П000050001020");

мСоставПоказателей = "СоставПоказателей2008Кв2";

мИдГруппы1  = "П0000100010";
мИдГруппы2  = "П0000200010";
мИдГруппы3  = "П0000300010";
мИдГруппы4  = "П0000400010";
мИдГруппы5  = "П0000500010";

КолИсхСтрокИдГруппы1 = 16;
КолИсхСтрокИдГруппы2 = 16;
КолИсхСтрокИдГруппы3 = 16;
КолИсхСтрокИдГруппы4 = 16;
КолИсхСтрокИдГруппы5 = 16;

МассивБулево = Новый Массив;
МассивБулево.Добавить(Тип("Булево"));
мОписаниеТиповБулево    = Новый ОписаниеТипов(МассивБулево);

// Список выбора поля выбора "Единица измерения"
ЭлементыФормы.ПолеВыбораЕдиницаИзмерения.СписокВыбора.Добавить(Перечисления.ПорядкиОкругленияОтчетности.Окр1,       "в рублях");
ЭлементыФормы.ПолеВыбораЕдиницаИзмерения.СписокВыбора.Добавить(Перечисления.ПорядкиОкругленияОтчетности.Окр1000,    "в тысячах рублей");
ЭлементыФормы.ПолеВыбораЕдиницаИзмерения.СписокВыбора.Добавить(Перечисления.ПорядкиОкругленияОтчетности.Окр1000000, "в миллионах рублей");

мКодыБюджетнойКлассификации2005 = Новый ТаблицаЗначений;
мКодыБюджетнойКлассификации2005.Колонки.Добавить("Код",,, 18);
мКодыБюджетнойКлассификации2005.Колонки.Добавить("Название",,, 50);

мКодыБюджетнойКлассификации2012 = Новый ТаблицаЗначений;
мКодыБюджетнойКлассификации2012.Колонки.Добавить("Код",,, 18);
мКодыБюджетнойКлассификации2012.Колонки.Добавить("Название",,, 50);

мРасположениеОбъекта = Новый ТаблицаЗначений;
мРасположениеОбъекта.Колонки.Добавить("Код",,, 4);
мРасположениеОбъекта.Колонки.Добавить("Название",,, 90);

мДополнительныйКоэф12 = Новый ТаблицаЗначений;
мДополнительныйКоэф12.Колонки.Добавить("Код",,"Значение", 9);
мДополнительныйКоэф12.Колонки.Добавить("Название",,, 90);

мКЭЗ_Раздел1 = Новый ТаблицаЗначений;
мКЭЗ_Раздел1.Колонки.Добавить("Код", , "Значение", 9);
мКЭЗ_Раздел1.Колонки.Добавить("Название", , "Экономические районы РФ", 90);

мКЭЗ_Раздел4 = Новый ТаблицаЗначений;
мКЭЗ_Раздел4.Колонки.Добавить("Код", , "Значение", 9);
мКЭЗ_Раздел4.Колонки.Добавить("Название", , "Экономические районы РФ", 90);

мДопКоэфТЗ = Новый ТаблицаЗначений;
мДопКоэфТЗ.Колонки.Добавить("Код",, "Значение", 9);
мДопКоэфТЗ.Колонки.Добавить("Название",,, 90);

мКЭЗ_ВодныеОбъекты = Новый ТаблицаЗначений;
мКЭЗ_ВодныеОбъекты.Колонки.Добавить("Код",, "Значение", 9);
мКЭЗ_ВодныеОбъекты.Колонки.Добавить("Название",, "Бассейны морей и рек", 90);

мКлассыОпасности = Новый ТаблицаЗначений;
мКлассыОпасности.Колонки.Добавить("Код",,"Класс", 6);
мКлассыОпасности.Колонки.Добавить("Название",,, 90);

мЭкологическийКлассРаздел2 = Новый ТаблицаЗначений;
мЭкологическийКлассРаздел2.Колонки.Добавить("Код",,"Класс", 6);
мЭкологическийКлассРаздел2.Колонки.Добавить("Название",,, 90);

мНормативыПлатыРаздел2 = Новый ТаблицаЗначений;
мНормативыПлатыРаздел2.Колонки.Добавить("Код",,"Норматив", 9);
мНормативыПлатыРаздел2.Колонки.Добавить("Название",,"Вид топлива", 90);

мВредныеВеществаРаздел1 = Новый ТаблицаЗначений;
мВредныеВеществаРаздел1.Колонки.Добавить("Код");
мВредныеВеществаРаздел1.Колонки.Добавить("Название",,"Наименование загрязняющих веществ", 90);
мВредныеВеществаРаздел1.Колонки.Добавить("Строка110",, "Норматив ПУДНВ", 18);
мВредныеВеществаРаздел1.Колонки.Добавить("Строка120",, "Норматив ПУЛВ", 18);

мВредныеВеществаРаздел3 = Новый ТаблицаЗначений;
мВредныеВеществаРаздел3.Колонки.Добавить("Код");
мВредныеВеществаРаздел3.Колонки.Добавить("Название",,"Наименование загрязняющих веществ", 90);
мВредныеВеществаРаздел3.Колонки.Добавить("Строка110",, "Норматив ПУДНВ", 12);
мВредныеВеществаРаздел3.Колонки.Добавить("Строка120",, "Норматив ПУЛВ", 12);

мФКТОРаздел4 = Новый ТаблицаЗначений;
мФКТОРаздел4.Колонки.Добавить("Код",,, 15);
мФКТОРаздел4.Колонки.Добавить("Название",, "Наименование", 90);

мКоэфИнфляция = Новый ТаблицаЗначений;
мКоэфИнфляция.Колонки.Добавить("Код",,"Значение", 9);
мКоэфИнфляция.Колонки.Добавить("Название",, "Наименование", 90);

ЦветЗаполняетсяТолькоВручную     = Новый Цвет(255, 255, 225);
ЦветЗаполняетсяАвтоКорректир     = Новый Цвет(255, 240, 200);
ЦветЗаполняетсяАвтоБезКорректир  = Новый Цвет(230, 240, 220);
ЦветЗаполняетсяАвтоАрифметика    = Новый Цвет(192, 220, 192);     // ЗЕЛЕНЫЙ
ЦветЗаполняетсяОднозначноВручную = Новый Цвет(255, 255, 192);  // ЖЕЛТЫЙ
ЦветЗаполняетсяАвтоматически     = Новый Цвет(255, 255, 255);      // Белый, Ввод запрещен

// структура цветов раскраски автозаполняемых ячеек
мСтруктураЦветовРаскраски = Новый Структура;
мСтруктураЦветовРаскраски.Вставить("_1", ЦветЗаполняетсяТолькоВручную);
мСтруктураЦветовРаскраски.Вставить("_2", ЦветЗаполняетсяАвтоКорректир);
мСтруктураЦветовРаскраски.Вставить("_3", ЦветЗаполняетсяАвтоБезКорректир);
мСтруктураЦветовРаскраски.Вставить("_4", ЦветЗаполняетсяАвтоАрифметика);
мСтруктураЦветовРаскраски.Вставить("_0", ЦветЗаполняетсяОднозначноВручную);
мСтруктураЦветовРаскраски.Вставить("_5", ЦветЗаполняетсяАвтоматически);


// Таблица значений хранит данные дополнительной страницы многостраничных разделов отчета.
// В колонках таблицы хранятся следующие данные:
//    - имя дополнительной страницы (отображается в списке дополнительных страниц);
//    - булево, признак текущей страницы (отображенной в поле табличного документа);
//    - структура, содержащая имена и значения редактируемых ячеек дополнительной страницы;
//    - таблица значений, содержит данные строк многострочного блока показателей страницы.
//
ОписаниеТиповСтрока254 = ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(254);
ОписаниеТиповДата      = ОбщегоНазначения.ПолучитьОписаниеТиповДаты(ЧастиДаты.Дата);
мОписаниеТиповЧислоЕ = ОбщегоНазначения.ПолучитьОписаниеТиповЧисла(17, 2);

ОписаниеТиповЧисло9_2 = ОбщегоНазначения.ПолучитьОписаниеТиповЧисла(9, 2);
ОписаниеТиповЧисло10_2 = ОбщегоНазначения.ПолучитьОписаниеТиповЧисла(10, 2);
ОписаниеТиповЧисло12_2 = ОбщегоНазначения.ПолучитьОписаниеТиповЧисла(12, 2);
ОписаниеТиповЧисло9_3 = ОбщегоНазначения.ПолучитьОписаниеТиповЧисла(9, 3);
ОписаниеТиповЧисло14_4 = ОбщегоНазначения.ПолучитьОписаниеТиповЧисла(20, 10); // Было 14, 4
ОписаниеТиповЧисло3_1 = ОбщегоНазначения.ПолучитьОписаниеТиповЧисла(3, 1);
ОписаниеТиповЧисло3_2 = ОбщегоНазначения.ПолучитьОписаниеТиповЧисла(3, 2);
ОписаниеТиповЧисло1 = ОбщегоНазначения.ПолучитьОписаниеТиповЧисла(1, 0);
ОписаниеТиповЧисло2_1 = ОбщегоНазначения.ПолучитьОписаниеТиповЧисла(2, 1);

СтруктураГруппы1 = Новый ТаблицаЗначений;
СтруктураГруппы1.Колонки.Добавить("П000010001001", ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(3));
СтруктураГруппы1.Колонки.Добавить("П000010001002", ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(254));
СтруктураГруппы1.Колонки.Добавить("П000010001003", ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(5));
СтруктураГруппы1.Колонки.Добавить("П000010001004", ОписаниеТиповЧисло14_4);
СтруктураГруппы1.Колонки.Добавить("П000010001005", ОписаниеТиповЧисло14_4);
СтруктураГруппы1.Колонки.Добавить("П000010001006", ОписаниеТиповЧисло14_4);
СтруктураГруппы1.Колонки.Добавить("П000010001007", ОписаниеТиповЧисло14_4);
СтруктураГруппы1.Колонки.Добавить("П000010001008", ОписаниеТиповЧисло14_4);
СтруктураГруппы1.Колонки.Добавить("П000010001009", ОписаниеТиповЧисло14_4);
СтруктураГруппы1.Колонки.Добавить("П000010001010", ОписаниеТиповЧисло9_2); // Нормативы всегда 9.2
СтруктураГруппы1.Колонки.Добавить("П000010001011", ОписаниеТиповЧисло10_2);// Норматив специально увеличен до 10.2, т.к. в списке выбора есть большое значение. Колонка также расширена.
СтруктураГруппы1.Колонки.Добавить("П000010001012", ОписаниеТиповЧисло9_2);
СтруктураГруппы1.Колонки.Добавить("П000010001013", ОписаниеТиповЧисло3_1);
СтруктураГруппы1.Колонки.Добавить("П000010001014", ОписаниеТиповЧисло1);
СтруктураГруппы1.Колонки.Добавить("П000010001015", ОписаниеТиповЧисло2_1);
СтруктураГруппы1.Колонки.Добавить("П000010001016", ОписаниеТиповЧисло3_2);
СтруктураГруппы1.Колонки.Добавить("П000010001017", мОписаниеТиповЧислоЕ);
СтруктураГруппы1.Колонки.Добавить("П000010001018", мОписаниеТиповЧислоЕ);
СтруктураГруппы1.Колонки.Добавить("П000010001019", мОписаниеТиповЧислоЕ);
СтруктураГруппы1.Колонки.Добавить("П000010001020", мОписаниеТиповЧислоЕ);

СтруктураГруппы2 = Новый ТаблицаЗначений;
СтруктураГруппы2.Колонки.Добавить("П000020001001", ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(3));
СтруктураГруппы2.Колонки.Добавить("П000020001002", ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(254));
СтруктураГруппы2.Колонки.Добавить("П000020001003", ОписаниеТиповЧисло14_4); // Факт. кол-во изр. топл.
СтруктураГруппы2.Колонки.Добавить("П000020001004", ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(254));
СтруктураГруппы2.Колонки.Добавить("П000020001005", ОписаниеТиповЧисло3_1); // Специально 3.1
СтруктураГруппы2.Колонки.Добавить("П000020001006", ОписаниеТиповЧисло3_1);
СтруктураГруппы2.Колонки.Добавить("П000020001007", ОписаниеТиповЧисло1);
СтруктураГруппы2.Колонки.Добавить("П000020001008", ОписаниеТиповЧисло2_1);
СтруктураГруппы2.Колонки.Добавить("П000020001009", ОписаниеТиповЧисло3_2);
СтруктураГруппы2.Колонки.Добавить("П000020001010", мОписаниеТиповЧислоЕ);

СтруктураГруппы3 = Новый ТаблицаЗначений;
СтруктураГруппы3.Колонки.Добавить("П000030001001", ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(3));
СтруктураГруппы3.Колонки.Добавить("П000030001002", ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(254));
СтруктураГруппы3.Колонки.Добавить("П000030001003", ОписаниеТиповЧисло14_4);
СтруктураГруппы3.Колонки.Добавить("П000030001004", ОписаниеТиповЧисло14_4);
СтруктураГруппы3.Колонки.Добавить("П000030001005", ОписаниеТиповЧисло14_4);
СтруктураГруппы3.Колонки.Добавить("П000030001006", ОписаниеТиповЧисло14_4);
СтруктураГруппы3.Колонки.Добавить("П000030001007", ОписаниеТиповЧисло14_4);
СтруктураГруппы3.Колонки.Добавить("П000030001008", ОписаниеТиповЧисло14_4);
СтруктураГруппы3.Колонки.Добавить("П000030001009", ОписаниеТиповЧисло12_2); // норматив 12.2
СтруктураГруппы3.Колонки.Добавить("П000030001010", ОписаниеТиповЧисло12_2); // норматив 12.2
СтруктураГруппы3.Колонки.Добавить("П000030001011", ОписаниеТиповЧисло12_2); // коэф.
СтруктураГруппы3.Колонки.Добавить("П000030001012", ОписаниеТиповЧисло3_2);
СтруктураГруппы3.Колонки.Добавить("П000030001013", ОписаниеТиповЧисло1);
СтруктураГруппы3.Колонки.Добавить("П000030001014", ОписаниеТиповЧисло3_2);
СтруктураГруппы3.Колонки.Добавить("П000030001015", ОписаниеТиповЧисло3_2);
СтруктураГруппы3.Колонки.Добавить("П000030001016", мОписаниеТиповЧислоЕ);
СтруктураГруппы3.Колонки.Добавить("П000030001017", мОписаниеТиповЧислоЕ);
СтруктураГруппы3.Колонки.Добавить("П000030001018", мОписаниеТиповЧислоЕ);
СтруктураГруппы3.Колонки.Добавить("П000030001019", мОписаниеТиповЧислоЕ);

СтруктураГруппы4 = Новый ТаблицаЗначений;
СтруктураГруппы4.Колонки.Добавить("П000040001001", ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(3));
СтруктураГруппы4.Колонки.Добавить("П000040001002", ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(254));
СтруктураГруппы4.Колонки.Добавить("П000040001003", ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(254));
СтруктураГруппы4.Колонки.Добавить("П000040001004", ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(254));
СтруктураГруппы4.Колонки.Добавить("П000040001005", ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(254));
СтруктураГруппы4.Колонки.Добавить("П000040001006", ОписаниеТиповЧисло14_4);
СтруктураГруппы4.Колонки.Добавить("П000040001007", ОписаниеТиповЧисло14_4);
СтруктураГруппы4.Колонки.Добавить("П000040001008", ОписаниеТиповЧисло14_4);
СтруктураГруппы4.Колонки.Добавить("П000040001009", ОписаниеТиповЧисло14_4);
СтруктураГруппы4.Колонки.Добавить("П000040001010", ОписаниеТиповЧисло14_4);
СтруктураГруппы4.Колонки.Добавить("П000040001011", ОписаниеТиповЧисло14_4);
СтруктураГруппы4.Колонки.Добавить("П000040001012", ОписаниеТиповЧисло14_4);
СтруктураГруппы4.Колонки.Добавить("П000040001013", ОписаниеТиповЧисло14_4);
СтруктураГруппы4.Колонки.Добавить("П000040001014", ОписаниеТиповЧисло14_4);

СтруктураГруппы5 = Новый ТаблицаЗначений;
СтруктураГруппы5.Колонки.Добавить("П000050001015", ОписаниеТиповЧисло14_4);
СтруктураГруппы5.Колонки.Добавить("П000050001016", ОписаниеТиповЧисло14_4);
СтруктураГруппы5.Колонки.Добавить("П000050001017", ОписаниеТиповЧисло14_4);
СтруктураГруппы5.Колонки.Добавить("П000050001018", ОписаниеТиповЧисло14_4);
СтруктураГруппы5.Колонки.Добавить("П000050001019", ОписаниеТиповЧисло9_2);
СтруктураГруппы5.Колонки.Добавить("П000050001020", ОписаниеТиповЧисло9_2);
СтруктураГруппы5.Колонки.Добавить("П000050001021", ОписаниеТиповЧисло2_1);
СтруктураГруппы5.Колонки.Добавить("П000050001022", ОписаниеТиповЧисло1);
СтруктураГруппы5.Колонки.Добавить("П000050001023", ОписаниеТиповЧисло3_2);
СтруктураГруппы5.Колонки.Добавить("П000050001024", ОписаниеТиповЧисло2_1);
СтруктураГруппы5.Колонки.Добавить("П000050001025", мОписаниеТиповЧислоЕ);
СтруктураГруппы5.Колонки.Добавить("П000050001026", мОписаниеТиповЧислоЕ);
СтруктураГруппы5.Колонки.Добавить("П000050001027", мОписаниеТиповЧислоЕ);

// структура исходных строк (минимального кол-ва) многострочных разделов формы
мСтруктураИсхКолвоСтрокРазделов = Новый Структура;
мСтруктураИсхКолвоСтрокРазделов.Вставить(мИдГруппы1, КолИсхСтрокИдГруппы1);
мСтруктураИсхКолвоСтрокРазделов.Вставить(мИдГруппы2, КолИсхСтрокИдГруппы2);
мСтруктураИсхКолвоСтрокРазделов.Вставить(мИдГруппы3, КолИсхСтрокИдГруппы3);
мСтруктураИсхКолвоСтрокРазделов.Вставить(мИдГруппы4, КолИсхСтрокИдГруппы4);
мСтруктураИсхКолвоСтрокРазделов.Вставить(мИдГруппы5, КолИсхСтрокИдГруппы5);

мСтруктураМногострочныхРазделов = Новый Структура;
мСтруктураМногострочныхРазделов.Вставить(мИдГруппы1, СтруктураГруппы1);
мСтруктураМногострочныхРазделов.Вставить(мИдГруппы2, СтруктураГруппы2);
мСтруктураМногострочныхРазделов.Вставить(мИдГруппы3, СтруктураГруппы3);
мСтруктураМногострочныхРазделов.Вставить(мИдГруппы4, СтруктураГруппы4);
мСтруктураМногострочныхРазделов.Вставить(мИдГруппы5, СтруктураГруппы5);

ТаблицаСтраницыРаздела = РегламентированнаяОтчетность.ПолучитьТаблицуМногостраничногоРаздела();

ТаблицаСтраницыРазделаДляМногострочныхРазделов            = Новый ТаблицаЗначений;
ТаблицаСтраницыРазделаДляМногострочныхРазделов.Колонки.Добавить("Представление",    ОписаниеТиповСтрока254, "Наименование");
ТаблицаСтраницыРазделаДляМногострочныхРазделов.Колонки.Добавить("АктивнаяСтраница", мОписаниеТиповБулево);
ТаблицаСтраницыРазделаДляМногострочныхРазделов.Колонки.Добавить("Данные");
ТаблицаСтраницыРазделаДляМногострочныхРазделов.Колонки.Добавить("ДанныеДопСтрок");
ТаблицаСтраницыРазделаДляМногострочныхРазделов.Колонки.Добавить("АвтоматическоеПредставление", мОписаниеТиповБулево);

// Элемент структуры - данные дополнительных страниц Раздела 1
ТаблицаСтраницыРаздела1 = ТаблицаСтраницыРазделаДляМногострочныхРазделов.Скопировать();
СтрПерваяСтраница = ТаблицаСтраницыРаздела1.Добавить();
СтрПерваяСтраница.Представление      = "Новая страница";
СтрПерваяСтраница.ДанныеДопСтрок = Неопределено; // В разделе есть многострочность, поэтому поле объявлено
СтрПерваяСтраница.АктивнаяСтраница   = Истина;
СтрПерваяСтраница.АвтоматическоеПредставление = Истина;

// Элемент структуры - данные дополнительных страниц Раздела 2
ТаблицаСтраницыРаздела2 = ТаблицаСтраницыРазделаДляМногострочныхРазделов.Скопировать();
СтрПерваяСтраница = ТаблицаСтраницыРаздела2.Добавить();
СтрПерваяСтраница.Представление      = "Новая страница";
СтрПерваяСтраница.ДанныеДопСтрок = Неопределено; // В разделе есть многострочность, поэтому поле объявлено
СтрПерваяСтраница.АктивнаяСтраница   = Истина;
СтрПерваяСтраница.АвтоматическоеПредставление = Истина;

// Элемент структуры - данные дополнительных страниц Раздела 3
ТаблицаСтраницыРаздела3 = ТаблицаСтраницыРазделаДляМногострочныхРазделов.Скопировать();
СтрПерваяСтраница = ТаблицаСтраницыРаздела3.Добавить();
СтрПерваяСтраница.Представление      = "Новая страница";
СтрПерваяСтраница.ДанныеДопСтрок = Неопределено; // В разделе есть многострочность, поэтому поле объявлено
СтрПерваяСтраница.АктивнаяСтраница   = Истина;
СтрПерваяСтраница.АвтоматическоеПредставление = Истина;

// Элемент структуры - данные дополнительных страниц Раздела 4
ТаблицаСтраницыРаздела4 = ТаблицаСтраницыРазделаДляМногострочныхРазделов.Скопировать();
СтрПерваяСтраница = ТаблицаСтраницыРаздела4.Добавить();
СтрПерваяСтраница.Представление      = "Новая страница";
СтрПерваяСтраница.ДанныеДопСтрок = Неопределено; // В разделе есть многострочность, поэтому поле объявлено
СтрПерваяСтраница.АктивнаяСтраница   = Истина;
СтрПерваяСтраница.АвтоматическоеПредставление = Истина;

// Элемент структуры - данные дополнительных страниц Раздела 5
ТаблицаСтраницыРаздела5 = ТаблицаСтраницыРазделаДляМногострочныхРазделов.Скопировать();
СтрПерваяСтраница = ТаблицаСтраницыРаздела5.Добавить();
СтрПерваяСтраница.Представление      = "Новая страница";
СтрПерваяСтраница.ДанныеДопСтрок = Неопределено; // В разделе есть многострочность, поэтому поле объявлено
СтрПерваяСтраница.АктивнаяСтраница   = Истина;
СтрПерваяСтраница.АвтоматическоеПредставление = Истина;

// Структура содержит данные дополнительных страниц раздела 1
мСтруктураМногостраничныхРазделов = Новый Структура;

ТаблицаСтраницыРасчет = ТаблицаСтраницыРаздела.Скопировать();
мСтруктураМногостраничныхРазделов.Вставить("Расчет", ТаблицаСтраницыРасчет);
мСтруктураМногостраничныхРазделов.Вставить("Раздел1", ТаблицаСтраницыРаздела1);
мСтруктураМногостраничныхРазделов.Вставить("Раздел2", ТаблицаСтраницыРаздела2);
мСтруктураМногостраничныхРазделов.Вставить("Раздел3", ТаблицаСтраницыРаздела3);
мСтруктураМногостраничныхРазделов.Вставить("Раздел4", ТаблицаСтраницыРаздела4);
мСтруктураМногостраничныхРазделов.Вставить("Раздел5", ТаблицаСтраницыРаздела5);

//// ОПИСАНИЕ ПАРАМЕТРОВ ФОРМЫ ОТЧЕТА
//
// Версия формы
мВерсияФормы = "01/06/2008"; // Первая версия

// Код отчета, равен КНД
мКодОтчета   = 1110012;

ТаблицаСообщений = Новый ТаблицаЗначений;
ТаблицаСообщений.Колонки.Добавить("Раздел");
ТаблицаСообщений.Колонки.Добавить("Графа");
ТаблицаСообщений.Колонки.Добавить("Строка");
ТаблицаСообщений.Колонки.Добавить("Страница");
ТаблицаСообщений.Колонки.Добавить("СтрокаПП");
ТаблицаСообщений.Колонки.Добавить("ИмяЯчейки");
ТаблицаСообщений.Колонки.Добавить("Описание");

мПечатныеформы = Новый СписокЗначений;
мПечатаемыеРазделы = Новый СписокЗначений;