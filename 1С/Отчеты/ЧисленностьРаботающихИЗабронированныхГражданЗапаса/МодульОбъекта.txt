Перем СохраненнаяНастройка Экспорт;        // Текущий вариант отчета

Перем ТаблицаВариантовОтчета Экспорт;      // Таблица вариантов доступных текущему пользователю

// Добавляет строку в таблицу ТДанных
Процедура ОписаниеСтрокиДанных(ТДанных, НомерСтрокиОтчета, Порядок, ИмяСтрокиОтчета, Категория)
	
	Строка = ТДанных.Добавить();
	Строка.НомерСтрокиОтчета = НомерСтрокиОтчета;
	Строка.Порядок = Порядок;
	Строка.ИмяСтрокиОтчета = ИмяСтрокиОтчета;
	Строка.Категория = Категория;

КонецПроцедуры
	
Функция СформироватьОтчет(Результат = Неопределено, ДанныеРасшифровки = Неопределено, ВыводВФормуОтчета = Истина) Экспорт
	
	ЗначениеПанелипользователя = ТиповыеОтчеты.ПолучитьЗначенияНастроекПанелиПользователяОбъекта(ЭтотОбъект);
	НастрокаПоУмолчанию        = КомпоновщикНастроек.ПолучитьНастройки();
	ТиповыеОтчеты.ПолучитьПримененуюНастройку(ЭтотОбъект);
	
	ТиповыеОтчеты.УстановитьПараметр(КомпоновщикНастроек, "Военнообязанный", Перечисления.ОтношениеКВоинскойОбязанности.Военнообязанный);
	
	Если ЗначениеПанелипользователя <> Неопределено тогда
		ЗначениеПанелипользователя.ВыводитьЗаголовокОтчета = ложь;
		ЗначенияНастроекПанелиПользователя = Новый ХранилищеЗначения(ЗначениеПанелипользователя);
	КонецЕсли;
	
	ЭлементСтруктуры = Неопределено;
	
	Если КомпоновщикНастроек.Настройки.Структура.Количество()=1 тогда
		ЭлементСтруктуры = КомпоновщикНастроек.Настройки.Структура[0];
	ИначеЕсли КомпоновщикНастроек.Настройки.Структура.Количество()> 1 Тогда
		Возврат Результат;
	КонецЕсли;
	
	Если ЭлементСтруктуры <> Неопределено И ТипЗнч(ЭлементСтруктуры) <> Тип("ГруппировкаКомпоновкиДанных") тогда
		 Возврат Результат;
	КонецЕсли;
	
	
	МассивГруппировок = ТиповыеОтчеты.ПолучитьЭлементыСтруктуры(КомпоновщикНастроек);
	Для Каждого Группировка из МассивГруппировок Цикл
		Параметр = Группировка.Значение.ПараметрыВывода.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных("TemplateType"));
		Параметр.Значение = ТипМакетаГруппировкиКомпоновкиДанных.Вертикальный;
		Параметр.Использование = истина;
	КонецЦикла;
	
	ГруппировкаПоОрганизации = ТиповыеОтчеты.ДобавитьГруппировку(КомпоновщикНастроек, "Организация");
	ПараметрВывода = ГруппировкаПоОрганизации.ПараметрыВывода.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных("TotalsPlacement"));
	ПараметрВывода.Значение = РасположениеИтоговКомпоновкиДанных.Конец; 
	ПараметрВывода.Использование = Истина;

	ТиповыеОтчеты.ДобавитьГруппировку(КомпоновщикНастроек, "Порядок");
	
	СписокОфицерскихЗваний	=	Новый СписокЗначений;
	СписокОфицерскихЗваний.Добавить(Справочники.ЗваниеГражданскогоВоинскогоУчета.МладшийЛейтенант);
	СписокОфицерскихЗваний.Добавить(Справочники.ЗваниеГражданскогоВоинскогоУчета.Лейтенант);
	СписокОфицерскихЗваний.Добавить(Справочники.ЗваниеГражданскогоВоинскогоУчета.СтаршийЛейтенант);
	СписокОфицерскихЗваний.Добавить(Справочники.ЗваниеГражданскогоВоинскогоУчета.Капитан);
	СписокОфицерскихЗваний.Добавить(Справочники.ЗваниеГражданскогоВоинскогоУчета.Майор);
	СписокОфицерскихЗваний.Добавить(Справочники.ЗваниеГражданскогоВоинскогоУчета.Подполковник);
	СписокОфицерскихЗваний.Добавить(Справочники.ЗваниеГражданскогоВоинскогоУчета.Полковник);
	СписокОфицерскихЗваний.Добавить(Справочники.ЗваниеГражданскогоВоинскогоУчета.ГенералМайор);
	СписокОфицерскихЗваний.Добавить(Справочники.ЗваниеГражданскогоВоинскогоУчета.ГенералЛейтенант);
	СписокОфицерскихЗваний.Добавить(Справочники.ЗваниеГражданскогоВоинскогоУчета.ГенералПолковник);
	СписокОфицерскихЗваний.Добавить(Справочники.ЗваниеГражданскогоВоинскогоУчета.ГенералАрмии);
	СписокОфицерскихЗваний.Добавить(Справочники.ЗваниеГражданскогоВоинскогоУчета.МаршалРоссийскойФедерации);
	
	ТиповыеОтчеты.УстановитьПараметр(КомпоновщикНастроек, "Офицеры", СписокОфицерскихЗваний);
	
	СписокЗванийПрапорщиков	=	Новый СписокЗначений;
	СписокЗванийПрапорщиков.Добавить(Справочники.ЗваниеГражданскогоВоинскогоУчета.Прапорщик);
	СписокЗванийПрапорщиков.Добавить(Справочники.ЗваниеГражданскогоВоинскогоУчета.СтаршийПрапорщик);
	СписокЗванийПрапорщиков.Добавить(Справочники.ЗваниеГражданскогоВоинскогоУчета.МладшийСержант);
	СписокЗванийПрапорщиков.Добавить(Справочники.ЗваниеГражданскогоВоинскогоУчета.Сержант);
	СписокЗванийПрапорщиков.Добавить(Справочники.ЗваниеГражданскогоВоинскогоУчета.СтаршийСержант);
	СписокЗванийПрапорщиков.Добавить(Справочники.ЗваниеГражданскогоВоинскогоУчета.Старшина);
	
	ТиповыеОтчеты.УстановитьПараметр(КомпоновщикНастроек, "Прапорщики", СписокЗванийПрапорщиков);
	
	СписокСолдатскихЗваний	=	Новый СписокЗначений;
	СписокСолдатскихЗваний.Добавить(Справочники.ЗваниеГражданскогоВоинскогоУчета.Рядовой);
	СписокСолдатскихЗваний.Добавить(Справочники.ЗваниеГражданскогоВоинскогоУчета.Ефрейтор);
	
	ТиповыеОтчеты.УстановитьПараметр(КомпоновщикНастроек, "Призывник", Перечисления.ОтношениеКВоинскойОбязанности.Призывник);
	ТиповыеОтчеты.УстановитьПараметр(КомпоновщикНастроек, "ПустаяКатегорияВоинскогоУчета", Перечисления.КатегорииДолжностейДляВоинскогоУчета.ПустаяСсылка());
	ТиповыеОтчеты.УстановитьПараметр(КомпоновщикНастроек, "Солдаты", СписокСолдатскихЗваний);
	
	СписокГодныеКСлужбе = Новый СписокЗначений;
	//СписокГодныеКСлужбе.Добавить(Перечисления.ГодностьКВоеннойСлужбе.Годен);
	СписокГодныеКСлужбе.Добавить(Перечисления.ГодностьКВоеннойСлужбе.ОграниченноГоден);
	//СписокГодныеКСлужбе.Добавить(Перечисления.ГодностьКВоеннойСлужбе.ВременноНеГоден);	
	
	ТиповыеОтчеты.УстановитьПараметр(КомпоновщикНастроек, "СписокГодныеКСлужбе", СписокГодныеКСлужбе);
	
	ПараметрПериод = КомпоновщикНастроек.Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных("Период"));
	Если ПараметрПериод = Неопределено Тогда
		ПериодФормирования = ОбщегоНазначения.ПолучитьРабочуюДату()
	Иначе
		ПериодФормирования = ПараметрПериод.Значение;
	КонецЕсли;
	ГодФормирования = Год(ПериодФормирования);
	
	Результат.Очистить();
	
	ТДанных = Новый ТаблицаЗначений;
	ТДанных.Колонки.Добавить("НомерСтрокиОтчета", ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(10));
	ТДанных.Колонки.Добавить("Порядок", ОбщегоНазначения.ПолучитьОписаниеТиповЧисла(2));
	ТДанных.Колонки.Добавить("ИмяСтрокиОтчета", ОбщегоНазначения.ПолучитьОписаниеТиповСтроки(100));
	ТДанных.Колонки.Добавить("Категория");
	
	Если ГодФормирования < 2011 Тогда
		
		СКД = ПолучитьМАкет("СхемаКомпоновкиДанных2010");
		
		Категории = Перечисления.КатегорииДолжностейДляВоинскогоУчета;
		
		ОписаниеСтрокиДанных(ТДанных, "1", 1, "Руководители", 		 Категории.Руководители);
		ОписаниеСтрокиДанных(ТДанных, "2", 2, "Специалисты - всего", Категории.ПрочиеСпециалисты);
		ОписаниеСтрокиДанных(ТДанных, "2", 2, "Специалисты - всего", Категории.СпециалистыСХ);
		ОписаниеСтрокиДанных(ТДанных, "2", 2, "Специалисты - всего", Категории.СпециалистыТорговлиИОбщепита);
		ОписаниеСтрокиДанных(ТДанных, "2", 2, "Специалисты - всего", Категории.СпециалистыНауки);
		ОписаниеСтрокиДанных(ТДанных, "2", 2, "Специалисты - всего", Категории.СпециалистыКультуры);
		ОписаниеСтрокиДанных(ТДанных, "2", 2, "Специалисты - всего", Категории.СпециалистыОбразования);
		ОписаниеСтрокиДанных(ТДанных, "2", 2, "Специалисты - всего", Категории.Врачи);
		ОписаниеСтрокиДанных(ТДанных, "2", 2, "Специалисты - всего", Категории.СреднийМедицинскийПерсонал);
		ОписаниеСтрокиДанных(ТДанных, "2", 2, "Специалисты - всего", Категории.ПрочиеСпециалисты);
		ОписаниеСтрокиДанных(ТДанных, "",   3,  "из них:", 							Неопределено);
		ОписаниеСтрокиДанных(ТДанных, "3",  4,  " - сельского хозяйства",			   Категории.СпециалистыСХ);
		ОписаниеСтрокиДанных(ТДанных, "4",  5,  " - торговли и общественного питания", Категории.СпециалистыТорговлиИОбщепита);
		ОписаниеСтрокиДанных(ТДанных, "5",  6,  " - науки", 							Категории.СпециалистыНауки);
		ОписаниеСтрокиДанных(ТДанных, "6",  7,  " - культуры и искусства", 				Категории.СпециалистыКультуры);
		ОписаниеСтрокиДанных(ТДанных, "7",  8,	" - образования", 						Категории.СпециалистыОбразования);
		ОписаниеСтрокиДанных(ТДанных, "8",  9,	" - здравохранения - всего", 			Категории.Врачи);
		ОписаниеСтрокиДанных(ТДанных, "8",  9,	" - здравохранения - всего", 			Категории.СреднийМедицинскийПерсонал);
		ОписаниеСтрокиДанных(ТДанных, "",   10, "в том числе:", 						Неопределено);
		ОписаниеСтрокиДанных(ТДанных, "9",  11, " - врачи", 							Категории.Врачи);
		ОписаниеСтрокиДанных(ТДанных, "10", 12,	" - средний медицинский персонал", 		Категории.СреднийМедицинскийПерсонал);
		ОписаниеСтрокиДанных(ТДанных, "11", 13,	"Другие служащие", 						Категории.ДругиеСлужащие);
		ОписаниеСтрокиДанных(ТДанных, "12", 14,	"Рабочие всего", 						Категории.Рабочие1_2Разрядов);
		ОписаниеСтрокиДанных(ТДанных, "12", 14,	"Рабочие всего", 						Категории.Рабочие3_4Разрядов);
		ОписаниеСтрокиДанных(ТДанных, "12", 14,	"Рабочие всего", 						Категории.Рабочие5РазрядаИВыше);
		ОписаниеСтрокиДанных(ТДанных, "12", 14,	"Рабочие всего", 						Категории.РабочиеНеИмеющиеТарифныхСтавок);
		ОписаниеСтрокиДанных(ТДанных, "12", 14,	"Рабочие всего", 						Категории.РабочиеСХ);
		ОписаниеСтрокиДанных(ТДанных, "12", 14,	"Рабочие всего", 						Категории.РабочиеЛокомотивныхБригад);
		ОписаниеСтрокиДанных(ТДанных, "12", 14,	"Рабочие всего", 						Категории.Водители);
		ОписаниеСтрокиДанных(ТДанных, "12", 14,	"Рабочие всего", 						Категории.Трактористы);
		ОписаниеСтрокиДанных(ТДанных, "12", 14,	"Рабочие всего", 						Категории.ПрочиеРабочие);
		ОписаниеСтрокиДанных(ТДанных, "  ", 15, "в том числе:", 						Неопределено);
		ОписаниеСтрокиДанных(ТДанных, "13", 16, " - 1-2 разрядов", 						Категории.Рабочие1_2Разрядов);
		ОписаниеСтрокиДанных(ТДанных, "14", 17,	" - 3-4 разрядов", 						Категории.Рабочие3_4Разрядов);
		ОписаниеСтрокиДанных(ТДанных, "15", 18,	" - 5-го разряда и выше", 				Категории.Рабочие5РазрядаИВыше);
		ОписаниеСтрокиДанных(ТДанных, "16", 19,	" - не имеющие тарифных разрядов",		Категории.РабочиеНеИмеющиеТарифныхСтавок);
		ОписаниеСтрокиДанных(ТДанных, "17",	20, " - сельскохозяйственного производства",Категории.РабочиеСХ);
		ОписаниеСтрокиДанных(ТДанных, "18",	21, " - локомотивных бригад", 				Категории.РабочиеЛокомотивныхБригад);
		ОписаниеСтрокиДанных(ТДанных, "19",	22, " - водители", 							Категории.Водители);
		ОписаниеСтрокиДанных(ТДанных, "20", 23, " - трактористы",						Категории.Трактористы);
		ОписаниеСтрокиДанных(ТДанных, "  ",	24, "Из численности руководителей,",		Неопределено);
		ОписаниеСтрокиДанных(ТДанных, "  ",	25, "специалистов и рабочих:",				Неопределено);
		ОписаниеСтрокиДанных(ТДанных, "21",	26, " - летно-подъемный состав",			Неопределено);
		ОписаниеСтрокиДанных(ТДанных, "22",	27, " - плавающий состав",					Неопределено);
		ОписаниеСтрокиДанных(ТДанных, "23",	28, "Учащиеся",								Категории.Учащиеся);
		ОписаниеСтрокиДанных(ТДанных, "24", 29, "ИТОГО (сумма строк 1+2+11+12+23)",   Категории.Руководители);
		ОписаниеСтрокиДанных(ТДанных, "24", 29, "ИТОГО (сумма строк 1+2+11+12+23)",   Категории.ПрочиеСпециалисты);
		ОписаниеСтрокиДанных(ТДанных, "24", 29, "ИТОГО (сумма строк 1+2+11+12+23)",   Категории.СпециалистыСХ);
		ОписаниеСтрокиДанных(ТДанных, "24", 29, "ИТОГО (сумма строк 1+2+11+12+23)",   Категории.СпециалистыТорговлиИОбщепита);
		ОписаниеСтрокиДанных(ТДанных, "24", 29, "ИТОГО (сумма строк 1+2+11+12+23)",   Категории.СпециалистыНауки);
		ОписаниеСтрокиДанных(ТДанных, "24", 29, "ИТОГО (сумма строк 1+2+11+12+23)",   Категории.СпециалистыКультуры);
		ОписаниеСтрокиДанных(ТДанных, "24", 29, "ИТОГО (сумма строк 1+2+11+12+23)",   Категории.СпециалистыОбразования);
		ОписаниеСтрокиДанных(ТДанных, "24", 29, "ИТОГО (сумма строк 1+2+11+12+23)",   Категории.Врачи);
		ОписаниеСтрокиДанных(ТДанных, "24", 29, "ИТОГО (сумма строк 1+2+11+12+23)",   Категории.СреднийМедицинскийПерсонал);
		ОписаниеСтрокиДанных(ТДанных, "24", 29, "ИТОГО (сумма строк 1+2+11+12+23)",  Категории.СпециалистыСХ);
		ОписаниеСтрокиДанных(ТДанных, "24", 29, "ИТОГО (сумма строк 1+2+11+12+23)",  Категории.СпециалистыТорговлиИОбщепита);
		ОписаниеСтрокиДанных(ТДанных, "24", 29, "ИТОГО (сумма строк 1+2+11+12+23)", Категории.СпециалистыНауки);
		ОписаниеСтрокиДанных(ТДанных, "24", 29, "ИТОГО (сумма строк 1+2+11+12+23)", Категории.СпециалистыКультуры);
		ОписаниеСтрокиДанных(ТДанных, "24", 29,	"ИТОГО (сумма строк 1+2+11+12+23)", Категории.СпециалистыОбразования);
		ОписаниеСтрокиДанных(ТДанных, "24", 29,	"ИТОГО (сумма строк 1+2+11+12+23)", Категории.ПрочиеСпециалисты);
		ОписаниеСтрокиДанных(ТДанных, "24", 29,	"ИТОГО (сумма строк 1+2+11+12+23)", Категории.Врачи);
		ОписаниеСтрокиДанных(ТДанных, "24", 29,	"ИТОГО (сумма строк 1+2+11+12+23)", Категории.СреднийМедицинскийПерсонал);
		ОписаниеСтрокиДанных(ТДанных, "24", 29, "ИТОГО (сумма строк 1+2+11+12+23)", Категории.Врачи);
		ОписаниеСтрокиДанных(ТДанных, "24", 29,	"ИТОГО (сумма строк 1+2+11+12+23)", Категории.СреднийМедицинскийПерсонал);
		ОписаниеСтрокиДанных(ТДанных, "24", 29,	"ИТОГО (сумма строк 1+2+11+12+23)", Категории.ДругиеСлужащие);
		ОписаниеСтрокиДанных(ТДанных, "24", 29,	"ИТОГО (сумма строк 1+2+11+12+23)", Категории.Рабочие1_2Разрядов);
		ОписаниеСтрокиДанных(ТДанных, "24", 29,	"ИТОГО (сумма строк 1+2+11+12+23)", Категории.Рабочие3_4Разрядов);
		ОписаниеСтрокиДанных(ТДанных, "24", 29,	"ИТОГО (сумма строк 1+2+11+12+23)", Категории.Рабочие5РазрядаИВыше);
		ОписаниеСтрокиДанных(ТДанных, "24", 29,	"ИТОГО (сумма строк 1+2+11+12+23)", Категории.РабочиеНеИмеющиеТарифныхСтавок);
		ОписаниеСтрокиДанных(ТДанных, "24", 29,	"ИТОГО (сумма строк 1+2+11+12+23)", Категории.РабочиеСХ);
		ОписаниеСтрокиДанных(ТДанных, "24", 29,	"ИТОГО (сумма строк 1+2+11+12+23)", Категории.РабочиеЛокомотивныхБригад);
		ОписаниеСтрокиДанных(ТДанных, "24", 29,	"ИТОГО (сумма строк 1+2+11+12+23)", Категории.Водители);
		ОписаниеСтрокиДанных(ТДанных, "24", 29,	"ИТОГО (сумма строк 1+2+11+12+23)", Категории.Трактористы);
		ОписаниеСтрокиДанных(ТДанных, "24", 29,	"ИТОГО (сумма строк 1+2+11+12+23)", Категории.Рабочие1_2Разрядов);
		ОписаниеСтрокиДанных(ТДанных, "24", 29,	"ИТОГО (сумма строк 1+2+11+12+23)", Категории.Рабочие3_4Разрядов);
		ОписаниеСтрокиДанных(ТДанных, "24", 29,	"ИТОГО (сумма строк 1+2+11+12+23)", Категории.Рабочие5РазрядаИВыше);
		ОписаниеСтрокиДанных(ТДанных, "24", 29,	"ИТОГО (сумма строк 1+2+11+12+23)",	Категории.РабочиеНеИмеющиеТарифныхСтавок);
		ОписаниеСтрокиДанных(ТДанных, "24", 29,	"ИТОГО (сумма строк 1+2+11+12+23)",	Категории.ПрочиеРабочие);
		ОписаниеСтрокиДанных(ТДанных, "24",	29, "ИТОГО (сумма строк 1+2+11+12+23)", Категории.РабочиеСХ);
		ОписаниеСтрокиДанных(ТДанных, "24",	29, "ИТОГО (сумма строк 1+2+11+12+23)", Категории.РабочиеЛокомотивныхБригад);
		ОписаниеСтрокиДанных(ТДанных, "24",	29, "ИТОГО (сумма строк 1+2+11+12+23)", Категории.Водители);
		ОписаниеСтрокиДанных(ТДанных, "24", 29, "ИТОГО (сумма строк 1+2+11+12+23)",	Категории.Трактористы);
		ОписаниеСтрокиДанных(ТДанных, "24",	29, "ИТОГО (сумма строк 1+2+11+12+23)",	Категории.Учащиеся);
		ОписаниеСтрокиДанных(ТДанных, "25",	30, "По небронируемым организациям",		Неопределено);
		ОписаниеСтрокиДанных(ТДанных, "26", 31, "ВСЕГО (сумма строк 24+25)", Категории.Руководители);
		ОписаниеСтрокиДанных(ТДанных, "26", 31, "ВСЕГО (сумма строк 24+25)", Категории.ПрочиеСпециалисты);
		ОписаниеСтрокиДанных(ТДанных, "26", 31, "ВСЕГО (сумма строк 24+25)", Категории.СпециалистыСХ);
		ОписаниеСтрокиДанных(ТДанных, "26", 31, "ВСЕГО (сумма строк 24+25)", Категории.ПрочиеСпециалисты);
		ОписаниеСтрокиДанных(ТДанных, "26", 31, "ВСЕГО (сумма строк 24+25)", Категории.СпециалистыТорговлиИОбщепита);
		ОписаниеСтрокиДанных(ТДанных, "26", 31, "ВСЕГО (сумма строк 24+25)", Категории.СпециалистыНауки);
		ОписаниеСтрокиДанных(ТДанных, "26", 31, "ВСЕГО (сумма строк 24+25)", Категории.СпециалистыКультуры);
		ОписаниеСтрокиДанных(ТДанных, "26", 31, "ВСЕГО (сумма строк 24+25)", Категории.СпециалистыОбразования);
		ОписаниеСтрокиДанных(ТДанных, "26", 31, "ВСЕГО (сумма строк 24+25)", Категории.Врачи);
		ОписаниеСтрокиДанных(ТДанных, "26", 31, "ВСЕГО (сумма строк 24+25)", Категории.СреднийМедицинскийПерсонал);
		ОписаниеСтрокиДанных(ТДанных, "26", 31, "ВСЕГО (сумма строк 24+25)", Категории.СпециалистыСХ);
		ОписаниеСтрокиДанных(ТДанных, "26", 31, "ВСЕГО (сумма строк 24+25)", Категории.СпециалистыТорговлиИОбщепита);
		ОписаниеСтрокиДанных(ТДанных, "26", 31, "ВСЕГО (сумма строк 24+25)", Категории.СпециалистыНауки);
		ОписаниеСтрокиДанных(ТДанных, "26", 31, "ВСЕГО (сумма строк 24+25)", Категории.СпециалистыКультуры);
		ОписаниеСтрокиДанных(ТДанных, "26", 31,	"ВСЕГО (сумма строк 24+25)", Категории.СпециалистыОбразования);
		ОписаниеСтрокиДанных(ТДанных, "26", 31,	"ВСЕГО (сумма строк 24+25)", Категории.Врачи);
		ОписаниеСтрокиДанных(ТДанных, "26", 31,	"ВСЕГО (сумма строк 24+25)", Категории.СреднийМедицинскийПерсонал);
		ОписаниеСтрокиДанных(ТДанных, "26", 31, "ВСЕГО (сумма строк 24+25)", Категории.Врачи);
		ОписаниеСтрокиДанных(ТДанных, "26", 31,	"ВСЕГО (сумма строк 24+25)", Категории.СреднийМедицинскийПерсонал);
		ОписаниеСтрокиДанных(ТДанных, "26", 31,	"ВСЕГО (сумма строк 24+25)", Категории.ДругиеСлужащие);
		ОписаниеСтрокиДанных(ТДанных, "26", 31,	"ВСЕГО (сумма строк 24+25)", Категории.Рабочие1_2Разрядов);
		ОписаниеСтрокиДанных(ТДанных, "26", 31,	"ВСЕГО (сумма строк 24+25)", Категории.Рабочие3_4Разрядов);
		ОписаниеСтрокиДанных(ТДанных, "26", 31,	"ВСЕГО (сумма строк 24+25)", Категории.Рабочие5РазрядаИВыше);
		ОписаниеСтрокиДанных(ТДанных, "26", 31,	"ВСЕГО (сумма строк 24+25)", Категории.РабочиеНеИмеющиеТарифныхСтавок);
		ОписаниеСтрокиДанных(ТДанных, "26", 31,	"ВСЕГО (сумма строк 24+25)", Категории.РабочиеСХ);
		ОписаниеСтрокиДанных(ТДанных, "26", 31,	"ВСЕГО (сумма строк 24+25)", Категории.РабочиеЛокомотивныхБригад);
		ОписаниеСтрокиДанных(ТДанных, "26", 31,	"ВСЕГО (сумма строк 24+25)", Категории.Водители);
		ОписаниеСтрокиДанных(ТДанных, "26", 31,	"ВСЕГО (сумма строк 24+25)", Категории.Трактористы);
		ОписаниеСтрокиДанных(ТДанных, "26", 31,	"ВСЕГО (сумма строк 24+25)", Категории.Рабочие1_2Разрядов);
		ОписаниеСтрокиДанных(ТДанных, "26", 31,	"ВСЕГО (сумма строк 24+25)", Категории.Рабочие3_4Разрядов);
		ОписаниеСтрокиДанных(ТДанных, "26", 31,	"ВСЕГО (сумма строк 24+25)", Категории.Рабочие5РазрядаИВыше);
		ОписаниеСтрокиДанных(ТДанных, "26", 31,	"ВСЕГО (сумма строк 24+25)", Категории.РабочиеНеИмеющиеТарифныхСтавок);
		ОписаниеСтрокиДанных(ТДанных, "26", 31,	"ВСЕГО (сумма строк 24+25)", Категории.ПрочиеРабочие);
		ОписаниеСтрокиДанных(ТДанных, "26",	31, "ВСЕГО (сумма строк 24+25)", Категории.РабочиеСХ);
		ОписаниеСтрокиДанных(ТДанных, "26",	31, "ВСЕГО (сумма строк 24+25)", Категории.РабочиеЛокомотивныхБригад);
		ОписаниеСтрокиДанных(ТДанных, "26",	31, "ВСЕГО (сумма строк 24+25)", Категории.Водители);
		ОписаниеСтрокиДанных(ТДанных, "26", 31, "ВСЕГО (сумма строк 24+25)", Категории.Трактористы);
		ОписаниеСтрокиДанных(ТДанных, "26",	31, "ВСЕГО (сумма строк 24+25)", Категории.Учащиеся);
	Иначе
		
		СКД = ПолучитьМАкет("СхемаКомпоновкиДанных2011");
		
		Категории = Перечисления.КатегорииДолжностейДляУчетаЗабронированныхС2011Года;
		
		ОписаниеСтрокиДанных(ТДанных, "1", 1, "Руководители", 		 Категории.Руководители);
		ОписаниеСтрокиДанных(ТДанных, "2", 2, "Специалисты - всего, из них по основным видам деятельности", Категории.СпециалистыСХ);
		ОписаниеСтрокиДанных(ТДанных, "2", 2, "Специалисты - всего, из них по основным видам деятельности", Категории.СпециалистыПолезныеИскопаемые);
		ОписаниеСтрокиДанных(ТДанных, "2", 2, "Специалисты - всего, из них по основным видам деятельности", Категории.СпециалистыПроизводствоЭлектроэнергии);
		ОписаниеСтрокиДанных(ТДанных, "2", 2, "Специалисты - всего, из них по основным видам деятельности", Категории.СпециалистыСтроительство);
		ОписаниеСтрокиДанных(ТДанных, "2", 2, "Специалисты - всего, из них по основным видам деятельности", Категории.СпециалистыТранспорт);
		ОписаниеСтрокиДанных(ТДанных, "2", 2, "Специалисты - всего, из них по основным видам деятельности", Категории.СпециалистыОбразования);
		ОписаниеСтрокиДанных(ТДанных, "2", 2, "Специалисты - всего, из них по основным видам деятельности", Категории.СпециалистыЗдравоохранение);
		ОписаниеСтрокиДанных(ТДанных, "2", 2, "Специалисты - всего, из них по основным видам деятельности", Категории.СпециалистыОбрабатывающиеПроизводства);
		ОписаниеСтрокиДанных(ТДанных, "2", 2, "Специалисты - всего, из них по основным видам деятельности", Категории.ПрочиеСпециалисты);
		ОписаниеСтрокиДанных(ТДанных, "3",  3,  "А Cельское хозяйство",			    						Категории.СпециалистыСХ);
		ОписаниеСтрокиДанных(ТДанных, "4",  4,  "C Добыча полезных ископаемых", 							Категории.СпециалистыПолезныеИскопаемые);
		ОписаниеСтрокиДанных(ТДанных, "5",  5,  "D Обрабатывающие производства", 							Категории.СпециалистыОбрабатывающиеПроизводства);
		ОписаниеСтрокиДанных(ТДанных, "6",  6,  "E Производство и распределение электро- энергии, газа и воды",Категории.СпециалистыПроизводствоЭлектроэнергии);
		ОписаниеСтрокиДанных(ТДанных, "7",  7,  "F Строительство",											Категории.СпециалистыСтроительство);
		ОписаниеСтрокиДанных(ТДанных, "8",  8,  "I Транспорт и связь",										Категории.СпециалистыТранспорт);
		ОписаниеСтрокиДанных(ТДанных, "9",  9,	"M Образование", 											Категории.СпециалистыОбразования);
		ОписаниеСтрокиДанных(ТДанных, "10", 10,	"N Здравоохранение и предоставление социальных услуг",		Категории.СпециалистыЗдравоохранение);
		ОписаниеСтрокиДанных(ТДанных, "11", 11,	"прочие виды экономической деятельности",					Категории.ПрочиеСпециалисты);
		
		ОписаниеСтрокиДанных(ТДанных, "12", 12,	"Другие служащие", 						Категории.ДругиеСлужащие);
		ОписаниеСтрокиДанных(ТДанных, "13", 13,	"Рабочие всего", 						Категории.РабочиеИмеющиеТарифныйРазряд);
		ОписаниеСтрокиДанных(ТДанных, "13", 13,	"Рабочие всего", 						Категории.РабочиеНеИмеющиеТарифныхРазрядов);
		ОписаниеСтрокиДанных(ТДанных, "13", 13,	"Рабочие всего", 						Категории.РабочиеСХ);
		ОписаниеСтрокиДанных(ТДанных, "13", 13,	"Рабочие всего", 						Категории.РабочиеЛокомотивныхБригад);
		ОписаниеСтрокиДанных(ТДанных, "13", 13,	"Рабочие всего", 						Категории.Водители);
		ОписаниеСтрокиДанных(ТДанных, "13", 13,	"Рабочие всего", 						Категории.Трактористы);
		ОписаниеСтрокиДанных(ТДанных, "14", 14,	"в том числе имеющие тарифные разряды",	Категории.РабочиеИмеющиеТарифныйРазряд);
		ОписаниеСтрокиДанных(ТДанных, "15", 15,	"не имеющие тарифных разрядов",			Категории.РабочиеНеИмеющиеТарифныхРазрядов);
		ОписаниеСтрокиДанных(ТДанных, "16",	16, "сельскохозяйственного производства",	Категории.РабочиеСХ);
		ОписаниеСтрокиДанных(ТДанных, "16",	17, "локомотивных бригад",					Категории.РабочиеЛокомотивныхБригад);
		ОписаниеСтрокиДанных(ТДанных, "18",	18, "водители", 							Категории.Водители);
		ОписаниеСтрокиДанных(ТДанных, "19", 19, "трактористы",							Категории.Трактористы);
		ОписаниеСтрокиДанных(ТДанных, "  ",	20, "Из численности руководителей, специалистов и рабочих:", Неопределено);
		ОписаниеСтрокиДанных(ТДанных, "20",	21, "летно-подъемный состав",			Неопределено);
		ОписаниеСтрокиДанных(ТДанных, "21",	22, "плавающий состав",					Неопределено);
		ОписаниеСтрокиДанных(ТДанных, "22", 23, "ИТОГО (сумма строк 1+2+12+13)",	Категории.Руководители);
		ОписаниеСтрокиДанных(ТДанных, "22", 23, "ИТОГО (сумма строк 1+2+12+13)",	Категории.СпециалистыСХ);
		ОписаниеСтрокиДанных(ТДанных, "22", 23, "ИТОГО (сумма строк 1+2+12+13)",	Категории.СпециалистыПолезныеИскопаемые);
		ОписаниеСтрокиДанных(ТДанных, "22", 23, "ИТОГО (сумма строк 1+2+12+13)",	Категории.СпециалистыПроизводствоЭлектроэнергии);
		ОписаниеСтрокиДанных(ТДанных, "22", 23, "ИТОГО (сумма строк 1+2+12+13)",	Категории.СпециалистыСтроительство);
		ОписаниеСтрокиДанных(ТДанных, "22", 23, "ИТОГО (сумма строк 1+2+12+13)",	Категории.СпециалистыОбразования);
		ОписаниеСтрокиДанных(ТДанных, "22", 23, "ИТОГО (сумма строк 1+2+12+13)",	Категории.СпециалистыЗдравоохранение);
		ОписаниеСтрокиДанных(ТДанных, "22", 23, "ИТОГО (сумма строк 1+2+12+13)",	Категории.СпециалистыТранспорт);
		ОписаниеСтрокиДанных(ТДанных, "22", 23, "ИТОГО (сумма строк 1+2+12+13)",	Категории.СпециалистыОбрабатывающиеПроизводства);
		ОписаниеСтрокиДанных(ТДанных, "22", 23, "ИТОГО (сумма строк 1+2+12+13)",	Категории.ПрочиеСпециалисты);
		ОписаниеСтрокиДанных(ТДанных, "22", 23,	"ИТОГО (сумма строк 1+2+12+13)",	Категории.ДругиеСлужащие);
		ОписаниеСтрокиДанных(ТДанных, "22", 23,	"ИТОГО (сумма строк 1+2+12+13)",	Категории.РабочиеИмеющиеТарифныйРазряд);
		ОписаниеСтрокиДанных(ТДанных, "22", 23,	"ИТОГО (сумма строк 1+2+12+13)",	Категории.РабочиеНеИмеющиеТарифныхРазрядов);
		ОписаниеСтрокиДанных(ТДанных, "22", 23,	"ИТОГО (сумма строк 1+2+12+13)",	Категории.РабочиеСХ);
		ОписаниеСтрокиДанных(ТДанных, "22", 23,	"ИТОГО (сумма строк 1+2+12+13)",	Категории.РабочиеЛокомотивныхБригад);
		ОписаниеСтрокиДанных(ТДанных, "22", 23,	"ИТОГО (сумма строк 1+2+12+13)",	Категории.Водители);
		ОписаниеСтрокиДанных(ТДанных, "22", 23,	"ИТОГО (сумма строк 1+2+12+13)",	Категории.Трактористы);
		
		ОписаниеСтрокиДанных(ТДанных, "23",	24, "По небронируемым организациям",	Неопределено);
		ОписаниеСтрокиДанных(ТДанных, "24", 25, "ВСЕГО (сумма строк 22+23)", Категории.Руководители);
		ОписаниеСтрокиДанных(ТДанных, "24", 25, "ВСЕГО (сумма строк 22+23)", Категории.СпециалистыСХ);
		ОписаниеСтрокиДанных(ТДанных, "24", 25, "ВСЕГО (сумма строк 22+23)", Категории.СпециалистыПолезныеИскопаемые);
		ОписаниеСтрокиДанных(ТДанных, "24", 25, "ВСЕГО (сумма строк 22+23)", Категории.СпециалистыПроизводствоЭлектроэнергии);
		ОписаниеСтрокиДанных(ТДанных, "24", 25, "ВСЕГО (сумма строк 22+23)", Категории.СпециалистыСтроительство);
		ОписаниеСтрокиДанных(ТДанных, "24", 25, "ВСЕГО (сумма строк 22+23)", Категории.СпециалистыЗдравоохранение);
		ОписаниеСтрокиДанных(ТДанных, "24", 25, "ВСЕГО (сумма строк 22+23)", Категории.СпециалистыОбразования);
		ОписаниеСтрокиДанных(ТДанных, "24", 25, "ВСЕГО (сумма строк 22+23)", Категории.СпециалистыТранспорт);
		ОписаниеСтрокиДанных(ТДанных, "24", 25, "ВСЕГО (сумма строк 22+23)", Категории.СпециалистыОбрабатывающиеПроизводства);
		ОписаниеСтрокиДанных(ТДанных, "24", 25, "ВСЕГО (сумма строк 22+23)", Категории.ПрочиеСпециалисты);
		ОписаниеСтрокиДанных(ТДанных, "24", 25, "ВСЕГО (сумма строк 22+23)", Категории.ДругиеСлужащие);
		ОписаниеСтрокиДанных(ТДанных, "24", 25, "ВСЕГО (сумма строк 22+23)", Категории.РабочиеИмеющиеТарифныйРазряд);
		ОписаниеСтрокиДанных(ТДанных, "24", 25, "ВСЕГО (сумма строк 22+23)", Категории.РабочиеНеИмеющиеТарифныхРазрядов);
		ОписаниеСтрокиДанных(ТДанных, "24", 25, "ВСЕГО (сумма строк 22+23)", Категории.РабочиеСХ);
		ОписаниеСтрокиДанных(ТДанных, "24", 25, "ВСЕГО (сумма строк 22+23)", Категории.РабочиеЛокомотивныхБригад);
		ОписаниеСтрокиДанных(ТДанных, "24", 25, "ВСЕГО (сумма строк 22+23)", Категории.Водители);
		ОписаниеСтрокиДанных(ТДанных, "24", 25, "ВСЕГО (сумма строк 22+23)", Категории.Трактористы);

	КонецЕсли;
	
	СхемаКомпоновкиДанных = СКД;
	Настройки = КомпоновщикНастроек.ПолучитьНастройки();
	КомпоновщикНастроек.Инициализировать(Новый ИсточникДоступныхНастроекКомпоновкиДанных(СКД));
	КомпоновщикНастроек.ЗагрузитьНастройки(Настройки);
	
	СтруктураДанных = Новый Структура("СтрокиОтчета", ТДанных);
	
	ТиповыеОтчеты.СформироватьТиповойОтчет(ЭтотОбъект, Результат, , ВыводВФормуОтчета, СтруктураДанных);
	
	//Параметры документа
	Результат.Автомасштаб 			= Истина;
	Результат.ОриентацияСтраницы 	= ОриентацияСтраницы.Ландшафт;
	Результат.Защита              	= Ложь;
	КомпоновщикНастроек.ЗагрузитьНастройки(НастрокаПоУмолчанию);
	Возврат Результат;
		
КонецФункции

Процедура СохранитьНастройку() Экспорт

	СтруктураНастроек = ТиповыеОтчеты.ПолучитьСтруктуруПараметровТиповогоОтчета(ЭтотОбъект);
	СохранениеНастроек.СохранитьНастройкуОбъекта(СохраненнаяНастройка, СтруктураНастроек);
	
КонецПроцедуры

Процедура ПрименитьНастройку() Экспорт
	
	Схема = ТиповыеОтчеты.ПолучитьСхемуКомпоновкиОбъекта(ЭтотОбъект);

	// Считываение структуры настроек отчета
 	Если Не СохраненнаяНастройка.Пустая() Тогда
		
		СтруктураНастроек = СохраненнаяНастройка.ХранилищеНастроек.Получить();
		Если Не СтруктураНастроек = Неопределено Тогда
			КомпоновщикНастроек.ЗагрузитьНастройки(СтруктураНастроек.НастройкиКомпоновщика);
			ЗаполнитьЗначенияСвойств(ЭтотОбъект, СтруктураНастроек);
		Иначе
			КомпоновщикНастроек.ЗагрузитьНастройки(Схема.НастройкиПоУмолчанию);
		КонецЕсли;
		
	Иначе
		КомпоновщикНастроек.ЗагрузитьНастройки(Схема.НастройкиПоУмолчанию);
	КонецЕсли;

КонецПроцедуры

Процедура ПередВыводомЭлементРезультата(МакетКомпоновки, ПроцессорКомпоновки, ЭлементРезультата) Экспорт
	
КонецПроцедуры

Процедура ПередВыводомОтчета(МакетКомпоновки, ПроцессорКомпоновки) Экспорт
	
	
КонецПроцедуры

Процедура ПриВыводеЗаголовкаОтчета(ОбластьЗаголовок) Экспорт
КонецПроцедуры

Функция ПолучитьПараметрыИсполненияОтчета() Экспорт
	СписокПолейПодстановкиОтборовПоУмолчанию = Новый Соответствие;
	СписокПолейПодстановкиОтборовПоУмолчанию.Вставить("Организация", "ОсновнаяОрганизация");
	
	Возврат Новый Структура("ИспользоватьСобытияПриФормированииОтчета,
	|ПриВыводеЗаголовкаОтчета,
	|ПослеВыводаПанелиПользователя,
	|ПослеВыводаПериода,
	|ПослеВыводаПараметра,
	|ПослеВыводаГруппировки,
	|ПослеВыводаОтбора,
	|ДействияПанелиИзменениеФлажкаДопНастроек,
	|ПриПолучениеНастроекПользователя, 
	|ЗаполнитьОтборыПоУмолчанию, 
	|СписокПолейПодстановкиОтборовПоУмолчанию", 
	ложь, ложь, ложь, ложь, ложь, ложь, ложь, ложь, ложь, истина, СписокПолейПодстановкиОтборовПоУмолчанию);
КонецФункции

#Если ТолстыйКлиентОбычноеПриложение Тогда
	
// Настройка отчета при отработки расшифровки
Процедура Настроить(Отбор) Экспорт
	
	// Настройка отбора
	Для каждого ЭлементОтбора Из Отбор Цикл
		
		Если ТипЗнч(ЭлементОтбора) = Тип("ЭлементОтбораКомпоновкиДанных") Тогда
			ПолеОтбора = ЭлементОтбора.ЛевоеЗначение;
		Иначе
			ПолеОтбора = Новый ПолеКомпоновкиДанных(ЭлементОтбора.Поле);
		КонецЕсли;
		
		Если КомпоновщикНастроек.Настройки.ДоступныеПоляОтбора.НайтиПоле(ПолеОтбора) = Неопределено Тогда
			Продолжить;
		КонецЕсли;
		
		НовыйЭлементОтбора = КомпоновщикНастроек.Настройки.Отбор.Элементы.Добавить(Тип("ЭлементОтбораКомпоновкиДанных"));
		Если ТипЗнч(ЭлементОтбора) = Тип("ЭлементОтбораКомпоновкиДанных") Тогда
			ЗаполнитьЗначенияСвойств(НовыйЭлементОтбора, ЭлементОтбора);
		Иначе
			НовыйЭлементОтбора.Использование  = Истина;
			НовыйЭлементОтбора.ЛевоеЗначение  = ПолеОтбора;
			Если ЭлементОтбора.Иерархия Тогда
				Если ТипЗнч(ЭлементОтбора.Значение) = Тип("СписокЗначений") Тогда
					НовыйЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.ВСпискеПоИерархии;
				Иначе
					НовыйЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.ВИерархии;
				КонецЕсли;
			Иначе
				Если ТипЗнч(ЭлементОтбора.Значение) = Тип("СписокЗначений") Тогда
					НовыйЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.ВСписке;
				Иначе
					НовыйЭлементОтбора.ВидСравнения = ВидСравненияКомпоновкиДанных.Равно;
				КонецЕсли;
			КонецЕсли;
			
			НовыйЭлементОтбора.ПравоеЗначение = ЭлементОтбора.Значение;
			
		КонецЕсли;
				
	КонецЦикла;
	
	ТиповыеОтчеты.УдалитьДублиОтбора(КомпоновщикНастроек);
	
КонецПроцедуры

#КонецЕсли

Процедура ДоработатьКомпоновщикПередВыводом() Экспорт
	
	ЗначениеПараметра = КомпоновщикНастроек.Настройки.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных("Период"));
	Если ЗначениеПараметра = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	Если ЗначениеПараметра.Значение = '00010101' Тогда
		ЗначениеПараметра.Значение = КонецДня(ТекущаяДата());
		ЗначениеПараметра.Использование = Истина;
	КонецЕсли;
	
КонецПроцедуры



Если СохраненнаяНастройка = Неопределено Тогда
	СохраненнаяНастройка =  Справочники.СохраненныеНастройки.ПустаяСсылка();
КонецЕсли;

Если КомпоновщикНастроек = Неопределено Тогда
	КомпоновщикНастроек =  Новый КомпоновщикНастроекКомпоновкиДанных;
КонецЕсли;
УправлениеОтчетами.ЗаменитьНазваниеПолейСхемыКомпоновкиДанных(СхемаКомпоновкиДанных);