// Процедура предназначена для получения начислений и действий с ними
// в зависимости от кадрового события.
//
// Параметры:
//  ДанныеДокумента					- исходные данные для выполнения запроса: ссылка на сотрудника, 
//									  если сотрудник один, таблица значений в случае, если их несколько
//  ДокументСсылка					- ссылка на документ
//  ДокументДата					- дата документа
//  Организация						- ссылка на организацию
//	ИмяДатыДействия					- в разных документах поле с датой действия 
//									  имеет разное имя: ДатаНачала, ДатаДействия, ДатаПриема
//	КоэффициентИндексацииЗаработка 	- необязательный, по умолчанию - 1 (нет индексации), 
//									  используется для пересчета значений при заполнении документа 
//									  Кадровое перемещение сотрудников организаций
//	ПоДаннымТрудовогоДоговора 		- необязательный, по умолчанию - Ложь, признак необходимости 
//									  получать данные трудового договора
//	ПолучатьПлановыеНачисления 		- необязательный, по умолчанию - Истина, признак необходимости 
//									  получать плановые начисления
//
Функция ПолучитьТаблицуДействийСУправленческимиНачислениями(ДанныеДокумента, ДокументСсылка, ДокументДата, ПолучатьПлановыеНачисления = Истина) Экспорт
	
	// некоторые поля в разных документах носят разные имена 
	Если ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.ПриемНаРаботу") Тогда
		ПолеПодразделение 	= "Подразделение";
		ПолеДолжность 		= "Должность";
		ПолеДатаДействия 	= "ДатаПриема";
	ИначеЕсли ТипЗнч(ДокументСсылка) = Тип("ДокументСсылка.КадровоеПеремещение") Тогда
		ПолеПодразделение 	= "НовоеПодразделение";
		ПолеДолжность 		= "НоваяДолжность";
		ПолеДатаДействия 	= "ДатаНачала";
	КонецЕсли;	
	
	// дополним таблицу данными шапки документа
	ДанныеДокумента.Колонки.Добавить("ДатаДокумента", 	ОбщегоНазначения.ПолучитьОписаниеТиповДаты(ЧастиДаты.ДатаВремя));
	ДанныеДокумента.ЗаполнитьЗначения(ДокументДата,		"ДатаДокумента");
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("Ссылка", ДокументСсылка);
	Запрос.УстановитьПараметр("ДанныеДокумента", ДанныеДокумента);

	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	ДанныеДокумента.Сотрудник,
	|	ДанныеДокумента.Физлицо,
	|	ВЫБОР
	|		КОГДА ДанныеДокумента." + ПолеДатаДействия + " <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	|			ТОГДА ДанныеДокумента." + ПолеДатаДействия + "
	|		ИНАЧЕ ДанныеДокумента.ДатаДокумента
	|	КОНЕЦ КАК ДатаДействия,
	|	ДанныеДокумента." + ПолеПодразделение + " КАК Подразделение,
	|	ДанныеДокумента." + ПолеДолжность + " КАК Должность,
	|	ДанныеДокумента.ДатаДокумента
	|ПОМЕСТИТЬ ДанныеДокумента
	|ИЗ
	|	&ДанныеДокумента КАК ДанныеДокумента
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ДанныеДокумента.Физлицо КАК Физлицо,
	|	ДанныеДокумента.ДатаДействия,
	|	МАКСИМУМ(Работники.Период) КАК Период
	|ПОМЕСТИТЬ РаботникиСрезПоследнихДаты
	|ИЗ
	|	ДанныеДокумента КАК ДанныеДокумента
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.Работники КАК Работники
	|		ПО ДанныеДокумента.Физлицо = Работники.ФизЛицо
	|			И ДанныеДокумента.ДатаДействия >= Работники.Период
	|			И (&Ссылка <> Работники.Регистратор)
	|
	|СГРУППИРОВАТЬ ПО
	|	ДанныеДокумента.Физлицо,
	|	ДанныеДокумента.ДатаДействия
	|
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	РаботникиСрезПоследних.Физлицо КАК Физлицо,
	|	РаботникиСрезПоследних.ДатаДействия,
	|	РаботникиСрезПоследних.Период,
	|	Работники.Подразделение КАК Подразделение,
	|	Работники.Должность КАК Должность
	|ПОМЕСТИТЬ РаботникиСрезПоследних
	|ИЗ
	|	РегистрСведений.Работники КАК Работники
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РаботникиСрезПоследнихДаты КАК РаботникиСрезПоследних
	|		ПО Работники.ФизЛицо = РаботникиСрезПоследних.Физлицо
	|			И Работники.Период = РаботникиСрезПоследних.Период
	|			И (Работники.Регистратор <> &Ссылка)
	|
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ДанныеДокумента.Сотрудник КАК Сотрудник,
	|	ДанныеДокумента.Физлицо КАК Физлицо,
	|	ДанныеДокумента.ДатаДействия,
	|	ЕСТЬNULL(ДанныеДокумента.Подразделение, РаботникиСрезПоследних.Подразделение) КАК Подразделение,
	|	ЕСТЬNULL(ДанныеДокумента.Должность, РаботникиСрезПоследних.Должность) КАК Должность,
	|	РаботникиСрезПоследних.Подразделение КАК СтароеПодразделение,
	|	РаботникиСрезПоследних.Должность КАК СтараяДолжность
	|ПОМЕСТИТЬ ДанныеСотрудников
	|ИЗ
	|	ДанныеДокумента КАК ДанныеДокумента
	|		ЛЕВОЕ СОЕДИНЕНИЕ РаботникиСрезПоследних КАК РаботникиСрезПоследних
	|		ПО ДанныеДокумента.Физлицо = РаботникиСрезПоследних.Физлицо
	|
	|;
	|";
	Если ПолучатьПлановыеНачисления Тогда
		ТекстЗапроса = ТекстЗапроса +  
		"ВЫБРАТЬ
		|	УправленческиеНачисленияПоказатели.Ссылка КАК ВидРасчета,
		|	УправленческиеНачисленияПоказатели.НомерСтроки КАК НомерПоказателя,
		|	ВЫБОР
		|		КОГДА УправленческиеНачисленияПоказатели.Показатель.ТипПоказателя = ЗНАЧЕНИЕ(Перечисление.ТипыПоказателейСхемМотивации.ТарифныйРазряд)
		|			ТОГДА ИСТИНА
		|		ИНАЧЕ ЛОЖЬ
		|	КОНЕЦ КАК ТребуетВводаТарифногоРазряда
		|ПОМЕСТИТЬ ДанныеВидаРасчетаНачисления
		|ИЗ
		|	ПланВидовРасчета.УправленческиеНачисления.Показатели КАК УправленческиеНачисленияПоказатели
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ДанныеДокумента.Сотрудник,
		|	ДанныеДокумента.Физлицо КАК Физлицо,
		|	ДанныеДокумента.ДатаДействия,
		|	МАКСИМУМ(ВЫБОР
		|			КОГДА Начисления.ПериодЗавершения <= ДанныеДокумента.ДатаДействия
		|					И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|				ТОГДА Начисления.ПериодЗавершения
		|			ИНАЧЕ Начисления.Период
		|		КОНЕЦ) КАК Период,
		|	ВЫБОР
		|		КОГДА Начисления.ПериодЗавершения <= ДанныеДокумента.ДатаДействия
		|				И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА Начисления.ВидРасчетаЗавершения
		|		ИНАЧЕ Начисления.ВидРасчета
		|	КОНЕЦ КАК ВидРасчета
		|ПОМЕСТИТЬ НачисленияСрезПоследних
		|ИЗ
		|	ДанныеДокумента КАК ДанныеДокумента
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ПлановыеНачисленияРаботников КАК Начисления
		|		ПО ДанныеДокумента.Физлицо = Начисления.ФизЛицо
		|			И ДанныеДокумента.ДатаДействия >= Начисления.Период
		|ГДЕ
		|	Начисления.ВидРасчета ССЫЛКА ПланВидовРасчета.УправленческиеНачисления
		|
		|СГРУППИРОВАТЬ ПО
		|	ДанныеДокумента.Сотрудник,
		|	ДанныеДокумента.Физлицо,
		|	ДанныеДокумента.ДатаДействия,
		|	ВЫБОР
		|		КОГДА Начисления.ПериодЗавершения <= ДанныеДокумента.ДатаДействия
		|				И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА Начисления.ВидРасчетаЗавершения
		|		ИНАЧЕ Начисления.ВидРасчета
		|	КОНЕЦ
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ДанныеДокумента.Сотрудник,
		|	ДанныеДокумента.Физлицо КАК Физлицо,
		|	ДанныеДокумента.ДатаДействия,
		|	МАКСИМУМ(ВЫБОР
		|			КОГДА Удержания.ПериодЗавершения <= ДанныеДокумента.ДатаДействия
		|					И Удержания.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|				ТОГДА Удержания.ПериодЗавершения
		|			ИНАЧЕ Удержания.Период
		|		КОНЕЦ) КАК Период,
		|	Удержания.ВидРасчета КАК ВидРасчета
		|ПОМЕСТИТЬ УдержанияСрезПоследних
		|ИЗ
		|	ДанныеДокумента КАК ДанныеДокумента
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ПлановыеУдержанияРаботников КАК Удержания
		|		ПО ДанныеДокумента.Физлицо = Удержания.ФизЛицо
		|			И ДанныеДокумента.ДатаДействия >= Удержания.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	ДанныеДокумента.Сотрудник,
		|	ДанныеДокумента.Физлицо,
		|	ДанныеДокумента.ДатаДействия,
		|	Удержания.ВидРасчета
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	НачисленияСрезПоследних.Сотрудник КАК Сотрудник,
		|	НачисленияСрезПоследних.Физлицо КАК Физлицо,
		|	ВЫБОР
		|		КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|				И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА Начисления.ВидРасчетаЗавершения
		|		ИНАЧЕ Начисления.ВидРасчета
		|	КОНЕЦ КАК ВидРасчета,
		|	ВЫБОР
		|		КОГДА ДанныеВидаРасчета1.ТребуетВводаТарифногоРазряда
		|			ТОГДА 0
		|		ИНАЧЕ ВЫБОР
		|				КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|						И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА Начисления.Показатель1Завершения
		|				ИНАЧЕ Начисления.Показатель1
		|			КОНЕЦ
		|	КОНЕЦ КАК Показатель1,
		|	ВЫБОР
		|		КОГДА ДанныеВидаРасчета2.ТребуетВводаТарифногоРазряда
		|			ТОГДА 0
		|		ИНАЧЕ ВЫБОР
		|				КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|						И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА Начисления.Показатель2Завершения
		|				ИНАЧЕ Начисления.Показатель2
		|			КОНЕЦ
		|	КОНЕЦ КАК Показатель2,
		|	ВЫБОР
		|		КОГДА ДанныеВидаРасчета3.ТребуетВводаТарифногоРазряда
		|			ТОГДА 0
		|		ИНАЧЕ ВЫБОР
		|				КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|						И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА Начисления.Показатель3Завершения
		|				ИНАЧЕ Начисления.Показатель3
		|			КОНЕЦ
		|	КОНЕЦ КАК Показатель3,
		|	ВЫБОР
		|		КОГДА ДанныеВидаРасчета4.ТребуетВводаТарифногоРазряда
		|			ТОГДА 0
		|		ИНАЧЕ ВЫБОР
		|				КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|						И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА Начисления.Показатель4Завершения
		|				ИНАЧЕ Начисления.Показатель4
		|			КОНЕЦ
		|	КОНЕЦ КАК Показатель4,
		|	ВЫБОР
		|		КОГДА ДанныеВидаРасчета5.ТребуетВводаТарифногоРазряда
		|			ТОГДА 0
		|		ИНАЧЕ ВЫБОР
		|				КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|						И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА Начисления.Показатель5Завершения
		|				ИНАЧЕ Начисления.Показатель5
		|			КОНЕЦ
		|	КОНЕЦ КАК Показатель5,
		|	ВЫБОР
		|		КОГДА ДанныеВидаРасчета6.ТребуетВводаТарифногоРазряда
		|			ТОГДА 0
		|		ИНАЧЕ ВЫБОР
		|				КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|						И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА Начисления.Показатель6Завершения
		|				ИНАЧЕ Начисления.Показатель6
		|			КОНЕЦ
		|	КОНЕЦ КАК Показатель6,
		|	ВЫБОР
		|		КОГДА ДанныеВидаРасчета1.ТребуетВводаТарифногоРазряда
		|			ТОГДА ВЫБОР
		|					КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|							И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|						ТОГДА Начисления.ТарифныйРазряд1Завершения
		|					ИНАЧЕ Начисления.ТарифныйРазряд1
		|				КОНЕЦ
		|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
		|	КОНЕЦ КАК ТарифныйРазряд1,
		|	ВЫБОР
		|		КОГДА ДанныеВидаРасчета2.ТребуетВводаТарифногоРазряда
		|			ТОГДА ВЫБОР
		|					КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|							И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|						ТОГДА Начисления.ТарифныйРазряд2Завершения
		|					ИНАЧЕ Начисления.ТарифныйРазряд2
		|				КОНЕЦ
		|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
		|	КОНЕЦ КАК ТарифныйРазряд2,
		|	ВЫБОР
		|		КОГДА ДанныеВидаРасчета3.ТребуетВводаТарифногоРазряда
		|			ТОГДА ВЫБОР
		|					КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|							И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|						ТОГДА Начисления.ТарифныйРазряд3Завершения
		|					ИНАЧЕ Начисления.ТарифныйРазряд3
		|				КОНЕЦ
		|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
		|	КОНЕЦ КАК ТарифныйРазряд3,
		|	ВЫБОР
		|		КОГДА ДанныеВидаРасчета4.ТребуетВводаТарифногоРазряда
		|			ТОГДА ВЫБОР
		|					КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|							И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|						ТОГДА Начисления.ТарифныйРазряд4Завершения
		|					ИНАЧЕ Начисления.ТарифныйРазряд4
		|				КОНЕЦ
		|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
		|	КОНЕЦ КАК ТарифныйРазряд4,
		|	ВЫБОР
		|		КОГДА ДанныеВидаРасчета5.ТребуетВводаТарифногоРазряда
		|			ТОГДА ВЫБОР
		|					КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|							И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|						ТОГДА Начисления.ТарифныйРазряд5Завершения
		|					ИНАЧЕ Начисления.ТарифныйРазряд5
		|				КОНЕЦ
		|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
		|	КОНЕЦ КАК ТарифныйРазряд5,
		|	ВЫБОР
		|		КОГДА ДанныеВидаРасчета6.ТребуетВводаТарифногоРазряда
		|			ТОГДА ВЫБОР
		|					КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|							И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|						ТОГДА Начисления.ТарифныйРазряд6Завершения
		|					ИНАЧЕ Начисления.ТарифныйРазряд6
		|				КОНЕЦ
		|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка)
		|	КОНЕЦ КАК ТарифныйРазряд6,
		|	ВЫБОР
		|		КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|				И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА Начисления.Валюта1Завершения
		|		ИНАЧЕ Начисления.Валюта1
		|	КОНЕЦ КАК Валюта1,
		|	ВЫБОР
		|		КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|				И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА Начисления.Валюта2Завершения
		|		ИНАЧЕ Начисления.Валюта2
		|	КОНЕЦ КАК Валюта2,
		|	ВЫБОР
		|		КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|				И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА Начисления.Валюта3Завершения
		|		ИНАЧЕ Начисления.Валюта3
		|	КОНЕЦ КАК Валюта3,
		|	ВЫБОР
		|		КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|				И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА Начисления.Валюта4Завершения
		|		ИНАЧЕ Начисления.Валюта4
		|	КОНЕЦ КАК Валюта4,
		|	ВЫБОР
		|		КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|				И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА Начисления.Валюта5Завершения
		|		ИНАЧЕ Начисления.Валюта5
		|	КОНЕЦ КАК Валюта5,
		|	ВЫБОР
		|		КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|				И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА Начисления.Валюта6Завершения
		|		ИНАЧЕ Начисления.Валюта6
		|	КОНЕЦ КАК Валюта6,
		|	НачисленияСрезПоследних.ДатаДействия
		|ПОМЕСТИТЬ НачисленияСотрудника
		|ИЗ
		|	РегистрСведений.ПлановыеНачисленияРаботников КАК Начисления
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ НачисленияСрезПоследних КАК НачисленияСрезПоследних
		|		ПО (Начисления.Регистратор <> &Ссылка)
		|			И Начисления.ФизЛицо = НачисленияСрезПоследних.Физлицо
		|			И (ВЫБОР
		|				КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|						И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА Начисления.ПериодЗавершения = НачисленияСрезПоследних.Период
		|				ИНАЧЕ Начисления.Период = НачисленияСрезПоследних.Период
		|			КОНЕЦ)
		|			И (ВЫБОР
		|				КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|						И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА Начисления.ВидРасчетаЗавершения = НачисленияСрезПоследних.ВидРасчета
		|				ИНАЧЕ Начисления.ВидРасчета = НачисленияСрезПоследних.ВидРасчета
		|			КОНЕЦ)
		|			И (ВЫБОР
		|				КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|						И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА Начисления.ДействиеЗавершения <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
		|				ИНАЧЕ Начисления.Действие <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
		|			КОНЕЦ)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ДанныеВидаРасчетаНачисления КАК ДанныеВидаРасчета1
		|		ПО (ВЫБОР
		|				КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|						И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА Начисления.ВидРасчетаЗавершения = ДанныеВидаРасчета1.ВидРасчета
		|				ИНАЧЕ Начисления.ВидРасчета = ДанныеВидаРасчета1.ВидРасчета
		|			КОНЕЦ)
		|			И (ДанныеВидаРасчета1.НомерПоказателя = 1)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ДанныеВидаРасчетаНачисления КАК ДанныеВидаРасчета2
		|		ПО (ВЫБОР
		|				КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|						И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА Начисления.ВидРасчетаЗавершения = ДанныеВидаРасчета2.ВидРасчета
		|				ИНАЧЕ Начисления.ВидРасчета = ДанныеВидаРасчета2.ВидРасчета
		|			КОНЕЦ)
		|			И (ДанныеВидаРасчета2.НомерПоказателя = 2)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ДанныеВидаРасчетаНачисления КАК ДанныеВидаРасчета3
		|		ПО (ВЫБОР
		|				КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|						И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА Начисления.ВидРасчетаЗавершения = ДанныеВидаРасчета3.ВидРасчета
		|				ИНАЧЕ Начисления.ВидРасчета = ДанныеВидаРасчета3.ВидРасчета
		|			КОНЕЦ)
		|			И (ДанныеВидаРасчета3.НомерПоказателя = 3)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ДанныеВидаРасчетаНачисления КАК ДанныеВидаРасчета4
		|		ПО (ВЫБОР
		|				КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|						И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА Начисления.ВидРасчетаЗавершения = ДанныеВидаРасчета4.ВидРасчета
		|				ИНАЧЕ Начисления.ВидРасчета = ДанныеВидаРасчета4.ВидРасчета
		|			КОНЕЦ)
		|			И (ДанныеВидаРасчета4.НомерПоказателя = 4)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ДанныеВидаРасчетаНачисления КАК ДанныеВидаРасчета5
		|		ПО (ВЫБОР
		|				КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|						И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА Начисления.ВидРасчетаЗавершения = ДанныеВидаРасчета5.ВидРасчета
		|				ИНАЧЕ Начисления.ВидРасчета = ДанныеВидаРасчета5.ВидРасчета
		|			КОНЕЦ)
		|			И (ДанныеВидаРасчета5.НомерПоказателя = 5)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ДанныеВидаРасчетаНачисления КАК ДанныеВидаРасчета6
		|		ПО (ВЫБОР
		|				КОГДА Начисления.ПериодЗавершения <= НачисленияСрезПоследних.ДатаДействия
		|						И Начисления.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА Начисления.ВидРасчетаЗавершения = ДанныеВидаРасчета6.ВидРасчета
		|				ИНАЧЕ Начисления.ВидРасчета = ДанныеВидаРасчета6.ВидРасчета
		|			КОНЕЦ)
		|			И (ДанныеВидаРасчета6.НомерПоказателя = 6)
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ
		|	УдержанияСрезПоследних.Сотрудник,
		|	УдержанияСрезПоследних.Физлицо,
		|	Удержания.ВидРасчета,
		|	ВЫБОР
		|		КОГДА Удержания.ПериодЗавершения <= УдержанияСрезПоследних.ДатаДействия
		|				И Удержания.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА Удержания.Показатель1Завершения
		|		ИНАЧЕ Удержания.Показатель1
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА Удержания.ПериодЗавершения <= УдержанияСрезПоследних.ДатаДействия
		|				И Удержания.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА Удержания.Показатель2Завершения
		|		ИНАЧЕ Удержания.Показатель2
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА Удержания.ПериодЗавершения <= УдержанияСрезПоследних.ДатаДействия
		|				И Удержания.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА Удержания.Показатель3Завершения
		|		ИНАЧЕ Удержания.Показатель3
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА Удержания.ПериодЗавершения <= УдержанияСрезПоследних.ДатаДействия
		|				И Удержания.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА Удержания.Показатель4Завершения
		|		ИНАЧЕ Удержания.Показатель4
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА Удержания.ПериодЗавершения <= УдержанияСрезПоследних.ДатаДействия
		|				И Удержания.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА Удержания.Показатель5Завершения
		|		ИНАЧЕ Удержания.Показатель5
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА Удержания.ПериодЗавершения <= УдержанияСрезПоследних.ДатаДействия
		|				И Удержания.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА Удержания.Показатель6Завершения
		|		ИНАЧЕ Удержания.Показатель6
		|	КОНЕЦ,
		|	ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка),
		|	ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка),
		|	ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка),
		|	ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка),
		|	ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка),
		|	ЗНАЧЕНИЕ(Справочник.ТарифныеРазряды.ПустаяСсылка),
		|	ВЫБОР
		|		КОГДА Удержания.ПериодЗавершения <= УдержанияСрезПоследних.ДатаДействия
		|				И Удержания.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА Удержания.Валюта1Завершения
		|		ИНАЧЕ Удержания.Валюта1
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА Удержания.ПериодЗавершения <= УдержанияСрезПоследних.ДатаДействия
		|				И Удержания.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА Удержания.Валюта2Завершения
		|		ИНАЧЕ Удержания.Валюта2
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА Удержания.ПериодЗавершения <= УдержанияСрезПоследних.ДатаДействия
		|				И Удержания.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА Удержания.Валюта3Завершения
		|		ИНАЧЕ Удержания.Валюта3
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА Удержания.ПериодЗавершения <= УдержанияСрезПоследних.ДатаДействия
		|				И Удержания.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА Удержания.Валюта4Завершения
		|		ИНАЧЕ Удержания.Валюта4
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА Удержания.ПериодЗавершения <= УдержанияСрезПоследних.ДатаДействия
		|				И Удержания.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА Удержания.Валюта5Завершения
		|		ИНАЧЕ Удержания.Валюта5
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА Удержания.ПериодЗавершения <= УдержанияСрезПоследних.ДатаДействия
		|				И Удержания.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|			ТОГДА Удержания.Валюта6Завершения
		|		ИНАЧЕ Удержания.Валюта6
		|	КОНЕЦ,
		|	УдержанияСрезПоследних.ДатаДействия
		|ИЗ
		|	РегистрСведений.ПлановыеУдержанияРаботников КАК Удержания
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ УдержанияСрезПоследних КАК УдержанияСрезПоследних
		|		ПО (Удержания.Регистратор <> &Ссылка)
		|			И Удержания.ФизЛицо = УдержанияСрезПоследних.Физлицо
		|			И (ВЫБОР
		|				КОГДА Удержания.ПериодЗавершения <= УдержанияСрезПоследних.ДатаДействия
		|						И Удержания.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА Удержания.ПериодЗавершения = УдержанияСрезПоследних.Период
		|				ИНАЧЕ Удержания.Период = УдержанияСрезПоследних.Период
		|			КОНЕЦ)
		|			И Удержания.ВидРасчета = УдержанияСрезПоследних.ВидРасчета
		|			И (ВЫБОР
		|				КОГДА Удержания.ПериодЗавершения <= УдержанияСрезПоследних.ДатаДействия
		|						И Удержания.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|					ТОГДА Удержания.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
		|				ИНАЧЕ Удержания.Действие = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
		|			КОНЕЦ)
		|;
		|";
	Иначе
		
		// здесь определяем "пустышку", если не выполняется запрос к регистру плановых начислений
		ТекстЗапроса = ТекстЗапроса +  
		"////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	NULL КАК Сотрудник,
		|	NULL КАК Физлицо,
		|	NULL КАК ВидРасчета,
		|	NULL КАК Показатель1,
		|	NULL КАК Показатель2,
		|	NULL КАК Показатель3,
		|	NULL КАК Показатель4,
		|	NULL КАК Показатель5,
		|	NULL КАК Показатель6,
		|	NULL КАК ТарифныйРазряд1,
		|	NULL КАК ТарифныйРазряд2,
		|	NULL КАК ТарифныйРазряд3,
		|	NULL КАК ТарифныйРазряд4,
		|	NULL КАК ТарифныйРазряд5,
		|	NULL КАК ТарифныйРазряд6,
		|	NULL КАК Валюта1,
		|	NULL КАК Валюта2,
		|	NULL КАК Валюта3,
		|	NULL КАК Валюта4,
		|	NULL КАК Валюта5,
		|	NULL КАК Валюта6,
		|	NULL КАК ДатаДействия
		|ПОМЕСТИТЬ НачисленияСотрудника
		|ГДЕ
		|	ЛОЖЬ
		|;
		|";
		
	КонецЕсли;
	
	ЗаполнениеНачислениямиДополнительный.ДобавитьТаблицыВЗапросПолученияДействийСУправленческимиНачислениями(ТекстЗапроса);
	
	ТекстЗапроса = ТекстЗапроса +  "
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	НачисленияСотрудника.Сотрудник КАК Сотрудник,
	|	НачисленияСотрудника.Физлицо,
	|	НачисленияСотрудника.ВидРасчета КАК ВидРасчета
	|ПОМЕСТИТЬ НачисленияЕстьВоВсехНаборах
	|ИЗ
	|	НачисленияСотрудника КАК НачисленияСотрудника
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ НачисленияСтаройПозицииСрезПоследних КАК НачисленияСтаройПозицииСрезПоследних
	|		ПО НачисленияСотрудника.Сотрудник = НачисленияСтаройПозицииСрезПоследних.Сотрудник
	|			И НачисленияСотрудника.ВидРасчета = НачисленияСтаройПозицииСрезПоследних.ВидРасчета
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ НачисленияНовойПозицииСрезПоследних КАК НачисленияНовойПозицииСрезПоследних
	|		ПО НачисленияСотрудника.ВидРасчета = НачисленияНовойПозицииСрезПоследних.ВидРасчета
	|			И НачисленияСотрудника.Сотрудник = НачисленияНовойПозицииСрезПоследних.Сотрудник
	|
	|;
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	НачисленияСтаройПозицииСрезПоследних.Сотрудник КАК Сотрудник,
	|	НачисленияСтаройПозицииСрезПоследних.ВидРасчета КАК ВидРасчета,
	|	НачисленияСтаройПозицииСрезПоследних.ДатаДействия КАК ДатаДействия,
	|	НачисленияСтаройПозицииСрезПоследних.Физлицо КАК Физлицо
	|ПОМЕСТИТЬ НачисленияПозицийОтличаютсяЗначениямиПоказателей
	|ИЗ
	|	НачисленияСтаройПозицииСрезПоследних КАК НачисленияСтаройПозицииСрезПоследних
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ НачисленияНовойПозицииСрезПоследних КАК НачисленияНовойПозицииСрезПоследних
	|		ПО НачисленияСтаройПозицииСрезПоследних.ВидРасчета = НачисленияНовойПозицииСрезПоследних.ВидРасчета
	|			И НачисленияСтаройПозицииСрезПоследних.Сотрудник = НачисленияНовойПозицииСрезПоследних.Сотрудник
	|			И (НачисленияСтаройПозицииСрезПоследних.Показатель1 <> НачисленияНовойПозицииСрезПоследних.Показатель1
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.Показатель2 <> НачисленияНовойПозицииСрезПоследних.Показатель2
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.Показатель3 <> НачисленияНовойПозицииСрезПоследних.Показатель3
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.Показатель4 <> НачисленияНовойПозицииСрезПоследних.Показатель4
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.Показатель5 <> НачисленияНовойПозицииСрезПоследних.Показатель5
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.Показатель6 <> НачисленияНовойПозицииСрезПоследних.Показатель6
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд1 <> НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд1
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд2 <> НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд2
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд3 <> НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд3
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд4 <> НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд4
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд5 <> НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд5
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд6 <> НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд6)
	|
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	НачисленияСтаройПозицииСрезПоследних.Сотрудник КАК Сотрудник,
	|	НачисленияСтаройПозицииСрезПоследних.ВидРасчета КАК ВидРасчета,
	|	НачисленияСтаройПозицииСрезПоследних.ДатаДействия КАК ДатаДействия,
	|	НачисленияСтаройПозицииСрезПоследних.Физлицо КАК Физлицо
	|ПОМЕСТИТЬ НачисленияОтличаютсяЗначениямиПоказателей
	|ИЗ
	|	НачисленияСтаройПозицииСрезПоследних КАК НачисленияСтаройПозицииСрезПоследних
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ НачисленияНовойПозицииСрезПоследних КАК НачисленияНовойПозицииСрезПоследних
	|		ПО НачисленияСтаройПозицииСрезПоследних.ВидРасчета = НачисленияНовойПозицииСрезПоследних.ВидРасчета
	|			И НачисленияСтаройПозицииСрезПоследних.Сотрудник = НачисленияНовойПозицииСрезПоследних.Сотрудник
	|			И (НачисленияСтаройПозицииСрезПоследних.Показатель1 <> НачисленияНовойПозицииСрезПоследних.Показатель1
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.Показатель2 <> НачисленияНовойПозицииСрезПоследних.Показатель2
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.Показатель3 <> НачисленияНовойПозицииСрезПоследних.Показатель3
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.Показатель4 <> НачисленияНовойПозицииСрезПоследних.Показатель4
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.Показатель5 <> НачисленияНовойПозицииСрезПоследних.Показатель5
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.Показатель6 <> НачисленияНовойПозицииСрезПоследних.Показатель6
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд1 <> НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд1
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд2 <> НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд2
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд3 <> НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд3
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд4 <> НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд4
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд5 <> НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд5
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд6 <> НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд6)
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	|	НачисленияСотрудника.Сотрудник,
	|	НачисленияСотрудника.ВидРасчета,
	|	НачисленияСотрудника.ДатаДействия,
	|	НачисленияСотрудника.Физлицо
	|ИЗ
	|	НачисленияСотрудника КАК НачисленияСотрудника
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ НачисленияНовойПозицииСрезПоследних КАК НачисленияНовойПозицииСрезПоследних
	|		ПО НачисленияСотрудника.ВидРасчета = НачисленияНовойПозицииСрезПоследних.ВидРасчета
	|			И НачисленияСотрудника.Сотрудник = НачисленияНовойПозицииСрезПоследних.Сотрудник
	|			И (НачисленияСотрудника.Показатель1 <> НачисленияНовойПозицииСрезПоследних.Показатель1
	|				ИЛИ НачисленияСотрудника.Показатель2 <> НачисленияНовойПозицииСрезПоследних.Показатель2
	|				ИЛИ НачисленияСотрудника.Показатель3 <> НачисленияНовойПозицииСрезПоследних.Показатель3
	|				ИЛИ НачисленияСотрудника.Показатель4 <> НачисленияНовойПозицииСрезПоследних.Показатель4
	|				ИЛИ НачисленияСотрудника.Показатель5 <> НачисленияНовойПозицииСрезПоследних.Показатель5
	|				ИЛИ НачисленияСотрудника.Показатель6 <> НачисленияНовойПозицииСрезПоследних.Показатель6
	|				ИЛИ НачисленияСотрудника.ТарифныйРазряд1 <> НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд1
	|				ИЛИ НачисленияСотрудника.ТарифныйРазряд2 <> НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд2
	|				ИЛИ НачисленияСотрудника.ТарифныйРазряд3 <> НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд3
	|				ИЛИ НачисленияСотрудника.ТарифныйРазряд4 <> НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд4
	|				ИЛИ НачисленияСотрудника.ТарифныйРазряд5 <> НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд5
	|				ИЛИ НачисленияСотрудника.ТарифныйРазряд6 <> НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд6)
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	|	НачисленияСотрудника.Сотрудник,
	|	НачисленияСотрудника.ВидРасчета,
	|	НачисленияСотрудника.ДатаДействия,
	|	НачисленияСотрудника.Физлицо
	|ИЗ
	|	НачисленияСотрудника КАК НачисленияСотрудника
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ НачисленияСтаройПозицииСрезПоследних КАК НачисленияСтаройПозицииСрезПоследних
	|		ПО НачисленияСотрудника.ВидРасчета = НачисленияСтаройПозицииСрезПоследних.ВидРасчета
	|			И НачисленияСотрудника.Сотрудник = НачисленияСтаройПозицииСрезПоследних.Сотрудник
	|			И (НачисленияСотрудника.Показатель1 <> НачисленияСтаройПозицииСрезПоследних.Показатель1
	|				ИЛИ НачисленияСотрудника.Показатель2 <> НачисленияСтаройПозицииСрезПоследних.Показатель2
	|				ИЛИ НачисленияСотрудника.Показатель3 <> НачисленияСтаройПозицииСрезПоследних.Показатель3
	|				ИЛИ НачисленияСотрудника.Показатель4 <> НачисленияСтаройПозицииСрезПоследних.Показатель4
	|				ИЛИ НачисленияСотрудника.Показатель5 <> НачисленияСтаройПозицииСрезПоследних.Показатель5
	|				ИЛИ НачисленияСотрудника.Показатель6 <> НачисленияСтаройПозицииСрезПоследних.Показатель6
	|				ИЛИ НачисленияСотрудника.ТарифныйРазряд1 <> НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд1
	|				ИЛИ НачисленияСотрудника.ТарифныйРазряд2 <> НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд2
	|				ИЛИ НачисленияСотрудника.ТарифныйРазряд3 <> НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд3
	|				ИЛИ НачисленияСотрудника.ТарифныйРазряд4 <> НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд4
	|				ИЛИ НачисленияСотрудника.ТарифныйРазряд5 <> НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд5
	|				ИЛИ НачисленияСотрудника.ТарифныйРазряд6 <> НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд6)
	|
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.НеИзменять) КАК Действие,
	|	НачисленияСотрудника.Сотрудник,
	|	НачисленияСотрудника.Физлицо,
	|	НачисленияСотрудника.ВидРасчета,
	|	НачисленияСотрудника.Показатель1,
	|	НачисленияСотрудника.Показатель2,
	|	НачисленияСотрудника.Показатель3,
	|	НачисленияСотрудника.Показатель4,
	|	НачисленияСотрудника.Показатель5,
	|	НачисленияСотрудника.Показатель6,
	|	НачисленияСотрудника.ТарифныйРазряд1,
	|	НачисленияСотрудника.ТарифныйРазряд2,
	|	НачисленияСотрудника.ТарифныйРазряд3,
	|	НачисленияСотрудника.ТарифныйРазряд4,
	|	НачисленияСотрудника.ТарифныйРазряд5,
	|	НачисленияСотрудника.ТарифныйРазряд6,
	|	НачисленияСотрудника.Валюта1,
	|	НачисленияСотрудника.Валюта2,
	|	НачисленияСотрудника.Валюта3,
	|	НачисленияСотрудника.Валюта4,
	|	НачисленияСотрудника.Валюта5,
	|	НачисленияСотрудника.Валюта6,
	|	НачисленияСотрудника.ДатаДействия
	|ПОМЕСТИТЬ Начисления
	|ИЗ
	|	НачисленияСтаройПозицииСрезПоследних КАК НачисленияСтаройПозицииСрезПоследних
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ НачисленияНовойПозицииСрезПоследних КАК НачисленияНовойПозицииСрезПоследних
	|		ПО НачисленияСтаройПозицииСрезПоследних.ВидРасчета = НачисленияНовойПозицииСрезПоследних.ВидРасчета
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель1 = НачисленияНовойПозицииСрезПоследних.Показатель1
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель2 = НачисленияНовойПозицииСрезПоследних.Показатель2
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель3 = НачисленияНовойПозицииСрезПоследних.Показатель3
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель4 = НачисленияНовойПозицииСрезПоследних.Показатель4
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель5 = НачисленияНовойПозицииСрезПоследних.Показатель5
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель6 = НачисленияНовойПозицииСрезПоследних.Показатель6
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд1 = НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд1
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд2 = НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд2
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд3 = НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд3
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд4 = НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд4
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд5 = НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд5
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд6 = НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд6
	|			И НачисленияСтаройПозицииСрезПоследних.Сотрудник = НачисленияНовойПозицииСрезПоследних.Сотрудник
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ НачисленияСотрудника КАК НачисленияСотрудника
	|		ПО НачисленияСтаройПозицииСрезПоследних.ВидРасчета = НачисленияСотрудника.ВидРасчета
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель1 = НачисленияСотрудника.Показатель1
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель2 = НачисленияСотрудника.Показатель2
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель3 = НачисленияСотрудника.Показатель3
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель4 = НачисленияСотрудника.Показатель4
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель5 = НачисленияСотрудника.Показатель5
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель6 = НачисленияСотрудника.Показатель6
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд1 = НачисленияСотрудника.ТарифныйРазряд1
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд2 = НачисленияСотрудника.ТарифныйРазряд2
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд3 = НачисленияСотрудника.ТарифныйРазряд3
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд4 = НачисленияСотрудника.ТарифныйРазряд4
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд5 = НачисленияСотрудника.ТарифныйРазряд5
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд6 = НачисленияСотрудника.ТарифныйРазряд6
	|			И НачисленияСтаройПозицииСрезПоследних.Сотрудник = НачисленияСотрудника.Сотрудник
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.НеИзменять),
	|	НачисленияСотрудника.Сотрудник,
	|	НачисленияСотрудника.Физлицо,
	|	НачисленияСотрудника.ВидРасчета,
	|	НачисленияСотрудника.Показатель1,
	|	НачисленияСотрудника.Показатель2,
	|	НачисленияСотрудника.Показатель3,
	|	НачисленияСотрудника.Показатель4,
	|	НачисленияСотрудника.Показатель5,
	|	НачисленияСотрудника.Показатель6,
	|	НачисленияСотрудника.ТарифныйРазряд1,
	|	НачисленияСотрудника.ТарифныйРазряд2,
	|	НачисленияСотрудника.ТарифныйРазряд3,
	|	НачисленияСотрудника.ТарифныйРазряд4,
	|	НачисленияСотрудника.ТарифныйРазряд5,
	|	НачисленияСотрудника.ТарифныйРазряд6,
	|	НачисленияСотрудника.Валюта1,
	|	НачисленияСотрудника.Валюта2,
	|	НачисленияСотрудника.Валюта3,
	|	НачисленияСотрудника.Валюта4,
	|	НачисленияСотрудника.Валюта5,
	|	НачисленияСотрудника.Валюта6,
	|	НачисленияСотрудника.ДатаДействия
	|ИЗ
	|	НачисленияСтаройПозицииСрезПоследних КАК НачисленияСтаройПозицииСрезПоследних
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ НачисленияНовойПозицииСрезПоследних КАК НачисленияНовойПозицииСрезПоследних
	|		ПО НачисленияСтаройПозицииСрезПоследних.ВидРасчета = НачисленияНовойПозицииСрезПоследних.ВидРасчета
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель1 = НачисленияНовойПозицииСрезПоследних.Показатель1
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель2 = НачисленияНовойПозицииСрезПоследних.Показатель2
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель3 = НачисленияНовойПозицииСрезПоследних.Показатель3
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель4 = НачисленияНовойПозицииСрезПоследних.Показатель4
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель5 = НачисленияНовойПозицииСрезПоследних.Показатель5
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель6 = НачисленияНовойПозицииСрезПоследних.Показатель6
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд1 = НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд1
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд2 = НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд2
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд3 = НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд3
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд4 = НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд4
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд5 = НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд5
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд6 = НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд6
	|			И НачисленияСтаройПозицииСрезПоследних.Сотрудник = НачисленияНовойПозицииСрезПоследних.Сотрудник
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ НачисленияСотрудника КАК НачисленияСотрудника
	|		ПО НачисленияСтаройПозицииСрезПоследних.ВидРасчета = НачисленияСотрудника.ВидРасчета
	|			И (НачисленияСтаройПозицииСрезПоследних.Показатель1 <> НачисленияСотрудника.Показатель1
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.Показатель2 <> НачисленияСотрудника.Показатель2
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.Показатель3 <> НачисленияСотрудника.Показатель3
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.Показатель4 <> НачисленияСотрудника.Показатель4
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.Показатель5 <> НачисленияСотрудника.Показатель5
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.Показатель6 <> НачисленияСотрудника.Показатель6
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд1 <> НачисленияСотрудника.ТарифныйРазряд1
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд2 <> НачисленияСотрудника.ТарифныйРазряд2
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд3 <> НачисленияСотрудника.ТарифныйРазряд3
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд4 <> НачисленияСотрудника.ТарифныйРазряд4
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд5 <> НачисленияСотрудника.ТарифныйРазряд5
	|				ИЛИ НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд6 <> НачисленияСотрудника.ТарифныйРазряд6)
	|			И НачисленияСтаройПозицииСрезПоследних.Сотрудник = НачисленияСотрудника.Сотрудник
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Начать),
	|	ДанныеСотрудников.Сотрудник,
	|	ДанныеСотрудников.Физлицо,
	|	НачисленияНовойПозицииСрезПоследних.ВидРасчета,
	|	НачисленияНовойПозицииСрезПоследних.Показатель1,
	|	НачисленияНовойПозицииСрезПоследних.Показатель2,
	|	НачисленияНовойПозицииСрезПоследних.Показатель3,
	|	НачисленияНовойПозицииСрезПоследних.Показатель4,
	|	НачисленияНовойПозицииСрезПоследних.Показатель5,
	|	НачисленияНовойПозицииСрезПоследних.Показатель6,
	|	НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд1,
	|	НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд2,
	|	НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд3,
	|	НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд4,
	|	НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд5,
	|	НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд6,
	|	НачисленияНовойПозицииСрезПоследних.Валюта1,
	|	НачисленияНовойПозицииСрезПоследних.Валюта2,
	|	НачисленияНовойПозицииСрезПоследних.Валюта3,
	|	НачисленияНовойПозицииСрезПоследних.Валюта4,
	|	НачисленияНовойПозицииСрезПоследних.Валюта5,
	|	НачисленияНовойПозицииСрезПоследних.Валюта6,
	|	ДанныеСотрудников.ДатаДействия
	|ИЗ
	|	НачисленияНовойПозицииСрезПоследних КАК НачисленияНовойПозицииСрезПоследних
	|		ЛЕВОЕ СОЕДИНЕНИЕ НачисленияСтаройПозицииСрезПоследних КАК НачисленияСтаройПозицииСрезПоследних
	|		ПО (НачисленияСтаройПозицииСрезПоследних.ВидРасчета = НачисленияНовойПозицииСрезПоследних.ВидРасчета)
	|			И НачисленияНовойПозицииСрезПоследних.Сотрудник = НачисленияСтаройПозицииСрезПоследних.Сотрудник
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ДанныеСотрудников КАК ДанныеСотрудников
	|		ПО НачисленияНовойПозицииСрезПоследних.Сотрудник = ДанныеСотрудников.Сотрудник
	|ГДЕ
	|	НачисленияСтаройПозицииСрезПоследних.ВидРасчета ЕСТЬ NULL 
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить),
	|	ДанныеСотрудников.Сотрудник,
	|	ДанныеСотрудников.Физлицо,
	|	НачисленияСтаройПозицииСрезПоследних.ВидРасчета,
	|	НачисленияСтаройПозицииСрезПоследних.Показатель1,
	|	НачисленияСтаройПозицииСрезПоследних.Показатель2,
	|	НачисленияСтаройПозицииСрезПоследних.Показатель3,
	|	НачисленияСтаройПозицииСрезПоследних.Показатель4,
	|	НачисленияСтаройПозицииСрезПоследних.Показатель5,
	|	НачисленияСтаройПозицииСрезПоследних.Показатель6,
	|	НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд1,
	|	НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд2,
	|	НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд3,
	|	НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд4,
	|	НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд5,
	|	НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд6,
	|	НачисленияСтаройПозицииСрезПоследних.Валюта1,
	|	НачисленияСтаройПозицииСрезПоследних.Валюта2,
	|	НачисленияСтаройПозицииСрезПоследних.Валюта3,
	|	НачисленияСтаройПозицииСрезПоследних.Валюта4,
	|	НачисленияСтаройПозицииСрезПоследних.Валюта5,
	|	НачисленияСтаройПозицииСрезПоследних.Валюта6,
	|	ДанныеСотрудников.ДатаДействия
	|ИЗ
	|	НачисленияСтаройПозицииСрезПоследних КАК НачисленияСтаройПозицииСрезПоследних
	|		ЛЕВОЕ СОЕДИНЕНИЕ НачисленияНовойПозицииСрезПоследних КАК НачисленияНовойПозицииСрезПоследних
	|		ПО НачисленияСтаройПозицииСрезПоследних.ВидРасчета = НачисленияНовойПозицииСрезПоследних.ВидРасчета
	|			И НачисленияСтаройПозицииСрезПоследних.Сотрудник = НачисленияНовойПозицииСрезПоследних.Сотрудник
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ДанныеСотрудников КАК ДанныеСотрудников
	|		ПО НачисленияСтаройПозицииСрезПоследних.Сотрудник = ДанныеСотрудников.Сотрудник
	|ГДЕ
	|	НачисленияНовойПозицииСрезПоследних.ВидРасчета ЕСТЬ NULL 
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Начать),
	|	ДанныеСотрудников.Сотрудник,
	|	ДанныеСотрудников.Физлицо,
	|	НачисленияСтаройПозицииСрезПоследних.ВидРасчета,
	|	НачисленияСтаройПозицииСрезПоследних.Показатель1,
	|	НачисленияСтаройПозицииСрезПоследних.Показатель2,
	|	НачисленияСтаройПозицииСрезПоследних.Показатель3,
	|	НачисленияСтаройПозицииСрезПоследних.Показатель4,
	|	НачисленияСтаройПозицииСрезПоследних.Показатель5,
	|	НачисленияСтаройПозицииСрезПоследних.Показатель6,
	|	НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд1,
	|	НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд2,
	|	НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд3,
	|	НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд4,
	|	НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд5,
	|	НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд6,
	|	НачисленияСтаройПозицииСрезПоследних.Валюта1,
	|	НачисленияСтаройПозицииСрезПоследних.Валюта2,
	|	НачисленияСтаройПозицииСрезПоследних.Валюта3,
	|	НачисленияСтаройПозицииСрезПоследних.Валюта4,
	|	НачисленияСтаройПозицииСрезПоследних.Валюта5,
	|	НачисленияСтаройПозицииСрезПоследних.Валюта6,
	|	ДанныеСотрудников.ДатаДействия
	|ИЗ
	|	НачисленияСтаройПозицииСрезПоследних КАК НачисленияСтаройПозицииСрезПоследних
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ НачисленияНовойПозицииСрезПоследних КАК НачисленияНовойПозицииСрезПоследних
	|		ПО НачисленияСтаройПозицииСрезПоследних.ВидРасчета = НачисленияНовойПозицииСрезПоследних.ВидРасчета
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель1 = НачисленияНовойПозицииСрезПоследних.Показатель1
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель2 = НачисленияНовойПозицииСрезПоследних.Показатель2
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель3 = НачисленияНовойПозицииСрезПоследних.Показатель3
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель4 = НачисленияНовойПозицииСрезПоследних.Показатель4
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель5 = НачисленияНовойПозицииСрезПоследних.Показатель5
	|			И НачисленияСтаройПозицииСрезПоследних.Показатель6 = НачисленияНовойПозицииСрезПоследних.Показатель6
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд1 = НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд1
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд2 = НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд2
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд3 = НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд3
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд4 = НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд4
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд5 = НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд5
	|			И НачисленияСтаройПозицииСрезПоследних.ТарифныйРазряд6 = НачисленияНовойПозицииСрезПоследних.ТарифныйРазряд6
	|			И НачисленияСтаройПозицииСрезПоследних.Сотрудник = НачисленияНовойПозицииСрезПоследних.Сотрудник
	|		ЛЕВОЕ СОЕДИНЕНИЕ НачисленияСотрудника КАК НачисленияСотрудника
	|		ПО НачисленияСтаройПозицииСрезПоследних.Сотрудник = НачисленияСотрудника.Сотрудник
	|			И НачисленияСтаройПозицииСрезПоследних.ВидРасчета = НачисленияСотрудника.ВидРасчета
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ДанныеСотрудников КАК ДанныеСотрудников
	|		ПО НачисленияСтаройПозицииСрезПоследних.Сотрудник = ДанныеСотрудников.Сотрудник
	|ГДЕ
	|	НачисленияСотрудника.ВидРасчета ЕСТЬ NULL 
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Изменить),
	|	НачисленияОтличаютсяЗначениямиПоказателей.Сотрудник,
	|	НачисленияОтличаютсяЗначениямиПоказателей.Физлицо,
	|	НачисленияОтличаютсяЗначениямиПоказателей.ВидРасчета,
	|	NULL,
	|	NULL,
	|	NULL,
	|	NULL,
	|	NULL,
	|	NULL,
	|	NULL,
	|	NULL,
	|	NULL,
	|	NULL,
	|	NULL,
	|	NULL,
	|	NULL,
	|	NULL,
	|	NULL,
	|	NULL,
	|	NULL,
	|	NULL,
	|	НачисленияОтличаютсяЗначениямиПоказателей.ДатаДействия
	|ИЗ
	|	НачисленияОтличаютсяЗначениямиПоказателей КАК НачисленияОтличаютсяЗначениямиПоказателей
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ НачисленияЕстьВоВсехНаборах КАК НачисленияЕстьВоВсехНаборах
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ НачисленияПозицийОтличаютсяЗначениямиПоказателей КАК НачисленияПозицийОтличаютсяЗначениямиПоказателей
	|			ПО (НачисленияПозицийОтличаютсяЗначениямиПоказателей.Сотрудник = НачисленияЕстьВоВсехНаборах.Сотрудник)
	|				И (НачисленияПозицийОтличаютсяЗначениямиПоказателей.ВидРасчета = НачисленияЕстьВоВсехНаборах.ВидРасчета)
	|		ПО НачисленияОтличаютсяЗначениямиПоказателей.Сотрудник = НачисленияЕстьВоВсехНаборах.Сотрудник
	|			И НачисленияОтличаютсяЗначениямиПоказателей.ВидРасчета = НачисленияЕстьВоВсехНаборах.ВидРасчета
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.НеИзменять),
	|	НачисленияСотрудника.Сотрудник,
	|	НачисленияСотрудника.Физлицо,
	|	НачисленияСотрудника.ВидРасчета,
	|	НачисленияСотрудника.Показатель1,
	|	НачисленияСотрудника.Показатель2,
	|	НачисленияСотрудника.Показатель3,
	|	НачисленияСотрудника.Показатель4,
	|	НачисленияСотрудника.Показатель5,
	|	НачисленияСотрудника.Показатель6,
	|	НачисленияСотрудника.ТарифныйРазряд1,
	|	НачисленияСотрудника.ТарифныйРазряд2,
	|	НачисленияСотрудника.ТарифныйРазряд3,
	|	НачисленияСотрудника.ТарифныйРазряд4,
	|	НачисленияСотрудника.ТарифныйРазряд5,
	|	НачисленияСотрудника.ТарифныйРазряд6,
	|	НачисленияСотрудника.Валюта1,
	|	НачисленияСотрудника.Валюта2,
	|	НачисленияСотрудника.Валюта3,
	|	НачисленияСотрудника.Валюта4,
	|	НачисленияСотрудника.Валюта5,
	|	НачисленияСотрудника.Валюта6,
	|	НачисленияСотрудника.ДатаДействия
	|ИЗ
	|	НачисленияСотрудника КАК НачисленияСотрудника
	|		ЛЕВОЕ СОЕДИНЕНИЕ НачисленияНовойПозицииСрезПоследних КАК НачисленияНовойПозицииСрезПоследних
	|		ПО НачисленияСотрудника.ВидРасчета = НачисленияНовойПозицииСрезПоследних.ВидРасчета
	|			И НачисленияСотрудника.Сотрудник = НачисленияНовойПозицииСрезПоследних.Сотрудник
	|		ЛЕВОЕ СОЕДИНЕНИЕ НачисленияСтаройПозицииСрезПоследних КАК НачисленияСтаройПозицииСрезПоследних
	|		ПО (НачисленияСтаройПозицииСрезПоследних.ВидРасчета = НачисленияСотрудника.ВидРасчета)
	|			И НачисленияСотрудника.Сотрудник = НачисленияСтаройПозицииСрезПоследних.Сотрудник
	|ГДЕ
	|	НачисленияНовойПозицииСрезПоследних.ВидРасчета ЕСТЬ NULL 
	|	И НачисленияСтаройПозицииСрезПоследних.ВидРасчета ЕСТЬ NULL 
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ВЫБОР
	|		КОГДА Начисления.ВидРасчета ССЫЛКА ПланВидовРасчета.УправленческиеНачисления
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ КАК ЭтоНачисление,
	|	Начисления.Действие КАК Действие,
	|	Начисления.ДатаДействия,
	|	Начисления.Сотрудник,
	|	Начисления.Физлицо КАК Физлицо,
	|	Начисления.ВидРасчета,
	|	ЕСТЬNULL(Начисления.Показатель1, 0) КАК Показатель1,
	|	ЕСТЬNULL(Начисления.Показатель2, 0) КАК Показатель2,
	|	ЕСТЬNULL(Начисления.Показатель3, 0) КАК Показатель3,
	|	ЕСТЬNULL(Начисления.Показатель4, 0) КАК Показатель4,
	|	ЕСТЬNULL(Начисления.Показатель5, 0) КАК Показатель5,
	|	ЕСТЬNULL(Начисления.Показатель6, 0) КАК Показатель6,
	|	Начисления.ТарифныйРазряд1,
	|	Начисления.ТарифныйРазряд2,
	|	Начисления.ТарифныйРазряд3,
	|	Начисления.ТарифныйРазряд4,
	|	Начисления.ТарифныйРазряд5,
	|	Начисления.ТарифныйРазряд6,
	|	ЕСТЬNULL(Начисления.Валюта1, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)) КАК Валюта1,
	|	ЕСТЬNULL(Начисления.Валюта2, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)) КАК Валюта2,
	|	ЕСТЬNULL(Начисления.Валюта3, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)) КАК Валюта3,
	|	ЕСТЬNULL(Начисления.Валюта4, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)) КАК Валюта4,
	|	ЕСТЬNULL(Начисления.Валюта5, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)) КАК Валюта5,
	|	ЕСТЬNULL(Начисления.Валюта6, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)) КАК Валюта6
	|ИЗ
	|	Начисления КАК Начисления";
	
	// В оставшейся части запроса объединяются выборки, сформированные по следующим условиям:
	//	- часть 1: вид расчета есть в наборах старой и новой позиций, в "наборе сотруднике" (везде)
	//  и все записи равны по показателям - не изменять
	//	- часть 2: есть везде, в старой и новой позициях по показателям равны, в сотруднике 
	//  значения показателей отличаются	- не изменять
	//	- часть 3: есть в наборе новой позиции, но нет в наборе старой - начать
	//	- часть 4: есть в наборе старой позиции, но нет в наборе новой - прекратить
	//	- часть 5: есть в наборе старой позиции, есть в наборе новой, но нет в наборе сотрудника - начать
	//	- часть 6: есть в наборе старой, есть в наборе новой, есть в наборе сотрудника, 
	//	отличаются значения показателей - изменить (занулить показатели)
	//	- часть 7: все, чего нет ни в наборе старой ни в наборе новой позиций - не изменять
	
	Запрос.Текст = ТекстЗапроса;
	
	Возврат Запрос.Выполнить().Выгрузить();
	
КонецФункции

// Процедура получает значения показателей по данным управленческого учета
//  для сотрудников, перечисленных во временной таблице запроса
//
Процедура СформироватьЗапросЗначенийПоказателейУправленческогоУчета(Запрос, ПоВременнойСхемеМотивации = Ложь) Экспорт
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	КурсыВалютДляРасчетовСПерсоналом.Валюта,
	|	КурсыВалютДляРасчетовСПерсоналом.Курс,
	|	КурсыВалютДляРасчетовСПерсоналом.Кратность
	|ПОМЕСТИТЬ КурсыВалют
	|ИЗ
	|	РегистрСведений.КурсыВалютДляРасчетовСПерсоналом КАК КурсыВалютДляРасчетовСПерсоналом
	|ГДЕ
	|	КурсыВалютДляРасчетовСПерсоналом.Период = &парамДатаВалютногоУчета
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	|	Константы.ВалютаРегламентированногоУчета,
	|	1,
	|	1
	|ИЗ
	|	Константы КАК Константы
	|
	|ОБЪЕДИНИТЬ
	|
	|ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка),
	|	1,
	|	1
	|;
	|";
	
	ТекстЗапроса = ТекстЗапроса + НачислениеЗарплатыРаботникамПереопределяемый.ТекстЗапросаПоказателейВидаРасчетов();
	
	ТекстЗапроса = ТекстЗапроса + "
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ЗначенияПоказателейСхемМотивации.ПериодДействия КАК ПериодДействия,
	|	ДвиженияРаботников.Физлицо КАК Физлицо,
	|	ЗначенияПоказателейСхемМотивации.Показатель КАК Показатель,
	|	ЗначенияПоказателейСхемМотивации.Значение КАК Значение,
	|	ЗначенияПоказателейСхемМотивации.Валюта КАК Валюта
	|ПОМЕСТИТЬ ЗначенияЕжемесячныхПоказателей
	|ИЗ
	|	ВТДвиженияРаботников КАК ДвиженияРаботников
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ЗначенияПоказателейСхемМотивации КАК ЗначенияПоказателейСхемМотивации
	|		ПО (ЗначенияПоказателейСхемМотивации.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))
	|			И (ЗначенияПоказателейСхемМотивации.ПериодДействия = НАЧАЛОПЕРИОДА(&парамНачало, МЕСЯЦ))
	|			И (ВЫБОР
	|				КОГДА ЗначенияПоказателейСхемМотивации.Показатель.ВидПоказателя = ЗНАЧЕНИЕ(Перечисление.ВидыПоказателейСхемМотивации.Индивидуальный)
	|						ИЛИ ЗначенияПоказателейСхемМотивации.Показатель.ВидПоказателя ЕСТЬ NULL 
	|					ТОГДА ДвиженияРаботников.Физлицо = ЗначенияПоказателейСхемМотивации.Сотрудник.Физлицо
	|				КОГДА ЗначенияПоказателейСхемМотивации.Показатель.ВидПоказателя = ЗНАЧЕНИЕ(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
	|					ТОГДА ДвиженияРаботников.Подразделение = ЗначенияПоказателейСхемМотивации.Подразделение
	|				ИНАЧЕ ИСТИНА
	|			КОНЕЦ)
	|";
	
	НачислениеЗарплатыРаботникамПереопределяемый.ДобавитьОбъединениеЗначенийЕжемесячныхПоказателей(ТекстЗапроса);
	
	ТекстЗапроса = ТекстЗапроса + "
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Период,
	|	ДвиженияРаботников.Физлицо,
	|	ДвиженияРаботников.Подразделение,
	|	ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Показатель,
	|	ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Значение,
	|	ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Валюта
	|ПОМЕСТИТЬ ЗначенияПериодическихПоказателей
	|ИЗ
	|	ВТДвиженияРаботников КАК ДвиженияРаботников
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ПериодическиеЗначенияПоказателейСхемМотивации.СрезПоследних(&парамКонец, Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних
	|		ПО (ВЫБОР
	|				КОГДА ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Показатель.ВидПоказателя = ЗНАЧЕНИЕ(Перечисление.ВидыПоказателейСхемМотивации.ПоПодразделению)
	|					ТОГДА ДвиженияРаботников.Подразделение = ПериодическиеЗначенияПоказателейСхемМотивацииСрезПоследних.Подразделение
	|				ИНАЧЕ ИСТИНА
	|			КОНЕЦ)
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	РазмерТарифныхСтавокСрезПоследних.Период,
	|	РазмерТарифныхСтавокСрезПоследних.ТарифныйРазряд КАК ТарифныйРазряд,
	|	РазмерТарифныхСтавокСрезПоследних.Размер,
	|	РазмерТарифныхСтавокСрезПоследних.Валюта
	|ПОМЕСТИТЬ РазмерТарифныхСтавок
	|ИЗ
	|	РегистрСведений.РазмерТарифныхСтавок.СрезПоследних(&парамНачало) КАК РазмерТарифныхСтавокСрезПоследних
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ТарифныйРазряд
	|;
	|";
	
	Если ПоВременнойСхемеМотивации Тогда
		
		ТекстЗапроса = ТекстЗапроса + 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ДвиженияРаботников.Период,
		|	ДвиженияРаботников.Физлицо,
		|	ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Начать) КАК Действие,
		|	СхемыМотивацииРаботников.ВидРасчета,
		|	ЛОЖЬ КАК ОсновноеНачисление,
		|	СхемыМотивацииРаботников.Организация,
		|	СхемыМотивацииРаботников.Показатель1,
		|	СхемыМотивацииРаботников.Валюта1,
		|	СхемыМотивацииРаботников.Показатель2,
		|	СхемыМотивацииРаботников.Валюта2,
		|	СхемыМотивацииРаботников.Показатель3,
		|	СхемыМотивацииРаботников.Валюта3,
		|	СхемыМотивацииРаботников.Показатель4,
		|	СхемыМотивацииРаботников.Валюта4,
		|	СхемыМотивацииРаботников.Показатель5,
		|	СхемыМотивацииРаботников.Валюта5,
		|	СхемыМотивацииРаботников.Показатель6,
		|	СхемыМотивацииРаботников.Валюта6,
		|	СхемыМотивацииРаботников.ТарифныйРазряд1,
		|	СхемыМотивацииРаботников.ТарифныйРазряд2,
		|	СхемыМотивацииРаботников.ТарифныйРазряд3,
		|	СхемыМотивацииРаботников.ТарифныйРазряд4,
		|	СхемыМотивацииРаботников.ТарифныйРазряд5,
		|	СхемыМотивацииРаботников.ТарифныйРазряд6
		|ПОМЕСТИТЬ ЗаписиПлановыхНачислений
		|ИЗ
		|	РегистрСведений.СхемыМотивацииРаботников КАК СхемыМотивацииРаботников
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДвиженияРаботников КАК ДвиженияРаботников
		|		ПО (СхемыМотивацииРаботников.ВидСхемыМотивации = &парамВидСхемыМотивации)
		|			И (ДвиженияРаботников.Должность = СхемыМотивацииРаботников.Должность)
		|			И (ДвиженияРаботников.Подразделение = СхемыМотивацииРаботников.Подразделение
		|				ИЛИ СхемыМотивацииРаботников.Подразделение В (ЗНАЧЕНИЕ(Справочник.Подразделения.ПустаяСсылка), НЕОПРЕДЕЛЕНО))
		|			И (СхемыМотивацииРаботников.ВидРасчета ССЫЛКА ПланВидовРасчета.УправленческиеНачисления)
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	ДвиженияРаботников.Период,
		|	ДвиженияРаботников.Физлицо,
		|	ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Начать) КАК Действие,
		|	СхемыМотивацииРаботников.ВидРасчета,
		|	СхемыМотивацииРаботников.Организация,
		|	СхемыМотивацииРаботников.Показатель1,
		|	СхемыМотивацииРаботников.Валюта1,
		|	СхемыМотивацииРаботников.Показатель2,
		|	СхемыМотивацииРаботников.Валюта2,
		|	СхемыМотивацииРаботников.Показатель3,
		|	СхемыМотивацииРаботников.Валюта3,
		|	СхемыМотивацииРаботников.Показатель4,
		|	СхемыМотивацииРаботников.Валюта4,
		|	СхемыМотивацииРаботников.Показатель5,
		|	СхемыМотивацииРаботников.Валюта5,
		|	СхемыМотивацииРаботников.Показатель6,
		|	СхемыМотивацииРаботников.Валюта6,
		|	NULL КАК ДокументОснование
		|ПОМЕСТИТЬ ЗаписиПлановыхУдержаний
		|ИЗ
		|	РегистрСведений.СхемыМотивацииРаботников КАК СхемыМотивацииРаботников
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТДвиженияРаботников КАК ДвиженияРаботников
		|		ПО (СхемыМотивацииРаботников.ВидСхемыМотивации = &парамВидСхемыМотивации)
		|			И (ДвиженияРаботников.Должность = СхемыМотивацииРаботников.Должность)
		|			И (ДвиженияРаботников.Подразделение = СхемыМотивацииРаботников.Подразделение
		|				ИЛИ СхемыМотивацииРаботников.Подразделение В (ЗНАЧЕНИЕ(Справочник.Подразделения.ПустаяСсылка), НЕОПРЕДЕЛЕНО))
		|			И (СхемыМотивацииРаботников.ВидРасчета ССЫЛКА ПланВидовРасчета.УправленческиеУдержания)
		|;
		|";
		
	Иначе
		ТекстЗапроса = ТекстЗапроса + "
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
		|	ПлановыеНачисленияРаботников.Период,
		|	ПлановыеНачисленияРаботников.ФизЛицо КАК ФизЛицо,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеНачисленияРаботников.ДействиеЗавершения
		|		ИНАЧЕ ПлановыеНачисленияРаботников.Действие
		|	КОНЕЦ КАК Действие,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ВЫБОР
		|					КОГДА ПлановыеНачисленияРаботников.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
		|						ИЛИ ПлановыеНачисленияРаботников.ВидРасчетаЗавершения = ЗНАЧЕНИЕ(ПланВидовРасчета.УправленческиеНачисления.ПустаяСсылка)
		|						ТОГДА ПлановыеНачисленияРаботников.ВидРасчета
		|					ИНАЧЕ ПлановыеНачисленияРаботников.ВидРасчетаЗавершения
		|				КОНЕЦ
		|		ИНАЧЕ ПлановыеНачисленияРаботников.ВидРасчета
		|	КОНЕЦ КАК ВидРасчета,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ВидРасчетаИзмерение = ЗНАЧЕНИЕ(ПланВидовРасчета.УправленческиеНачисления.ПустаяСсылка)
		|			ТОГДА ИСТИНА
		|		ИНАЧЕ ЛОЖЬ
		|	КОНЕЦ КАК ОсновноеНачисление,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеНачисленияРаботников.Показатель1Завершения
		|		ИНАЧЕ ПлановыеНачисленияРаботников.Показатель1
		|	КОНЕЦ КАК Показатель1,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеНачисленияРаботников.Показатель2Завершения
		|		ИНАЧЕ ПлановыеНачисленияРаботников.Показатель2
		|	КОНЕЦ КАК Показатель2,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеНачисленияРаботников.Показатель3Завершения
		|		ИНАЧЕ ПлановыеНачисленияРаботников.Показатель3
		|	КОНЕЦ КАК Показатель3,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеНачисленияРаботников.Показатель4Завершения
		|		ИНАЧЕ ПлановыеНачисленияРаботников.Показатель4
		|	КОНЕЦ КАК Показатель4,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеНачисленияРаботников.Показатель5Завершения
		|		ИНАЧЕ ПлановыеНачисленияРаботников.Показатель5
		|	КОНЕЦ КАК Показатель5,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеНачисленияРаботников.Показатель6Завершения
		|		ИНАЧЕ ПлановыеНачисленияРаботников.Показатель6
		|	КОНЕЦ КАК Показатель6,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеНачисленияРаботников.Валюта1Завершения
		|		ИНАЧЕ ПлановыеНачисленияРаботников.Валюта1
		|	КОНЕЦ КАК Валюта1,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеНачисленияРаботников.Валюта2Завершения
		|		ИНАЧЕ ПлановыеНачисленияРаботников.Валюта2
		|	КОНЕЦ КАК Валюта2,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеНачисленияРаботников.Валюта3Завершения
		|		ИНАЧЕ ПлановыеНачисленияРаботников.Валюта3
		|	КОНЕЦ КАК Валюта3,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеНачисленияРаботников.Валюта4Завершения
		|		ИНАЧЕ ПлановыеНачисленияРаботников.Валюта4
		|	КОНЕЦ КАК Валюта4,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеНачисленияРаботников.Валюта5Завершения
		|		ИНАЧЕ ПлановыеНачисленияРаботников.Валюта5
		|	КОНЕЦ КАК Валюта5,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеНачисленияРаботников.Валюта6Завершения
		|		ИНАЧЕ ПлановыеНачисленияРаботников.Валюта6
		|	КОНЕЦ КАК Валюта6,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеНачисленияРаботников.ТарифныйРазряд1Завершения
		|		ИНАЧЕ ПлановыеНачисленияРаботников.ТарифныйРазряд1
		|	КОНЕЦ КАК ТарифныйРазряд1,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеНачисленияРаботников.ТарифныйРазряд2Завершения
		|		ИНАЧЕ ПлановыеНачисленияРаботников.ТарифныйРазряд2
		|	КОНЕЦ КАК ТарифныйРазряд2,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеНачисленияРаботников.ТарифныйРазряд3Завершения
		|		ИНАЧЕ ПлановыеНачисленияРаботников.ТарифныйРазряд3
		|	КОНЕЦ КАК ТарифныйРазряд3,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеНачисленияРаботников.ТарифныйРазряд4Завершения
		|		ИНАЧЕ ПлановыеНачисленияРаботников.ТарифныйРазряд4
		|	КОНЕЦ КАК ТарифныйРазряд4,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеНачисленияРаботников.ТарифныйРазряд5Завершения
		|		ИНАЧЕ ПлановыеНачисленияРаботников.ТарифныйРазряд5
		|	КОНЕЦ КАК ТарифныйРазряд5,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеНачисленияРаботников.ТарифныйРазряд6Завершения
		|		ИНАЧЕ ПлановыеНачисленияРаботников.ТарифныйРазряд6
		|	КОНЕЦ КАК ТарифныйРазряд6
		|ПОМЕСТИТЬ ЗаписиПлановыхНачислений
		|ИЗ
		|	РегистрСведений.ПлановыеНачисленияРаботников.СрезПоследних(
		|			&парамНачало,
		|			Физлицо В
		|				(ВЫБРАТЬ
		|					Физлицо
		|				ИЗ
		|					РаботникиСрезПоследних)) КАК ПлановыеНачисленияРаботников
		|ГДЕ
		|	ВЫБОР
		|			КОГДА ПлановыеНачисленияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|					И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамНачало
		|				ТОГДА ПлановыеНачисленияРаботников.ДействиеЗавершения <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
		|			ИНАЧЕ ПлановыеНачисленияРаботников.Действие <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
		|		КОНЕЦ
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ПлановыеНачисленияРаботников.Период,
		|	ПлановыеНачисленияРаботников.ФизЛицо,
		|	ПлановыеНачисленияРаботников.Действие,
		|	ПлановыеНачисленияРаботников.ВидРасчета,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ВидРасчетаИзмерение = ЗНАЧЕНИЕ(ПланВидовРасчета.УправленческиеНачисления.ПустаяСсылка)
		|			ТОГДА ИСТИНА
		|		ИНАЧЕ ЛОЖЬ
		|	КОНЕЦ,
		|	ПлановыеНачисленияРаботников.Показатель1,
		|	ПлановыеНачисленияРаботников.Показатель2,
		|	ПлановыеНачисленияРаботников.Показатель3,
		|	ПлановыеНачисленияРаботников.Показатель4,
		|	ПлановыеНачисленияРаботников.Показатель5,
		|	ПлановыеНачисленияРаботников.Показатель6,
		|	ПлановыеНачисленияРаботников.Валюта1,
		|	ПлановыеНачисленияРаботников.Валюта2,
		|	ПлановыеНачисленияРаботников.Валюта3,
		|	ПлановыеНачисленияРаботников.Валюта4,
		|	ПлановыеНачисленияРаботников.Валюта5,
		|	ПлановыеНачисленияРаботников.Валюта6,
		|	ПлановыеНачисленияРаботников.ТарифныйРазряд1,
		|	ПлановыеНачисленияРаботников.ТарифныйРазряд2,
		|	ПлановыеНачисленияРаботников.ТарифныйРазряд3,
		|	ПлановыеНачисленияРаботников.ТарифныйРазряд4,
		|	ПлановыеНачисленияРаботников.ТарифныйРазряд5,
		|	ПлановыеНачисленияРаботников.ТарифныйРазряд6
		|ИЗ
		|	РегистрСведений.ПлановыеНачисленияРаботников КАК ПлановыеНачисленияРаботников
		|ГДЕ
		|	ПлановыеНачисленияРаботников.ФизЛицо В
		|			(ВЫБРАТЬ
		|				СписокРаботников.Физлицо
		|			ИЗ
		|				СписокРаботников КАК СписокРаботников)
		|	И ПлановыеНачисленияРаботников.Период > &парамНачало
		|	И ПлановыеНачисленияРаботников.Период <= &парамКонец
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ПлановыеНачисленияРаботников.ПериодЗавершения,
		|	ПлановыеНачисленияРаботников.ФизЛицо,
		|	ПлановыеНачисленияРаботников.ДействиеЗавершения,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ДействиеЗавершения = ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
		|			ИЛИ ПлановыеНачисленияРаботников.ВидРасчетаЗавершения = ЗНАЧЕНИЕ(ПланВидовРасчета.УправленческиеНачисления.ПустаяСсылка)
		|			ТОГДА ПлановыеНачисленияРаботников.ВидРасчета
		|		ИНАЧЕ ПлановыеНачисленияРаботников.ВидРасчетаЗавершения
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА ПлановыеНачисленияРаботников.ВидРасчетаИзмерение = ЗНАЧЕНИЕ(ПланВидовРасчета.УправленческиеНачисления.ПустаяСсылка)
		|			ТОГДА ИСТИНА
		|		ИНАЧЕ ЛОЖЬ
		|	КОНЕЦ,
		|	ПлановыеНачисленияРаботников.Показатель1Завершения,
		|	ПлановыеНачисленияРаботников.Показатель2Завершения,
		|	ПлановыеНачисленияРаботников.Показатель3Завершения,
		|	ПлановыеНачисленияРаботников.Показатель4Завершения,
		|	ПлановыеНачисленияРаботников.Показатель5Завершения,
		|	ПлановыеНачисленияРаботников.Показатель6Завершения,
		|	ПлановыеНачисленияРаботников.Валюта1Завершения,
		|	ПлановыеНачисленияРаботников.Валюта2Завершения,
		|	ПлановыеНачисленияРаботников.Валюта3Завершения,
		|	ПлановыеНачисленияРаботников.Валюта4Завершения,
		|	ПлановыеНачисленияРаботников.Валюта5Завершения,
		|	ПлановыеНачисленияРаботников.Валюта6Завершения,
		|	ПлановыеНачисленияРаботников.ТарифныйРазряд1Завершения,
		|	ПлановыеНачисленияРаботников.ТарифныйРазряд2Завершения,
		|	ПлановыеНачисленияРаботников.ТарифныйРазряд3Завершения,
		|	ПлановыеНачисленияРаботников.ТарифныйРазряд4Завершения,
		|	ПлановыеНачисленияРаботников.ТарифныйРазряд5Завершения,
		|	ПлановыеНачисленияРаботников.ТарифныйРазряд6Завершения
		|ИЗ
		|	РегистрСведений.ПлановыеНачисленияРаботников КАК ПлановыеНачисленияРаботников
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПлановыеНачисленияРаботников КАК ВременныеПлановыеНачисленияРаботников
		|		ПО ПлановыеНачисленияРаботников.ФизЛицо = ВременныеПлановыеНачисленияРаботников.ФизЛицо
		|			И ПлановыеНачисленияРаботников.ВидРасчетаИзмерение = ВременныеПлановыеНачисленияРаботников.ВидРасчетаИзмерение
		|			И ПлановыеНачисленияРаботников.Период < ВременныеПлановыеНачисленияРаботников.Период
		|			И ПлановыеНачисленияРаботников.ПериодЗавершения >= ВременныеПлановыеНачисленияРаботников.Период
		|ГДЕ
		|	ПлановыеНачисленияРаботников.ФизЛицо В
		|			(ВЫБРАТЬ
		|				СписокРаботников.Физлицо
		|			ИЗ
		|				СписокРаботников КАК СписокРаботников)
		|	И ПлановыеНачисленияРаботников.ПериодЗавершения >= &парамНачало
		|	И ПлановыеНачисленияРаботников.ПериодЗавершения <= &парамКонец
		|	И ВременныеПлановыеНачисленияРаботников.ФизЛицо ЕСТЬ NULL 
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ФизЛицо,
		|	ВидРасчета,
		|	ТарифныйРазряд1,
		|	ТарифныйРазряд2,
		|	ТарифныйРазряд3,
		|	ТарифныйРазряд4,
		|	ТарифныйРазряд5,
		|	ТарифныйРазряд6
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
		|	ПлановыеУдержанияРаботников.Период,
		|	ПлановыеУдержанияРаботников.ФизЛицо КАК ФизЛицо,
		|	ВЫБОР
		|		КОГДА ПлановыеУдержанияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеУдержанияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеУдержанияРаботников.ДействиеЗавершения
		|		ИНАЧЕ ПлановыеУдержанияРаботников.Действие
		|	КОНЕЦ КАК Действие,
		|	ПлановыеУдержанияРаботников.ВидРасчета КАК ВидРасчета,
		|	ВЫБОР
		|		КОГДА ПлановыеУдержанияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеУдержанияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеУдержанияРаботников.Показатель1Завершения
		|		ИНАЧЕ ПлановыеУдержанияРаботников.Показатель1
		|	КОНЕЦ КАК Показатель1,
		|	ВЫБОР
		|		КОГДА ПлановыеУдержанияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеУдержанияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеУдержанияРаботников.Показатель2Завершения
		|		ИНАЧЕ ПлановыеУдержанияРаботников.Показатель2
		|	КОНЕЦ КАК Показатель2,
		|	ВЫБОР
		|		КОГДА ПлановыеУдержанияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеУдержанияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеУдержанияРаботников.Показатель3Завершения
		|		ИНАЧЕ ПлановыеУдержанияРаботников.Показатель3
		|	КОНЕЦ КАК Показатель3,
		|	ВЫБОР
		|		КОГДА ПлановыеУдержанияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеУдержанияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеУдержанияРаботников.Показатель4Завершения
		|		ИНАЧЕ ПлановыеУдержанияРаботников.Показатель4
		|	КОНЕЦ КАК Показатель4,
		|	ВЫБОР
		|		КОГДА ПлановыеУдержанияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеУдержанияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеУдержанияРаботников.Показатель5Завершения
		|		ИНАЧЕ ПлановыеУдержанияРаботников.Показатель5
		|	КОНЕЦ КАК Показатель5,
		|	ВЫБОР
		|		КОГДА ПлановыеУдержанияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеУдержанияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеУдержанияРаботников.Показатель6Завершения
		|		ИНАЧЕ ПлановыеУдержанияРаботников.Показатель6
		|	КОНЕЦ КАК Показатель6,
		|	ВЫБОР
		|		КОГДА ПлановыеУдержанияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеУдержанияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеУдержанияРаботников.Валюта1Завершения
		|		ИНАЧЕ ПлановыеУдержанияРаботников.Валюта1
		|	КОНЕЦ КАК Валюта1,
		|	ВЫБОР
		|		КОГДА ПлановыеУдержанияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеУдержанияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеУдержанияРаботников.Валюта2Завершения
		|		ИНАЧЕ ПлановыеУдержанияРаботников.Валюта2
		|	КОНЕЦ КАК Валюта2,
		|	ВЫБОР
		|		КОГДА ПлановыеУдержанияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеУдержанияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеУдержанияРаботников.Валюта3Завершения
		|		ИНАЧЕ ПлановыеУдержанияРаботников.Валюта3
		|	КОНЕЦ КАК Валюта3,
		|	ВЫБОР
		|		КОГДА ПлановыеУдержанияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеУдержанияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеУдержанияРаботников.Валюта4Завершения
		|		ИНАЧЕ ПлановыеУдержанияРаботников.Валюта4
		|	КОНЕЦ КАК Валюта4,
		|	ВЫБОР
		|		КОГДА ПлановыеУдержанияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеУдержанияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеУдержанияРаботников.Валюта5Завершения
		|		ИНАЧЕ ПлановыеУдержанияРаботников.Валюта5
		|	КОНЕЦ КАК Валюта5,
		|	ВЫБОР
		|		КОГДА ПлановыеУдержанияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|				И ПлановыеУдержанияРаботников.ПериодЗавершения <= &парамНачало
		|			ТОГДА ПлановыеУдержанияРаботников.Валюта6Завершения
		|		ИНАЧЕ ПлановыеУдержанияРаботников.Валюта6
		|	КОНЕЦ КАК Валюта6,
		|	ПлановыеУдержанияРаботников.ДокументОснование
		|ПОМЕСТИТЬ ЗаписиПлановыхУдержаний
		|ИЗ
		|	РегистрСведений.ПлановыеУдержанияРаботников.СрезПоследних(
		|			&парамНачало,
		|			Физлицо В
		|				(ВЫБРАТЬ
		|					Физлицо
		|				ИЗ
		|					РаботникиСрезПоследних)) КАК ПлановыеУдержанияРаботников
		|ГДЕ
		|	ВЫБОР
		|			КОГДА ПлановыеУдержанияРаботников.ПериодЗавершения <> ДАТАВРЕМЯ(1, 1, 1)
		|					И ПлановыеУдержанияРаботников.ПериодЗавершения <= &парамНачало
		|				ТОГДА ПлановыеУдержанияРаботников.ДействиеЗавершения <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
		|			ИНАЧЕ ПлановыеУдержанияРаботников.Действие <> ЗНАЧЕНИЕ(Перечисление.ВидыДействияСНачислением.Прекратить)
		|		КОНЕЦ
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ПлановыеУдержанияРаботников.Период,
		|	ПлановыеУдержанияРаботников.ФизЛицо,
		|	ПлановыеУдержанияРаботников.Действие,
		|	ПлановыеУдержанияРаботников.ВидРасчета,
		|	ПлановыеУдержанияРаботников.Показатель1,
		|	ПлановыеУдержанияРаботников.Показатель2,
		|	ПлановыеУдержанияРаботников.Показатель3,
		|	ПлановыеУдержанияРаботников.Показатель4,
		|	ПлановыеУдержанияРаботников.Показатель5,
		|	ПлановыеУдержанияРаботников.Показатель6,
		|	ПлановыеУдержанияРаботников.Валюта1,
		|	ПлановыеУдержанияРаботников.Валюта2,
		|	ПлановыеУдержанияРаботников.Валюта3,
		|	ПлановыеУдержанияРаботников.Валюта4,
		|	ПлановыеУдержанияРаботников.Валюта5,
		|	ПлановыеУдержанияРаботников.Валюта6,
		|	ПлановыеУдержанияРаботников.ДокументОснование
		|ИЗ
		|	РегистрСведений.ПлановыеУдержанияРаботников КАК ПлановыеУдержанияРаботников
		|ГДЕ
		|	ПлановыеУдержанияРаботников.ФизЛицо В
		|			(ВЫБРАТЬ
		|				СписокРаботников.Физлицо
		|			ИЗ
		|				СписокРаботников КАК СписокРаботников)
		|	И ПлановыеУдержанияРаботников.Период > &парамНачало
		|	И ПлановыеУдержанияРаботников.Период <= &парамКонец
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ПлановыеУдержанияРаботников.ПериодЗавершения,
		|	ПлановыеУдержанияРаботников.ФизЛицо,
		|	ПлановыеУдержанияРаботников.ДействиеЗавершения,
		|	ПлановыеУдержанияРаботников.ВидРасчета,
		|	ПлановыеУдержанияРаботников.Показатель1Завершения,
		|	ПлановыеУдержанияРаботников.Показатель2Завершения,
		|	ПлановыеУдержанияРаботников.Показатель3Завершения,
		|	ПлановыеУдержанияРаботников.Показатель4Завершения,
		|	ПлановыеУдержанияРаботников.Показатель5Завершения,
		|	ПлановыеУдержанияРаботников.Показатель6Завершения,
		|	ПлановыеУдержанияРаботников.Валюта1Завершения,
		|	ПлановыеУдержанияРаботников.Валюта2Завершения,
		|	ПлановыеУдержанияРаботников.Валюта3Завершения,
		|	ПлановыеУдержанияРаботников.Валюта4Завершения,
		|	ПлановыеУдержанияРаботников.Валюта5Завершения,
		|	ПлановыеУдержанияРаботников.Валюта6Завершения,
		|	ПлановыеУдержанияРаботников.ДокументОснование
		|ИЗ
		|	РегистрСведений.ПлановыеУдержанияРаботников КАК ПлановыеУдержанияРаботников
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПлановыеУдержанияРаботников КАК ВременныеПлановыеУдержанияРаботников
		|		ПО ПлановыеУдержанияРаботников.ФизЛицо = ВременныеПлановыеУдержанияРаботников.ФизЛицо
		|			И ПлановыеУдержанияРаботников.ВидРасчета = ВременныеПлановыеУдержанияРаботников.ВидРасчета
		|			И ПлановыеУдержанияРаботников.Период < ВременныеПлановыеУдержанияРаботников.Период
		|			И ПлановыеУдержанияРаботников.ПериодЗавершения >= ВременныеПлановыеУдержанияРаботников.Период
		|			И ПлановыеУдержанияРаботников.ДокументОснование = ВременныеПлановыеУдержанияРаботников.ДокументОснование
		|ГДЕ
		|	ПлановыеУдержанияРаботников.ФизЛицо В
		|			(ВЫБРАТЬ
		|				СписокРаботников.Физлицо
		|			ИЗ
		|				СписокРаботников КАК СписокРаботников)
		|	И ПлановыеУдержанияРаботников.ПериодЗавершения >= &парамНачало
		|	И ПлановыеУдержанияРаботников.ПериодЗавершения <= &парамКонец
		|	И ВременныеПлановыеУдержанияРаботников.ФизЛицо ЕСТЬ NULL 
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ФизЛицо,
		|	ВидРасчета
		|;
		|";
	
	КонецЕсли;
	
	ТекстЗапроса = ТекстЗапроса + "
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ЗаписиПлановыхНачислений.Период,
	|	ЗаписиПлановыхНачислений.ФизЛицо,
	|	ЗаписиПлановыхНачислений.Действие,
	|	ЗаписиПлановыхНачислений.ВидРасчета,
	|	ЗаписиПлановыхНачислений.ОсновноеНачисление,
	|	ВЫБОР
	|		КОГДА ПоказательВидаРасчета1.ТипТарифныйРазряд
	|			ТОГДА РазмерТарифнойСтавкиРазряда1.Размер
	|		ИНАЧЕ ЗаписиПлановыхНачислений.Показатель1
	|	КОНЕЦ КАК Показатель1,
	|	ВЫБОР
	|		КОГДА ПоказательВидаРасчета2.ТипТарифныйРазряд
	|			ТОГДА РазмерТарифнойСтавкиРазряда2.Размер
	|		ИНАЧЕ ЗаписиПлановыхНачислений.Показатель2
	|	КОНЕЦ КАК Показатель2,
	|	ВЫБОР
	|		КОГДА ПоказательВидаРасчета3.ТипТарифныйРазряд
	|			ТОГДА РазмерТарифнойСтавкиРазряда3.Размер
	|		ИНАЧЕ ЗаписиПлановыхНачислений.Показатель3
	|	КОНЕЦ КАК Показатель3,
	|	ВЫБОР
	|		КОГДА ПоказательВидаРасчета4.ТипТарифныйРазряд
	|			ТОГДА РазмерТарифнойСтавкиРазряда4.Размер
	|		ИНАЧЕ ЗаписиПлановыхНачислений.Показатель4
	|	КОНЕЦ КАК Показатель4,
	|	ВЫБОР
	|		КОГДА ПоказательВидаРасчета5.ТипТарифныйРазряд
	|			ТОГДА РазмерТарифнойСтавкиРазряда5.Размер
	|		ИНАЧЕ ЗаписиПлановыхНачислений.Показатель5
	|	КОНЕЦ КАК Показатель5,
	|	ВЫБОР
	|		КОГДА ПоказательВидаРасчета6.ТипТарифныйРазряд
	|			ТОГДА РазмерТарифнойСтавкиРазряда6.Размер
	|		ИНАЧЕ ЗаписиПлановыхНачислений.Показатель6
	|	КОНЕЦ КАК Показатель6,
	|	ВЫБОР
	|		КОГДА ПоказательВидаРасчета1.ТипТарифныйРазряд
	|			ТОГДА РазмерТарифнойСтавкиРазряда1.Валюта
	|		ИНАЧЕ ЗаписиПлановыхНачислений.Валюта1
	|	КОНЕЦ КАК Валюта1,
	|	ВЫБОР
	|		КОГДА ПоказательВидаРасчета2.ТипТарифныйРазряд
	|			ТОГДА РазмерТарифнойСтавкиРазряда2.Валюта
	|		ИНАЧЕ ЗаписиПлановыхНачислений.Валюта2
	|	КОНЕЦ КАК Валюта2,
	|	ВЫБОР
	|		КОГДА ПоказательВидаРасчета3.ТипТарифныйРазряд
	|			ТОГДА РазмерТарифнойСтавкиРазряда3.Валюта
	|		ИНАЧЕ ЗаписиПлановыхНачислений.Валюта3
	|	КОНЕЦ КАК Валюта3,
	|	ВЫБОР
	|		КОГДА ПоказательВидаРасчета4.ТипТарифныйРазряд
	|			ТОГДА РазмерТарифнойСтавкиРазряда4.Валюта
	|		ИНАЧЕ ЗаписиПлановыхНачислений.Валюта4
	|	КОНЕЦ КАК Валюта4,
	|	ВЫБОР
	|		КОГДА ПоказательВидаРасчета5.ТипТарифныйРазряд
	|			ТОГДА РазмерТарифнойСтавкиРазряда5.Валюта
	|		ИНАЧЕ ЗаписиПлановыхНачислений.Валюта5
	|	КОНЕЦ КАК Валюта5,
	|	ВЫБОР
	|		КОГДА ПоказательВидаРасчета6.ТипТарифныйРазряд
	|			ТОГДА РазмерТарифнойСтавкиРазряда6.Валюта
	|		ИНАЧЕ ЗаписиПлановыхНачислений.Валюта6
	|	КОНЕЦ КАК Валюта6,
	|	ПоказательВидаРасчета1.Показатель КАК ПоказательСсылка1,
	|	ПоказательВидаРасчета2.Показатель КАК ПоказательСсылка2,
	|	ПоказательВидаРасчета3.Показатель КАК ПоказательСсылка3,
	|	ПоказательВидаРасчета4.Показатель КАК ПоказательСсылка4,
	|	ПоказательВидаРасчета5.Показатель КАК ПоказательСсылка5,
	|	ПоказательВидаРасчета6.Показатель КАК ПоказательСсылка6
	|ПОМЕСТИТЬ ПлановыеНачисления
	|ИЗ
	|	ЗаписиПлановыхНачислений КАК ЗаписиПлановыхНачислений
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПоказателиВидаРасчета КАК ПоказательВидаРасчета1
	|		ПО ЗаписиПлановыхНачислений.ВидРасчета = ПоказательВидаРасчета1.ВидРасчета
	|			И (ПоказательВидаРасчета1.НомерПоказателя = 1)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПоказателиВидаРасчета КАК ПоказательВидаРасчета2
	|		ПО ЗаписиПлановыхНачислений.ВидРасчета = ПоказательВидаРасчета2.ВидРасчета
	|			И (ПоказательВидаРасчета2.НомерПоказателя = 2)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПоказателиВидаРасчета КАК ПоказательВидаРасчета3
	|		ПО ЗаписиПлановыхНачислений.ВидРасчета = ПоказательВидаРасчета3.ВидРасчета
	|			И (ПоказательВидаРасчета3.НомерПоказателя = 3)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПоказателиВидаРасчета КАК ПоказательВидаРасчета4
	|		ПО ЗаписиПлановыхНачислений.ВидРасчета = ПоказательВидаРасчета4.ВидРасчета
	|			И (ПоказательВидаРасчета4.НомерПоказателя = 4)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПоказателиВидаРасчета КАК ПоказательВидаРасчета5
	|		ПО ЗаписиПлановыхНачислений.ВидРасчета = ПоказательВидаРасчета5.ВидРасчета
	|			И (ПоказательВидаРасчета5.НомерПоказателя = 5)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПоказателиВидаРасчета КАК ПоказательВидаРасчета6
	|		ПО ЗаписиПлановыхНачислений.ВидРасчета = ПоказательВидаРасчета6.ВидРасчета
	|			И (ПоказательВидаРасчета6.НомерПоказателя = 6)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РазмерТарифныхСтавок КАК РазмерТарифнойСтавкиРазряда1
	|		ПО ЗаписиПлановыхНачислений.ТарифныйРазряд1 = РазмерТарифнойСтавкиРазряда1.ТарифныйРазряд
	|		ЛЕВОЕ СОЕДИНЕНИЕ РазмерТарифныхСтавок КАК РазмерТарифнойСтавкиРазряда2
	|		ПО ЗаписиПлановыхНачислений.ТарифныйРазряд2 = РазмерТарифнойСтавкиРазряда2.ТарифныйРазряд
	|		ЛЕВОЕ СОЕДИНЕНИЕ РазмерТарифныхСтавок КАК РазмерТарифнойСтавкиРазряда3
	|		ПО ЗаписиПлановыхНачислений.ТарифныйРазряд3 = РазмерТарифнойСтавкиРазряда3.ТарифныйРазряд
	|		ЛЕВОЕ СОЕДИНЕНИЕ РазмерТарифныхСтавок КАК РазмерТарифнойСтавкиРазряда4
	|		ПО ЗаписиПлановыхНачислений.ТарифныйРазряд4 = РазмерТарифнойСтавкиРазряда4.ТарифныйРазряд
	|		ЛЕВОЕ СОЕДИНЕНИЕ РазмерТарифныхСтавок КАК РазмерТарифнойСтавкиРазряда5
	|		ПО ЗаписиПлановыхНачислений.ТарифныйРазряд5 = РазмерТарифнойСтавкиРазряда5.ТарифныйРазряд
	|		ЛЕВОЕ СОЕДИНЕНИЕ РазмерТарифныхСтавок КАК РазмерТарифнойСтавкиРазряда6
	|		ПО ЗаписиПлановыхНачислений.ТарифныйРазряд6 = РазмерТарифнойСтавкиРазряда6.ТарифныйРазряд
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ЗаписиПлановыхУдержаний.Период,
	|	ЗаписиПлановыхУдержаний.ФизЛицо,
	|	ЗаписиПлановыхУдержаний.Действие,
	|	ЗаписиПлановыхУдержаний.ВидРасчета,
	|	ЗаписиПлановыхУдержаний.Показатель1 КАК Показатель1,
	|	ЗаписиПлановыхУдержаний.Показатель2 КАК Показатель2,
	|	ЗаписиПлановыхУдержаний.Показатель3 КАК Показатель3,
	|	ЗаписиПлановыхУдержаний.Показатель4 КАК Показатель4,
	|	ЗаписиПлановыхУдержаний.Показатель5 КАК Показатель5,
	|	ЗаписиПлановыхУдержаний.Показатель6 КАК Показатель6,
	|	ЗаписиПлановыхУдержаний.Валюта1 КАК Валюта1,
	|	ЗаписиПлановыхУдержаний.Валюта2 КАК Валюта2,
	|	ЗаписиПлановыхУдержаний.Валюта3 КАК Валюта3,
	|	ЗаписиПлановыхУдержаний.Валюта4 КАК Валюта4,
	|	ЗаписиПлановыхУдержаний.Валюта5 КАК Валюта5,
	|	ЗаписиПлановыхУдержаний.Валюта6 КАК Валюта6,
	|	ПоказательВидаРасчета1.Показатель КАК ПоказательСсылка1,
	|	ПоказательВидаРасчета2.Показатель КАК ПоказательСсылка2,
	|	ПоказательВидаРасчета3.Показатель КАК ПоказательСсылка3,
	|	ПоказательВидаРасчета4.Показатель КАК ПоказательСсылка4,
	|	ПоказательВидаРасчета5.Показатель КАК ПоказательСсылка5,
	|	ПоказательВидаРасчета6.Показатель КАК ПоказательСсылка6,
	|	ЗаписиПлановыхУдержаний.ДокументОснование
	|ПОМЕСТИТЬ ПлановыеУдержания
	|ИЗ
	|	ЗаписиПлановыхУдержаний КАК ЗаписиПлановыхУдержаний
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПоказателиВидаРасчета КАК ПоказательВидаРасчета1
	|		ПО ЗаписиПлановыхУдержаний.ВидРасчета = ПоказательВидаРасчета1.ВидРасчета
	|			И (ПоказательВидаРасчета1.НомерПоказателя = 1)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПоказателиВидаРасчета КАК ПоказательВидаРасчета2
	|		ПО ЗаписиПлановыхУдержаний.ВидРасчета = ПоказательВидаРасчета2.ВидРасчета
	|			И (ПоказательВидаРасчета2.НомерПоказателя = 2)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПоказателиВидаРасчета КАК ПоказательВидаРасчета3
	|		ПО ЗаписиПлановыхУдержаний.ВидРасчета = ПоказательВидаРасчета3.ВидРасчета
	|			И (ПоказательВидаРасчета3.НомерПоказателя = 3)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПоказателиВидаРасчета КАК ПоказательВидаРасчета4
	|		ПО ЗаписиПлановыхУдержаний.ВидРасчета = ПоказательВидаРасчета4.ВидРасчета
	|			И (ПоказательВидаРасчета4.НомерПоказателя = 4)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПоказателиВидаРасчета КАК ПоказательВидаРасчета5
	|		ПО ЗаписиПлановыхУдержаний.ВидРасчета = ПоказательВидаРасчета5.ВидРасчета
	|			И (ПоказательВидаРасчета5.НомерПоказателя = 5)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПоказателиВидаРасчета КАК ПоказательВидаРасчета6
	|		ПО ЗаписиПлановыхУдержаний.ВидРасчета = ПоказательВидаРасчета6.ВидРасчета
	|			И (ПоказательВидаРасчета6.НомерПоказателя = 6)
	|;
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ПлановыеПоказатели.Период,
	|	ПлановыеПоказатели.ФизЛицо,
	|	ВЫБОР
	|		КОГДА ПлановыеПоказатели.НомерПоказателя = 1
	|			ТОГДА ПлановыеПоказатели.ПоказательСсылка1
	|		КОГДА ПлановыеПоказатели.НомерПоказателя = 2
	|			ТОГДА ПлановыеПоказатели.ПоказательСсылка2
	|		КОГДА ПлановыеПоказатели.НомерПоказателя = 3
	|			ТОГДА ПлановыеПоказатели.ПоказательСсылка3
	|		КОГДА ПлановыеПоказатели.НомерПоказателя = 4
	|			ТОГДА ПлановыеПоказатели.ПоказательСсылка4
	|		КОГДА ПлановыеПоказатели.НомерПоказателя = 5
	|			ТОГДА ПлановыеПоказатели.ПоказательСсылка5
	|		КОГДА ПлановыеПоказатели.НомерПоказателя = 6
	|			ТОГДА ПлановыеПоказатели.ПоказательСсылка6
	|	КОНЕЦ КАК Показатель,
	|	ВЫБОР
	|		КОГДА ПлановыеПоказатели.НомерПоказателя = 1
	|			ТОГДА ПлановыеПоказатели.Показатель1
	|		КОГДА ПлановыеПоказатели.НомерПоказателя = 2
	|			ТОГДА ПлановыеПоказатели.Показатель2
	|		КОГДА ПлановыеПоказатели.НомерПоказателя = 3
	|			ТОГДА ПлановыеПоказатели.Показатель3
	|		КОГДА ПлановыеПоказатели.НомерПоказателя = 4
	|			ТОГДА ПлановыеПоказатели.Показатель4
	|		КОГДА ПлановыеПоказатели.НомерПоказателя = 5
	|			ТОГДА ПлановыеПоказатели.Показатель5
	|		КОГДА ПлановыеПоказатели.НомерПоказателя = 6
	|			ТОГДА ПлановыеПоказатели.Показатель6
	|	КОНЕЦ КАК Значение,
	|	ВЫБОР
	|		КОГДА ПлановыеПоказатели.НомерПоказателя = 1
	|			ТОГДА ПлановыеПоказатели.Валюта1
	|		КОГДА ПлановыеПоказатели.НомерПоказателя = 2
	|			ТОГДА ПлановыеПоказатели.Валюта2
	|		КОГДА ПлановыеПоказатели.НомерПоказателя = 3
	|			ТОГДА ПлановыеПоказатели.Валюта3
	|		КОГДА ПлановыеПоказатели.НомерПоказателя = 4
	|			ТОГДА ПлановыеПоказатели.Валюта4
	|		КОГДА ПлановыеПоказатели.НомерПоказателя = 5
	|			ТОГДА ПлановыеПоказатели.Валюта5
	|		КОГДА ПлановыеПоказатели.НомерПоказателя = 6
	|			ТОГДА ПлановыеПоказатели.Валюта6
	|	КОНЕЦ КАК Валюта
	|ПОМЕСТИТЬ ЗначенияПлановыхПоказателей
	|ИЗ
	|	(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|		ПлановыеНачисления.Период КАК Период,
	|		ПлановыеНачисления.ФизЛицо КАК ФизЛицо,
	|		ПоказателиВидаРасчета.НомерПоказателя КАК НомерПоказателя,
	|		ПлановыеНачисления.ПоказательСсылка1 КАК ПоказательСсылка1,
	|		ПлановыеНачисления.ПоказательСсылка2 КАК ПоказательСсылка2,
	|		ПлановыеНачисления.ПоказательСсылка3 КАК ПоказательСсылка3,
	|		ПлановыеНачисления.ПоказательСсылка4 КАК ПоказательСсылка4,
	|		ПлановыеНачисления.ПоказательСсылка5 КАК ПоказательСсылка5,
	|		ПлановыеНачисления.ПоказательСсылка6 КАК ПоказательСсылка6,
	|		ПлановыеНачисления.Показатель1 КАК Показатель1,
	|		ПлановыеНачисления.Показатель2 КАК Показатель2,
	|		ПлановыеНачисления.Показатель3 КАК Показатель3,
	|		ПлановыеНачисления.Показатель4 КАК Показатель4,
	|		ПлановыеНачисления.Показатель5 КАК Показатель5,
	|		ПлановыеНачисления.Показатель6 КАК Показатель6,
	|		ПлановыеНачисления.Валюта1 КАК Валюта1,
	|		ПлановыеНачисления.Валюта2 КАК Валюта2,
	|		ПлановыеНачисления.Валюта3 КАК Валюта3,
	|		ПлановыеНачисления.Валюта4 КАК Валюта4,
	|		ПлановыеНачисления.Валюта5 КАК Валюта5,
	|		ПлановыеНачисления.Валюта6 КАК Валюта6
	|	ИЗ
	|		ПлановыеНачисления КАК ПлановыеНачисления
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПоказателиВидаРасчета КАК ПоказателиВидаРасчета
	|			ПО ПлановыеНачисления.ВидРасчета = ПоказателиВидаРасчета.ВидРасчета
	|	ГДЕ
	|		ПоказателиВидаРасчета.ЗапрашиватьПриКадровыхПеремещениях
	|		И ПоказателиВидаРасчета.Показатель.ВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.НеИзменяется)
	|	
	|	ОБЪЕДИНИТЬ
	|	
	|	ВЫБРАТЬ
	|		ПлановыеУдержания.Период,
	|		ПлановыеУдержания.ФизЛицо,
	|		ПоказателиВидаРасчета.НомерПоказателя,
	|		ПлановыеУдержания.ПоказательСсылка1,
	|		ПлановыеУдержания.ПоказательСсылка2,
	|		ПлановыеУдержания.ПоказательСсылка3,
	|		ПлановыеУдержания.ПоказательСсылка4,
	|		ПлановыеУдержания.ПоказательСсылка5,
	|		ПлановыеУдержания.ПоказательСсылка6,
	|		ПлановыеУдержания.Показатель1,
	|		ПлановыеУдержания.Показатель2,
	|		ПлановыеУдержания.Показатель3,
	|		ПлановыеУдержания.Показатель4,
	|		ПлановыеУдержания.Показатель5,
	|		ПлановыеУдержания.Показатель6,
	|		ПлановыеУдержания.Валюта1,
	|		ПлановыеУдержания.Валюта2,
	|		ПлановыеУдержания.Валюта3,
	|		ПлановыеУдержания.Валюта4,
	|		ПлановыеУдержания.Валюта5,
	|		ПлановыеУдержания.Валюта6
	|	ИЗ
	|		ПлановыеУдержания КАК ПлановыеУдержания
	|			ЛЕВОЕ СОЕДИНЕНИЕ ПоказателиВидаРасчета КАК ПоказателиВидаРасчета
	|			ПО ПлановыеУдержания.ВидРасчета = ПоказателиВидаРасчета.ВидРасчета
	|	ГДЕ
	|		ПоказателиВидаРасчета.ЗапрашиватьПриКадровыхПеремещениях
	|		И ПоказателиВидаРасчета.Показатель.ВозможностьИзменения = ЗНАЧЕНИЕ(Перечисление.ИзменениеПоказателейСхемМотивации.НеИзменяется)) КАК ПлановыеПоказатели
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ЗначенияПоказателей.ПериодДействия,
	|	ЗначенияПоказателей.Физлицо,
	|	ЗначенияПоказателей.Показатель,
	|	ЗначенияПоказателей.Значение,
	|	ВЫБОР
	|		КОГДА ЗначенияПоказателей." + ЗаполнениеДокументовЗК.ВалютаПоказателяИмяПоляЗапроса() + " = ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)
	|			ТОГДА ВЫБОР
	|					КОГДА ЗначенияПоказателей.Показатель.ТипПоказателя = ЗНАЧЕНИЕ(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
	|						ТОГДА ЗначенияПоказателей.Показатель.Валюта
	|					КОГДА ЗначенияПоказателей.Показатель.ТипПоказателя = ЗНАЧЕНИЕ(Перечисление.ТипыПоказателейСхемМотивации.СуммаПоказателя)
	|							И ЗначенияПоказателей.Показатель.СуммируемыйПоказатель.ТипПоказателя = ЗНАЧЕНИЕ(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
	|						ТОГДА ЗначенияПоказателей.Показатель.СуммируемыйПоказатель.Валюта
	|					ИНАЧЕ ЗначенияПоказателей.Валюта
	|				КОНЕЦ
	|		ИНАЧЕ ЗначенияПоказателей." + ЗаполнениеДокументовЗК.ВалютаПоказателяИмяПоляЗапроса() + "
	|	КОНЕЦ КАК Валюта
	|ПОМЕСТИТЬ ЗначенияПоказателейИсходнаяВалюта
	|ИЗ
	|	(ВЫБРАТЬ РАЗЛИЧНЫЕ
	|		ЗначенияЕжемесячныхПоказателей.ПериодДействия КАК ПериодДействия,
	|		ЗначенияЕжемесячныхПоказателей.Физлицо КАК Физлицо,
	|		ЗначенияЕжемесячныхПоказателей.Показатель КАК Показатель,
	|		ЗначенияЕжемесячныхПоказателей.Значение КАК Значение,
	|		ЗначенияЕжемесячныхПоказателей.Валюта КАК Валюта
	|	ИЗ
	|		ЗначенияЕжемесячныхПоказателей КАК ЗначенияЕжемесячныхПоказателей
	|	
	|	ОБЪЕДИНИТЬ
	|	
	|	ВЫБРАТЬ
	|		ЗначенияПериодическихПоказателей.Период,
	|		ЗначенияПериодическихПоказателей.Физлицо,
	|		ЗначенияПериодическихПоказателей.Показатель,
	|		ЗначенияПериодическихПоказателей.Значение,
	|		ЗначенияПериодическихПоказателей.Валюта
	|	ИЗ
	|		ЗначенияПериодическихПоказателей КАК ЗначенияПериодическихПоказателей
	|	
	|	ОБЪЕДИНИТЬ
	|	
	|	ВЫБРАТЬ
	|		ЗначенияПлановыхПоказателей.Период,
	|		ЗначенияПлановыхПоказателей.Физлицо,
	|		ЗначенияПлановыхПоказателей.Показатель,
	|		ЗначенияПлановыхПоказателей.Значение,
	|		ЗначенияПлановыхПоказателей.Валюта
	|	ИЗ
	|		ЗначенияПлановыхПоказателей КАК ЗначенияПлановыхПоказателей) КАК ЗначенияПоказателей
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ЗначенияПоказателей.ПериодДействия,
	|	ЗначенияПоказателей.Физлицо,
	|	ЗначенияПоказателей.Показатель,
	|	ЗначенияПоказателей.Значение КАК ИсходноеЗначение,
	|	ВЫБОР
	|		КОГДА ЗначенияПоказателей.Показатель.ТипПоказателя = ЗНАЧЕНИЕ(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
	|			ТОГДА ЗначенияПоказателей.Значение * (КурсВалютыПоказателя.Курс / КурсВалютыПоказателя.Кратность) / (КурсВалютыУпрУчета.Курс / КурсВалютыУпрУчета.Кратность)
	|		ИНАЧЕ ЗначенияПоказателей.Значение
	|	КОНЕЦ КАК Значение,
	|	ЗначенияПоказателей.Валюта,
	|	ВЫБОР
	|		КОГДА ЗначенияПоказателей.Показатель.ТипПоказателя = ЗНАЧЕНИЕ(Перечисление.ТипыПоказателейСхемМотивации.Денежный)
	|				И (НЕ ЗначенияПоказателей.Валюта В (Константы.ВалютаУправленческогоУчета, ЗНАЧЕНИЕ(Справочник.Валюты.ПустаяСсылка)))
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ КАК ВводитсяВВалюте,
	|	КурсВалютыПоказателя.Курс / КурсВалютыПоказателя.Кратность / (КурсВалютыУпрУчета.Курс / КурсВалютыУпрУчета.Кратность) КАК КурсВалюты
	|ПОМЕСТИТЬ ЗначенияПоказателейИсходныйПериодДействия
	|ИЗ
	|	ЗначенияПоказателейИсходнаяВалюта КАК ЗначенияПоказателей
	|		ЛЕВОЕ СОЕДИНЕНИЕ КурсыВалют КАК КурсВалютыПоказателя
	|		ПО ЗначенияПоказателей.Валюта = КурсВалютыПоказателя.Валюта
	|		ЛЕВОЕ СОЕДИНЕНИЕ КурсыВалют КАК КурсВалютыУпрУчета
	|			ВНУТРЕННЕЕ СОЕДИНЕНИЕ Константы КАК Константы
	|			ПО (ИСТИНА)
	|		ПО (КурсВалютыУпрУчета.Валюта = Константы.ВалютаУправленческогоУчета)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ЗначенияПоказателей.ПериодДействия,
	|	ЗначенияПоказателей.Физлицо,
	|	ЗначенияПоказателей.Показатель";
	
	Запрос.Текст = ТекстЗапроса;
	
	Запрос.Выполнить();
	
КонецПроцедуры