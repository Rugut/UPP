Функция ФормаРабочегоСтола(ТекущийПользователь) Экспорт
	
	Возврат Обработки.РабочийСтол.ПолучитьФорму();
	
КонецФункции

#Если ТолстыйКлиентОбычноеПриложение Тогда

Процедура ОткрытьРабочийСтол() Экспорт

	ТекущийПользователь = глЗначениеПеременной("глТекущийПользователь");
	ФормаРабочегоСтола = РабочийСтолПереопределяемый.ФормаРабочегоСтола(ТекущийПользователь);
	ФормаРабочегоСтола.Открыть();
	ИспользоватьРабочийСтол = УправлениеПользователями.ПолучитьЗначениеПоУмолчанию(ТекущийПользователь, "ОткрыватьПриЗапускеРабочийСтол");
	Если Не ИспользоватьРабочийСтол Тогда
		// для текущего пользователя установим использование рабочего стола
		НаборЗаписей = РегистрыСведений.НастройкиПользователей.СоздатьНаборЗаписей();
		НаборЗаписей.Отбор.Пользователь.Установить(ТекущийПользователь);
		НаборЗаписей.Отбор.Настройка.Установить(ПланыВидовХарактеристик.НастройкиПользователей.ОткрыватьПриЗапускеРабочийСтол);
		НаборЗаписей.Прочитать();
		
		Если НаборЗаписей.Количество() = 0 Тогда
			НоваяЗапись = НаборЗаписей.Добавить();
			НоваяЗапись.Пользователь = ТекущийПользователь;
			НоваяЗапись.Настройка = ПланыВидовХарактеристик.НастройкиПользователей.ОткрыватьПриЗапускеРабочийСтол;
			НоваяЗапись.Значение = Истина;
		ИначеЕсли Не НаборЗаписей[0].Значение Тогда
			НаборЗаписей[0].Значение = Истина;
		КонецЕсли;
		Если ОбщегоНазначения.ЗаписатьНабор(НаборЗаписей) Тогда
			// оповестим форму настройки параметров пользователя
			Оповестить("ИзмененаНастройкаОткрыватьПриЗапускеРабочийСтол", Новый Структура("ТекущийПользователь, ОткрыватьПриЗапускеРабочийСтол", ТекущийПользователь, Истина));
		КонецЕсли;	
	КонецЕсли;	

КонецПроцедуры

Процедура ФормаНачисленийПередОткрытием(Форма) Экспорт
	
	// В этой конфигурации дополнительных действий не предусмотрено
	
КонецПроцедуры

Процедура ИнициализироватьРабочийСтол() Экспорт
 	
	Если УправлениеПользователями.ПолучитьЗначениеПоУмолчанию(глЗначениеПеременной("глТекущийПользователь"), "ОткрыватьПриЗапускеРабочийСтол") Тогда
		ФормаРабочегоСтола = РабочийСтолПереопределяемый.ФормаРабочегоСтола(глЗначениеПеременной("глТекущийПользователь"));
		ФормаРабочегоСтола.Открыть();
	КонецЕсли;
	
КонецПроцедуры

#КонецЕсли